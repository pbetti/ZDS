IOP Intro      Introducton to IOP Concepts
IOP            GETION   GETIOP    GETIOS   IOMATCH  PUTIOD
IOP Recording  IORCOFF  IORCON    IORLOFF  IORLON
DU/Max DU      GETDUOK  GETMDISK  GETMUSER PUTs
Messages       GETMSG   GETSHM    PUTSHM
Named Dir      ADDNDR   DIRNDR    DUNDR    GETNDR    SUBNDR
Path           GETPATH
Processor Spd  GETSPEED PUTSPEED
Quiet Flag     GETQUIET PUTQUIET
RCP Address    GETRCP
Shell Stack    GETSH1   GETSH2
Wheel Byte     GETWHL   PUTWHL
:IOP Intro     Introduction to IOP Concepts

     Thió  seô oæ routineó providå accesó tï thå systeí  I/Ï 
Packagå  (IOP)®   Thå deviceó iî aî IOĞ arå identifieä bù  á 
logicaì IÄ (referrinç tï thå generiã CON¬  RDR¬ PUN¬ anä LSÔ 
devices© anä á physicaì IÄ (referrinç tï thå specifiã devicå 
undeò  thå generic)®   Bù convention¬  thå routineó iî  thió 
collectioî  alwayó pasó thå logicaì IÄ iî thå Â registeò anä 
thå  physicaì  IÄ iî thå Ã register®   Thå  followinç  tablå 
shows the assignments:

          Logical ID
           (B Reg)       Device
          ----------     ------
               0         CON:
               1         RDR:
               2         PUN:
               3         LST:


     Thå IOĞ statuó table¬  whicè ió containeä iî everù IOP¬ 
returnó informatioî oî thå physicaì IDs®   Iô telló ho÷ manù 
physicaì  deviceó  (PID© arå availablå foò eacè logicaì  ID¬ 
anä  iô  telló thå currenô assignmenô (°  tï  PID-1)®   Thió 
table is structured as follows:

          Offset              Number of  Current
          Bytes     Device     Devices  Assignment
          ------    ------    --------- ----------
           0-1      CON:       Byte 0    Byte 1
           2-3      RDR:       Byte 2    Byte 3
           4-5      PUN:       Byte 4    Byte 5
           6-7      LST:       Byte 6    Byte 7

     Foò example¬ iæ bytå ° (numbeò oæ physicaì consoles© ió 
5¬  theî  bytå ± (currenô physicaì consolå  assignment©  caî 
onlù  bå  iî  thå rangå froí ° tï  4®   Thå  GETIOÓ  routinå 
returns the address of this table.


     The routines in the IOP collection are as follows:

          GETION    Return a string giving the name of
                    the device identified by a logical ID
                    and a physical ID

          GETIOP    Return the address and size of the IOP

          GETIOS    Return a pointer to the IOP status table

          IOMATCH   Searches for a physical device name
                    associated with a particular logical ID

          PUTIOD    Select and IOP device by logical ID and
                    physical ID

:IOP Address    GETION   GETIOP   GETIOS   IOMATCH  PUTIOD

Z3LIB Routine: GETION

Function:

     GETIOÎ  (Geô IÏ Name© returnó á pointeò (iî HL© tï  thå 
strinç describinç thå devicå whoså logicaì IÄ (° tï 3¬ wherå 
CON=0¬  RDR=1¬  PUN=2¬ anä LST=3© ió iî Â anä physicaì IÄ ió 
iî C®  Á ió erroò flag.

Inputs: 
     B = Logical device ID (0..3)
     C = Physical ID

Outputs: 
     HL = address of string naming the indicated device
     A = Error Flag
          A=0 and Zero Flag Set (Z) if no IOP or range error
          A=0FFH and NZ if no error


Registers Affected: PSW, HL

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: GETIOP

Function:
     Returî  thå addresó oæ thå input/output packagå  buffeò 
iî HÌ anä thå sizå oæ thå buffeò iî termó oæ 128-bytå blockó 
in A.  If there is no IOP buffer, A=0 and Zero Flag Set (Z).

     GETIOĞ simplù returnó detailó oî thå IOP buffeò addresó 
anä  size¬  buô iô doeó noô saù iæ aî IOP ió residenô withiî 
it®   Tï  finä thió out¬  looë aô thå firsô bytå oæ thå  IOP 
buffer¬  and¬  iæ iô ió zero¬  theî therå ió nï IOP present®  
Example:
          ext  getiop    ;reference
          ...
          call getiop    ;obtain data
          jz   noiopbuf  ;no IOP buffer is available
          mov  a,m       ;get first byte of buffer
          ora  a         ;set zero flag accordingly
          jz   noiopload ;no IOP is in the buffer

Inputs: None

Outputsº HÌ ½ addresó oæ IOĞ buffer
               A=0 and Zero Flag Set (Z) if no buffer, else
               A=sizå oæ buffeò iî 128-bytå blockó anä NZ

Registers Affected: HL, PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: GETIOS

Function:

     GETIOÓ  returnó  á  pointeò tï thå I/Ï  Packagå  statuó 
table in HL.  This table is structured as follows:

          Offset              Number of  Current
          Bytes     Device     Devices  Assignment
          ------    ------    --------- ----------
           0-1      CON:       Byte 0    Byte 1
           2-3      RDR:       Byte 2    Byte 3
           4-5      PUN:       Byte 4    Byte 5
           6-7      LST:       Byte 6    Byte 7

     Error code is returned in A.


Inputs: None

Outputs: 
     HL = address of IOP status table
     A = Error Code
          A=0 and Zero Flag Set (Z) if no IOP loaded
          A=0FFH and NZ if OK

Registers Affected: PSW, HL

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: IOMATCH

Function:

     IOMATCÈ  searcheó foò thå namå (pointeä tï bù HL© oæ  á 
physicaì devicå associateä witè á particulaò logicaì IÄ  (iî 
B)®   Thió  namå  ió  á strinç terminateä bù á nulì  oò  anù 
characteò  lesó  thaî  oò equaì tï á  space®   Thå  namå  ió 
capitalizeä internally®   Iæ found¬ Ã ió returneä containinç 
the physical ID of the device.

     For example,
               ...
               LXI  H,MYCON   ;pointer to string
               MVI  B,0       ;select CON device
               CALL IOMATCH
               JZ   ERROR
               ...            ;C=physical ID of MYCON
     MYCON:    DS   'CRT1',0  ;name of desired CON device

Inputs: 
     HL = address of string name to look for
     B  = Logical ID (CON=0, RDR=1, PUN=2, LST=3)

Outputs: 
     C  = Physical ID
     A  = Error Code
          A=0 and Zero Flag Set if not found or no IOP
          A=0FFH and NZ if OK

Registers Affected: PSW, C

Side Effects: None

Special Error Conditions: None



Z3LIB Routine: PUTIOD

Function:

     PUTIOÄ selectó thå IOĞ devicå indicateä bù thå  logicaì 
IÄ iî Â anä thå physicaì IÄ iî C®  Logicaì IÄ numberó arå iî 
thå rangå froí ° tï 3¬  wherå COÎ ½ 0¬ RDÒ ½ 1¬ PUÎ ½ 2¬ anä 
LSÔ  ½  3®   Seå thå introductorù sectioî oî IOPó  foò  morå 
details.

Inputs: 
     B = Logical ID (CON=0, RDR=1, PUN=2, LST=3)
     C = Physical ID

Outputs: 
     A = Error Code
          A=0 and Zero Flag Set (Z) if no IOP or range error
               (physical or logical ID number invalid)
          A=0FFH and NZ if OK

Registers Affected: PSW

Side Effects: Device selection is made

Special Error Conditions: None


:IOP Recording      IORCOFF   IORCON    IORLOFF   IORLON

Z3LIB Routine: IORCON/IORCOFF/IORLON/IORLOFF

Function:

     IORCOÎ  turnó oî thå Consolå I/Ï Recordinç facilitù  iî 
thå  currenô I/Ï Package®   Oî input¬  HÌ pointó tï  aî  FCÂ 
whicè  identifieó  thå filå tï recorä intï (thió ió á  ZCPR³ 
standarä FCB¬ wherå offseô ° containó thå disë anä offseô 1³ 
thå  useò  data)®   Á  particulaò IOĞ maù  oò  maù  noô  paù 
attentioî tï thió FCÂ pointer¬ dependinç oî implementation.

     IORCOFÆ turnó ofæ thå Consolå I/Ï Recordinç facilitù iî 
thå currenô I/Ï Package.

     IORLOÎ  anä IORLOFÆ perforí thå samå functionó foò  thå 
List I/O Recording facility.

     Oî exit¬  Á returnó aî erroò codå indicatinç succesó oò 
failure.

Inputs: 
     HL = address of ZCPR3 FCB identifying file to record
          into for IORCON and IORLON

Outputs: 
     A = Error Code
          A=0 and Zero Flag Set (Z) if no IOP available or
               IOP does not support I/O Recording
          A=0FFH and NZ if OK

Registers Affected: PSW

Side Effects: I/O Recording is turned on or off

Special Error Conditions: None


:DÕ  GETDUOË GETMDISË GETMUSEÒ PUTDUOK PUTMDISË PUTMUSER

Z3LIB Routine: GETDUOK

Function:
     Returî thå DUOË flaç iî Á witè thå Zerï Flaç Seô (Z© iæ 
A=0®   DUOË  ió  á flaç whicè telló thå prograí iæ iô ió  tï 
permiô thå useò tï specifù thå DUº prefiø tï changå disë anä 
useò area®  Á ZCPR³ utilitù caî alwayó specifù á DIRº prefiø 
(nameä  directory© iî identifyinç thå disë anä useò areá  tï 
examine¬  buô  iî  somå  "secure¢  applicationó  iô  ió  noô 
desirablå  tï  allo÷ thå useò tï emploù thå  DUº  prefiø  tï 
accesó  ANÙ  disk/useò area®   Thió flaç  (DUOK©  telló  thå 
utility if it is OK for the user to employ the DU: prefix.

Inputs: None

Outputs: A=0 and Zero Flag Set (Z) if NOT OK to use DU:
            A=0FFH and Zero Flag Clear (NZ) if OK to use DU:


Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: GETMDISK

Function:
     Returî  thå  numbeò  oæ thå maximuí disë  iî  A®   Thió 
numbeò ió iî thå rangå froí ± tï 16¬ wherå ± meanó disë Á ió 
the maximum disk on the system and 16 means disk P is.

     Thå  ZCPR³  Environmenô  Descriptoò  maù  bå  useä   tï 
restricô  accesó  tï  certaiî  partó  oæ  thå  system®   Foò 
instance¬  á  "normaì user¢ maù bå denieä accesó tï diskó  Ã 
anä  Ä anä tï anù useò areá beyonä 10®   Á "privelegeä user¢ 
whï haó thå poweò tï changå thå ZCPR³ Environmenô Descriptoò 
can gain access to any disk or user area he desires.

Inputs: None

Outputs: A = disk number (disk A = 1)


Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: GETMUSER

Function:
     Returî thå numbeò oæ thå maximuí useò areá iî A®   Thió 
number is in the range from 0 to 31.

     Thå  ZCPR³  Environmenô  Descriptoò  maù  bå  useä   tï 
restricô  accesó  tï  certaiî  partó  oæ  thå  system®   Foò 
instance¬  á  "normaì user¢ maù bå denieä accesó tï diskó  Ã 
anä  Ä anä tï anù useò areá beyonä 10®   Á "privelegeä user¢ 
whï haó thå poweò tï changå thå ZCPR³ Environmenô Descriptoò 
can gain access to any disk or user area he desires.

Inputs: None

Outputs: A = maximum user area which may be accessed


Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: PUTDUOK

Function:

     PUTDUOË  setó thå DÕ OË bytå froí A®   Iæ A=0¬  DUOË ió 
falså (usinç DÕ ió NOÔ OK)¬ anä iæ A<>° (0FFÈ ió preferred)¬ 
DUOË  ió truå (usinç DÕ ió OK)®   Nï registeró  affecteä  oò 
error codes returned.

Inputs: 
     A = DUOK value (0=DU NOT OK, 0FFH = DU OK)

Outputs: None

Registers Affected: None
Side Effects: DUOK flag is set
Special Error Conditions: None


Z3LIB Routine: PUTMDISK

Function:

     PUTMDISË  setó thå maximuí disk¬  aó indicateä bù thå Á 
registeò (A=± setó disë Aº  aó max¬  A=² setó disë B:¬ etc)®  
Nï erroò conditionó arå returneä (nï validitù checë oæ inpuô 
argument is made), and no registers are affected.

Inputs: 
     A = Maximum Disk number (disk A: = 1)

Outputs: None

Registers Affected: None
Side Effects: MDISK flag in Environment Descriptor is set
Special Error Conditions: None


Z3LIB Routine: PUTMUSER

Function:

     PUTMUSEÒ  setó thå maximuí useò area¬  aó indicateä  bù 
thå  Á  register®   Nï  erroò conditionó  arå  returneä  (nï 
validitù checë oæ inpuô argumenô ió made)¬  anä nï registeró 
are affected.

Inputs: 
     A = Maximum User number (user 0 = 0)

Outputs: None

Registers Affected: None
Side Effects: Max User flag in Environment Descriptor set
Special Error Conditions: None

:Messages       GETMSG GETSHM PUTSHM

Z3LIB Routine: GETMSG

Function:
     Returî  thå addresó oæ thå ZCPR³ Messagå Buffeò iî  HL®  
A=°  anä  Zerï  Flaç Seô (Z© iæ therå ió  nï  ZCPR³  Messagå 
Buffer.
     Seå thå Z3LIÂ informatioî sectionó oî ZCPR³ Messages.

Inputs: None

Outputs: HL = address of ZCPR3 Message Buffer
            A = 0 and Zero Flag Set (Z) if there is none

Registers Affected: HL, PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: GETSHM

Function:
     GETSHÍ  returnó  thå valuå oæ thå shelì  messagå  whoså 
numbeò  ió specifieä iî B®   Therå arå threå shelì messages¬ 
sï ° <½ Â <½ ² (thå programmeò musô bå surå á valiä valuå ió 
presented).

Inputs: B = Message Number (0, 1, 2)

Outputs: A = Message Value (Zero Flag Set Accordingly)

Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: PUTSHM

Function:
     PUTSHÍ setó thå valuå oæ thå shelì messagå whoså numbeò 
ió giveî iî B®   Thå messagå valuå ió iî A®   Therå arå onlù 
three shell messages, so B = 0, 1, or 2.

Inputs: A = Message Value, B = Message Number = 0,1,2

Outputs: None

Registers Affected: None

Side Effects: Message Value is Set

Special Error Conditions: None

:Named Dir      ADDNDR  DIRNDR  DUNDR  GETNDR  SUBNDR

Z3LIB Routine: ADDNDR

Function:

     ADDNDÒ  addó  á directorù namå tï thå  nameä  directorù 
buffer¬  iæ possible®   HÌ pointó tï á ZCPR³ FCÂ (disë ió aô 
offseô  0¬  witè currenô disë ½ ° anä disë Á ½ 1¬  anä  useò 
numbeò  ió aô offseô 13© whicè containó thå disë namå iî thå 
FÎ fielä oæ thå FCB®  DÅ optionallù pointó tï aî 8-characteò 
buffeò  containinç  thå password®   Botè FÎ anä  thå  8-chaò 
passworä buffeò arå space-filleä oî thå right®  Oî input¬ iæ 
A=°  theî thå DÅ pointeò ió ignoreä anä thå passworä ió  seô 
empty (all spaces).

     ADDNDÒ capitalizeó thå disë namå anä password®  Iô alsï 
sortó  thå  nameä  directorù buffeò tï  insurå  thaô  iô  ió 
properlù  ordereä  bù DU®   Nï checë ió madå  foò  duplicatå 
names or duplicate DU references.


     Iæ therå ió nï nameä directorù buffeò oò iæ thå  buffeò 
ió  full¬  ADDNDÒ  returnó witè A=° anä Zerï Flaç  Set®   Iæ 
ADDNDR succeeded, A=0FFH and NZ.

Inputs: 
     A = Password flag:
          if A=0, set password to all spaces (no password)
          if A<>0, set password from buffer pted to by DE
     HL = address of FCB containing DU and disk name
     DE = address of password buffer (8 chars)
Outputs: 
     A = Return code:
          A=0 and Zero Flag Set (Z) if no named directory
               buffer or directory buffer full
          A<>0 and NZ if success

Registers Affected: PSW
Side Effects: Named directory buffer is changed
Special Error Conditions: None

Z3LIB Routine: DIRNDR

Function:

     DIRNDÒ searcheó througè thå currenô nameä directorù foò 
thå  namå  whoså buffeò ió pointeä tï bù HL®   Thió namå  ió 
automaticallù capitalized¬  anä HÌ pointó tï aî  8-characteò 
buffeò  (spacå filì oî right© containinç thå namå tï  searcè 
for®   Iæ  found¬  BÃ ½ DÕ (disë Á ½ 1© associateä witè  thå 
name¬   anä  HÌ  pointó  tï  thå  18-bytå  entry¬  whicè  ió 
structured as follows:

          DB   DISK ;A=1
          DB   USER
          DS   8    ;Name (caps) with space fill
          DS   8    ;Password (caps) with space fill

     If no NDR buffer or not found, A=0 and Zero Flag Set.


Inputs: 
     HL = address of 8-char buffer containing name to
          search for (space fill on right)

Outputs: 
     BC = DU (disk A = 1) if found
     HL = address of NDR entry if found
     A = Error Code
          A=0 and Zero Flag Set (Z) if no NDR buffer or
               name not found
          A=0FFH and NZ if name found

Registers Affected: BC, HL, PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: DUNDR

Function:

     DUNDÒ searcheó througè thå currenô nameä directorù  foò 
thå DÕ (disk/user© containeä iî BÃ (disë Á ½ 1).

     Iæ  found¬  HÌ  pointó tï thå 18-bytå entry¬  whicè  ió 
structureä aó follows:

          DB   DISK ;A=1
          DB   USER
          DS   8    ;Name (caps) with space fill
          DS   8    ;Password (caps) with space fill

     If no NDR buffer or not found, A=0 and Zero Flag Set.


Inputs: 
     BC = DU to search for (disk A = 1)

Outputs: 
     HL = address of NDR entry if found
     A = Error Code
          A=0 and Zero Flag Set (Z) if no NDR buffer or
               name not found
          A=0FFH and NZ if name found

Registers Affected: HL, PSW

Side Effects: None

Special Error Conditions: None

Z3LIB Routine: GETNDR

Function:
     Returî  thå addresó oæ thå nameä directorù buffeò iî HÌ 
anä thå sizå oæ thå buffeò iî termó oæ 128-bytå blockó iî A®  
Iæ therå ió nï NDÒ buffer¬ A=° anä Zerï Flaç Seô (Z).

     GETNDR simplù returnó detailó oî thå NDR buffeò addresó 
anä  size¬  buô iô doeó noô saù iæ aî NDR ió residenô withiî 
it®   Tï  finä thió out¬  looë aô thå firsô bytå oæ thå  NDR 
buffer¬  and¬  iæ iô ió zero¬  theî therå ió nï NDR present®  
Example:
          ext  getndr    ;reference
          ...
          call getndr    ;obtain data
          jz   nondrbuf  ;no NDR buffer is available
          mov  a,m       ;get first byte of buffer
          ora  a         ;set zero flag accordingly
          jz   nondrload ;no NDR is in the buffer

Inputs: None

Outputsº HÌ ½ addresó oæ NDR buffer
               A=0 and Zero Flag Set (Z) if no buffer, else
               A=sizå oæ buffeò iî 128-bytå blockó anä NZ

Registers Affected: HL, PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: SUBNDR

Function:

     SUBNDÒ  subtractó  (removes© á directorù namå froí  thå 
nameä directorù buffer¬  iæ possible®   HÌ pointó tï thå  8-
characteò  buffeò containinç thå namå tï deletå (spacå  filì 
oî right)®  SUBNDÒ capitalizeó thió namå anä removeó iô froí 
thå  nameä directorù buffeò iæ iô ió present¬  repackinç thå 
buffer.

     Iæ  therå ió nï nameä directorù buffeò oò thå  namå  ió 
noô  founä iî thå buffer¬  SUBNDÒ returnó witè A=° anä  Zerï 
Flag Set (Z).  If success, SUBNDR returns with A<>0 and NZ.


Inputs: 
     HL = address of 8-char buffer containing name to delete

Outputs: 
     A=0 and Zero Flag Set (Z) if no NDR or name not found
     A<>0 and NZ if success

Registers Affected: PSW

Side Effects: Named directory buffer is changed

Special Error Conditions: None


:Path           GETPATH

Z3LIB Routine: GETPATH

Function:
     Returî  thå addresó oæ thå ZCPR³ Command-Searcè Patè iî 
HL®   A=°  anä Zerï Flaç Seô (Z© iæ therå ió nï ZCPR³  Path®  
Iæ  therå  ió  á ZCPR³ Path¬  Á ½ numbeò  oæ  two-bytå  patè 
elements allowed in it.

     A ZCPR3 Path Element is structured as follows:

          Byte 1:  Disk ID
                    Disk A = 1, B = 2, etc
                    Current Disk = '$'
          Byte 2:  User ID
                    Number from 0 to 31


     A ZCPR3 Path is terminated by a Disk ID of 0.  Example:

          path:
               db   '$',1     ;current disk, user 1
               db   1,'$'     ;disk A, current user
               db   1,15      ;disk A, user 15
               db   0         ;end of path

Inputs: None

Outputs: HL = address of ZCPR3 Path
            A = 0 and Zero Flag Set (Z) if there is none

Registers Affected: HL, PSW

Side Effects: None

Special Error Conditions: None

:Processor Spd  GETSPEED PUTSPEED

Z3LIB Routine: GETSPEED

Function:
     Returî thå speeä oæ thå processoò iî A®   Thió one-bytå 
valuå  ió tï represenô thå processoò speeä iî  MHz¬  sï  A=± 
means 1 MHz, A = 4 means 4 MHz, etc.

     This function is useful for software timing loops.

Inputs: None

Outputs: A = processor speed

Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: PUTSPEED

Function:

     PUTSPEEÄ setó thå processoò speeä (passeä iî  A)®   A=± 
for 1 MHz, 2 for 2 MHz, etc.

     Nï  erroò  messageó arå returneä (nï validitù checë  ió 
made).  No registers are affected.

Inputs: 
     A = Processor Speed in MHz

Outputs: None

Registers Affected: None
Side Effects: Processor Speed in Env Desc is set
Special Error Conditions: None

:Quiet Flag     GETQUIET PUTQUIET

Z3LIB Routine: GETQUIET

Function:
     Returî thå Quieô Flaç iî A®  A½ ° anä Zerï Flaç Seô (Z© 
iæ  thå prograí ió NOÔ tï ruî quietly¬  A=0FFÈ anä NÚ iæ thå 
program is to run quietly.

     Bù quieô operation¬  thå prograí ió noô tï displaù  anù 
informative messages.

Inputs: None

Outputs: A = Quiet Flag (0=not quiet) and Zero Flag set
               accordingly


Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: PUTQUIET

Function:

     PUTQUIEÔ  setó thå quieô flaç witè thå valuå iî Á  (A=° 
foò NOÔ QUIET¬ Á <¾ ° [0FFÈ preferredİ foò quiet)®  Nï erroò 
messages, and no registers affected.

Inputs: 
     A = Quiet flag value (0=NOT QUIET, 0FFH=QUIET)

Outputs: None

Registers Affected: None
Side Effects: Quiet flag in Env Desc is set
Special Error Conditions: None

:RCP Address    GETRCP

Z3LIB Routine: GETRCP

Function:
     Returî  thå  addresó oæ thå  residenô  commanä  packagå 
buffeò iî HÌ anä thå sizå oæ thå buffeò iî termó oæ 128-bytå 
blockó iî A®   Iæ therå ió nï RCĞ buffer¬  A=° anä Zerï Flaç 
Seô (Z).

     GETRCĞ simplù returnó detailó oî thå RCĞ buffeò addresó 
anä  size¬  buô iô doeó noô saù iæ aî RCĞ ió residenô withiî 
it®   Tï  finä thió out¬  looë aô thå firsô bytå oæ thå  RCĞ 
buffer¬  and¬  iæ iô ió zero¬  theî therå ió nï RCĞ present®  
Example:
          ext  getfcp    ;reference
          call getfcp    ;obtain data
          jz   nofcpbuf  ;no FCP buffer is available
          mov  a,m       ;get first byte of buffer
          ora  a         ;set zero flag accordingly
          jz   nofcpload ;no FCP is in the buffer

Inputs: None

Outputsº HÌ ½ addresó oæ RCĞ buffer
               A=0 and Zero Flag Set (Z) if no buffer, else
               A=sizå oæ buffeò iî 128-bytå blockó anä NZ

Registers Affected: HL, PSW

Side Effects: None

Special Error Conditions: None

:Shell Stack    GETSH1 GETSH2

Z3LIB Routine: GETSH1

Function:
     Returî  thå addresó oæ thå shelì stacë iî HL¬  thå sizå 
oæ  eacè shelì stacë entrù iî B¬  anä thå numbeò oæ  entrieó 
possiblå iî thå shelì stacë iî A®  A=° anä Zerï Flaç Seô (Z© 
if there is no shell stack.

     Seå  thå SHPUSÈ anä SHPOĞ routineó foò detaiì oî  otheò 
facilitieó foò dealinç witè shelì stackó provideä bù  Z3LIB®  
GETSH± serveó mainlù tï providå data.

Inputs: None

Outputs: HL = address of Shell Stack
               B = number of bytes in each shell stack entry
               A = number of entries possible in the stack
                    A = 0 and Zero Flag Set (Z) if no stack


Registers Affected: HL, B, PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: GETSH2

Function:
     Returî thå addresó oæ thå shelì stacë iî HL¬  thå  sizå 
oæ  eacè shelì stacë entrù iî DE¬  anä thå numbeò oæ entrieó 
possiblå iî thå shelì stacë iî botè Á anä B®   A=° anä  Zerï 
Flaç Seô (Z© iæ therå ió nï shelì stack.

     Seå  thå  SHPUSÈ  anä SHPOĞ routineó  foò  otheò  Z3LIÂ 
capabilitieó  wrô shells®   GETSH² serveó mainlù tï  providå 
datá iî á forí thaô ió morå usablå foò certaiî  applicationó 
thaî GETSH1.

Inputs: None

Outputs: HL = address of Shell Stack
              DE = number of bytes in each shell stack entry
             A,B = number of entries possible in the stack
                    A = 0 and Zero Flag Set (Z) if no stack


Registers Affected: HL, DE, B, PSW

Side Effects: None

Special Error Conditions: None


:Wheel Byte     GETWHL PUTWHL

Z3LIB Routine: GETWHL

Function:
     Returî thå Wheeì Bytå iî A®  A½ ° anä Zerï Flaç Seô (Z© 
iæ thå prograí ió NOÔ tï givå Wheeì powers¬ A=0FFÈ anä NÚ iæ 
thå prograí ió tï ruî iî á privelegeä mode.

     Bù wheeì operation¬  thå prograí ió noô tï prohibiô thå 
useò froí performinç anù function®   Foò instance¬  allowinç 
thå  useò tï changå thå PATÈ shoulä bå á Wheeì  functioî  sï 
thaô  thå  "normal¢  useò  ió  noô  alloweä  tï  changå  hió 
environmenô whilå á "priveleged¢ useò is.

Inputs: None

Outputs: A = Wheel Byte (0=not wheel) and Zero Flag set
               accordingly


Registers Affected: PSW

Side Effects: None

Special Error Conditions: None


Z3LIB Routine: PUTWHL

Function:
     Seô thå Wheeì Bytå iî A®  A½ ° anä Zerï Flaç Seô (Z© iæ 
thå  prograí ió NOÔ tï givå Wheeì powers¬  A=0FFÈ anä NÚ  iæ 
thå prograí ió tï ruî iî á privelegeä mode.

Inputs: A=Wheel Byte Value

Outputs: None

Registers Affected: None

Side Effects: Wheel Byte is Set

Special Error Conditions: None

