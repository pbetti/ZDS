ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее BIGTREK ASC   Ђ     	 
   BIGTREK ASC  Ђ         BIGTREK ASC           BIGTREK BAS   Ђ      ! " #  BIGTREK BAS  Ђ$ % & ' ( ) * +  BIGTREK BAS  8, - . /          CATALOG 22    0                CATALOG 24    1                DUMP    ASM   Ђ2 3 4 5 6 7 8 9  DUMP    ASM  : ;              DUMP    COM   < =              LIST    COM   
>                PIP     COM   :? @ A B          RATFOR  COM   ЂC D E F G H I J  RATFOR  COM  ~K L M N O P Q R  STARTREKTXT   ЂS T U V W X Y Z ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее STARTREKTXT  Ђ[ \ ] ^ _ ` a b  STARTREKTXT  Ђc d e f g h i j  STARTREKTXT  )k l m            STAT    COM   )n o p            STRTRK#2ASC   Ђq r s t u v w x  STRTRK#2ASC  !y z {            TAPELIB COM   #| } ~            TAPELIB DOC   _ Ђ Ѓ ‚ ѓ „      TAPELIB MAC   Ђ… † ‡ € ‰ Љ ‹ Њ  TAPELIB MAC  ЂЌ Ћ Џ ђ ‘ ’ “ ”  TAPELIB MAC  '• – —            TREKINFODOC   7 ™ љ ›          TREKMOD ASC   Ђњ ќ ћ џ   Ў ў Ј  TREKMOD ASC  Ђ¤ Ґ ¦ § Ё © Є «  TREKMOD ASC  M¬ ­ ® Ї °        UGFORM        !± І і           ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее VOLUME24DOC   ґ µ              XDIR    ASM   T¶ · ё № є »      XDIR    COM   ј                ZOSO    22    $Ѕ ѕ ї           ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее,NOVICE,SENIOR,EXPERT,COURSE,WCOST,ICOST
25 DATA PEFFECT,SCORE,OUT,ANTARES,SIRIUS,RIGEL,MERAK,PROCYON,CAPELLA
26 DATA VEGA,DENEB,CANOPUS,ALDEBARAN,ALTAIR,REGULUS,BELLATRIX,ARCTURUS
27 DATA POLLUX,SPICA,10.5,12,1.5,9,0,3,7.5,6,4.5
28 DEF FNA(X)=INT(8*RND(X))+1:DEF FNB(X)=INT(10*RND(X))+1
29 DEF FND(X)=X/60
30 DEFFNR(X)=INT(X*10+.5)/10:DEFFNS(X)=INT(X*100+.5)/100
40 FORI=1TO12:READD$(I):NEXT:FORI=1TO20:READC$(I):NEXT
43 FORI=1TO3:READT$(I):NEXT:FORI=1TO4:READS$(I):NEXT:FORI=1TO6
44 READC2$(I):NEXT:FOUB29002:GOSUB14001:GOTO70
545 ?:GOSUB37001:GOTO70
551 GOSUB21001:IFJ3=0THEN70ELSE710
576 GOSUB31001:IFJ3=0THEN70
585 IFA2<>0THEN901
590 IFG(Q1,Q2)<>LQTHEN70
595 GOTO750
601 GOSUB32001:IFJ3=0THEN70
603 IFA2<>0THEN901
610 IFG(Q1,Q2)<>LQTHEN70
615 GOTO750
627 GOSUB25010:GOTO70
710 IFA2<>0THEN901
720 IFT1<>0THENGOSUB9000
730 IFA2<>0THEN901
740 IFG(Q1,Q2)<LQTHEN790
750 GOSUB2001:IFA2<>0THEN901
760 IFA2<>0THEN901
770 GOTO740
790 GOSUB1000:GOTO70
901 ?:?:INPUT"ANOTHER GAME ";A$
910 IFLEFT$(A$,ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееRI=1TO16:READG1$(I):NEXT:FORI=1TO9:READC5(I):NEXT
46 GOSUB24001:S7$(1)="":S7$(2)="  ":S7$(3)=" ":S7$(4)=""
70 IFA2<>0THEN901
75 J4=0:T1=0:INPUT"COMMAND";A$:IFLEN(A$)>1THEN110
80 ?"2 LETTERS, PLEASE.":GOTO75
110 FORI=1TO20
120 IFA$=LEFT$(C$(I),LEN(A$))THEN150
130 NEXT
135 ?"ILLEGAL !! - USE THIS LIST"
140 ?:FORI=1TO20STEP4
141 ?C$(I);TAB(12);C$(I+1);TAB(22);C$(I+2);TAB(32);C$(I+3)
142 NEXT:?:GOTO70
150 ONIGOTO201,226,251,276,291,301,326,351,376,401
160 ONI-10GOTO426,901,476,501,526,545,551,576,61)="Y"THEN46
911 ?CHR$(26):END
1000 IF(C3<>0)AND(J4=0)THENGOSUB16001
1020 IFK3=0THENRETURN
1030 IFA2<>0THENRETURN
1040 P2=1/I8
1050 J5=0
1060 ?
1070 IFC5$="DOCKED"THEN1780
1080 H2=0:H3=0:C6=1
1090 IFS9=1THENC6=.5+.5*RND(1)
1100 A3=0
1110 FORL=1TOK3
1120 IFK6(L)<0THEN1540
1130 A3=1
1140 D6=.8+.05*RND(1)
1150 H4=K6(L)*D6^K8(L)
1160 IF(S4=0)AND(S9=0)THEN1230
1170 P3=.1:IFP2*S3>P3THENP3=P2*S3
1180 H5=P3*C6*H4+1
1190 IFH5>S3THENH5=S3
1195 S3=S3-H5:H4=H4-H5
1210 IF(P3>.1)AND(H4<5E-03*E1)THENееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1 'REWRITE BY ZOSO
2 RANDOMIZE:WIDTH90:LQ=1000
7 DIM G1$(16),V$(5,5),C$(20),G(8,8),D$(12),Q$(10,10),D4(12),D9(106)
10 DIM S2(8,8):Q$="?"
15 DATA S.R. SENSORS,L.R. SENSORS,PHASERS,PHOTON TUBES,LIFE SUPPORT
20 DATA WARP ENGINES,IMPULSE ENGINES,SHIELDS,SUBSPACE RADIO
21 DATA SHUTTLE CRAFT,COMPUTER,TRANSFER PANEL,ABANDON,CHART,COMPUTER
22 DATA DAMAGES,DESTRUCT,DOCK,IDLE,IMPULSE,LRSCAN,NAVIGATE,PHASERS,QUIT
23 DATA SHIELDS,SOS,SRSCAN,STATUS,TORPEDO,TRANSFER,VISUAL,WARP,SHORT
24 DATA MEDIUM,LONG,BEGINNER01,627
201 GOSUB 35001:GOTO70
226 GOSUB 3001:GOTO70
251 GOSUB5001:GOTO70
276 GOSUB8001:GOTO70
291 GOSUB36001:GOTO70
301 GOSUB7000:GOTO70
326 GOSUB33001:IFJ3=0THEN70
331 IFA2<>0THEN901
332 IFG(Q1,Q2)=1000THEN750
340 GOSUB1000:GOTO70
351 GOSUB13001:IFJ3=0THEN70
353 GOTO710
376 GOSUB14001:GOTO70
401 GOSUB34001
402 IFJ3=0THEN70
410 GOTO710
426 GOSUB20001:IFJ3=0THEN70
428 GOSUB1000:GOTO70
476 GOSUB26001:IFJ3=0THEN70
478 IFA2<>0THEN901
479 GOSUB1000:S9=0:GOTO70
501 GOSUB11001:GOTO70
526 GOS1540
1230 J5=1
1240 ?FNR(H4);"UNIT HIT ON THE ";S5$;" FROM ";
1250 J6=K4(L):J7=K5(L)
1260 IFQ$(J6,J7)="K"THEN?"KLINGON AT";
1270 IFQ$(J6,J7)="C"THEN?"COMMANDER AT";
1280 ?J6;"-";J7
1290 IFH4>H2THENH2=H4
1300 H3=H3+H4
1310 IFH4<(275-25*S8)*(1+.5*RND(1))THEN1530
1320 N4=1+INT(H4/(500+100*RND(1)))
1330 ?"*** CRITICAL HIT--";
1340 K9=1
1350 FORW4=1TON4
1360 J9=INT(12*RND(1))+1
1370 C5(W4)=J9
1380 E3=(H4*D5)/(N4*(75+25*RND(1)))
1390 IFJ9=6THENE3=E3/3
1395 D4(J9)=D4(J9)+E3
1400 IFW4=1THEN1470
";S5$;" HAS STOPPED IN QUADRANT CONTAINING SUPERNOVA"
2050 ? "*** AUTO-OVERRIDE ATTEMPTS TO HURL ";S5$;" TO OTHER QUADRANT"
2080 S2(Q1,Q2)=1
2090 GOSUB18000
2100 IFD4(6)=0THEN2290
2110 ?
2120 ?"WARP ENGINES DAMAGED."
2140 ?:?"TRYING TO ENGAGE IMPULSE ENGINES..."
2150 IFD4(7)=0THEN2190
2160 ?"IMPULSE ENGINES DAMAGED."
2165 F9=8
2170 GOSUB10000
2180 RETURN
2190 P2=.75*E1
2200 D6=4E-03*(P2-50)
2210 D7=1.4142+1.2*RND(1)
2220 D1=D6
2230 IFD6>D7THEND1=D7
2240 T1=D1/.4
2250 D2=12*RND(1)
2260 J4ULD YOU LIKE A SHORT, MEDIUM OR LONG GAME";
4140 GOTO4095
4150 L2=I
4160 ?"ARE YOU A BEGINNER, NOVICE, SENIOR OR EXPERT ";
4170 INPUTA$
4180 FORI=1TO4
4190 IFA$=LEFT$(S$(I),LEN(A$))THEN4220
4200 NEXTI
4210 GOTO4160
4220 S8=I:MR=I
4230 INPUT"ENTER MISSION PASSWORD...";X$:?
4245 ?"....STAND BY...."
4250 J=RND(1)
4280 D5=.5*S8:I2=INT(L2+1+RND(1)*3)
4290 IFI2>5THENI2=5
4300 R3=I2
4310 I5=7*L2
4320 R5=I5
4340 R7=(S8-2*RND(1)+1)*S8*.1+.1
4350 IFR7<.2THENR7=R7+.1
4360 I1=INT(2*R7*I5)
4370 R1=I)*(3.1416-ATN(ABS(Y/X)))
5239 IFX=0THENZ7=SGN(Y)*1.5708
5240 IFX>0THENZ7=ATN(Y/X)
5245 D2=12-Z7*1.9098593:IFD2>12THEND2=D2-12
5250 ?"COURSE IS";FNS(D2);" FOR A DISTANCE OF";
5260 ?FNS(D1);"QUADRANTS.":GOTO5040
5302 INPUT"ENTER DISTANCE AND WARP FACTOR";D1,A4
5304 IF(D1<0)THEN5040
5310 C7=D1*A4*A4*A4
5315 T1=(10*D1)/((A4*A4)+1E-05)
5320 ?"IT WOULD TAKE";FNS(T1);"STARDATES AND USE"
5325 ?FNR(C7);"UNITS OF ENERGY  (";FNR(C7+C7);"IF SHIELDS ARE UP)"
5330 GOTO5040
5410 INPUT"ENTER DISTANCE...";D1
51420 FORV=1TOW4
1430 IFJ9=C5(V-1)THEN1480
1440 NEXTV
1450 K9=K9+1
1460 IFK9=3THEN?
1465 ? " AND ";
1470 ?D$(J9);
1480 NEXTW4
1490 ? " DAMAGED."
1500 IFD4(8)=0THEN1530
1510 IFS4<>0THEN?"*** SHIELDS KNOCKED DOWN."
1520 S4=0
1530 E1=E1-H4
1540 NEXTL
1550 IFA3=0THENRETURN
1560 IFE1<=0THEN1750
1570 P4=100*P2*S3+.5
1580 IFJ5<>0THEN1610
1590 ?"ENEMY ATTACK--SHIELDS REDUCED TO ";
1600 GOTO1650
1610 ?"ENERGY LEFT:";FNS(E1);"   SHIELDS ";
1620 IFS4<>0THEN?"UP,";
1630 IF(S4=0)AND(D4(8)=0)THEN?"DO=0
2270 GOSUB13200
2280 GOTO2400
2290 W1=6+2*RND(1)
2300 W2=W1*W1
2310 P2=.75*E1
2320 D6=P2/(W1*W1*W1*(S4+1))
2330 D7=1.4142+2*RND(1)
2340 D1=D6
2350 IFD6>D7THEND1=D7
2360 T1=10*D1/W2
2370 D2=12*RND(1)
2380 J4=0
2390 GOSUB34500
2400 IFJ4<>0THEN2440
2410 F9=8
2420 GOSUB10000
2430 RETURN
2440 IFR1<>0THENRETURN
2450 F9=1
2460 GOSUB10000
2470 RETURN
3001 ?:?"      1   2   3   4   5   6   7   8"
3010 ?"     --- --- --- --- --- --- --- ---"
3020 FORI=1TO8
3030 ?I;" ";
3040 FORJ=1TO8
3061
4380 I4=INT(S8+.0625*I1*RND(1))
4390 R2=I4
4400 I3=(I1+4*I4)*I5
4410 R4=I3
4420 RETURN
5001 IFD4(11)=0THEN5030
5010 ?" COMPUTER DISABLED"
5020 RETURN
5030 ?"----COMPUTER ACTIVE----"
5040 INPUT"PROGRAM NAME";B$
5050 FORI=1TO6
5060 IFB$=LEFT$(C2$(I),LEN(B$))THEN5120
5070 NEXT
5080 ?"VALID PROGRAMS ARE:"
5090 ?"  COURSE    WCOST   SCORE"
5100 ?"  PEFFECT   ICOST   OUT"
5110 GOTO5040
5120 ON IGOTO5210,5302,5410,5510,5610,5700
5210 INPUT "ENTER QUADRANT AND SECTOR - ";A3,A4
5220 IF(A3<>INT(420 IFD1<0THEN5040
5430 C7=250*D1+50:T1=D1/.4
5440 ?"IT WOULD TAKE";FNR(T1);"STARDATES AND USE"
5450 ?C7;"UNITS OF ENERGY"
5460 GOTO5040
5510 INPUT"ENTER PHASER RANGE IN QUADRANTS";A3
5520 IFA3<0THEN5040
5530 A3=A3*10:C7=(.9^A3)*100
5540 ?"PHASERS ARE ";LEFT$(STR$(C7),5);"% EFFECTIVE AT THAT RANGE"
5550 GOTO5040
5610 GOSUB23000
5620 GOTO5040
5700 RETURN
5990 ?"FORMAT IS MN,XXYY...WHERE MN IS THE QUADRANT"
5991 ?"AND XXYY IS THE SECTOR...E.G. 64,0307 REFERS"
5992 ?"TO QUADRANT 6-4, SECTOR 3-7.WN, ";
1640 IFD4(8)>0THEN?"DAMAGED, ";
1650 ?INT(P4);"%"
1660 IF(H2<200)AND(H3<500)THEN1800
1670 J8=INT(H3*RND(1)*.015)
1680 IFJ8<2THEN1800
1690 ?
1700 ?"---> 'SICKBAY TO BRIDGE.  WE SUFFERED ";J8;"CASUALTIES IN THAT ATTACK"
1730 C4=C4+J8
1740 GOTO1800
1750 F9=5
1760 GOSUB10000:RETURN
1780 ?"*** KLINGONS ATTACK-- STARBASE SHIELDS PROTECT THE ";S5$
1800 FORW4=1TOK3
1810 K8(W4)=K7(W4)
1820 NEXTW4
1830 GOSUB28000:RETURN
2001 ?:IFJ4=0THEN2050
2020 ?"*** RED ALERT!  RED ALERT!"
2030 ?"*** THE 0 ONSGN(S2(I,J))+2GOTO3070,3090,3110
3070 ?" .1.";
3080 GOTO 3160
3090 ?" ...";
3100 GOTO3160
3110 IFS2(I,J)>LQTHEN3150
3120 IFG(I,J)<LQTHEN?S7$(LEN(STR$(G(I,J))));STR$(G(I,J));
3130 IFG(I,J)=LQTHEN?" ***";
3140 GOTO3160
3150 ?S2(I,J)-LQ;
3160 NEXTJ:?:NEXTI:GOSUB18400:?
3190 ?"THE ";S5$;" IS CURRENTLY IN ";G2$;" (";Q1;"-";Q2;")"
3200 RETURN
4001 ?CHR$(26)
4070 S8=0:L2=0
4090 ?"MISSION DURATION...: ";
4095 INPUTA$
4100 FOR I=1TO3
4110 IFA$=LEFT$(T$(I),LEN(A$))THEN4150
4120 NEXTI
4130 ?"WOA3))OR(A4<>INT(A4))THEN5990
5221 IFA3<0THEN5040
5222 IFA3=0THENA3=10*Q1+Q2
5223 A3=A3+.5
5225 K=INT(A3/10)
5226 IF(K<1)OR(K>8)THEN5990
5227 C6(1)=K:K=INT(A3-C6(1)*10)
5228 IF(K<1)OR(K>8)THEN5990
5229 C6(2)=K:A4=A4+.5
5230 K=INT(A4/100)
5231 IF(K<1)OR(K>10)THEN5990
5232 C6(1)=C6(1)+(K-1)/10:K=INT(A4-K*100)
5233 IF(K<1)OR(K>10)THEN5990
5234 C6(2)=C6(2)+(K-1)/10
5235 X=Q1+((S6-1)/10)-C6(1):Y=Q2+((S7-1)/10)-C6(2)
5236 D1=0:D2=0:IF(X=0)AND(Y=0)THEN5250
5237 D1=SQR(X*X+Y*Y)
5238 IFX<0THENZ7=SGN(Y"
5995 GOTO 5040
6000 IFT2$<>"C"THEN6100
6010 C3=0:?"*** COMMANDER AT";
6030 FORF=1TOR2:IF(C1(F)=Q1)AND(C2(F)=Q2)THEN6050
6040 NEXTF
6050 C1(F)=C1(R2):C2(F)=C2(R2):C1(R2)=0:C2(R2)=0
6060 R2=R2-1:F1(2)=1E+30
6070 IFR2<>0THENF1(2)=D0-(I4/R2)*LOG(RND(1))
6080 K2=K2+1
6090 GOTO6120
6100 ?"*** KLINGON AT";
6110 K1=K1+1
6120 ?A5;"-";A6;"DESTROYED."
6130 Q$(A5,A6)=".":R1=R1-1
6140 IFR1=0THENRETURN
6150 R5=R4/(R1+4*R2)
6160 G(Q1,Q2)=G(Q1,Q2)-100
6170 FORF=1TOK3
6180 IF(K4(F)=A5)AND(K5(F)=A6)THEN60 RETURN
9120 IF(D4(5)=0)OR(C5$="DOCKED")THEN9180
9130 IF(L1>=X6)OR(D4(5)<=L1)THEN9160
9140 F9=3:GOSUB10000
9150 RETURN
9160 L1=L1-X6
9170 IFD4(5)<=X6THENL1=J1
9180 R=X6
9190 IFC5$="DOCKED"THENR=X6/D3
9200 FORL=1TO12
9210 IFD4(L)<=0THEN9230
9220 D4(L)=D4(L)-R
9225 IFD4(L)<0THEND4(L)=0
9226 IFD4(L)<>0THEN9230
9227 ?:?"DAMAGE CONTROL-  ";D$(L);" NOW OPERATIONAL."
9230 NEXTL
9240 IFM=0THENRETURN
9250 T1=T1-X6
9260 ONMGOTO9280,9291,9340,9355,9475
9280 X2=0:Y2=0:GOSUB27000
9285 F1(1)=D0-.5*I5(106)=B5
9349 S0=1:F1(3)=D0-.3*I5*LOG(RND(1)):GOTO9000
9355 IF(R2=0)OR(R3=0)THEN9400
9360 FORI=1TOR3:FORJ=1TOR2:IF(B2(I)=C1(J))AND(B3(I)=C2(J))THEN9410
9370 NEXTJ:NEXTI
9380 F1(4)=D0+.5+3*RND(1)
9390 F1(5)=1E+30:GOTO9000
9400 F1(4)=1E+30:F1(5)=1E+30:GOTO9000
9410 B4=B2(I):B5=B3(I)
9420 IF(B4=Q1)AND(B5=Q2)THEN9380
9430 F1(5)=D0+.5+3*RND(1)
9440 F1(4)=F1(5)-.3*I5*LOG(RND(1))
9450 IFD4(9)>0THEN9000
9460 ?:?"  CAPTAIN, THE STARBASE IN";B4;"-";B5;"IS UNDER ATTACK-"
9462 ?"  AND CAN ONLY RESIST UNTIICT RESOLVED - PREPARED FOR RATING ";B$
10001 ?CHR$(26):A2=1:?:?"IT IS STARDATE";FNR(D0):?
10010 ONF9GOTO10025,10135,10165,10190,10200,10205,10225,10240
10015 ONF9-8GOTO10250,10271,10285
10025 ?"YOU HAVE DESTROYED THE KLINGON INVASION FLEET":?
10030 ?"     ***THE FEDERATION IS SAVED***":G1=1
10035 IF(A1=0)OR(B1<>0)THEN10110
10040 IFLEFT$(S5$,1)<>"E"THEN10110
10045 IF3*S1+35*N1+C4>=100THEN10110
10050 IFD0-J2<=6THEN10075
10060 R8=.1*S8*(S8+1)+.1
10065 IF(K1+K2)/(D0-J2)<R8THEN10110
10075 ?:?"YOU HA200
6190 NEXTF
6200 K3=K3-1
6210 IFF>K3THEN6250
6220 FORG=FTOK3
6230 K4(G)=K4(G+1):K5(G)=K5(G+1):K6(G)=K6(G+1)
6235 K7(G)=K7(G+1):K8(G)=K7(G)
6240 NEXTG
6250 K4(K3+1)=0:K5(K3+1)=0:K7(K3+1)=0:K8(K3+1)=0:K6(K3+1)=0
6260 RETURN
7000 IFC5$="DOCKED"THEN7100
7010 IFB6=0THEN7020
7015 IF(ABS(S6-B6)<=1)AND(ABS(S7-B7)<=1)THEN7040
7020 ?S5$;" NOT ADJACENT TO A BASE."
7030 RETURN
7040 C5$="DOCKED"
7050 ?"---> DOCKING COMPLETED"
7060 E1=I7:S3=I8:T4=I9:L1=J1
7070 RETURN
7100 ?"CAPTAIN, WE'RE ALREADY DO*LOG(RND(1))
9286 IFG(Q1,Q2)=LQTHENRETURN
9287 GOTO9000
9291 IFR2=0THEN9330
9292 IFC5$="DOCKED"THEN9325
9293 I=INT(RND(1)*R2)+1
9294 Y6=(C1(I)-Q1)^2+(C2(I)-Q2)^2
9295 IFY6=0THEN9325
9296 Y6=SQR(Y6):T1=.17778*Y6
9297 ?:?"*** ";S5$;" CAUGHT IN LONG-RANGE TRACTOR BEAM--"
9298 Q1=C1(I):Q2=C2(I)
9299 S6=FNB(1):S7=FNB(1)
9300 ?"PULLED TO QUADRANT";Q1;"-";Q2;", SECTOR";S6;"-";S7
9301 IFR6<>0THEN?"(IDLE PERIOD CANCELLED)"
9302 R6=0
9303 IFS4<>0THEN9320
9304 IF(D4(8)=0)AND(S3>0)THEN9310
9305 ?"(SHIEL STARDATE";FNR(F1(5));"!!!"
9465 IFR6=0THEN9000
9466 INPUT"  SHALL WE CANCEL IDLE PERIOD";B$
9468 IFLEFT$(B$,1)="Y"THENR6=0
9469 GOTO9000
9475 F1(5)=1E+30:IF(R2=0)OR(R3=0)THEN9000
9485 K=INT(G(B4,B5)/100):IFG(B4,B5)-K*100<10THEN9000
9490 FORI=1TOR2:IF(C1(I)=B4)AND(C2(I)=B5)THEN9520
9510 NEXT:GOTO9000
9520 IFS2(B4,B5)=-1THENS2(B4,B5)=0
9530 IFS2(B4,B5)>999THENS2(B4,B5)=S2(B4,B5)-10
9540 IF(B4<>Q1)OR(B5<>Q2)THEN9630
9550 FORI=1TOK3:K=K4(I):L=K5(I)
9560 IFQ$(K,L)="C"THEN9570
9565 NEXT
9570 IFK6VE DONE SO WELL THAT COMMAND"
10076 IFS8=4THEN10090
10080 ?"PROMOTES YOU.....";
10085 IFS8=1THEN?"TO NOVICE CLASS!"
10086 IFS8=2THEN?"TO SENIOR CLASS!"
10087 IFS8=3THEN?"TO EXPERT CLASS!"
10088 ?"   ***CONGRATULATIONS***":GOTO10110
10090 ?"PROMOTES YOU TO 'COMMODORE EMERITUS'."
10100 ?:?"NOW YOU CAN RETIRE !"
10110 GOSUB23000
10120 RETURN
10135 ?"TIME HAS RUN OUT - THE FEDERATION HAS BEEN CONQUERED AND YOUR CRAFT"
10136 ?"IS NOW ENEMY PROPERTY... YOU WILL STAND TRIAL AS A WAR-CRIMINAL..."
10137CKED!"
7110 RETURN
8001 J=0:?:FORI=1TO12
8010 IFD4(I)<=0THEN8070
8020 IFJ<>0THEN8060
8030 ?"     DEVICE";SPC(12);"-REPAIR TIMES-"
8040 ?SPC(21);"IN FLIGHT    DOCKED":J=1
8060 ?"  ";D$(I);TAB(23);FNS(D4(I));TAB(33);FNS(D3*D4(I))
8070 NEXTI
8080 IFJ=0THEN?" - ALL DEVICES FUNCTIONAL -"
8090 RETURN
9000 M=0:D7=D0+T1:FORL=1TO5
9020 IFF1(L)>D7THEN9040
9030 M=L:D7=F1(L)
9040 NEXTL
9050 X6=D7-D0:D0=D7
9060 R4=R4-(R1+4*R2)*X6
9070 R5=R4/(R1+4*R2)
9080 IFR5>0THEN9120
9090 F9=2
9100 GOSUB10000
911LDS NOT CURRENTLY USABLE.)"
9307 GOTO9320
9310 GOSUB26500
9315 S9=0
9320 GOSUB18000
9325 F1(2)=D0+T1-1.5*(I5/R2)*LOG(RND(1))
9326 GOTO9000
9330 F1(2)=1E+30:GOTO9000
9340 D9(1)=D0:D9(2)=R1:D9(3)=R2:D9(4)=R3:D9(5)=R4:D9(6)=R5
9342 D9(7)=S1:D9(8)=B1:D9(9)=K1:D9(10)=K2
9343 FORI=1TO8:FORJ=1TO8:D9(I-1+8*(J-1)+11)=G(I,J):NEXTJ:NEXTI
9344 FORI=75TO84:D9(I)=C1(I-74):NEXT
9345 FORI=85TO94:D9(I)=C2(I-84):NEXT
9346 FORI=95TO99:D9(I)=B2(I-94):NEXT
9347 FORI=100TO104:D9(I)=B3(I-99):NEXT
9348 D9(105)=B4:D9(I)<25+50*RND(1)THEN9000
9580 Q$(B6,B7)=".":B6=0:B7=0
9590 GOSUB17000
9600 ?:?"CAPTAIN, I BELIEVE THE STARBASE HAS BEEN DESTROYED"
9620 GOTO9680
9630 IF(R3=1)OR(D4(9)>0)THEN9680
9640 ?
9650 ?"--> STARFLEET COMMAND REPORTS THAT STARBASE IN QUADRANT";B4;"-";B5
9660 ?"HAS BEEN DESTROYED BY ENEMY COMMANDER !!"
9680 G(B4,B5)=G(B4,B5)-10
9690 IFR3<=1THEN9730
9700 FORI=1TOR3:IF(B2(I)=B4)AND(B3(I)=B5)THEN9720
9710 NEXT
9720 B2(I)=B2(R3):B3(I)=B3(R3)
9730 R3=R3-1
9740 GOTO9000
10000 ?:?:?:INPUT"CONFL ?"ON THE BASIS OF YOUR RECORD YOU WILL BE";
10139 IFR1*3>I1THEN10150
10140 ?" SUMMARILY EXECUTED"
10145 A1=0:GOSUB23000:RETURN
10150 ?" IMPRISONED FOR LIFE"
10165 ?"YOUR LIFE SUPPORT RESERVES HAVE RUN OUT, AND"
10170 ?"YOU WILL SOON DIE!!!"
10172 ?
10175 ?"YOUR STARSHIP IS A DERELICT IN SPACE."
10180 GOTO10300
10190 ?"YOUR ENERGY SUPPLY IS EXHAUSTED.":GOTO10172
10200 ?"THE ";S5$;" HAS BEEN DESTROYED IN BATTLE."
10201 GOTO10300
10205 RETURN
10225 ?"YOUR STARSHIP HAS BEEN DESTROYED BY A NOVA." BE DESTROYED!"
10350 GOSUB23000:RETURN
10355 ?"SINCE YOU TOOK THE LAST KLINGON WITH YOU, YOU ARE"
10360 ?"A MARTYR AND A HERO.":G1=1:A1=0
10390 GOSUB23000:RETURN
11001 IFC5$<>"DOCKED"THEN11020
11010 ?"--> CAPTAIN, WE'RE ALREADY DOCKED!"
11015 RETURN
11020 IFD4(9)=0THEN11030
11025 ?"SUBSPACE RADIO DAMAGED...CANNOT TRANSMIT.":RETURN
11030 IFR3<>0THEN11050
11040 ?"CAPTAIN, NO RESPONSE FROM STARBASE !":RETURN
11050 N1=N1+1:IFB6=0THEN11070
11060 GOTO11130
11070 D1=1E+30
11080 FORL=1TOR3:X=10*SQR(THEN12100
12090 ?"MINOR HIT ON ":GOTO12110
12100 ?FNR(H2);"UNIT HIT ON ";
12110 M$=Q$(X8,Y8)
12120 IF M$="K"THEN?"KLINGON AT";
12125 IFM$="C"THEN?"COMMANDER AT";
12130 ?X8;"-";Y8
12140 IFK6(N)<>0THEN12180
12150 A5=X8:A6=Y8:T2$=Q$(X8,Y8):GOSUB6000
12160 IFR1<>0THEN12250
12170 F9=1:GOSUB10000:GOTO12250
12180 IFK6(N)<0THEN12240
12190 IFRND(1)<.9THEN12240
12200 IFK6(N)>(.4+.4*RND(1))*P3THEN12240
12205 ?
12210 ?"*** CAPTAIN, THE VESSEL AT SECTOR";
12215 ?X8;"-";Y8
12220 ?"   HAS JUST LOST ITS FIIFD4(2)<>0THEN14180
14020 ?"L.R. SCAN FOR QUADRANT";Q1;"-";Q2:?
14030 I=Q1-1:J=Q1+1:K=Q2-1:L=Q2+1
14040 FORM=ITOJ:FORN=KTOL
14050 IF(M<=0)OR(M>8)THEN14110
14060 IF(N<=0)OR(N>8)THEN14110
14070 IFD4(11)=0THENS2(M,N)=1
14080 IFG(M,N)>=LQTHEN ?"  ***";" ";
14090 IFG(M,N)<LQTHEN?SPC(5-LEN(STR$(G(M,N))));G(M,N);
14100 GOTO14120
14110 ?N$;" ";
14120 NEXTN:?
14130 ?
14140 NEXTM
14150 IFD4(11)=0THENRETURN
14160 ?"*** WARNING *** - COMPUTER DISABLED - SCAN NOT RECORDED."
14170 RETURN
14180 ?"LONG RAN
10230 ?"NICE WORK, IDIOT !!!":GOTO10300
10240 ?"THE ";S5$;" HAS BEEN INCINERATED BY A SUPERNOVA."
10241 GOTO10300
10250 ?"YOU HAVE BEEN CAPTURED BY THE ENEMY. IF YOU STILL HAD A STARBASE,"
10255 ?"YOU WOULD HAVE BEEN REPATRIATED. SINCE YOU HAVE NO BASES, YOU WILL"
10260 ?"BE MERCILESSLY TORTURED !!"
10266 GOTO10300
10271 ?:?"THE ";S5$;" IS NOW AN EXPANDING CLOUD"
10272 ?"OF SUB-ATOMIC PARTICLES...":GOTO10300
10285 ?"STARBASE WAS UNABLE TO RE-MATERIALIZE YOUR STARSHIP."
10300 ?
10310 IFLEFT$(S5$,(B2(L)-Q1)^2+(B3(L)-Q2)^2)
11090 IFX>D1THEN11110
11100 D1=X:K=L
11110 NEXTL
11120 Q1=B2(K):Q2=B3(K):GOSUB18000
11130 Q$(S6,S7)="."
11135 ?
11140 ?"STARBASE IN QUADRANT";Q1;"-";Q2;"RESPONDS --";
11145 ?"  ";S5$;" DEMATERIALIZES."
11146 P2=(1-.98^D1)^.333333
11150 FORL=1TO3
11155 IFL=1THEN?"1ST ";
11160 IFL=2THEN?"2ND ";
11170 IFL=3THEN?"3RD ";
11180 ?"ATTEMPT TO RE-MATERIALIZE THE ";S5$;". . . . .";
11190 IFRND(1)>P2THEN11220
11200 ?"FAILS.":NEXTL
11210 F9=11:GOSUB10000:RETURN
11220 FORL=1TREPOWER !!!"
12225 ?
12230 K6(N)=-K6(N)
12240 N=N+1
12250 NEXTK
12260 RETURN
13001 J3=0
13010 IFD4(7)<>0THEN13250
13020 IFE1<=75THEN13070
13030 INPUT"ENTER COURSE....";D2
13040 IFD2<.01ORD2>12THENGOSUB40000ELSE13048
13041 RETURN
13048 INPUT"DISTANCE ";D1:IFD1>0THEN13050
13049 RETURN
13050 P3=50+250*D1
13060 IFP3<E1THEN13140
13070 ?
13080 ?"1ST OFFICER SPOCK-  'CAPTAIN, THE IMPULSE ENGINES"
13090 ?"REQUIRE 50 UNITS OF ENERGY TO ENGAGE, PLUS 250 UNITS PER ";
13100 IFE1>75THEN13120
13110 ?"GE SENSORS DAMAGED.":RETURN
15001 A5=(15-D2)*.523599:D4=-SIN(A5):D6=COS(A5):B8=ABS(D4)
15030 IFABS(D6)>B8THENB8=ABS(D6)
15040 D4=D4/B8:D6=D6/B8:T5=0:T6=0
15050 IFD0+T1<F1(2)THEN15080
15060 T5=1:C5$="RED":D1=D1*(F1(2)-D0)/T1+.1
15070 T1=F1(2)-D0+1E-05
15080 Q$(S6,S7)=".":X7=S6:Y7=S7:H9=INT(10*D1*B8+.5)
15090 IFH9=0THEN15115
15100 FORL=1TOH9
15102 X7=X7+D4:X1=INT(X7+.5):Y7=Y7+D6:Y1=INT(Y7+.5)
15105 IF(X1<1)OR(X1>10)THEN15150
15106 IF(Y1<1)OR(Y1>10)THEN15150
15108 IFQ$(X1,Y1)="O"THEN15111
15109 I1)="F"THENS5$=""
10315 IFLEFT$(S5$,1)="E"THENS5$="FAERIE QUEENE"
10316 A1=0
10320 IFR1=0THEN10355
10325 G3=R4/I3:B8=(R1+2*R2)/(I1+2*I4)
10326 A3=G3/B8
10327 IF A3<1+.5+RND(1)THEN10345
10330 ?"AS A RESULT OF YOUR ACTIONS, A TREATY WITH THE KLINGON"
10331 ?"EMPIRE HAS BEEN SIGNED.  THE TERMS OF THE TREATY ARE"
10332 IFA3<3*RND(1)THEN10340
10335 ?"FAVORABLE TO THE FEDERATION.":?
10336 ?"CONGRATULATIONS.":GOTO10350
10340 ?"HIGHLY UNFAVORABLE TO THE FEDERATION.":GOTO10350
10345 ?"THE FEDERATION WILLO5:I=B6+INT(3*RND(1))-1
11230 IF(I<1)OR(I>10)THEN11260
11235 J=B7+INT(3*RND(1))-1
11240 IF(J<1)OR(J>10)THEN11260
11250 IFQ$(I,J)="."THEN11270
11260 NEXTL:?"FAILS.":GOTO11210
11270 ?"SUCCEEDS.":S6=I:S7=J:Q$(I,J)=LEFT$(S5$,1)
11280 GOSUB7000:?"CAPTAIN, WE MADE IT!":RETURN
12001 P4=2:L5=K3:N=1
12010 FORK=1TOL5
12020 IFH3(K)=0THEN12240
12030 D6=.9+.01*RND(1):H2=H3(K)*D6^K7(N)
12040 P3=K6(N)
12050 P=ABS(P3):IFP4*H2<PTHENP=P4*H2
12060 K6(N)=P3-SGN(P3)*ABS(P)
12070 X8=K4(N):Y8=K5(N)
12080 IFH2>4.99QUADRANT.  THEY ARE USELESS NOW.'":RETURN
13120 ?"QUADRANT.  WE CAN GO A MAXIMUM OF ";
13130 ?FNR(4E-03*(E1-50)-.05);"QUADRANTS.'":RETURN
13140 T1=D1/.4
13150 IFT1<R5THEN13200
13160 ?"SIR, MAX. SPEED UNDER IMPULSE IS ONLY 4 SECTORS PER STARDATE"
13170 INPUT"-- AUTHORIZE ";B$
13190 IFLEFT$(B$,1)<>"Y"THENRETURN
13200 GOSUB15001:J3=1
13210 IFA2<>0THENRETURN
13220 E1=E1-P3
13230 IFE1>0THENRETURN
13240 F9=4:GOSUB10000:RETURN
13250 ?"IMPULSE ENGINES DAMAGED.":RETURN
14001 N$="    #"
14005 ?
14010 FQ$(X1,Y1)<>"."THEN15125
15110 NEXTL
15111 D1=.1*SQR((S6-X1)^2+(S7-Y1)^2)
15112 S6=X1:S7=Y1
15115 F4=S6:F5=S7
15116 IFQ$(X1,Y1)<>"O"THEN15320
15120 T2=FNA(1):T3=FNA(1)
15122 Q1=FNA(1):Q2=FNA(1):S6=FNB(1):S7=FNB(1):?
15123 ?"*** SPACE PORTAL ENTERED ***":GOTO15307
15125 T6=1:K=50*D1/T1+.001:D1=.1*SQR((S6-X1)^2+(S7-Y1)^2)
15127 IF(Q$(X1,Y1)="K")OR(Q$(X1,Y1)="C")THEN15145
15129 ?:?S5$;" BLOCKED BY ";
15130 IFQ$(X1,Y1)="*"THEN?"STAR AT";
15131 IFQ$(X1,Y1)="B"THEN?"STARBASE AT";
15132 ?" SECTOR";X115268 ?"SECTOR";X1-10*(Z1-1);"-";Y1-10*(Z2-1);"'"
15270 IFT5<>0THENRETURN
15295 Q1=INT((X1+9)/10):Q2=INT((Y1+9)/10)
15296 S6=X1-10*(Q1-1):S7=Y1-10*(Q2-1)
15307 GOSUB18400:?:GOTO15315
15310 ?CHR$(26):?"ENTERING THE ";G2$;" QUADRANT  (";Q1;"-";Q2;")"
15315 Q$(S6,S7)=LEFT$(S5$,1):GOSUB18000:GOSUB29002:GOSUB14001:RETURN
15320 Q$(S6,S7)=LEFT$(S5$,1)
15321 IFL6=1THENRETURN
15325 IFK3=0THEN15390
15330 FORL=1TOK3
15340 F3=SQR((F4-K4(L))^2+(F5-K5(L))^2)
15350 K8(L)=.5*(K7(L)+F3)
15360 K7(L)=F3
15370 NE0)THEN16185
16180 ONSGN(N)+2GOTO16240,16190,16190
16185 IFQ$(L,M)="."THEN16195
16190 A=-A:GOTO16200
16195 R=L:S=M
16200 NEXTL2
16205 Q$(R,S)="C"
16210 IF(R=C)AND(S=D)THENRETURN
16215 K4(K)=R:K5(K)=S:K7(K)=SQR((S6-R)^2+(S7-S)^2)
16220 K8(K)=K7(K):IFN>0THEN?"*** COMMANDER ADVANCES TO";
16225 IFN<0THEN?"*** COMMANDER RETREATS TO";
16230 ?" SECTOR";R;"-";S:GOSUB28000:RETURN
16240 I=Q1+INT((L+9)/10)-1:J=Q2+INT((M+9)/10)-1
16245 IF(I<1)OR(I>8)THEN16350
16250 IF(J<1)OR(J>8)THEN16350
16260 FORL3=1TOR0
18120 NEXTA:GOTO18140
18130 Q$(S,T)="C":K6(K3)=LQ+400*RND(1):C3=1
18140 GOSUB28000
18150 IFU<10THEN18190
18160 U=U-10
18170 B6=FNB(1):B7=FNB(1):IFQ$(B6,B7)<>"."THEN18170
18180 Q$(B6,B7)="B"
18190 GOSUB17000:IFU<1THENRETURN
18200 FORA=1TOU
18210 S=FNB(1):T=FNB(1):IFQ$(S,T)<>"."THEN18210
18220 Q$(S,T)="*":NEXTA
18230 IF(T2<>Q1)OR(T3<>Q2)THENRETURN
18240 S=FNB(1):T=FNB(1):IFQ$(S,T)<>"."THEN18240
18250 Q$(S,T)="O":?
18260 ?"*** SHORT-RANGE SENSORS DETECT A SPACE-WARP IN THIS QUADRANT"
18280 RE;"-";Y1;"...."
15133 ?"EMERGENCY STOP REQUIRED";FNR(K);"UNITS OF ENERGY."
15135 E1=E1-K
15137 S6=INT(X7-D4+.5):F4=S6:S7=INT(Y7-D6+.5):F5=S7
15140 IFE1>0THEN15320
15141 F9=4:GOSUB10000:RETURN
15145 S6=X1:S7=Y1:GOSUB22001:F4=S6:F5=S7:GOTO15320
15150 IFK3=0THEN15165
15155 FORL=1TOK3
15156 F3=SQR((X1-K4(L))^2+(Y1-K5(L))^2)
15158 K8(L)=.5*(F3+K7(L)):NEXTL
15160 IFG(Q1,Q2)<>LQTHENGOSUB1000
15162 IFA2<>0THENRETURN
15165 X7=10*(Q1-1)+S6:Y7=10*(Q2-1)+S7
15170 X1=INT(X7+10*D1*B8*D4+.5)
15175 Y1=INT(Y7+XTL
15380 GOSUB28000
15390 GOSUB17000:RETURN
16001 A=1:B=1
16010 FORK=1TOK3
16020 C=K4(K):D=K5(K)
16030 IFQ$(C,D)="C"THEN16050
16040 NEXTK
16050 N=0:F=K6(K)+100*K3
16060 IFF>LQTHENN=INT(RND(1)*K7(K)+1)
16065 IF((C5$="DOCKED")AND((B4<>Q1)OR(B5<>Q2)))THENN=-S8
16070 IFN=0THENN=INT(((F+200*RND(1))/150)-5)
16071 IFN=0THENRETURN
16072 IF(N>0)AND(K7(K)<1.5)THENRETURN
16075 IFABS(N)>S8THENN=SGN(N)*ABS(S8)
16080 T=ABS(N):P=S6-C:Q=S7-D
16085 IF2*ABS(P)<ABS(Q)THENP=0
16090 IF2*ABS(Q)<ABS(P)THENQ=0
12
16265 IF(C1(L3)=I)AND(C2(L3)=J)THEN16350
16270 NEXTL3:?"*** COMMANDER ESCAPES TO ";
16275 ?"QUADRANT";I;"-";J;"  (AND REGAINS STRENGTH)"
16280 K4(K)=K4(K3):K5(K)=K5(K3):K7(K)=K7(K3):K8(K)=K8(K3)
16285 K6(K)=K6(K3):K3=K3-1:C3=0
16290 IFC5$<>"DOCKED"THENGOSUB17000
16300 GOSUB28000
16310 G(Q1,Q2)=G(Q1,Q2)-100:G(I,J)=G(I,J)+100
16320 FORL3=1TOR2
16330 IF(C1(L3)=Q1)AND(C2(L3)=Q2)THEN16340
16335 NEXTL3
16340 C1(L3)=I:C2(L3)=J:RETURN
16350 A=-A:B=-B:GOTO16200
17000 C5$="GREEN":IFE1<LQTHENC5$="YELLOTURN
18290 FORA=1TO10:FORB=1TO10:Q$(A,B)=".":NEXTB:NEXTA
18300 Q$(S6,S7)=LEFT$(S5$,1):RETURN
18400 G4$="III":L=2:IFQ2>=5THEN18420
18410 L=1
18420 G2$=G1$(2*(Q1-1)+L):L=Q2
18425 IFL<=4THEN18440
18430 L=Q2-4
18440 G3$="IV":IFL=4THEN18460
18450 G3$=LEFT$(G4$,L)
18460 G2$=G2$+" "+G3$:RETURN
19002 IFRND(1)>.1THEN19015
19010 GOSUB27000:RETURN
19015 Q$(A5,A6)=".":?"*** STAR AT SECTOR";A5;"-";A6;"NOVAS."
19020 G(Q1,Q2)=G(Q1,Q2)-1:S1=S1+1
19025 B9=1:T6=1:T7=1:K=0:X1=0:Y1=0
19030 H4(B9,1)=A5:H4(B9,2)=10*D1*B8*D6+.5):L6=0
15180 L5=0
15185 IFX1>0THEN15195
15190 X1=-X1+1:L5=1
15195 IFY1>0THEN15210
15200 Y1=-Y1+1:L5=1
15210 IFX1<=80THEN15220
15215 X1=161-X1:L5=1
15220 IFY1<=80THEN15230
15225 Y1=161-Y1:L5=1
15230 IFL5=0THEN15240
15235 L6=1:GOTO15180
15240 IFL6=0THEN15270
15260 ?:?"*** MESSAGE FROM STARFLEET COMMAND.....STARDATE";FNR(DO)
15261 ?"PERMISSION TO EXIT GALAXY - DENIED -"
15265 ?"'ENGINES SHUT DOWN AT ";
15266 Z1=INT((X1+9)/10):Z2=INT((Y1+9)/10)
15267 ?"QUADRANT";Z1;"-";Z2;",  ";
6095 IFP<>0THENP=SGN(P*N)
16100 IFQ<>0THENQ=SGN(Q*N)
16105 R=C:S=D:Q$(C,D)="."
16110 FORL2=1TOT:L=R+P:M=S+Q
16115 IF(L>0)AND(L<=10)THEN16120
16117 ONSGN(N)+2GOTO16240,16165,16165
16120 IF(M>0)AND(M<=10)THEN16130
16125 ONSGN(N)+2GOTO16240,16135,16135
16130 IFQ$(L,M)="."THEN16195
16135 IF(Q=B)OR(P=0)THEN16165
16140 M=S+B
16145 IF(M>0)AND(M<=10)THEN16155
16150 ONSGN(N)+2GOTO16240,16160,16160
16155 IFQ$(L,M)="."THEN16195
16160 B=-B
16165 IF(P=A)OR(Q=0)THEN16200
16170 L=R+A
16175 IF(L>0)AND(L<=1W"
17020 IFG(Q1,Q2)>99THENC5$="RED"
17030 RETURN
18000 J4=1:B6=0:B7=0:K3=0:C3=0:U=G(Q1,Q2):IFU>999THEN18290
18030 K3=INT(.01*U):FORA=1TO10:FORB=1TO10:Q$(A,B)=".":NEXTB:NEXTA
18040 Q$(S6,S7)=LEFT$(S5$,1):U=G(Q1,Q2):IFU<100THEN18150
18050 U=U-100*K3:FORA=1TOK3
18060 S=FNB(1):K4(A)=S:T=FNB(1):K5(A)=T
18070 IFQ$(S,T)<>"."THEN18060
18080 Q$(S,T)="K":K7(A)=SQR((S6-S)^2+(S7-T)^2):K8(A)=K7(A)
18090 K6(A)=RND(1)*150+325:NEXTA
18100 IFR2=0THEN18140
18110 FORA=1TOR2
18115 IF(C1(A)=Q1)AND(C2(A)=Q2)THEN1813A6
19035 FORM=B9TOT6:FORQ=1TO3:FORJ=1TO3
19040 IFJ*Q=4THEN19260
19045 J5=H4(M,1)+Q-2:J6=H4(M,2)+J-2
19050 IF(J5<1)OR(J5>10)THEN19260
19055 IF(J6<1)OR(J6>10)THEN19260
19060 IFQ$(J5,J6)="."THEN19260
19065 IFQ$(J5,J6)="O"THEN19260
19070 IFQ$(J5,J6)<>"*"THEN19105
19075 IFRND(1)>=.1THEN19085
19080 X2=J5:Y2=J6:GOSUB27000:RETURN
19085 T7=T7+1:H4(T7,1)=J5:H4(T7,2)=J6:G(Q1,Q2)=G(Q1,Q2)-1
19090 S1=S1+1:?"*** STAR AT SECTOR";J5;"-";J6;"NOVAS."
19100 GOTO19255
19105 IFQ$(J5,J6)<>"B"THEN19140
19110 G(Q1,Q6)^2):K8(V)=K7(V)
19241 Q$(J5,J6)="."
19245 ?:GOTO19260
19250 A5=J5:A6=J6:T2$=Q$(J5,J6):GOSUB6000:GOTO19260
19255 ?:Q$(J5,J6)="."
19260 NEXTJ:NEXTQ:NEXTM
19265 IFT6=T7THEN19280
19270 B9=T6+1:T6=T7:GOTO19035
19280 IFK=0THENRETURN
19290 D1=K*.1
19300 IFX1<>0THENX1=SGN(X1)
19310 IFY1<>0THENY1=SGN(Y1)
19320 I=3*(X1+1)+Y1+2
19330 D2=C5(I)
19340 IFD2=0THEND1=0
19350 IFD1=0THENRETURN
19360 ?:?"FORCE OF NOVA DISPLACES STARSHIP."
19370 GOSUB15001:RETURN
20001 P=2:J3=1
20020 IFC5$<>"DOCKED"THEN2003NEXTI:GOTO20280
20270 H3(I)=H3(I)+E:E=0
20280 GOSUB12001
20290 IF(E<>0)AND(A2=0)THEN20310
20300 J3=1:RETURN
20310 ?FNR(E);"EXPENDED ON EMPTY SPACE.":J3=1:RETURN
21001 J3=1:IFD4(4)=0THEN21015
21010 ?"PHOTON TUBES DAMAGED.":GOTO21035
21015 IFT4<>0THEN21025
21020 ?"NO TORPEDOS LEFT.":GOTO21035
21025 INPUT"TORPEDO COURSE";C6
21030 IFC6<.01ORC6>12THENGOSUB40000ELSE21040
21035 J3=0:RETURN
21040 INPUT"BURST OF 3";B$:N=1
21045 IFLEFT$(B$,1)="N"THEN21070
21050 IFLEFT$(B$,1)<>"Y"THEN21040
21051 IFT4>2A5=INT(X5+.5)
21160 IF(A5<1)OR(A5>10)THEN21430
21165 Y5=Y5+Y4:A6=INT(Y5+.5)
21170 IF(A6<1)OR(A6>10)THEN21430
21175 IF(L9=5)OR(L9=9)THEN?
21180 ?FNR(X5);"-";FNR(Y5);", ";
21185 IFQ$(A5,A6)<>"."THEN21195
21190 GOTO21425
21195 ?:IFQ$(A5,A6)="K"THEN21220
21200 IFQ$(A5,A6)<>"C"THEN21325
21205 IFRND(1)>.1THEN21220
21210 ?"*** COMMANDER AT SECTOR";A5;"-";A6;"USES ANTI-PHOTON DEVICE !"
21215 ?"-- TORPEDO NEUTRALIZED.":GOTO21435
21220 FORV=1TOK3
21225 IF(A5=K4(V))AND(A6=K5(V))THEN21235
21230 NEXTV
212)=G(Q1,Q2)-10:FORV=1TOR3
19115 IF(B2(V)<>Q1)OR(B3(V)<>Q2)THEN19125
19120 B2(V)=B2(R3):B3(V)=B3(R3)
19125 NEXTV:R3=R3-1:B6=0:B7=0:B1=B1+1:GOSUB17000
19130 ?"*** STARBASE AT SECTOR";J5;"-";J6;"DESTROYED."
19135 GOTO19255
19140 IF(S6<>J5)OR(S7<>J6)THEN19190
19145 ?"*** STARSHIP BUFFETED BY NOVA.":IFS4<>0THEN19155
19150 E1=E1-LQ:GOTO19170
19155 IFS3>=LQTHEN19180
19160 D6=LQ-S3:E1=E1-D6:GOSUB17000:S3=0:S4=0
19165 ?"*** STARSHIP SHIELDS KNOCKED OUT.":D4(8)=5E-03*D5*RND(1))*D6
19170 IFE1>0THEN19185
10
20025 ?"PHASERS CAN'T BE FIRED THRU BASE SHIELDS.":GOTO20080
20030 IFD4(3)=0THEN20050
20040 ?"PHASER BANKS DAMAGED.":GOTO20080
20050 IFS4=0THEN20060
20055 ?"SHIELDS MUST BE DOWN TO FIRE PHASERS.":GOTO20080
20060 IFK3>0THEN20090
20065 ?
20070 ?"THE SHORT-RANGE SENSORS DETECT NO ENEMY IN THIS QUADRANT."
20080 J3=0:RETURN
20090 ?"PHASERS LOCKED ON TARGET.  ENERGY AVAILABLE=";
20095 ?.01*INT(100*E1)
20100 INPUT"UNITS TO FIRE";P1:IFP1<E1THEN20120
20110 ?"ENERGY AVAILABLE =";:GOTO20095
20120 IFP1>THEN21060
21055 ?"NO BURST.  ONLY";T4;"TORPEDOS LEFT.":GOTO21035
21060 INPUT"SPREAD ANGLE (3 - 30 DEG)";G2
21061 IFG2<0THEN21035
21062 IF(G2<3)OR(G2>30)THEN21060
21063 G2=FND(G2)
21065 N=3
21070 FORZ6=1TON
21075 IFC5$<>"DOCKED"THENT4=T4-1
21080 Z7=Z6:R=RND(1)
21085 R=(R+RND(1))*.5-.5
21090 IF(R>=-.4)AND(R<=.4)THEN21125
21095 R=(RND(1)+1.2)*R:IFN=3THEN21105
21100 ?"*** METEORITE DEFLECTION":R=INT(RND(1)*50)+1
21101 ?"TORPEDO EFFECTIVENESS REDUCED"; R;"%":?:GOTO21110
21105 ?"*** TORPEDO NUMBER"235 K=K6(V):W3=200+800*RND(1)
21240 IFABS(K)<W3THENW3=ABS(K)
21245 K6(V)=K-SGN(K)*ABS(W3):IFK6(V)<>0THEN21255
21250 T2$=Q$(A5,A6):GOSUB6000:GOTO21435
21255 IFQ$(A5,A6)="K"THEN?"*** KLINGON AT";
21260 IFQ$(A5,A6)="C"THEN?"*** COMMANDER AT";
21265 ?A5;"-";A6;
21270 A7=A8+2.5*(RND(1)-.5)
21275 W3=ABS(-SIN(A7)):IFABS(COS(A7))>W3THENW3=ABS(COS(A7))
21280 X7=-SIN(A7)/W3:Y7=COS(A7)/W3
21285 P=INT(A5+X7+.5):Q=INT(A6+Y7+.5)
21290 IF(P<1)OR(P>10)OR(Q<1)OR(Q>10)THEN21320
21295 IFQ$(P,Q)<>"."THEN21320
21309175 F9=7:GOSUB10000:RETURN
19180 S3=S3-LQ
19185 X1=X1+S6-H4(M,1):Y1=Y1+S7-H4(M,2):K=K+1:GOTO19260
19190 IFQ$(J5,J6)<>"C"THEN19250
19195 FORV=1TOK3
19200 IF(K4(V)=J5)AND(K5(V)=J6)THEN19210
19205 NEXTV
19210 K6(V)=K6(V)-800:IFK6(V)<=0THEN19250
19215 N5=J5+J5-H4(M,1):N6=J6+J6-H4(M,2)
19220 ?"*** COMMANDER AT SECTOR";J5;"-";J6;"DAMAGED";
19225 IF(N5<1)OR(N5>10)OR(N6<1)OR(N6>10)THEN19245
19230 ?" AND BUFFETED TO SECTOR";N5;"-";N6
19235 Q$(N5,N6)="C":K4(V)=N5:K5(V)=N6
19240 K7(V)=SQR((S6-N5)^2+(S7-N0THEN20140
20130 J3=0:RETURN
20140 E1=E1-P1
20142 IFD4(11)=0THEN20147
20144 P1=P1*(RND(1)*.5+.5)
20145 ?:?"COMPUTER MALFUNCTION HAMPERS PHASER ACCURACY.":?
20147 E=P1:IFK3=0THEN20310
20150 E=0:T5=(K3*(K3+1))/2
20160 FORI=1TOK3:H3(I)=((K3+1-I)/T5)*P1
20170 H5(I)=ABS(K6(I))/(P*.9^K7(I))
20180 IFH3(I)<=H5(I)THEN20200
20190 E=E+(H3(I)-H5(I)):H3(I)=H5(I)
20200 NEXTI
20210 IFE=0THEN20280
20220 FORI=1TOK3:R7=H5(I)-H3(I)
20230 IFR7<=0THEN20260
20240 IFR7>=ETHEN20270
20250 H3(I)=H5(I):E=E-R7
20260 ;Z6;"MISFIRE - ";R;"% DOWN"
21110 IF RND(1)>.2THEN21125
21115 ?"*** PHOTON TUBES DAMAGED BY MISFIRE."
21120 D4(4)=D5*(1+2*RND(1)):GOTO21440
21125 IF(S4<>0)OR(C5$="DOCKED")THENR=R+1E-03*S3*R
21130 A3=C6+.25*R:IFN=1THEN21140
21135 A8=(15-A3+(2-Z6)*G2)*.523599:?
21137 ?"TRACK FOR TORPEDO NUMBER";Z7;"--":GOTO21145
21140 ?:?"TORPEDO TRACK --":A8=(15-A3)*.523599
21145 X4=-SIN(A8):Y4=COS(A8):B8=ABS(X4)
21146 IFABS(Y4)>ABS(X4)THENB8=ABS(Y4)
21150 X4=X4/B8:Y4=Y4/B8:X5=S6:Y5=S7
21155 FORL9=1TO15:X5=X5+X4:0 Q$(P,Q)=Q$(A5,A6):Q$(A5,A6)=".":?"DAMAGED--"
21305 ?"   DISPLACED BY BLAST TO SECTOR";P;"-";Q
21310 K4(V)=P:K5(V)=Q:K7(V)=SQR((S6-P)^2+(S7-Q)^2)
21311 K8(V)=K7(V)
21315 GOSUB28000:GOTO21435
21320 ?"DAMAGED, BUT NOT DESTROYED.":GOTO21435
21325 IFQ$(A5,A6)<>"B"THEN21365
21330 ?"*** STARBASE DESTROYED...!!!"
21335 IFS2(Q1,Q2)<0THENS2(Q1,Q2)=0
21340 FORW=1TOR3
21345 IF(B2(W)<>Q1)OR(B3(W)<>Q2)THEN21355
21350 B2(W)=B2(R3):B3(W)=B3(R3)
21355 NEXTW:Q$(A5,A6)=".":R3=R3-1:B6=0:B7=0
21360 G(Q1,Q2)=G(Q1,0 IFD4(6)<0THEND4(6)=0
22130 S4=0:IFR1<>0THENRETURN
22140 F9=1:GOSUB10000:RETURN
23000 P=D0-J2:IF(P<>0)AND(R1=0)THEN23020
23010 IFP<5THENP=5
23020 N=(K2+K1)/P:K=INT(500*N+.5):L=0
23030 IFG1<>0THENL=100*S8
23035 I=0
23040 IFLEFT$(S5$,1)="E"THENM=0
23045 IFLEFT$(S5$,1)="F"THENM=1
23050 IFLEFT$(S5$,1)=""THENM=2
23060 IFA1=0THENI=200
23070 J=10*K1+50*K2+K+L-I-100*B1-100*M-35*N1-3*S1-C4
23080 ?:IFJ<>0THEN23100
23090 ?"AS YET, YOU HAVE NO SCORE.":RETURN
23100 ?"YOUR SCORE --":?:IFK1=0THEN23120
2314:J1=4:L1=J1
24020 Q1=FNA(1):Q2=FNA(1):S6=FNB(1):S7=FNB(1):I9=10:T4=I9
24030 W1=5:W2=25:FORI=1TO12:D4(I)=0:NEXT
24040 J2=100*INT(31*RND(1)+20):D0=J2:K1=0:K2=0:N1=0:N2=0:R6=0:C4=0
24050 A1=1:D3=.25:FORI=1TO8:FORJ=1TO8:S2(I,J)=0:NEXTJ:NEXTI
24060 F1(1)=D0-.5*I5*LOG(RND(1)):F1(5)=1E+30
24070 F1(2)=D0-1.5*(I5/R2)*LOG(RND(1)):I6=0
24080 F1(3)=D0-.3*I5*LOG(RND(1)):F1(4)=D0-.3*I5*LOG(RND(1))
24090 FORI=1TO8:FORJ=1TO8:K=INT(RND(1)*9+1):I6=I6+K
24100 G(I,J)=K:NEXTJ:NEXTI:S1=0
24110 FOR I=1TOI2
24120 X=INTTHE STARSHIP"
24370 ?"U.S.S. ENTERPRISE, IT IS YOUR MISSION TO SEEK OUT AND"
24380 ?"DESTROY THIS INVASION FORCE OF";I1;"BATTLE CRUISERS."
24390 ?:?"YOU HAVE AN INITIAL ALLOTMENT OF";INT(I5);
24400 ?"STARDATES":?"TO COMPLETE YOUR MISSION."
24410 ?"AS THE MISSION PROCEEDS, YOU MAY BE GIVEN MORE TIME."
24420 ?:?"YOU WILL HAVE";I2;"SUPPORTING STARBASE(S).":?
24430 GOTO24515
24440 ?"STARDATE..............";I
24450 ?"NUMBER OF KLINGONS....";I1
24460 ?"NUMBER OF STARDATES...";INT(I5)
24470 ?"NUMBER OF Q2)-10:B1=B1+1:GOSUB17000:GOTO21435
21365 IFQ$(A5,A6)<>"*"THEN21405
21370 IFRND(1)>.15THEN21385
21375 ?"*** STAR AT SECTOR";A5;"-";A6;"UNAFFECTED BY PHOTON BLAST"
21380 GOTO21435
21385 X2=A5:Y2=A6:GOSUB19002:A5=X2:A6=Y2
21390 IFG(Q1,Q2)=LQTHENRETURN
21395 IFA2<>0THENRETURN
21400 GOTO21435
21405 ?:?"  >>> ORGANIAN TRUCE-MONITOR DESTROYED <<<":Q$(A5,A6)=".":?
21420 T2=0:T3=0:GOTO21435
21425 NEXTL9
21430 ?:?"TORPEDO MISSED!"
21435 NEXTZ6
21440 IFR1<>0THENRETURN
21445 F9=1:GOSUB10000:RETURN
220010 ?K1;TAB(5);"ORDINARY KLINGON(S) DESTROYED";TAB(36);10*K1*MR
23120 IFK2=0THEN23140
23130 ?K2;TAB(5);"KLINGON COMMANDER(S) DESTROYED";TAB(36);50*K2*MR
23140 IFK=0THEN23160
23150 ?FNR(N);TAB(5);"KLINGONS PER STARDATE, AVERAGE";
23155 ?TAB(36);K*MR
23160 IFS1=0THEN23180
23170 ?S1;TAB(5);"STAR(S) DESTROYED";TAB(36);-3*S1*MR
23180 IFB1=0THEN23200
23190 ?B1;TAB(5);"STARBASES DESTROYED";TAB(36);-100*B1*MR
23200 IFN1=0THEN23220
23210 ?N1;TAB(5);"SOS CALL(S) TO A STARBASE";TAB(36);-35*N1*MR
23220 IFC4=(RND(1)*6+2):Y=INT(RND(1)*6+2)
24130 IFG(X,Y)>=10THEN24120
24140 IFI<2THEN24180
24150 K=I-1:FORJ=1TOK:D1=SQR((B2(J)-X)^2+(B3(J)-Y)^2)
24160 IFD1<2THEN24120
24170 NEXTJ
24180 B2(I)=X:B3(I)=Y:S2(X,Y)=-1:G(X,Y)=G(X,Y)+10:NEXTI
24190 B1=0:K=I1-I4:L=INT(.25*S8*(9-L2)+1)
24200 M=INT((1-RND(1)^2)*L):IFM>KTHENM=K
24210 N=100*M
24220 X=FNA(1):Y=FNA(1):IFG(X,Y)+N>999THEN24220
24230 G(X,Y)=G(X,Y)+N:K=K-M:IFK<>0THEN24200
24240 FORI=1TOI4
24250 X=FNA(1):Y=FNA(1):IF(G(X,Y)<99)AND(RND(1)<.75)THEN24250
24260 STARBASES...";I2
24480 ?"STARBASE LOCATIONS....";
24490 FORI=1TOI2:?B2(I);"-";B3(I);
24500 IFI<>I2THEN?", ";
24510 NEXTI:?:?
24515 GOSUB18400
24520 ?"THE ";S5$;" IS CURRENTLY IN THE ";G2$;" QUADRANT."
24530 GOSUB18000
24531 ?:INPUT"READY TO CONTINUE";NL$:?CHR$(26):GOSUB29002:GOSUB14001:RETURN
25010 INPUT"WARP FACTOR";K
25020 ?
25025 IFK<1THEN25140
25026 IFK>10THEN25150
25030 J=W1:W1=K:W2=W1*W1
25040 IF(W1<=J)OR(W1<=6)THEN25070
25050 IFW1<=8THEN25080
25060 IFW1>8THEN25100
25070 ?"'WARP FACTO1 ?:?"*** RED ALERT!!   RED ALERT!! ***":?
22010 ?"*** COLLISION IMMINENT!!":?
22020 ?"*** ";S5$;" RAMS ";:W7=1:IFQ$(S6,S7)="C"THENW7=2
22030 IFW7=1THEN?"KLINGON AT ";
22040 IFW7=2THEN?"COMMANDER AT ";
22050 ?"SECTOR";S6;"-";S7:A5=S6:A6=S7:T2$=Q$(S6,S7)
22060 GOSUB6000:?"*** ";S5$;" HEAVILY DAMAGED."
22070 K=INT(5+RND(1)*20):?"***SICKBAY REPORTS";K;"CASUALTIES!"
22080 C4=C4+K:FORL=1TO12:I=RND(1)
22090 J=(3.5*W7*(RND(1)+I)+1)*D5
22100 IFL=6THENJ=J/3
22110 D4(L)=D4(L)+T1+J:NEXTL:D4(6)=D4(6)-3
22120THEN23240
23230 ?C4;TAB(5);"CASUALTIES INCURRED";TAB(36);-C4*MR
23240 IFM=0THEN23260
23250 ?M;TAB(5);"SHIP(S) LOST OR DESTROYED";TAB(36)-100*M*MR
23260 IFA1<>0THEN23280
23270 ?TAB(5)"PENALTY FOR GETTING KILLED";TAB(36);-200*MR
23280 IFG1=0THEN23300
23290 ?TAB(5);"BONUS FOR WINNING ";S$(S8);" GAME";TAB(36);L*MR
23300 ?TAB(5);"-------------------------------------"
23310 ?TAB(28);"TOTAL";TAB(36);J*MR;"**":RETURN
24001 A2=0:G1=0:GOSUB4001:S5$="ENTERPRISE"
24010 I7=5000:E1=I7:I8=2500:S3=I8:S4=0:S9=SIFG(X,Y)>899THEN24250
24270 IFI=1THEN24300
24280 M=I-1:FORJ=1TOM:IF(C1(J)=X)AND(C2(J)=Y)THEN24250
24290 NEXTJ
24300 G(X,Y)=G(X,Y)+100:C1(I)=X:C2(I)=Y:NEXTI
24305 I=INT(D0):?:S0=0
24310 T2=FNA(1):T3=FNA(1):IFG(T2,T3)<100THEN24310
24320 IFS8<>1THEN24440
24330 ?"IT IS STARDATE";I;"...THE ORGANIAN PEACE TREATY BETWEEN"
24340 ?"THE UNITED FEDERATION OF PLANETS AND THE KLINGON EMPIRE"
24350 ?"HAS COLLAPSED AND THE FEDERATION IS BEING ATTACKED BY A"
24360 ?"DEADLY KLINGON INVASION FLEET.  AS CAPTAIN OF R";W1;"CAPTAIN'":RETURN
25080 ?"*** OUR MAXIMUM SAFE SPEED IS WARP 6":RETURN";
25100 IFW1=10THEN25130
25110 ?"*** CAPTAIN, OUR ENGINES MAY NOT TAKE IT !":RETURN
25130 ?"-'AYE, CAPTAIN, WE'LL GIVE IT A TRY.'":RETURN
25140 ?"-'WE CAN'T GO BELOW WARP 1, CAPTAIN.'":RETURN
25150 ?"-'OUR TOP SPEED IS WARP 10, CAPTAIN.'"
25160 RETURN
26001 J3=0:IFD4(8)<>0THEN26600
26010 IFS4<>0THEN26530
26500 INPUT"SHIELDS ARE DOWN.  DO YOU WANT THEM UP";B$
26510 IFLEFT$(B$,1)="Y"THEN26560
26520 RETURN
26530 INPUT"SHIOM STARFLEET COMMAND...STARDATE";INT(D0)
27170 ?"'SUPERNOVA IN QUADRANT";X;"-";Y;
27175 ?"....CAUTION ADVISED'"
27180 N=G(X,Y):R=INT(N/100):Q=0
27190 IF(X<>Q1)OR(Y<>Q2)THEN27210
27200 K3=0:C3=0
27210 IFR=0THEN27270
27220 R1=R1-R:IFR2=0THEN27270
27230 FORL=1TOR2:IF(C1(L)<>X)OR(C2(L)<>Y)THEN27260
27240 C1(L)=C1(R2):C2(L)=C2(R2):C1(R2)=0:C2(R2)=0
27250 R2=R2-1:R=R-1:Q=1:IFR2=0THENF1(2)=1E+30
27260 NEXTL
27270 IFR3=0THEN27310
27280 FORL=1TOR3:IF(B2(L)<>X)OR(B3(L)<>Y)THEN27300
27290 B2(L)=B2(R3):B39040 ONIGOTO29050,29060,29080,29090,29140
29045 ONI-5GOTO29150,29160,29170,29200,29210
29050 ?" STARDATE      ";FNR(D0):GOTO29220
29060 IFC5$<>"DOCKED"THENGOSUB17000
29070 ?" CONDITION      ";C5$:GOTO29220
29080 ?" POSITION      ";Q1;"-";Q2;", ";S6;"-";S7:GOTO29220
29090 ?" LIFE SUPPORT   ";:IFD4(5)<>0THEN29110
29100 ?"ACTIVE":GOTO29220
29110 IFC5$<>"DOCKED"THEN29130
29120 ?"DAMAGED, SUPPORTED BY STARBASE":GOTO29220
29130 ?"DAMAGED, RESERVES=";FNS(L1):GOTO29220
29140 ?" WARP FACTOR   ";FNR(W1):GOIFR2<>0THENF1(2)=D0-(I5/R2)*LOG(RND(1))
30160 F1(3)=D0-.5*I5*LOG(RND(1))
30170 FORI=1TO8:FORJ=1TO8:IF1<S2(I,J)THENS2(I,J)=1
30180 NEXTJ:NEXTI
30185 ?
30190 ?"SPOCK HAS RECONSTRUCTED A CORRECT STAR CHART FROM MEMORY."
30200 GOSUB18000:RETURN
31001 J3=0:IFD4(12)<>0THEN31120
31020 INPUT"NUMBER OF UNITS TO SHIELDS";Z3
31030 IFZ3<0THENRETURN
31040 IFE1+S3-Z3>0THEN31060
31050 ?"SCOTT HERE-  'WE ONLY HAVE";FNR(E1+S3);"UNITS LEFT.'"
31051 RETURN
31060 E1=E1+S3-Z3:S3=Z3:?"--ENERGY TRANSFER COMPLETE--"
ELDS ARE UP.  DO YOU WANT THEM DOWN";B$
26540 IFLEFT$(B$,1)="Y"THEN26590
26550 RETURN
26560 S4=1:S9=1:IFC5$<>"DOCKED"THENE1=E1-50
26570 ?"SHIELDS RAISED.":IFE1<=0THEN26610
26580 J3=1:RETURN
26590 S4=0:S9=1:?"SHIELDS LOWERED.":J3=1:RETURN
26600 ?"SHIELDS DAMAGED AND DOWN. ":RETURN
26610 ?:?"SHIELDS CONSUME ALL ENERGY."
26620 F9=4:GOSUB10000:RETURN
27000 IFX2<>0THEN27100
27010 N=INT(RND(1)*I6+1):FORX=1TO8:FORY=1TO8
27020 N=N-(G(X,Y)-INT(G(X,Y)/10)*10):IFN<=0THEN27040
27030 NEXTY:NEXTX:RETURN
270(L)=B3(R3):B2(R3)=0:B3(R3)=0:R3=R3-1
27300 NEXTL
27310 IFX2=0THEN27350
27320 N=G(X,Y)-INT(G(X,Y)/100)*100
27330 S1=S1+(N-INT(N/10)*10):B1=B1+INT(N/10)
27340 K1=K1+R:K2=K2+Q
27350 IF(S2(X,Y)<>0)AND(D4(9)<>0)THENS2(X,Y)=LQ+G(X,Y)
27360 IF(D4(9)=0)OR((Q1=X)AND(Q2=Y))THENS2(X,Y)=1
27370 G(X,Y)=1000
27380 IF(R1<>0)OR((X=Q1)AND(Y=Q2))THEN27430
27390 ?CHR$(26):?"*** SUPERNOVA IN QUADRANT";X;"-";Y;"HAS DESTROYED THE"
27400 ?"REMAINDER OF THE ENEMY FLEET !!"
27420 F9=1:GOSUB10010:RETURN
27430 IFA2=0THENTO29220
29150 ?" ENERGY";SPC(8);.01*INT(100*E1):GOTO29220
29160 ?" TORPEDOS      ";T4:GOTO29220
29170 ?" SHIELDS        ";:B$="DOWN,":IFS4<>0THENB$="UP,"
29180 IFD4(8)>0THENB$="DAMAGED,"
29190 ?B$;INT(100*S3/I8+.5);"%":GOTO29220
29200 ?" KLINGONS LEFT ";R1:GOTO29220
29210 ?" TIME LEFT     ";FNS(R5)
29220 NEXTI:RETURN
29230 ?"SHORT RANGE SENSORS DAMAGED.":RETURN
30001 ?:?"*** TIME WARP ENTERED ***":?"YOU ARE TRAVELING ";
30010 IFS0<>0THEN30050
30020 T1=-.5*I5*LOG(RND(1))
30030 ?"FORWARD IN TIME"31070 ?"(SHIP ENERGY=";FNR(E1);"    SHIELD ENERGY=";FNR(S3);")"
31075 J3=1
31080 T1=.1:P5=(K3+4*C3)/48:IFP5<.1THENP5=.1
31090 IFP5>RND(1)THENGOSUB1000
31100 IFA2<>0THENRETURN
31110 GOSUB9000:RETURN
31120 ?"TRANSFER PANEL DAMAGED.":RETURN
32001 INPUT"WHICH DIRECTION";Z
32002 IFZ<.01ORZ>12THENGOSUB40000ELSE32020
32005 J3=0:RETURN
32020 T1=.05:P=(K3+4*C3)/48:IFP<.05THENP=.05
32030 IFP>RND(1)THENGOSUB1000
32040 IFA2<>0THENRETURN
32050 GOSUB9000:J3=1:IFA2<>0THENRETURN
32080 D5=INT((Z/12)*8+1.5):IFD40 IF(X<>Q1)OR(Y<>Q2)THEN27150
27050 IFJ4<>0THEN27150
27060 N=INT(RND(1)*(G(X,Y)-INT(G(X,Y)/10)*10))+1
27070 FORX3=1TO10:FORY3=1TO10:IFQ$(X3,Y3)<>"*"THEN27090
27080 N=N-1:IFN=0THEN27100
27090 NEXTY3:NEXTX3
27100 ?:?"*** RED ALERT!!  RED ALERT!! ***
27105 X3=X2:Y3=Y2
27110 ?"*** INCIPIENT SUPERNOVA DETECTED AT SECTOR";X3;"-";Y3
27120 X=Q1:Y=Q2:K=(X2-S6)^2+(Y2-S7)^2
27130 IFK>1.5THEN27180
27140 ?"*** EMERGENCY AUTO-OVERRIDE JAMMED ***":A2=1:GOTO27180
27150 IFD4(9)<>0THEN27180
27160 ?:?"MESSAGE FRRETURN
27440 F9=8:GOSUB10010:RETURN
28000 IFK3<=1THENRETURN
28010 Z4=0:FORO=1TOK3-1:IFK7(O)<=K7(O+1)THEN28080
28020 K=K7(O):K7(O)=K7(O+1):K7(O+1)=K
28030 K=K8(O):K8(O)=K8(O+1):K8(O+1)=K
28040 K=K4(O):K4(O)=K4(O+1):K4(O+1)=K
28050 K=K5(O):K5(O)=K5(O+1):K5(O+1)=K
28060 K=K6(O):K6(O)=K6(O+1):K6(O+1)=K
28070 Z4=1
28080 NEXTO
28090 IFZ4<>0THEN28010
28100 RETURN
29002 IFD(1)<>0THEN29230
29010 ?:?"    1 2 3 4 5 6 7 8 9 10"
29020 FORI=1TO10:IFI<10THEN?" ";
29030 ?I;:FORJ=1TO10:?Q$(I,J);" ";:NEXTJ
2;FNR(T1);"STARDATES."
30040 F1(2)=F1(2)+T1:GOTO30200
30050 M=D0:D0=D9(1)
30060 ?"BACKWARD IN TIME";FNR(M-D0);"STARDATES.":S0=0
30070 R1=D9(2):R2=D9(3):R3=D9(4):R4=D9(5):R5=D9(6)
30080 S1=D9(7):B1=D9(8):K1=D9(9):K2=D9(10)
30090 FORI=1TO8:FORJ=1TO8:G(I,J)=D9(I-1+8*(J-1)+11):NEXTJ:NEXTI
30100 FORI=75TO84:C1(I-74)=D9(I):NEXT
30110 FORI=85TO94:C2(I-84)=D9(I):NEXT
30120 FORI=95TO99:B2(I-94)=D9(I):NEXT
30130 FORI=100TO104:B3(I-99)=D9(I):NEXT:B4=D9(105):B5=D9(106)
30140 F1(1)=D0-.5*I5*LOG(RND(1))
30150 5>8THEND5=1
32085 FORI=1TO5:FORJ=1TO5:V$(I,J)=" ":NEXTJ:NEXTI:N=0
32087 V$(3,3)=LEFT$(S5$,1)
32090 OND5GOTO32100,32130,32150,32170,32190,32220,32260,32300
32100 I=S6-2:J=S7-2:V$(1,1)=Q$:IF(J>0)AND(I>0)THENV$(1,1)=Q$(I,J)
32110 I=S6-1:J=S7-1:V$(2,2)=Q$:IF(I>0)AND(J>0)THENV$(2,2)=Q$(I,J)
32120 N=N+1:IFN=3THEN32350
32125 I=S6-2:V$(1,2)=Q$:IF(I>0)AND(J>0)THENV$(1,2)=Q$(I,J)
32130 I=S6-2:V$(1,3)=Q$:IFI>0THENV$(1,3)=Q$(I,S7)
32135 I=S6-1:V$(2,3)=Q$:IFI>0THENV$(2,3)=Q$(I,S7)
32140 N=N+1:IFN=3THEN32350
3<11)AND(J>0)THENV$(4,2)=Q$(I,J)
32280 N=N+1:IFN=3THEN32350
32290 J=S7-2:V$(4,1)=Q$:IF(I<11)AND(J>0)THENV$(4,1)=Q$(I,J)
32300 J=S7-2:V$(3,1)=Q$:IFJ>0THENV$(3,1)=Q$(S6,J)
32310 J=S7-1:V$(3,2)=Q$:IFJ>0THENV$(3,2)=Q$(S6,J)
32320 N=N+1:IFN=3THEN32350
32330 I=S6-1:J=S7-2:V$(2,1)=Q$:IF(I>0)AND(J>0)THENV$(2,1)=Q$(I,J)
32340 GOTO32100
32350 FORI=1TO5
32360 IF(V$(I,1)=" ")AND(V$(I,3)=" ")AND(V$(I,5)=" ")THEN32390
32370 ?"  ";
32380 FORJ=1TO5:?V$(I,J);" ";:NEXTJ:?
32390 NEXTI:RETURN
33001 J3=0:INPUT"HOW M34140 RETURN
34150 T1=10*D1/W2:IFT1<.8*R5THEN34500
34160 ?:?"MR. SPOCK - 'CAPTAIN, I COMPUTE THAT SUCH A TRIP"
34170 ?" WILL REQUIRE APPROXIMATELY";FNR(100*T1/R5);
34180 ?"PERCENT":?"   OF OUR REMAINING TIME.  ARE YOU SURE ";
34190 INPUT "THIS IS WISE";B$:IFLEFT$(B$,1)="Y"THEN34500
34200 J3=0:RETURN
34500 Q4=0:W=0:IFW1<=6THEN34660
34510 P=D1*(6-W1)^2/66.6667:IFP>RND(1)THENQ4=1
34520 IFQ4<>0THEND1=RND(1)*D1
34530 W=0:IFW1<10THEN34550
34540 IF.25*D1>RND(1)THENW=1
34550 IF(Q4=0)AND(W=0)THEN34660
3W ESCAPE IN THE GALILEO."
35060 ?"THE REMAINDER OF THE CREW BEAMS DOWN"
35070 ?"TO THE NEAREST HABITABLE PLANET.":IFR3<>0THEN35090
35080 F9=9:GOSUB10000:RETURN
35090 ?:?"YOU ARE CAPTURED BY KLINGONS AND RELEASED TO"
35100 ?"THE FEDERATION IN A PRISONER-OF-WAR EXCHANGE."
35110 ?"STARFLEET PUTS YOU IN COMMAND OF ANOTHER SHIP,"
35120 ?"THE FAERIE QUEENE WHICH IS ANTIQUATED, BUT"
35130 ?"STILL USABLE.":N=INT(RND(1)*R3+1):Q1=B2(N):Q2=B3(N)
35140 S6=5:S7=5:GOSUB18000:Q$(S6,S7)="."
35145 FORL=1TO3:S6=INT2145 I=S6-2:J=S7+1:V$(1,4)=Q$:IF(I>0)AND(J<11)THENV$(1,4)=Q$(I,J)
32150 I=S6-2:J=S7+2:V$(1,5)=Q$:IF(I>0)AND(J<11)THENV$(1,5)=Q$(I,J)
32155 I=S6-1:J=S7+1:V$(2,4)=Q$:IF(I>0)AND(J<11)THENV$(2,4)=Q$(I,J)
32160 N=N+1:IFN=3THEN32350
32165 J=S7+2:V$(2,5)=Q$:IF(I>0)AND(J<11)THENV$(2,5)=Q$(I,J)
32170 J=S7+2:V$(3,5)=Q$:IFJ<11THENV$(3,5)=Q$(S6,J)
32175 J=S7+1:V$(3,4)=Q$:IFJ<11THENV$(3,4)=Q$(S6,J)
32180 N=N+1:IFN=3THEN32350
32185 I=S6+1:J=S7+2:V$(4,5)=Q$:IF(I<11)AND(J<11)THENV$(4,5)=Q$(I,J)
32190 I=S6+2:J=S7+2ANY STARDATES";Z5:IF(Z5<R5)AND(K3=0)THEN33030
33020 INPUT"ARE YOU SURE";B$:IFLEFT$(B$,1)<>"Y"THENRETURN
33030 R6=1
33040 IFZ5<=0THENR6=0
33050 IFR6=0THENRETURN
33060 T1=Z5:Z6=Z5
33070 IFK3=0THEN33100
33080 T1=1+RND(1):IFZ5<T1THENT1=Z5
33090 Z6=T1
33100 IFT1<Z5THENGOSUB1000
33110 IFA2<>0THENRETURN
33120 GOSUB9000:J3=1:IFA2<>0THENRETURN
33130 Z5=Z5-Z6:GOTO33040
34001 J3=0:IFD4(6)<>0THEN34750
34010 INPUT"ENTER COURSE...";D2:IFD2<.01ORD2>12THENGOSUB40000ELSE34013
34012 RETURN
34013 INPUT"DISTANC4560 A=(15-D2)*.5236:X1=-SIN(A):X2=COS(A)
34570 B8=ABS(X1):IFABS(X2)>ABS(X1)THENB8=ABS(X2)
34580 X1=X1/B8:Y1=Y1/B8:N=INT(10*D1*B8+.5):X=S6:Y=S7
34590 IFN=0THEN34660
34600 FORL=1TON
34610 X=X+X1:Q=INT(X+.5):IF(Q<1)OR(Q>10)THEN34660
34620 Y=Y+Y1:R=INT(Y+.5):IF(R<1)OR(R>10)THEN34660
34630 IFQ$(Q,R)="."THEN34650
34640 Q4=0:W=0
34650 NEXTL
34660 GOSUB15001:IFA2<>0THENRETURN
34670 E1=E1-D1*W1*W1*W1*(S4+1):IFE1>0THEN34690
34680 F9=4:GOSUB10000:RETURN
34690 T1=10*D1/W2:IFW<>0THENGOSUB30001
34700 IFQ4=(3*RND(1)-1+B6)
35150 IF(S6<1)OR(S7>10)THEN35180
35160 S7=INT(3*RND(1)-1+B7):IF(S7<1)OR(S7>10)THEN35180
35170 IFQ$(S6,S7)="."THEN35190
35180 NEXTL:GOTO35140
35190 S5$="FAERIE QUEENE":Q$(S6,S7)=LEFT$(S5$,1):C5$="DOCKED"
35200 FORL=1TO12:D4(L)=0:NEXT:D4(10)=-1:E1=3000:I7=E1
35210 S3=1500:I8=S3:T4=6:I9=T4:L1=3:J1=L1:S4=0:W1=5:W2=25
35220 RETURN
36001 IFD4(11)=0THEN36030
36010 ?"COMPUTER DAMAGED - CANNOT EXECUTE DESTRUCT SEQUENCE"
36020 RETURN
36030 ?:?"    ---WORKING---"
36040 ?"IDENTIFICATION-POS:V$(5,5)=Q$:IF(I<11)AND(J<11)THENV$(5,5)=Q$(I,J)
32195 I=S6+1:J=S7+1:V$(4,4)=Q$:IF(I<11)AND(J<11)THENV$(4,4)=Q$(I,J)
32200 N=N+1:IFN=3THEN32350
32210 I=S6+2:V$(5,4)=Q$:IF(I<11)AND(J<11)THENV$(5,4)=Q$(I,J)
32220 I=S6+2:V$(5,3)=Q$:IFI<11THENV$(5,3)=Q$(I,S7)
32230 I=S6+1:V$(4,3)=Q$:IFI<11THENV$(4,3)=Q$(I,S7)
32240 N=N+1:IFN=3THEN32350
32250 I=S6+2:J=S7-1:V$(5,2)=Q$:IF(I<11)AND(J>0)THENV$(5,2)=Q$(I,J)
32260 I=S6+2:J=S7-2:V$(5,1)=Q$:IF(I<11)AND(J>0)THENV$(5,1)=Q$(I,J)
32270 I=S6+1:J=S7-1:V$(4,2)=Q$:IF(IE...";D1:IFD1<=0THENRETURN
34030 P=(D1+.05)*W1*W1*W1*(S4+1):IFP<E1THEN34150
34040 J3=0:?:?"ENGINEERING TO BRIDGE--"
34050 IF(S4=0)OR(.5*P>E1)THEN34080
34060 ?"  WE HAVEN'T THE ENERGY TO GO THAT FAR WITH";
34070 ?" THE SHIELDS UP.":RETURN
34080 W=INT((E1/(D1+.05))^.333333):IFW<=0THEN34130
34090 ?"  WE HAVEN'T THE ENERGY.  BUT WE COULD DO IT AT WARP";W
34100 IFS4<>0THEN34120
34110 RETURN
34120 ?"  IF YOU'LL LOWER THE SHIELDS.":RETURN
34130 ?"  WE CAN'T DO IT, CAPTAIN.  WE HAVEN'T GOT THE ENERGY."
0THEN34740
34710 ?:?"ENGINEERING TO BRIDGE--":?"   SCOTT HERE-  ";
34715 ?"'WE'VE JUST BLOWN THE WARP ENGINES."
34720 ?"   WE'LL HAVE TO SHUT 'ER DOWN HERE, CAPTAIN.'"
34725 D4(6)=D5*(3*RND(1)+1)
34740 J3=1:RETURN
34750 ?"WARP ENGINES DAMAGED.":RETURN
35001 ONSGN(D4(10))+2GOTO35010,35030,35020
35010 ?"YE FAERIE QUEENE HAS NO SHUTTLE CRAFT.":RETURN
35020 ?"SHUTTLE CRAFT DAMAGED.":RETURN
35030 ?:?"***ABANDON SHIP!  ABANDON SHIP!"
35040 ?"***ALL HANDS ABANDON SHIP!":?
35050 ?"YOU AND THE BRIDGE CREITIVE"
36050 ?"SELF-DESTRUCT-SEQUENCE-ACTIVATED":J=3
36060 FORI=10TO6STEP-1:?SPC(J);I:GOSUB36210:J=J+3:NEXT
36070 ?"ENTER-YOUR-MISSION-PASSWORD-TO-CONTINUE"
36080 ?"SELF-DESTRUCT-SEQUENCE-OTHERWISE-DESTRUCT"
36090 ?"SEQUENCE-WILL-BE-ABORTED"
36100 INPUTB$:IFB$<>X$THEN36190
36110 ?"PASSWORD-ACCEPTED":J=10
36120 FORI=5TO1STEP-1:?SPC(J);I:GOSUB36210:J=J+3:NEXT
36130 ?:?"*****ENTROPY OF ";S5$;" MAXIMIZED*****"
36140 ?:IFK3=0THEN36180
36150 W=20*E1:FORL=1TOK3:IFK6(L)*K7(L)>WTHEN36170
36160 A5=K4(L):AWCOST,ICOST ; ѓ PEFFECT,SCORE,OUT,ANTARES,SIRIUS,RIGEL,MERAK,PROCYON,CAPELLA b; ѓ VEGA,DENEB,CANOPUS,ALDEBARAN,ALTAIR,REGULUS,BELLATRIX,ARCTURUS ‘; ѓ POLLUX,SPICA,10.5,12,1.5,9,0,3,7.5,6,4.5 ѕ; ”  A(X)­°(8§·(X))Ґ1:”  B(X)­°(10§·(X))Ґ1 П; ”  D(X)­XЁ60 я; ” R(X)­°(X§10Ґ.5)Ё10:” S(X)­°(X§100Ґ.5)Ё100 %<( ЃI­1џ12:†D$(I):‚:ЃI­1џ20:†C$(I):‚ P<+ ЃI­1џ3:†T$(I):‚:ЃI­1џ4:†S$(I):‚:ЃI­1џ6 Ђ<, †C2$(I):‚:ЃI­1џ16:†G1$(I):‚:ЃI­1џ9:†C5(I):‚ ¶<. Њ24001:S7$(1)­"":S7$(2)­"  ":S7$(3)­" ":S7$(4)­"" Е<F ЉA2®¬0ў901 о<K J4­0:ЉД(A$,1)­"Y"ў46 л@Џ—Г(26):Ђ AиЉ(C3®¬0)Є(J4­0)ўЊ16001 AьЉK3­0ўЌ AЉA2®¬0ўЌ +AP2­1ЁI8 4AJ5­0 :A$— QA.ЉC5$­"DOCKED"ў1780 dA8H2­0:H3­0:C6­1 |ABЉS9­1ўC6­.5Ґ.5§·(1) …ALA3­0 ‘AVЃL­1џK3 ЈA`ЉK6(L)®0ў1540 ¬AjA3­1 їAtD6­.8Ґ.05§·(1) ХA~H4­K6(L)§D6©K8(L) нA€Љ(S4­0)Є(S9­0)ў1230 
B’P3­.1:ЉP2§S3¬P3ўP3­P2§S3 BњH5­P3§C6§H4Ґ1 -B¦ЉH5¬S3ўH5­S3 CB«S3­S3¦H5:H4­H4¦H5 cBєЉ(P3¬.1)Є(H4®5E¦03§E1)ў1540 lBОJ5­1 ™BШ— R(H4);"UNIT HIT ON THE ";S5$;" FROM "; ЇBвJ6­K4(L):J7­K5(L) СBмЉQ$(J6,J7)­"K"ў—"KLINGON AT THE ";S5$ жFЃW4­1џK3 шFK8(W4)­K7(W4)  G‚W4 G&Њ28000:Ќ GС—:ЉJ4­0ў2050 @Gд—"*** RED ALERT!  RED ALERT!" „Gо—"*** THE ";S5$;" HAS STOPPED IN QUADRANT CONTAINING SUPERNOVA" ЙG— "*** AUTO-OVERRIDE ATTEMPTS TO HURL ";S5$;" TO OTHER QUADRANT" ЩG S2(Q1,Q2)­1 дG*Њ18000 цG4ЉD4(6)­0ў2290 ьG>— HH—"WARP ENGINES DAMAGED." FH\—:—"TRYING TO ENGAGE IMPULSE ENGINES..." XHfЉD4(7)­0ў2190 xHp—"IMPULSE ENGINES DAMAGED." ЃHuF9­8 ЊHzЊ10000 ’H„Ќ  HЋP2­.75§E1 µHD6­4E¦03§(P2¦50) МHўD7­1.4142Ґ1.2§·(1) ЦH6=K5(L):T2$=Q$(A5,A6):GOSUB6000
36170 NEXTL
36180 F9=10:GOSUB10000:RETURN
36190 ?"PASSWORD-REJECTED"
36200 ?"CONTINUITY-EFFECTED":?:RETURN
36210 K=12345:FORM=1TO90:K=K+1:NEXTM:RETURN
37001 FORI=1TO10:GOTO29040:RETURN
40000 ?"---> COURSE(S) .01-12 ONLY !!!":RETURN
                                                                                                                                T1­0:„"COMMAND";A$:Љї(A$)¬1ў110 =P —"2 LETTERS, PLEASE.":€75 =n ЃI­1џ20 3=x ЉA$­Д(C$(I),ї(A$))ў150 9=‚ ‚ [=‡ —"ILLEGAL !! - USE THIS LIST" k=Њ —:ЃI­1џ20¤4 ќ=Ќ —C$(I);ћ12);C$(IҐ1);ћ22);C$(IҐ2);ћ32);C$(IҐ3) ©=Ћ ‚:—:€70 Ш=– ‘I€201,226,251,276,291,301,326,351,376,401 
>  ‘I¦10€426,901,476,501,526,545,551,576,601,627 >Й Њ 35001:€70 )>в Њ 3001:€70 7>ы Њ5001:€70 E>Њ8001:€70 T>#Њ36001:€70 b>-Њ7000:€70 v>FЊ33001:ЉJ3­0ў70 …>KЉA2®¬0ў901 њ>LЉG(Q1,Q2)­1000ў750 Є>TЊ1000:€70 ѕ>_Њ13001:ЉJ3­0ў70 З>a€710 Ц>xЊ14"; хBцЉQ$(J6,J7)­"C"ў—"COMMANDER AT"; C —J6;"-";J7 C
ЉH4¬H2ўH2­H4 "CH3­H3ҐH4 GCЉH4®(275¦25§S8)§(1Ґ.5§·(1))ў1530 eC(N4­1Ґ°(H4Ё(500Ґ100§·(1))) ЂC2—"*** CRITICAL HIT--"; ‰C<K9­1 –CFЃW4­1џN4 ЄCPJ9­°(12§·(1))Ґ1 ёCZC5(W4)­J9 ЩCdE3­(H4§D5)Ё(N4§(75Ґ25§·(1))) лCnЉJ9­6ўE3­E3Ё3  DsD4(J9)­D4(J9)ҐE3 DxЉW4­1ў1470 DЊЃV­1џW4 0D–ЉJ9­C5(V¦1)ў1480 7D ‚V CDЄK9­K9Ґ1 ODґЉK9­3ў— ^D№— " AND "; kDѕ—D$(J9); sDИ‚W4 …DТ— " DAMAGED." —DЬЉD4(8)­0ў1530 їDжЉS4®¬0ў—"*** SHIELDS KNOCKED DOWN." ИDрS4­0 ХDъE1¬D1­D6 зH¶ЉD6¬D7ўD1­D7 фHАT1­D1Ё.4 IКD2­12§·(1) IФJ4­0 IЮЊ13200 !Iи€2400 1IтW1­6Ґ2§·(1) >IьW2­W1§W1 LI	P2­.75§E1 hI	D6­P2Ё(W1§W1§W1§(S4Ґ1)) }I	D7­1.4142Ґ2§·(1) ‡I$	D1­D6 I.	ЉD6¬D7ўD1­D7 ЁI8	T1­10§D1ЁW2 ·IB	D2­12§·(1) АIL	J4­0 ЛIV	Њ34500 ЫI`	ЉJ4®¬0ў2440 дIj	F9­8 пIt	Њ10000 хI~	Ќ J€	ЉR1®¬0ўЌ J’	F9­1 Jњ	Њ10000 J¦	Ќ IJ№—:—"      1   2   3   4   5   6   7   8" uJВ—"     --- --- --- --- --- --- --- ---" ЂJМЃI­1џ8 ЊJЦ—I;" "; —JаЃJ­1џ8 ёJф‘Ї(S2(I,J))Ґ2€3070,3090,3110 ЕJю—" .1."; РJ€ 316Bд8 ХREWRITE BY ZOSO ц8 Н:С90:LQ­1000 :9 … G1$(16),V$(5,5),C$(20),G(8,8),D$(12),Q$(10,10),D4(12),D9(106) O9
 … S2(8,8):Q$­"?" ‘9 ѓ S.R. SENSORS,L.R. SENSORS,PHASERS,PHOTON TUBES,LIFE SUPPORT Л9 ѓ WARP ENGINES,IMPULSE ENGINES,SHIELDS,SUBSPACE RADIO : ѓ SHUTTLE CRAFT,COMPUTER,TRANSFER PANEL,ABANDON,CHART,COMPUTER T: ѓ DAMAGES,DESTRUCT,DOCK,IDLE,IMPULSE,LRSCAN,NAVIGATE,PHASERS,QUIT —: ѓ SHIELDS,SOS,SRSCAN,STATUS,TORPEDO,TRANSFER,VISUAL,WARP,SHORT Ъ: ѓ MEDIUM,LONG,BEGINNER,NOVICE,SENIOR,EXPERT,COURSE,001:€70 б>‘Њ34001 о>’ЉJ3­0ў70 ч>љ€710 ?ЄЊ20001:ЉJ3­0ў70 ?¬Њ1000:€70 -?ЬЊ26001:ЉJ3­0ў70 <?ЮЉA2®¬0ў901 O?ЯЊ1000:S9­0:€70 ^?хЊ11001:€70 t?Њ29002:Њ14001:€70 …?!—:Њ37001:€70 ћ?'Њ21001:ЉJ3­0ў70:Й710 І?@Њ31001:ЉJ3­0ў70 Б?IЉA2®¬0ў901 Ц?NЉG(Q1,Q2)®¬LQў70 Я?S€750 у?YЊ32001:ЉJ3­0ў70 @[ЉA2®¬0ў901 @bЉG(Q1,Q2)®¬LQў70  @g€750 /@sЊ25010:€70 >@ЖЉA2®¬0ў901 O@РЉT1®¬0ўЊ9000 ^@ЪЉA2®¬0ў901 s@дЉG(Q1,Q2)®LQў790 €@оЊ2001:ЉA2®¬0ў901 —@шЉA2®¬0ў901  @€740 ®@Њ1000:€70 К@…—:—:„"ANOTHER GAME ";A$ Ю@Ћ­E1¦H4 ЬD‚L иDЉA3­0ўЌ шDЉE1®­0ў1750 E"P4­100§P2§S3Ґ.5 E,ЉJ5®¬0ў1610 FE6—"ENEMY ATTACK--SHIELDS REDUCED TO "; PE@€1650 zEJ—"ENERGY LEFT:"; S(E1);"   SHIELDS "; ЌETЉS4®¬0ў—"UP,"; ®E^Љ(S4­0)Є(D4(8)­0)ў—"DOWN, "; ЙEhЉD4(8)¬0ў—"DAMAGED, "; ШEr—°(P4);"%" фE|Љ(H2®200)Є(H3®500)ў1800 F†J8­°(H3§·(1)§.015) FђЉJ8®2ў1800  Fљ— mF¤—"---> 'SICKBAY TO BRIDGE.  WE SUFFERED ";J8;"CASUALTIES IN THAT ATTACK" zFВC4­C4ҐJ8 „FМ€1800 ЌFЦF9­5 љFаЊ10000:Ќ ЩFф—"*** KLINGONS ATTACK-- STARBASE SHIELDS PROTECT0 ЭJ—" ..."; зJ€3160 ьJ&ЉS2(I,J)¬LQў3150 )K0ЉG(I,J)®LQў—S7$(ї(А(G(I,J))));А(G(I,J)); AK:ЉG(I,J)­LQў—" ***"; KKD€3160 \KN—S2(I,J)¦LQ; qKX‚J:—:‚I:Њ18400:— ¬Kv—"THE ";S5$;" IS CURRENTLY IN ";G2$;" (";Q1;"-";Q2;")" ІKЂЌ ЅKЎ—Г(26) ЛKжS8­0:L2­0 йKъ—"MISSION DURATION...: "; сKя„A$ эKЃ I­1џ3 LЉA$­Д(T$(I),ї(A$))ў4150  L‚I TL"—"WOULD YOU LIKE A SHORT, MEDIUM OR LONG GAME"; ^L,€4095 gL6L2­I ќL@—"ARE YOU A BEGINNER, NOVICE, SENIOR OR EXPERT "; ҐLJ„A$ °LTЃI­1џ4 МL^ЉA$­Д(S$(I),ї(A$))ў4220 УL0)¦C6(2) чPtD1­0:D2­0:Љ(X­0)Є(Y­0)ў5250 	QuD1­¶(X§XҐY§Y) -QvЉX®0ўZ7­Ї(Y)§(3.1416¦Ѕ(±(YЁX))) EQwЉX­0ўZ7­Ї(Y)§1.5708 XQxЉX¬0ўZ7­Ѕ(YЁX) Q}D2­12¦Z7§1.9098593:ЉD2¬12ўD2­D2¦12 ­Q‚—"COURSE IS"; S(D2);" FOR A DISTANCE OF"; МQЊ— S(D1);"QUADRANTS.":€5040 шQ¶„"ENTER DISTANCE AND WARP FACTOR";D1,A4 	RёЉ(D1®0)ў5040 RѕC7­D1§A4§A4§A4 ;RГT1­(10§D1)Ё((A4§A4)Ґ1E¦05) kRИ—"IT WOULD TAKE"; S(T1);"STARDATES AND USE" «RН— R(C7);"UNITS OF ENERGY  ("; R(C7ҐC7);"IF SHIELDS ARE UP)" µRТ€5040 СR"„"ENTER DISTANCE...";K3Ґ1)­0:K7(K3Ґ1)­0:K8(K3Ґ1)­0:K6(K3Ґ1)­0 эVtЌ WXЉC5$­"DOCKED"ў7100 #WbЉB6­0ў7020 IWgЉ(±(S6¦B6)®­1)Є(±(S7¦B7)®­1)ў7040 mWl—S5$;" NOT ADJACENT TO A BASE." sWvЌ „WЂC5$­"DOCKED" ўWЉ—"---> DOCKING COMPLETED" ѕW”E1­I7:S3­I8:T4­I9:L1­J1 ДWћЌ кWј—"CAPTAIN, WE'RE ALREADY DOCKED!" рWЖЌ XAJ­0:—:ЃI­1џ12 XJЉD4(I)®­0ў8070 $XTЉJ®¬0ў8060 MX^—"     DEVICE";Ў12);"-REPAIR TIMES-" qXh—Ў21);"IN FLIGHT    DOCKED":J­1 ўX|—"  ";D$(I);ћ23); S(D4(I));ћ33); S(D3§D4(I)) ©X†‚I СXђЉJ­0ў—" - ALL DEVICES FUNCTIONAL Y USABLE.)" д\[$€9320 п\^$Њ26500 ш\c$S9­0 ]h$Њ18000 ']m$F1(2)­D0ҐT1¦1.5§(I5ЁR2)§ё(·(1)) 1]n$€9000 G]r$F1(2)­1EҐ30:€9000 Ѓ]|$D9(1)­D0:D9(2)­R1:D9(3)­R2:D9(4)­R3:D9(5)­R4:D9(6)­R5 Є]~$D9(7)­S1:D9(8)­B1:D9(9)­K1:D9(10)­K2 Ь]$ЃI­1џ8:ЃJ­1џ8:D9(I¦1Ґ8§(J¦1)Ґ11)­G(I,J):‚J:‚I ъ]Ђ$ЃI­75џ84:D9(I)­C1(I¦74):‚ ^Ѓ$ЃI­85џ94:D9(I)­C2(I¦84):‚ 6^‚$ЃI­95џ99:D9(I)­B2(I¦94):‚ V^ѓ$ЃI­100џ104:D9(I)­B3(I¦99):‚ p^„$D9(105)­B4:D9(106)­B5 –^…$S0­1:F1(3)­D0¦.3§I5§ё(·(1)):€9000 ®^‹$Љ(R2­0)«(R3­0)ў9400 д^ђ$ЃI­1џR3:ЃJ­1џR2:Љ(B2(I)­C1(Jh‚I ЭLr€4160 лL|S8­I:MR­I M†„"ENTER MISSION PASSWORD...";X$:— )M•—"....STAND BY...." 4MљJ­·(1) SMёD5­.5§S8:I2­°(L2Ґ1Ґ·(1)§3) bMВЉI2¬5ўI2­5 lMМR3­I2 xMЦI5­7§L2 ‚MаR5­I5  MфR7­(S8¦2§·(1)Ґ1)§S8§.1Ґ.1 ґMюЉR7®.2ўR7­R7Ґ.1 ЖMI1­°(2§R7§I5) РMR1­I1 лMI4­°(S8Ґ.0625§I1§·(1)) хM&R2­I4 	N0I3­(I1Ґ4§I4)§I5 N:R4­I3 NDЌ ,N‰ЉD4(11)­0ў5030 FN’—" COMPUTER DISABLED" LNњЌ kN¦—"----COMPUTER ACTIVE----" ‚N°„"PROGRAM NAME";B$ ЌNєЃI­1џ6 ЄNДЉB$­Д(C2$(I),ї(B$))ў5120 °NО‚ ЛNШ—"VALID PROGRAMS ARE:" мNвD1 аR,ЉD1®0ў5040 ъR6C7­250§D1Ґ50:T1­D1Ё.4 *S@—"IT WOULD TAKE"; R(T1);"STARDATES AND USE" DSJ—C7;"UNITS OF ENERGY" NST€5040 xS†„"ENTER PHASER RANGE IN QUADRANTS";A3 ‡SђЉA3®0ў5040 ЈSљA3­A3§10:C7­(.9©A3)§100 ЮS¤—"PHASERS ARE ";Д(А(C7),5);"% EFFECTIVE AT THAT RANGE" иS®€5040 уSкЊ23000 эSф€5040 TDЌ 7Tf—"FORMAT IS MN,XXYY...WHERE MN IS THE QUADRANT" kTg—"AND XXYY IS THE SECTOR...E.G. 64,0307 REFERS" ЏTh—"TO QUADRANT 6-4, SECTOR 3-7." љTk€ 5040 ­TpЉT2$®¬"C"ў6100 ЛTzC3­0:—"*** COMMANDER AT"; уTЋ-" ЧXљЌ пX(#M­0:D7­D0ҐT1:ЃL­1џ5 Y<#ЉF1(L)¬D7ў9040 YF#M­L:D7­F1(L) YP#‚L -YZ#X6­D7¦D0:D0­D7 DYd#R4­R4¦(R1Ґ4§R2)§X6 XYn#R5­R4Ё(R1Ґ4§R2) gYx#ЉR5¬0ў9120 pY‚#F9­2 {YЊ#Њ10000 ЃY–#Ќ ¤Y #Љ(D4(5)­0)«(C5$­"DOCKED")ў9180 ГYЄ#Љ(L1¬­X6)«(D4(5)®­L1)ў9160 УYґ#F9­3:Њ10000 ЩYѕ#Ќ жYИ#L1­L1¦X6 ыYТ#ЉD4(5)®­X6ўL1­J1 ZЬ#R­X6 Zж#ЉC5$­"DOCKED"ўR­X6ЁD3 *Zр#ЃL­1џ12 =Zъ#ЉD4(L)®­0ў9230 OZ$D4(L)­D4(L)¦R dZ	$ЉD4(L)®0ўD4(L)­0 wZ
$ЉD4(L)®¬0ў9230 ¬Z$—:—"DAMAGE CONTROL-  ";D$(L);" NOW OPERATIONAL." іZ$‚L ѕZ$ЉM­0ўЌ ЛZ"$T1­T1¦X6 лZ,))Є(B3(I)­C2(J))ў9410 о^љ$‚J:‚I _¤$F1(4)­D0Ґ.5Ґ3§·(1) _®$F1(5)­1EҐ30:€9000 =_ё$F1(4)­1EҐ30:F1(5)­1EҐ30:€9000 S_В$B4­B2(I):B5­B3(I) m_М$Љ(B4­Q1)Є(B5­Q2)ў9380 „_Ц$F1(5)­D0Ґ.5Ґ3§·(1) ў_а$F1(4)­F1(5)¦.3§I5§ё(·(1)) ґ_к$ЉD4(9)¬0ў9000 х_ф$—:—"  CAPTAIN, THE STARBASE IN";B4;"-";B5;"IS UNDER ATTACK-" 1`ц$—"  AND CAN ONLY RESIST UNTIL STARDATE"; R(F1(5));"!!!" @`щ$ЉR6­0ў9000 h`ъ$„"  SHALL WE CANCEL IDLE PERIOD";B$ ~`ь$ЉД(B$,1)­"Y"ўR6­0 €`э$€9000 ¬`%F1(5)­1EҐ30:Љ(R2­0)«(R3­0)ў9000 Ъ`%K­°(G(B4,B5)Ё100):ЉG(B4,B5)¦K§—"  COURSE    WCOST   SCORE" Oм—"  PEFFECT   ICOST   OUT" Oц€5040 ;O ‘ I€5210,5302,5410,5510,5610,5700 fOZ„ "ENTER QUADRANT AND SECTOR - ";A3,A4 €OdЉ(A3®¬°(A3))«(A4®¬°(A4))ў5990 —OeЉA3®0ў5040 ­OfЉA3­0ўA3­10§Q1ҐQ2 єOgA3­A3Ґ.5 ЙOiK­°(A3Ё10) ЯOjЉ(K®1)«(K¬8)ў5990 ьOkC6(1)­K:K­°(A3¦C6(1)§10) PlЉ(K®1)«(K¬8)ў5990 'PmC6(2)­K:A4­A4Ґ.5 7PnK­°(A4Ё100) NPoЉ(K®1)«(K¬10)ў5990 uPpC6(1)­C6(1)Ґ(K¦1)Ё10:K­°(A4¦K§100) ЊPqЉ(K®1)«(K¬10)ў5990 ҐPrC6(2)­C6(2)Ґ(K¦1)Ё10 ЧPsX­Q1Ґ((S6¦1)Ё10)¦C6(1):Y­Q2Ґ((S7¦1)Ё1ЃF­1џR2:Љ(C1(F)­Q1)Є(C2(F)­Q2)ў6050 ъT‚F *UўC1(F)­C1(R2):C2(F)­C2(R2):C1(R2)­0:C2(R2)­0 BU¬R2­R2¦1:F1(2)­1EҐ30 fU¶ЉR2®¬0ўF1(2)­D0¦(I4ЁR2)§ё(·(1)) rUАK2­K2Ґ1 |UК€6120 “UФ—"*** KLINGON AT"; џUЮK1­K1Ґ1 »Uи—A5;"-";A6;"DESTROYED." ХUтQ$(A5,A6)­".":R1­R1¦1 бUьЉR1­0ўЌ хUR5­R4Ё(R1Ґ4§R2) VG(Q1,Q2)­G(Q1,Q2)¦100 VЃF­1џK3 ;V$Љ(K4(F)­A5)Є(K5(F)­A6)ў6200 BV.‚F NV8K3­K3¦1 ]VBЉF¬K3ў6250 iVLЃG­FџK3 —VVK4(G)­K4(GҐ1):K5(G)­K5(GҐ1):K6(G)­K6(GҐ1) µV[K7(G)­K7(GҐ1):K8(G)­K7(G) јV`‚G чVjK4(K3Ґ1)­0:K5($‘M€9280,9291,9340,9355,9475  [@$X2­0:Y2­0:Њ27000 [E$F1(1)­D0¦.5§I5§ё(·(1)) .[F$ЉG(Q1,Q2)­LQўЌ 8[G$€9000 G[K$ЉR2­0ў9330 ^[L$ЉC5$­"DOCKED"ў9325 q[M$I­°(·(1)§R2)Ґ1 ’[N$Y6­(C1(I)¦Q1)©2Ґ(C2(I)¦Q2)©2 Ў[O$ЉY6­0ў9325 »[P$Y6­¶(Y6):T1­.17778§Y6 ф[Q$—:—"*** ";S5$;" CAUGHT IN LONG-RANGE TRACTOR BEAM--" 
\R$Q1­C1(I):Q2­C2(I)  \S$S6­ B(1):S7­ B(1) Y\T$—"PULLED TO QUADRANT";Q1;"-";Q2;", SECTOR";S6;"-";S7 \U$ЉR6®¬0ў—"(IDLE PERIOD CANCELLED)" €\V$R6­0 \W$ЉS4®¬0ў9320 і\X$Љ(D4(8)­0)Є(S3¬0)ў9310 Ъ\Y$—"(SHIELDS NOT CURRENTL100®10ў9000 a%ЃI­1џR2:Љ(C1(I)­B4)Є(C2(I)­B5)ў9520 a&%‚:€9000 ,a0%ЉS2(B4,B5)­¦1ўS2(B4,B5)­0 Va:%ЉS2(B4,B5)¬999ўS2(B4,B5)­S2(B4,B5)¦10 raD%Љ(B4®¬Q1)«(B5®¬Q2)ў9630 ЋaN%ЃI­1џK3:K­K4(I):L­K5(I) ¤aX%ЉQ$(K,L)­"C"ў9570 Єa]%‚ Еab%ЉK6(I)®25Ґ50§·(1)ў9000 бal%Q$(B6,B7)­".":B6­0:B7­0 мav%Њ17000 (bЂ%—:—"CAPTAIN, I BELIEVE THE STARBASE HAS BEEN DESTROYED" 2b”%€9680 Mbћ%Љ(R3­1)«(D4(9)¬0)ў9680 SbЁ%— њbІ%—"--> STARFLEET COMMAND REPORTS THAT STARBASE IN QUADRANT";B4;"-";B5 Мbј%—"HAS BEEN DESTROYED BY ENEMY COMMANDER !!" еbIMINAL..." 	g™'—"ON THE BASIS OF YOUR RECORD YOU WILL BE"; g›'ЉR1§3¬I1ў10150 7gњ'—" SUMMARILY EXECUTED" IgЎ'A1­0:Њ23000:Ќ eg¦'—" IMPRISONED FOR LIFE" ™gµ'—"YOUR LIFE SUPPORT RESERVES HAVE RUN OUT, AND" µgє'—"YOU WILL SOON DIE!!!" »gј'— иgї'—"YOUR STARSHIP IS A DERELICT IN SPACE." уgД'€10300 "hО'—"YOUR ENERGY SUPPLY IS EXHAUSTED.":€10172 ShШ'—"THE ";S5$;" HAS BEEN DESTROYED IN BATTLE." ^hЩ'€10300 dhЭ'Ќ —hс'—"YOUR STARSHIP HAS BEEN DESTROYED BY A NOVA." єhц'—"NICE WORK, IDIOT !!!":€10300 тh (—"THE ";S5$;" HA WE'RE ALREADY DOCKED!" мl+Ќ яl+ЉD4(9)­0ў11030 2m+—"SUBSPACE RADIO DAMAGED...CANNOT TRANSMIT.":Ќ Cm+ЉR3®¬0ў11050 qm +—"CAPTAIN, NO RESPONSE FROM STARBASE !":Ќ ‰m*+N1­N1Ґ1:ЉB6­0ў11070 ”m4+€11130 Ўm>+D1­1EҐ30 ПmH+ЃL­1џR3:X­10§¶((B2(L)¦Q1)©2Ґ(B3(L)¦Q2)©2) ЯmR+ЉX¬D1ў11110 мm\+D1­X:K­L уmf+‚L np+Q1­B2(K):Q2­B3(K):Њ18000 "nz+Q$(S6,S7)­"." (n+— ]n„+—"STARBASE IN QUADRANT";Q1;"-";Q2;"RESPONDS --"; ~n‰+—"  ";S5$;" DEMATERIALIZES." nЉ+P2­(1¦.98©D1)©.333333 ЈnЋ+ЃL­1џ3 µn“+ЉL­1ў—"1ST "; Зn+ЉL­2ў—"2ND "; Щnў+ЉL­ў13250 зrЬ2ЉE1®­75ў13070 sж2„"ENTER COURSE....";D2 "sр2ЉD2®.01«D2¬12ўЊ40000:Й13048 (sс2Ќ Hsш2„"DISTANCE ";D1:ЉD1¬0ў13050 Nsщ2Ќ _sъ2P3­50Ґ250§D1 ps3ЉP3®E1ў13140 vs3— Їs3—"1ST OFFICER SPOCK-  'CAPTAIN, THE IMPULSE ENGINES" сs"3—"REQUIRE 50 UNITS OF ENERGY TO ENGAGE, PLUS 250 UNITS PER "; t,3ЉE1¬75ў13120 -t63—"QUADRANT.  THEY ARE USELESS NOW.'":Ќ Xt@3—"QUADRANT.  WE CAN GO A MAXIMUM OF "; ѓtJ3— R(4E¦03§(E1¦50)¦.05);"QUADRANTS.'":Ќ ђtT3T1­D1Ё.4 Ўt^3ЉT1®R5ў13200 еth3—"SIR, MAX. SPEED UNDER IMPULSE IS ONLY 4Р%G(B4,B5)­G(B4,B5)¦10 хbЪ%ЉR3®­1ў9730 cд%ЃI­1џR3:Љ(B2(I)­B4)Є(B3(I)­B5)ў9720 #cо%‚ Acш%B2(I)­B2(R3):B3(I)­B3(R3) Mc&R3­R3¦1 Wc&€9000 ђc'—:—:—:„"CONFLICT RESOLVED - PREPARED FOR RATING ";B$ Ѕc'—Г(26):A2­1:—:—"IT IS STARDATE"; R(D0):— хc'‘F9€10025,10135,10165,10190,10200,10205,10225,10240 d'‘F9¦8€10250,10271,10285 Hd)'—"YOU HAVE DESTROYED THE KLINGON INVASION FLEET":— wd.'—"     ***THE FEDERATION IS SAVED***":G1­1 ‘d3'Љ(A1­0)«(B1®¬0)ў10110 Єd8'ЉД(S5$,1)®¬"E"ў10110 Иd='Љ3§S1Ґ35§N1ҐC4¬­100ў10110 ЬdB'ЉDS BEEN INCINERATED BY A SUPERNOVA." эh(€10300 Fi
(—"YOU HAVE BEEN CAPTURED BY THE ENEMY. IF YOU STILL HAD A STARBASE," ђi(—"YOU WOULD HAVE BEEN REPATRIATED. SINCE YOU HAVE NO BASES, YOU WILL" Іi(—"BE MERCILESSLY TORTURED !!" Ѕi(€10300 мi(—:—"THE ";S5$;" IS NOW AN EXPANDING CLOUD" j (—"OF SUB-ATOMIC PARTICLES...":€10300 Qj-(—"STARBASE WAS UNABLE TO RE-MATERIALIZE YOUR STARSHIP." Wj<(— pjF(ЉД(S5$,1)­"F"ўS5$­"" –jK(ЉД(S5$,1)­"E"ўS5$­"FAERIE QUEENE" џjL(A1­0 ЇjP(ЉR1­0ў10355 УjU(G3­R4ЁI3:B8­(R1Ґ2§R2)Ё(I1Ґ23ў—"3RD "; o¬+—"ATTEMPT TO RE-MATERIALIZE THE ";S5$;". . . . ."; #o¶+Љ·(1)¬P2ў11220 4oА+—"FAILS.":‚L GoК+F9­11:Њ10000:Ќ coФ+ЃL­1џ5:I­B6Ґ°(3§·(1))¦1 {oЮ+Љ(I®1)«(I¬10)ў11260 ђoг+J­B7Ґ°(3§·(1))¦1 Ёoи+Љ(J®1)«(J¬10)ў11260 їoт+ЉQ$(I,J)­"."ў11270 Чoь+‚L:—"FAILS.":€11210 p,—"SUCCEEDS.":S6­I:S7­J:Q$(I,J)­Д(S5$,1) 'p,Њ7000:—"CAPTAIN, WE MADE IT!":Ќ :pб.P4­2:L5­K3:N­1 Fpк.ЃK­1џL5 Ypф.ЉH3(K)­0ў12240 ~pю.D6­.9Ґ.01§·(1):H2­H3(K)§D6©K7(N) ‹p/P3­K6(N) Ёp/P­±(P3):ЉP4§H2®PўP­P4§H2 Аp/K6(N)­P3¦Ї(P3)§±(P) Цp&/X8­K4(N):Y SECTORS PER STARDATE" эtr3„"-- AUTHORIZE ";B$ u†3ЉД(B$,1)®¬"Y"ўЌ !uђ3Њ15001:J3­1 .uљ3ЉA2®¬0ўЌ ;u¤3E1­E1¦P3 Gu®3ЉE1¬0ўЌ Yuё3F9­4:Њ10000:Ќ {uВ3—"IMPULSE ENGINES DAMAGED.":Ќ Љu±6N$­"    #" ђuµ6— ¤uє6ЉD4(2)®¬0ў14180 ОuД6—"L.R. SCAN FOR QUADRANT";Q1;"-";Q2:— оuО6I­Q1¦1:J­Q1Ґ1:K­Q2¦1:L­Q2Ґ1  vШ6ЃM­IџJ:ЃN­KџL vв6Љ(M®­0)«(M¬8)ў14110 0vм6Љ(N®­0)«(N¬8)ў14110 Hvц6ЉD4(11)­0ўS2(M,N)­1 gv 7ЉG(M,N)¬­LQў —"  ***";" "; ђv
7ЉG(M,N)®LQў—Ў5¦ї(А(G(M,N))));G(M,N); ›v7€14120 Ёv7—N$;" "; ±v(7‚N:— ·v27— ѕv<7‚M ОvF7ЉD4(11)­0ўЌ 0¦J2®­6ў10075 уdL'R8­.1§S8§(S8Ґ1)Ґ.1 eQ'Љ(K1ҐK2)Ё(D0¦J2)®R8ў10110 =e['—:—"YOU HAVE DONE SO WELL THAT COMMAND" Me\'ЉS8­4ў10090 ge`'—"PROMOTES YOU....."; …ee'ЉS8­1ў—"TO NOVICE CLASS!" Јef'ЉS8­2ў—"TO SENIOR CLASS!" Бeg'ЉS8­3ў—"TO EXPERT CLASS!" иeh'—"   ***CONGRATULATIONS***":€10110 fj'—"PROMOTES YOU TO 'COMMODORE EMERITUS'." 3ft'—:—"NOW YOU CAN RETIRE !" >f~'Њ23000 Df€'Ќ Џf—'—"TIME HAS RUN OUT - THE FEDERATION HAS BEEN CONQUERED AND YOUR CRAFT" Щf'—"IS NOW ENEMY PROPERTY... YOU WILL STAND TRIAL AS A WAR-CR§I4) аjV(A3­G3ЁB8 щjW(Љ A3®1Ґ.5Ґ·(1)ў10345 7kZ(—"AS A RESULT OF YOUR ACTIONS, A TREATY WITH THE KLINGON" sk[(—"EMPIRE HAS BEEN SIGNED.  THE TERMS OF THE TREATY ARE" €k\(ЉA3®3§·(1)ў10340 ®k_(—"FAVORABLE TO THE FEDERATION.":— Нk`(—"CONGRATULATIONS.":€10350 ld(—"HIGHLY UNFAVORABLE TO THE FEDERATION.":€10350 *li(—"THE FEDERATION WILL BE DESTROYED!" 7ln(Њ23000:Ќ pls(—"SINCE YOU TOOK THE LAST KLINGON WITH YOU, YOU ARE" –lx(—"A MARTYR AND A HERO.":G1­1:A1­0 Јl–(Њ23000:Ќ јlщ*ЉC5$®¬"DOCKED"ў11020 жl+—"--> CAPTAIN,8­K5(N) йp0/ЉH2¬4.99ў12100 q:/—"MINOR HIT ON ":€12110 !qD/— R(H2);"UNIT HIT ON "; 2qN/M$­Q$(X8,Y8) NqX/Љ M$­"K"ў—"KLINGON AT"; kq]/ЉM$­"C"ў—"COMMANDER AT"; zqb/—X8;"-";Y8 Ћql/ЉK6(N)®¬0ў12180 Іqv/A5­X8:A6­Y8:T2$­Q$(X8,Y8):Њ6000 ГqЂ/ЉR1®¬0ў12250 ЪqЉ/F9­1:Њ10000:€12250 нq”/ЉK6(N)®0ў12240  rћ/Љ·(1)®.9ў12240 !rЁ/ЉK6(N)¬(.4Ґ.4§·(1))§P3ў12240 'r­/— QrІ/—"*** CAPTAIN, THE VESSEL AT SECTOR"; `r·/—X8;"-";Y8 Љrј/—"   HAS JUST LOST ITS FIREPOWER !!!" ђrБ/— ЎrЖ/K6(N)­¦K6(N) «rР/N­NҐ1 ІrЪ/‚K ёrд/Ќ БrЙ2J3­0 ХrТ2ЉD4(7)®¬0wP7—"*** WARNING *** - COMPUTER DISABLED - SCAN NOT RECORDED." wZ7Ќ 9wd7—"LONG RANGE SENSORS DAMAGED.":Ќ lw™:A5­(15¦D2)§.523599:D4­¦»(A5):D6­є(A5):B8­±(D4) ѓw¶:Љ±(D6)¬B8ўB8­±(D6) ЈwА:D4­D4ЁB8:D6­D6ЁB8:T5­0:T6­0 єwК:ЉD0ҐT1®F1(2)ў15080 дwФ:T5­1:C5$­"RED":D1­D1§(F1(2)¦D0)ЁT1Ґ.1 ъwЮ:T1­F1(2)¦D0Ґ1E¦05 *xи:Q$(S6,S7)­".":X7­S6:Y7­S7:H9­°(10§D1§B8Ґ.5) :xт:ЉH9­0ў15115 Fxь:ЃL­1џH9 txю:X7­X7ҐD4:X1­°(X7Ґ.5):Y7­Y7ҐD6:Y1­°(Y7Ґ.5) Ћx;Љ(X1®1)«(X1¬10)ў15150 Ёx;Љ(Y1®1)«(Y1¬10)ў15150 Бx;ЉQ$(X1,Y1)­"O"ў15111 Ыx;ЉQ$(X1,Y1ѓ;L6­1:€15180 м|€;ЉL6­0ў15270 ,}њ;—:—"*** MESSAGE FROM STARFLEET COMMAND.....STARDATE"; R(DO) X}ќ;—"PERMISSION TO EXIT GALAXY - DENIED -" w}Ў;—"'ENGINES SHUT DOWN AT "; ›}ў;Z1­°((X1Ґ9)Ё10):Z2­°((Y1Ґ9)Ё10) ј}Ј;—"QUADRANT";Z1;"-";Z2;",  "; м}¤;—"SECTOR";X1¦10§(Z1¦1);"-";Y1¦10§(Z2¦1);"'" щ}¦;ЉT5®¬0ўЌ ~ї;Q1­°((X1Ґ9)Ё10):Q2­°((Y1Ґ9)Ё10) A~А;S6­X1¦10§(Q1¦1):S7­Y1¦10§(Q2¦1) U~Л;Њ18400:—:€15315 ’~О;—Г(26):—"ENTERING THE ";G2$;" QUADRANT  (";Q1;"-";Q2;")" А~У;Q$(S6,S7)­Д(S5$,1):Њ18000:Њ29002:Њ14001:Ќ Ч~Ш;Q$(S6,S7)­5(K)­S:K7(K)­¶((S6¦R)©2Ґ(S7¦S)©2) #ѓ\?K8(K)­K7(K):ЉN¬0ў—"*** COMMANDER ADVANCES TO"; Jѓa?ЉN®0ў—"*** COMMANDER RETREATS TO"; jѓf?—" SECTOR";R;"-";S:Њ28000:Ќ ”ѓp?I­Q1Ґ°((LҐ9)Ё10)¦1:J­Q2Ґ°((MҐ9)Ё10)¦1 «ѓu?Љ(I®1)«(I¬8)ў16350 Вѓz?Љ(J®1)«(J¬8)ў16350 Пѓ„?ЃL3­1џR2 рѓ‰?Љ(C1(L3)­I)Є(C2(L3)­J)ў16350 „Ћ?‚L3:—"*** COMMANDER ESCAPES TO "; I„“?—"QUADRANT";I;"-";J;"  (AND REGAINS STRENGTH)" Ѓ„?K4(K)­K4(K3):K5(K)­K5(K3):K7(K)­K7(K3):K8(K)­K8(K3) џ„ќ?K6(K)­K6(K3):K3­K3¦1:C3­0 №„ў?ЉC5$®¬"DOCKED"ўЊ17000 Д„¬?Њ28000 р„¶?G(Q1,Q6,S7)­Д(S5$,1):Ќ ю€аGG4$­"III":L­2:ЉQ2¬­5ў18420 ‰кGL­1 #‰фGG2$­G1$(2§(Q1¦1)ҐL):L­Q2 3‰щGЉL®­4ў18440 >‰юGL­Q2¦4 V‰HG3$­"IV":ЉL­4ў18460 g‰HG3$­Д(G4$,L) }‰HG2$­G2$Ґ" "ҐG3$:Ќ ђ‰:JЉ·(1)¬.1ў19015 ќ‰BJЊ27000:Ќ Ш‰GJQ$(A5,A6)­".":—"*** STAR AT SECTOR";A5;"-";A6;"NOVAS." ш‰LJG(Q1,Q2)­G(Q1,Q2)¦1:S1­S1Ґ1 ЉQJB9­1:T6­1:T7­1:K­0:X1­0:Y1­0 5ЉVJH4(B9,1)­A5:H4(B9,2)­A6 PЉ[JЃM­B9џT6:ЃQ­1џ3:ЃJ­1џ3 aЉ`JЉJ§Q­4ў19260 ѓЉeJJ5­H4(M,1)ҐQ¦2:J6­H4(M,2)ҐJ¦2 ќЉjJЉ(J5®1)«(J5¬10)ў19260 ·ЉoJЉ(J6®1)«(J6¬10)ў19260 РЉtJЉQ$(J5,J6)­"."ў1926)®¬"."ў15125 вx;‚L y;D1­.1§¶((S6¦X1)©2Ґ(S7¦Y1)©2) y;S6­X1:S7­Y1 #y;F4­S6:F5­S7 =y;ЉQ$(X1,Y1)®¬"O"ў15320 Sy;T2­ A(1):T3­ A(1) }y;Q1­ A(1):Q2­ A(1):S6­ B(1):S7­ B(1):— Ёy;—"*** SPACE PORTAL ENTERED ***":€15307 Юy;T6­1:K­50§D1ЁT1Ґ.001:D1­.1§¶((S6¦X1)©2Ґ(S7¦Y1)©2) 	z;Љ(Q$(X1,Y1)­"K")«(Q$(X1,Y1)­"C")ў15145 $z;—:—S5$;" BLOCKED BY "; Cz;ЉQ$(X1,Y1)­"*"ў—"STAR AT"; fz;ЉQ$(X1,Y1)­"B"ў—"STARBASE AT"; †z;—" SECTOR";X1;"-";Y1;"...." ѕz;—"EMERGENCY STOP REQUIRED"; R(K);"UNITS OF ENERGY." Кz;E1­E1¦K шz!;Д(S5$,1) г~Щ;ЉL6­1ўЌ у~Э;ЉK3­0ў15390 я~в;ЃL­1џK3 #м;F3­¶((F4¦K4(L))©2Ґ(F5¦K5(L))©2) ;ц;K8(L)­.5§(K7(L)ҐF3) H <K7(L)­F3 O
<‚L Z<Њ28000 g<Њ17000:Ќ sЃ>A­1:B­1 Љ>ЃK­1џK3 “”>C­K4(K):D­K5(K) Єћ>ЉQ$(C,D)­"C"ў16050 ±Ё>‚K ИІ>N­0:F­K6(K)Ґ100§K3 дј>ЉF¬LQўN­°(·(1)§K7(K)Ґ1) ЂБ>Љ((C5$­"DOCKED")Є((B4®¬Q1)«(B5®¬Q2)))ўN­¦S8 7ЂЖ>ЉN­0ўN­°(((FҐ200§·(1))Ё150)¦5) BЂЗ>ЉN­0ўЌ [ЂИ>Љ(N¬0)Є(K7(K)®1.5)ўЌ uЂЛ>Љ±(N)¬S8ўN­Ї(N)§±(S8) ЋЂР>T­±(N):P­S6¦C:Q­S7¦D ЈЂХ>Љ2§±(P)®±(Q)ўP­0 ёЂЪ>Љ2§±(Q)®±(P)ўQ­0 ЛЂЯ>ЉP®¬0ўP­Ї(P§N) ЮЂд2)­G(Q1,Q2)¦100:G(I,J)­G(I,J)Ґ100 э„А?ЃL3­1џR2  …К?Љ(C1(L3)­Q1)Є(C2(L3)­Q2)ў16340 (…П?‚L3 @…Ф?C1(L3)­I:C2(L3)­J:Ќ U…Ю?A­¦A:B­¦B:€16200 y…hBC5$­"GREEN":ЉE1®LQўC5$­"YELLOW" ”…|BЉG(Q1,Q2)¬99ўC5$­"RED" љ…†BЌ П…PFJ4­1:B6­0:B7­0:K3­0:C3­0:U­G(Q1,Q2):ЉU¬999ў18290 †nFK3­°(.01§U):ЃA­1џ10:ЃB­1џ10:Q$(A,B)­".":‚B:‚A 0†xFQ$(S6,S7)­Д(S5$,1):U­G(Q1,Q2):ЉU®100ў18150 G†‚FU­U¦100§K3:ЃA­1џK3 k†ЊFS­ B(1):K4(A)­S:T­ B(1):K5(A)­T ѓ†–FЉQ$(S,T)®¬"."ў18060 є† FQ$(S,T)­"K":K7(A)­¶((S6¦S)©2Ґ(S7¦T)©2):K8(A)­K7(A) Ф†ЄFK6(A)­·(1)§150Ґ30 йЉyJЉQ$(J5,J6)­"O"ў19260 ‹~JЉQ$(J5,J6)®¬"*"ў19105 ‹ѓJЉ·(1)¬­.1ў19085 0‹€JX2­J5:Y2­J6:Њ27000:Ќ h‹ЌJT7­T7Ґ1:H4(T7,1)­J5:H4(T7,2)­J6:G(Q1,Q2)­G(Q1,Q2)¦1 ќ‹’JS1­S1Ґ1:—"*** STAR AT SECTOR";J5;"-";J6;"NOVAS." Ё‹њJ€19255 В‹ЎJЉQ$(J5,J6)®¬"B"ў19140 г‹¦JG(Q1,Q2)­G(Q1,Q2)¦10:ЃV­1џR3 Њ«JЉ(B2(V)®¬Q1)«(B3(V)®¬Q2)ў19125 $Њ°JB2(V)­B2(R3):B3(V)­B3(R3) LЊµJ‚V:R3­R3¦1:B6­0:B7­0:B1­B1Ґ1:Њ17000 ЃЊєJ—"*** STARBASE AT SECTOR";J5;"-";J6;"DESTROYED." ЊЊїJ€19255 ©ЊДJЉ(S6®¬J5)«(S7®¬J6)ў19190 ЬЊЙJ—"*** STARSHIP BUFFETED BY NOVA."S6­°(X7¦D4Ґ.5):F4­S6:S7­°(Y7¦D6Ґ.5):F5­S7 {$;ЉE1¬0ў15320 {%;F9­4:Њ10000:Ќ D{);S6­X1:S7­Y1:Њ22001:F4­S6:F5­S7:€15320 T{.;ЉK3­0ў15165 `{3;ЃL­1џK3 „{4;F3­¶((X1¦K4(L))©2Ґ(Y1¦K5(L))©2) џ{6;K8(L)­.5§(F3ҐK7(L)):‚L ·{8;ЉG(Q1,Q2)®¬LQўЊ1000 Д{:;ЉA2®¬0ўЌ и{=;X7­10§(Q1¦1)ҐS6:Y7­10§(Q2¦1)ҐS7 |B;X1­°(X7Ґ10§D1§B8§D4Ґ.5) %|G;Y1­°(Y7Ґ10§D1§B8§D6Ґ.5):L6­0 .|L;L5­0 >|Q;ЉX1¬0ў15195 P|V;X1­¦X1Ґ1:L5­1 `|[;ЉY1¬0ў15210 r|`;Y1­¦Y1Ґ1:L5­1 „|j;ЉX1®­80ў15220 —|o;X1­161¦X1:L5­1 ©|t;ЉY1®­80ў15230 ј|y;Y1­161¦Y1:L5­1 М|~;ЉL5­0ў15240 Ь|>ЉQ®¬0ўQ­Ї(Q§N) цЂй>R­C:S­D:Q$(C,D)­"." Ѓо>ЃL2­1џT:L­RҐP:M­SҐQ 'Ѓу>Љ(L¬0)Є(L®­10)ў16120 EЃх>‘Ї(N)Ґ2€16240,16165,16165 ^Ѓш>Љ(M¬0)Є(M®­10)ў16130 |Ѓэ>‘Ї(N)Ґ2€16240,16135,16135 “Ѓ?ЉQ$(L,M)­"."ў16195 ЄЃ?Љ(Q­B)«(P­0)ў16165 ґЃ?M­SҐB НЃ?Љ(M¬0)Є(M®­10)ў16155 лЃ?‘Ї(N)Ґ2€16240,16160,16160 ‚?ЉQ$(L,M)­"."ў16195 ‚ ?B­¦B "‚%?Љ(P­A)«(Q­0)ў16200 ,‚*?L­RҐA E‚/?Љ(L¬0)Є(L®­10)ў16185 c‚4?‘Ї(N)Ґ2€16240,16190,16190 z‚9?ЉQ$(L,M)­"."ў16195 Љ‚>?A­¦A:€16200 –‚C?R­L:S­M ћ‚H?‚L2 ®‚M?Q$(R,S)­"C" Б‚R?Љ(R­C)Є(S­D)ўЌ р‚W?K4(K)­R:K25:‚A д†ґFЉR2­0ў18140 р†ѕFЃA­1џR2 ‡ГFЉ(C1(A)­Q1)Є(C2(A)­Q2)ў18130 ‡ИF‚A:€18140 G‡ТFQ$(S,T)­"C":K6(K3)­LQҐ400§·(1):C3­1 R‡ЬFЊ28000 b‡жFЉU®10ў18190 m‡рFU­U¦10 ™‡ъFB6­ B(1):B7­ B(1):ЉQ$(B6,B7)®¬"."ў18170 «‡GQ$(B6,B7)­"B" Ѕ‡GЊ17000:ЉU®1ўЌ И‡GЃA­1џU р‡"GS­ B(1):T­ B(1):ЉQ$(S,T)®¬"."ў18210 €,GQ$(S,T)­"*":‚A €6GЉ(T2®¬Q1)«(T3®¬Q2)ўЌ D€@GS­ B(1):T­ B(1):ЉQ$(S,T)®¬"."ў18240 V€JGQ$(S,T)­"O":— љ€TG—"*** SHORT-RANGE SENSORS DETECT A SPACE-WARP IN THIS QUADRANT"  €hGЌ Ж€rGЃA­1џ10:ЃB­1џ10:Q$(A,B)­".":‚B:‚A Я€|GQ$(S:ЉS4®¬0ў19155 рЊОJE1­E1¦LQ:€19170 ЌУJЉS3¬­LQў19180 )ЌШJD6­LQ¦S3:E1­E1¦D6:Њ17000:S3­0:S4­0 jЌЭJ—"*** STARSHIP SHIELDS KNOCKED OUT.":D4(8)­5E¦03§D5§·(1))§D6 zЌвJЉE1¬0ў19185 ЊЌзJF9­7:Њ10000:Ќ ™ЌмJS3­S3¦LQ МЌсJX1­X1ҐS6¦H4(M,1):Y1­Y1ҐS7¦H4(M,2):K­KҐ1:€19260 жЌцJЉQ$(J5,J6)®¬"C"ў19250 тЌыJЃV­1џK3 Ћ KЉ(K4(V)­J5)Є(K5(V)­J6)ў19210 ЋK‚V >Ћ
KK6(V)­K6(V)¦800:ЉK6(V)®­0ў19250 dЋKN5­J5ҐJ5¦H4(M,1):N6­J6ҐJ6¦H4(M,2) ЋK—"*** COMMANDER AT SECTOR";J5;"-";J6;"DAMAGED"; БЋKЉ(N5®1)«(N5¬10)«(N6®1)«(N6¬10)ў19245 кЋK—" AND BUCURACY.":— о’іNE­P1:ЉK3­0ў20310 “¶NE­0:T5­(K3§(K3Ґ1))Ё2 *“АNЃI­1џK3:H3(I)­((K3Ґ1¦I)ЁT5)§P1 J“КNH5(I)­±(K6(I))Ё(P§.9©K7(I)) b“ФNЉH3(I)®­H5(I)ў20200 „“ЮNE­EҐ(H3(I)¦H5(I)):H3(I)­H5(I) ‹“иN‚I љ“тNЉE­0ў20280 µ“ьNЃI­1џK3:R7­H5(I)¦H3(I) Ж“OЉR7®­0ў20260 Ч“OЉR7¬­Eў20270 о“OH3(I)­H5(I):E­E¦R7 ь“$O‚I:€20280 ”.OH3(I)­H3(I)ҐE:E­0 ”8OЊ12001 6”BOЉ(E®¬0)Є(A2­0)ў20310 A”LOJ3­1:Ќ n”VO— R(E);"EXPENDED ON EMPTY SPACE.":J3­1:Ќ †”	RJ3­1:ЉD4(4)­0ў21015 Є”R—"PHOTON TUBES DAMAGED.":€21035 »”RЉT4®¬0ў21025 Ы”R—"NO TORPEDOS L йЁRЉ(A5®1)«(A5¬10)ў21430 ™­RY5­Y5ҐY4:A6­°(Y5Ґ.5) ™ІRЉ(A6®1)«(A6¬10)ў21430 1™·RЉ(L9­5)«(L9­9)ў— N™јR— R(X5);"-"; R(Y5);", "; h™БRЉQ$(A5,A6)®¬"."ў21195 s™ЖR€21425 Ћ™ЛR—:ЉQ$(A5,A6)­"K"ў21220 Ё™РRЉQ$(A5,A6)®¬"C"ў21325 »™ХRЉ·(1)¬.1ў21220  љЪR—"*** COMMANDER AT SECTOR";A5;"-";A6;"USES ANTI-PHOTON DEVICE !" &љЯR—"-- TORPEDO NEUTRALIZED.":€21435 2љдRЃV­1џK3 SљйRЉ(A5­K4(V))Є(A6­K5(V))ў21235 ZљоR‚V vљуRK­K6(V):W3­200Ґ800§·(1) ‹љшRЉ±(K)®W3ўW3­±(K) ІљэRK6(V)­K¦Ї(K)§±(W3):ЉK6(V)®¬0ў21255 СљST2$­Q$(A5,A6):Њ6000:€214— ећ¬ST2­0:T3­0:€21435 нћ±S‚L9 џ¶S—:—"TORPEDO MISSED!" џ»S‚Z6 џАSЉR1®¬0ўЌ -џЕSF9­1:Њ10000:Ќ ZџсU—:—"*** RED ALERT!!   RED ALERT!! ***":— |џъU—"*** COLLISION IMMINENT!!":— ЇџV—"*** ";S5$;" RAMS ";:W7­1:ЉQ$(S6,S7)­"C"ўW7­2 ЙџVЉW7­1ў—"KLINGON AT "; еџVЉW7­2ў—"COMMANDER AT ";  "V—"SECTOR";S6;"-";S7:A5­S6:A6­S7:T2$­Q$(S6,S7) A ,VЊ6000:—"*** ";S5$;" HEAVILY DAMAGED." z 6VK­°(5Ґ·(1)§20):—"***SICKBAY REPORTS";K;"CASUALTIES!" • @VC4­C4ҐK:ЃL­1џ12:I­·(1) І JVJ­(3.5§W7§(·(1)ҐI)Ґ1)§D5 Б TVЉL­6ўJ­JЁ3 з ^VD4(L)­D4(FFETED TO SECTOR";N5;"-";N6 Џ#KQ$(N5,N6)­"C":K4(V)­N5:K5(V)­N6 ;Џ(KK7(V)­¶((S6¦N5)©2Ґ(S7¦N6)©2):K8(V)­K7(V) MЏ)KQ$(J5,J6)­"." ZЏ-K—:€19260 …Џ2KA5­J5:A6­J6:T2$­Q$(J5,J6):Њ6000:€19260 ™Џ7K—:Q$(J5,J6)­"." ¦Џ<K‚J:‚Q:‚M ·ЏAKЉT6­T7ў19280 РЏFKB9­T6Ґ1:T6­T7:€19035 ЫЏPKЉK­0ўЌ зЏZKD1­K§.1 ыЏdKЉX1®¬0ўX1­Ї(X1) ђnKЉY1®¬0ўY1­Ї(Y1) #ђxKI­3§(X1Ґ1)ҐY1Ґ2 0ђ‚KD2­C5(I) ?ђЊKЉD2­0ўD1­0 Kђ–KЉD1­0ўЌ vђ K—:—"FORCE OF NOVA DISPLACES STARSHIP." ѓђЄKЊ15001:Ќ ђђ!NP­2:J3­1 ©ђ4NЉC5$®¬"DOCKED"ў20030 бђ9N—"PHASERS CAN'T BE FIRED THRU BASEFT.":€21035 ф”!R„"TORPEDO COURSE";C6 •&RЉC6®.01«C6¬12ўЊ40000:Й21040 •+RJ3­0:Ќ 8•0R„"BURST OF 3";B$:N­1 O•5RЉД(B$,1)­"N"ў21070 g•:RЉД(B$,1)®¬"Y"ў21040 w•;RЉT4¬2ў21060 ©•?R—"NO BURST.  ONLY";T4;"TORPEDOS LEFT.":€21035 Н•DR„"SPREAD ANGLE (3 - 30 DEG)";G2 Э•ERЉG2®0ў21035 ч•FRЉ(G2®3)«(G2¬30)ў21060 –GRG2­ D(G2) –IRN­3 –NRЃZ6­1џN 4–SRЉC5$®¬"DOCKED"ўT4­T4¦1 E–XRZ7­Z6:R­·(1) Z–]RR­(RҐ·(1))§.5¦.5 v–bRЉ(R¬­¦.4)Є(R®­.4)ў21125 ”–gRR­(·(1)Ґ1.2)§R:ЉN­3ў21105 Г–lR—"*** METEORITE DEFLECTION":R­°(·(1)§50)Ґ1 ш–mR—"TORPE35 чљSЉQ$(A5,A6)­"K"ў—"*** KLINGON AT"; ›SЉQ$(A5,A6)­"C"ў—"*** COMMANDER AT"; /›S—A5;"-";A6; G›SA7­A8Ґ2.5§(·(1)¦.5) q›SW3­±(¦»(A7)):Љ±(є(A7))¬W3ўW3­±(є(A7)) Ћ› SX7­¦»(A7)ЁW3:Y7­є(A7)ЁW3 ®›%SP­°(A5ҐX7Ґ.5):Q­°(A6ҐY7Ґ.5) У›*SЉ(P®1)«(P¬10)«(Q®1)«(Q¬10)ў21320 л›/SЉQ$(P,Q)®¬"."ў21320 њ4SQ$(P,Q)­Q$(A5,A6):Q$(A5,A6)­".":—"DAMAGED--" Kњ9S—"   DISPLACED BY BLAST TO SECTOR";P;"-";Q zњ>SK4(V)­P:K5(V)­Q:K7(V)­¶((S6¦P)©2Ґ(S7¦Q)©2) Љњ?SK8(V)­K7(V) њњCSЊ28000:€21435 ЖњHS—"DAMAGED, BUT NOT DESTROYED.":€21435 ањMSЉQ$(L)ҐT1ҐJ:‚L:D4(6)­D4(6)¦3 ь hVЉD4(6)®0ўD4(6)­0 ЎrVS4­0:ЉR1®¬0ўЌ  Ў|VF9­1:Њ10000:Ќ AЎШYP­D0¦J2:Љ(P®¬0)Є(R1­0)ў23020 NЎвYЉP®5ўP­5 pЎмYN­(K2ҐK1)ЁP:K­°(500§NҐ.5):L­0 „ЎцYЉG1®¬0ўL­100§S8 ЊЎыYI­0 ўЎ ZЉД(S5$,1)­"E"ўM­0 ёЎZЉД(S5$,1)­"F"ўM­1 НЎ
ZЉД(S5$,1)­""ўM­2 ЭЎZЉA1­0ўI­200 ўZJ­10§K1Ґ50§K2ҐKҐL¦I¦100§B1¦100§M¦35§N1¦3§S1¦C4 "ў(Z—:ЉJ®¬0ў23100 Fў2Z—"AS YET, YOU HAVE NO SCORE.":Ќ iў<Z—"YOUR SCORE --":—:ЉK1­0ў23120 ЈўFZ—K1;ћ5);"ORDINARY KLINGON(S) DESTROYED";ћ36);10§K1§MR іўPZЉK2­0ў23140 оўZZ—K2;ћ5);"KLINGON COMMANE SHIELDS.":€20080 фђ>NЉD4(3)­0ў20050 ‘HN—"PHASER BANKS DAMAGED.":€20080 (‘RNЉS4­0ў20060 \‘WN—"SHIELDS MUST BE DOWN TO FIRE PHASERS.":€20080 l‘\NЉK3¬0ў20090 r‘aN— і‘fN—"THE SHORT-RANGE SENSORS DETECT NO ENEMY IN THIS QUADRANT." ѕ‘pNJ3­0:Ќ у‘zN—"PHASERS LOCKED ON TARGET.  ENERGY AVAILABLE="; ’N—.01§°(100§E1) +’„N„"UNITS TO FIRE";P1:ЉP1®E1ў20120 M’ЋN—"ENERGY AVAILABLE =";:€20095 ]’NЉP1¬0ў20140 h’ўNJ3­0:Ќ u’¬NE1­E1¦P1 ‰’®NЉD4(11)­0ў20147  ’°NP1­P1§(·(1)§.5Ґ.5) Щ’±N—:—"COMPUTER MALFUNCTION HAMPERS PHASER ACDO EFFECTIVENESS REDUCED"; R;"%":—:€21110 -—qR—"*** TORPEDO NUMBER";Z6;"MISFIRE - ";R;"% DOWN" A—vRЉ ·(1)¬.2ў21125 m—{R—"*** PHOTON TUBES DAMAGED BY MISFIRE." Њ—ЂRD4(4)­D5§(1Ґ2§·(1)):€21440 ·—…RЉ(S4®¬0)«(C5$­"DOCKED")ўR­RҐ1E¦03§S3§R Т—ЉRA3­C6Ґ.25§R:ЉN­1ў21140 х—ЏRA8­(15¦A3Ґ(2¦Z6)§G2)§.523599:— $‘R—"TRACK FOR TORPEDO NUMBER";Z7;"--":€21145 Q”R—:—"TORPEDO TRACK --":A8­(15¦A3)§.523599 q™RX4­¦»(A8):Y4­є(A8):B8­±(X4) ‹љRЉ±(Y4)¬±(X4)ўB8­±(Y4) ­ћRX4­X4ЁB8:Y4­Y4ЁB8:X5­S6:Y5­S7 ПЈRЃL9­1џ15:X5­X5ҐX4:A5­°(X5Ґ.5)A5,A6)®¬"B"ў21365 ќRS—"*** STARBASE DESTROYED...!!!" !ќWSЉS2(Q1,Q2)®0ўS2(Q1,Q2)­0 -ќ\SЃW­1џR3 PќaSЉ(B2(W)®¬Q1)«(B3(W)®¬Q2)ў21355 nќfSB2(W)­B2(R3):B3(W)­B3(R3) •ќkS‚W:Q$(A5,A6)­".":R3­R3¦1:B6­0:B7­0 ДќpSG(Q1,Q2)­G(Q1,Q2)¦10:B1­B1Ґ1:Њ17000:€21435 ЮќuSЉQ$(A5,A6)®¬"*"ў21405 тќzSЉ·(1)¬.15ў21385 3ћS—"*** STAR AT SECTOR";A5;"-";A6;"UNAFFECTED BY PHOTON BLAST" >ћ„S€21435 aћ‰SX2­A5:Y2­A6:Њ19002:A5­X2:A6­Y2 tћЋSЉG(Q1,Q2)­LQўЌ Ѓћ“SЉA2®¬0ўЌ ЊћS€21435 РћќS—:—"  >>> ORGANIAN TRUCE-MONITOR DESTROYED <<<":Q$(A5,A6)­".":DER(S) DESTROYED";ћ36);50§K2§MR эўdZЉK­0ў23160 .ЈnZ— R(N);ћ5);"KLINGONS PER STARDATE, AVERAGE"; =ЈsZ—ћ36);K§MR MЈxZЉS1­0ў23180 {Ј‚Z—S1;ћ5);"STAR(S) DESTROYED";ћ36);¦3§S1§MR ‹ЈЊZЉB1­0ў23200 ЅЈ–Z—B1;ћ5);"STARBASES DESTROYED";ћ36);¦100§B1§MR НЈ ZЉN1­0ў23220 ¤ЄZ—N1;ћ5);"SOS CALL(S) TO A STARBASE";ћ36);¦35§N1§MR ¤ґZЉC4­0ў23240 B¤ѕZ—C4;ћ5);"CASUALTIES INCURRED";ћ36);¦C4§MR Q¤ИZЉM­0ў23260 †¤ТZ—M;ћ5);"SHIP(S) LOST OR DESTROYED";ћ36)¦100§M§MR —¤ЬZЉA1®¬0ў23280 Й¤жZ—ћ5)"PENALTY FOR GETTING KILLED";ћ36);¦200§MR Щ¤рZЉY)®99)Є(·(1)®.75)ў24250 ьЁД^ЉG(X,Y)¬899ў24250 ©О^ЉI­1ў24300 7©Ш^M­I¦1:ЃJ­1џM:Љ(C1(J)­X)Є(C2(J)­Y)ў24250 >©в^‚J g©м^G(X,Y)­G(X,Y)Ґ100:C1(I)­X:C2(I)­Y:‚I z©с^I­°(D0):—:S0­0 ¤©ц^T2­ A(1):T3­ A(1):ЉG(T2,T3)®100ў24310 µ© _ЉS8®¬1ў24440 ф©
_—"IT IS STARDATE";I;"...THE ORGANIAN PEACE TREATY BETWEEN" 3Є_—"THE UNITED FEDERATION OF PLANETS AND THE KLINGON EMPIRE" rЄ_—"HAS COLLAPSED AND THE FEDERATION IS BEING ATTACKED BY A" ґЄ(_—"DEADLY KLINGON INVASION FLEET.  AS CAPTAIN OF THE STARSHIP" сЄ2_—"U.S.S. ENTERPRISE, ICAN'T GO BELOW WARP 1, CAPTAIN.'":Ќ Ї>b—"-'OUR TOP SPEED IS WARP 10, CAPTAIN.'" %ЇHbЌ >Ї‘eJ3­0:ЉD4(8)®¬0ў26600 OЇљeЉS4®¬0ў26530 ЂЇ„g„"SHIELDS ARE DOWN.  DO YOU WANT THEM UP";B$ —ЇЋgЉД(B$,1)­"Y"ў26560 ќЇgЌ ОЇўg„"SHIELDS ARE UP.  DO YOU WANT THEM DOWN";B$ еЇ¬gЉД(B$,1)­"Y"ў26590 лЇ¶gЌ °АgS4­1:S9­1:ЉC5$®¬"DOCKED"ўE1­E1¦50 5°Кg—"SHIELDS RAISED.":ЉE1®­0ў26610 @°ФgJ3­1:Ќ i°ЮgS4­0:S9­1:—"SHIELDS LOWERED.":J3­1:Ќ Ќ°иg—"SHIELDS DAMAGED AND DOWN. ":Ќ І°тg—:—"SHIELDS CONSUME ALL ENERGY." Д°ьgF9­4:Њ10000:Ќ Х°xiЉX2®¬0°(G(X,Y)Ё100)§100 µВjS1­S1Ґ(N¦°(NЁ10)§10):B1­B1Ґ°(NЁ10) µМjK1­K1ҐR:K2­K2ҐQ JµЦjЉ(S2(X,Y)®¬0)Є(D4(9)®¬0)ўS2(X,Y)­LQҐG(X,Y) sµаjЉ(D4(9)­0)«((Q1­X)Є(Q2­Y))ўS2(X,Y)­1 ѓµкjG(X,Y)­1000 ¦µфjЉ(R1®¬0)«((X­Q1)Є(Y­Q2))ў27430 кµюj—Г(26):—"*** SUPERNOVA IN QUADRANT";X;"-";Y;"HAS DESTROYED THE" ¶k—"REMAINDER OF THE ENEMY FLEET !!" #¶kF9­1:Њ10010:Ќ /¶&kЉA2­0ўЌ A¶0kF9­8:Њ10010:Ќ N¶`mЉK3®­1ўЌ w¶jmZ4­0:ЃO­1џK3¦1:ЉK7(O)®­K7(OҐ1)ў28080 ›¶tmK­K7(O):K7(O)­K7(OҐ1):K7(OҐ1)­K ї¶~mK­K8(O):K8(O)­K8(OҐ1):K8(OҐ1)­K г¶€mK­K4(O):K4(G1­0ў23300 ҐъZ—ћ5);"BONUS FOR WINNING ";S$(S8);" GAME";ћ36);L§MR AҐ[—ћ5);"-------------------------------------" dҐ[—ћ28);"TOTAL";ћ36);J§MR;"**":Ќ ‰ҐБ]A2­0:G1­0:Њ4001:S5$­"ENTERPRISE" їҐК]I7­5000:E1­I7:I8­2500:S3­I8:S4­0:S9­S4:J1­4:L1­J1 уҐФ]Q1­ A(1):Q2­ A(1):S6­ B(1):S7­ B(1):I9­10:T4­I9 ¦Ю]W1­5:W2­25:ЃI­1џ12:D4(I)­0:‚ Q¦и]J2­100§°(31§·(1)Ґ20):D0­J2:K1­0:K2­0:N1­0:N2­0:R6­0:C4­0 ¦т]A1­1:D3­.25:ЃI­1џ8:ЃJ­1џ8:S2(I,J)­0:‚J:‚I ¦¦ь]F1(1)­D0¦.5§I5§ё(·(1)):F1(5)­1EҐ30 М¦^F1(2)­D0¦1.5§(I5ЁR2)§ё(·(1)):I6­0 ю¦T IS YOUR MISSION TO SEEK OUT AND" -«<_—"DESTROY THIS INVASION FORCE OF";I1;"BATTLE CRUISERS." ^«F_—:—"YOU HAVE AN INITIAL ALLOTMENT OF";°(I5); Њ«P_—"STARDATES":—"TO COMPLETE YOUR MISSION." И«Z_—"AS THE MISSION PROCEEDS, YOU MAY BE GIVEN MORE TIME." ю«d_—:—"YOU WILL HAVE";I2;"SUPPORTING STARBASE(S).":— 	¬n_€24515 )¬x_—"STARDATE..............";I J¬‚_—"NUMBER OF KLINGONS....";I1 n¬Њ_—"NUMBER OF STARDATES...";°(I5) Џ¬–_—"NUMBER OF STARBASES...";I2 ®¬ _—"STARBASE LOCATIONS...."; М¬Є_ЃI­1џI2:—B2(I);"-";B3(I); Ю¬ў27100 ц°‚iN­°(·(1)§I6Ґ1):ЃX­1џ8:ЃY­1џ8 #±ЊiN­N¦(G(X,Y)¦°(G(X,Y)Ё10)§10):ЉN®­0ў27040 /±–i‚Y:‚X:Ќ J± iЉ(X®¬Q1)«(Y®¬Q2)ў27150 [±ЄiЉJ4®¬0ў27150 „±ґiN­°(·(1)§(G(X,Y)¦°(G(X,Y)Ё10)§10))Ґ1 °±ѕiЃX3­1џ10:ЃY3­1џ10:ЉQ$(X3,Y3)®¬"*"ў27090 Е±ИiN­N¦1:ЉN­0ў27100 С±Тi‚Y3:‚X3 ъ±Ьi—:—"*** RED ALERT!!  RED ALERT!! *** 
ІбiX3­X2:Y3­Y2 FІжi—"*** INCIPIENT SUPERNOVA DETECTED AT SECTOR";X3;"-";Y3 jІрiX­Q1:Y­Q2:K­(X2¦S6)©2Ґ(Y2¦S7)©2 {ІъiЉK¬1.5ў27180 µІj—"*** EMERGENCY AUTO-OVERRIDE JAMMED ***":A2­1:€27180 ЙІjЉD4(9)®¬0ў27180 іj—O)­K4(OҐ1):K4(OҐ1)­K ·’mK­K5(O):K5(O)­K5(OҐ1):K5(OҐ1)­K +·њmK­K6(O):K6(O)­K6(OҐ1):K6(OҐ1)­K 4·¦mZ4­1 ;·°m‚O L·єmЉZ4®¬0ў28010 R·ДmЌ e·JqЉD(1)®¬0ў29230 ‡·Rq—:—"    1 2 3 4 5 6 7 8 9 10" џ·\qЃI­1џ10:ЉI®10ў—" "; А·fq—I;:ЃJ­1џ10:—Q$(I,J);" ";:‚J е·pq‘I€29050,29060,29080,29090,29140 ёuq‘I¦5€29150,29160,29170,29200,29210 1ёzq—" STARDATE      "; R(D0):€29220 Kё„qЉC5$®¬"DOCKED"ўЊ17000 nёЋq—" CONDITION      ";C5$:€29220 Ґёq—" POSITION      ";Q1;"-";Q2;", ";S6;"-";S7:€29220 Оёўq—" LIFE SUPPORT   ";:ЉD4(5)®¬0ў29110 ^F1(3)­D0¦.3§I5§ё(·(1)):F1(4)­D0¦.3§I5§ё(·(1)) &§^ЃI­1џ8:ЃJ­1џ8:K­°(·(1)§9Ґ1):I6­I6ҐK >§$^G(I,J)­K:‚J:‚I:S1­0 K§.^Ѓ I­1џI2 k§8^X­°(·(1)§6Ґ2):Y­°(·(1)§6Ґ2) Ѓ§B^ЉG(X,Y)¬­10ў24120 ђ§L^ЉI®2ў24180 ї§V^K­I¦1:ЃJ­1џK:D1­¶((B2(J)¦X)©2Ґ(B3(J)¦Y)©2) П§`^ЉD1®2ў24120 Ц§j^‚J 	Ёt^B2(I)­X:B3(I)­Y:S2(X,Y)­¦1:G(X,Y)­G(X,Y)Ґ10:‚I /Ё~^B1­0:K­I1¦I4:L­°(.25§S8§(9¦L2)Ґ1) NЁ€^M­°((1¦·(1)©2)§L):ЉM¬KўM­K ZЁ’^N­100§M ‚Ёњ^X­ A(1):Y­ A(1):ЉG(X,Y)ҐN¬999ў24220 ЁЁ¦^G(X,Y)­G(X,Y)ҐN:K­K¦M:ЉK®¬0ў24200 ґЁ°^ЃI­1џI4 жЁє^X­ A(1):Y­ A(1):Љ(G(X,ґ_ЉI®¬I2ў—", "; й¬ѕ_‚I:—:— ф¬Г_Њ18400 -­И_—"THE ";S5$;" IS CURRENTLY IN THE ";G2$;" QUADRANT." 8­Т_Њ18000 n­У_—:„"READY TO CONTINUE";NL$:—Г(26):Њ29002:Њ14001:Ќ ѓ­Іa„"WARP FACTOR";K ‰­јa— ­БaЉK®1ў25140 Ё­ВaЉK¬10ў25150 ї­ЖaJ­W1:W1­K:W2­W1§W1 Ъ­РaЉ(W1®­J)«(W1®­6)ў25070 л­ЪaЉW1®­8ў25080 ы­дaЉW1¬8ў25100 ®оa—"'WARP FACTOR";W1;"CAPTAIN'":Ќ O®шa—"*** OUR MAXIMUM SAFE SPEED IS WARP 6":Ќ"; `®bЉW1­10ў25130 ”®b—"*** CAPTAIN, OUR ENGINES MAY NOT TAKE IT !":Ќ Г®*b—"-'AYE, CAPTAIN, WE'LL GIVE IT A TRY.'":Ќ т®4b—"-'WE :—"MESSAGE FROM STARFLEET COMMAND...STARDATE";°(D0) )і"j—"'SUPERNOVA IN QUADRANT";X;"-";Y; Eі'j—"....CAUTION ADVISED'" aі,jN­G(X,Y):R­°(NЁ100):Q­0 |і6jЉ(X®¬Q1)«(Y®¬Q2)ў27210 Љі@jK3­0:C3­0 ™іJjЉR­0ў27270 ±іTjR1­R1¦R:ЉR2­0ў27270 Ъі^jЃL­1џR2:Љ(C1(L)®¬X)«(C2(L)®¬Y)ў27260 
ґhjC1(L)­C1(R2):C2(L)­C2(R2):C1(R2)­0:C2(R2)­0 2ґrjR2­R2¦1:R­R¦1:Q­1:ЉR2­0ўF1(2)­1EҐ30 9ґ|j‚L Iґ†jЉR3­0ў27310 rґђjЃL­1џR3:Љ(B2(L)®¬X)«(B3(L)®¬Y)ў27300 ЄґљjB2(L)­B2(R3):B3(L)­B3(R3):B2(R3)­0:B3(R3)­0:R3­R3¦1 ±ґ¤j‚L Бґ®jЉX2­0ў27350 аґёjN­G(X,Y)¦гё¬q—"ACTIVE":€29220 ьё¶qЉC5$®¬"DOCKED"ў29130 )№Аq—"DAMAGED, SUPPORTED BY STARBASE":€29220 Q№Кq—"DAMAGED, RESERVES="; S(L1):€29220 v№Фq—" WARP FACTOR   "; R(W1):€29220 ћ№Юq—" ENERGY";Ў8);.01§°(100§E1):€29220 ї№иq—" TORPEDOS      ";T4:€29220 у№тq—" SHIELDS        ";:B$­"DOWN,":ЉS4®¬0ўB$­"UP," єьqЉD4(8)¬0ўB$­"DAMAGED," 1єr—B$;°(100§S3ЁI8Ґ.5);"%":€29220 Rєr—" KLINGONS LEFT ";R1:€29220 pєr—" TIME LEFT     "; S(R5) yє$r‚I:Ќ џє.r—"SHORT RANGE SENSORS DAMAGED.":Ќ Щє1u—:—"*** TIME WARP ENTERED ***":—"YOU ARE TRP5¬·(1)ўЊ1000 йѕ|yЉA2®¬0ўЌ хѕ†yЊ9000:Ќ їђy—"TRANSFER PANEL DAMAGED.":Ќ /ї}„"WHICH DIRECTION";Z Mї}ЉZ®.01«Z¬12ўЊ40000:Й32020 Xї}J3­0:Ќ ї}T1­.05:P­(K3Ґ4§C3)Ё48:ЉP®.05ўP­.05 ‘ї}ЉP¬·(1)ўЊ1000 ћї(}ЉA2®¬0ўЌ ¶ї2}Њ9000:J3­1:ЉA2®¬0ўЌ ШїP}D5­°((ZЁ12)§8Ґ1.5):ЉD5¬8ўD5­1  АU}ЃI­1џ5:ЃJ­1џ5:V$(I,J)­" ":‚J:‚I:N­0 АW}V$(3,3)­Д(S5$,1) MАZ}‘D5€32100,32130,32150,32170,32190,32220,32260,32300 ‡Аd}I­S6¦2:J­S7¦2:V$(1,1)­Q$:Љ(J¬0)Є(I¬0)ўV$(1,1)­Q$(I,J) БАn}I­S6¦1:J­S7¦1:V$(2,2)­Q$:Љ(I¬0)Є(J¬0)ўV$(2,2)­Q$(I,J) ЦАx}N­NҐ1:ЉN­­S7¦1:V$(4,2)­Q$:Љ(I®11)Є(J¬0)ўV$(4,2)­Q$(I,J) Е~N­NҐ1:ЉN­3ў32350 FЕ"~J­S7¦2:V$(4,1)­Q$:Љ(I®11)Є(J¬0)ўV$(4,1)­Q$(I,J) rЕ,~J­S7¦2:V$(3,1)­Q$:ЉJ¬0ўV$(3,1)­Q$(S6,J) ћЕ6~J­S7¦1:V$(3,2)­Q$:ЉJ¬0ўV$(3,2)­Q$(S6,J) іЕ@~N­NҐ1:ЉN­3ў32350 нЕJ~I­S6¦1:J­S7¦2:V$(2,1)­Q$:Љ(I¬0)Є(J¬0)ўV$(2,1)­Q$(I,J) шЕT~€32100 Ж^~ЃI­1џ5 8Жh~Љ(V$(I,1)­" ")Є(V$(I,3)­" ")Є(V$(I,5)­" ")ў32390 CЖr~—"  "; aЖ|~ЃJ­1џ5:—V$(I,J);" ";:‚J:— jЖ†~‚I:Ќ ўЖйЂJ3­0:„"HOW MANY STARDATES";Z5:Љ(Z5®R5)Є(K3­0)ў33030 ЙЖьЂ„"ARE YOU SURE";B$:ЉД(B$,1)®¬"Y"ўЌ ТЖЃR(1)ўQ4­1 нКШ†ЉQ4®¬0ўD1­·(1)§D1 Лв†W­0:ЉW1®10ў34550 Лм†Љ.25§D1¬·(1)ўW­1 /Лц†Љ(Q4­0)Є(W­0)ў34660 TЛ ‡A­(15¦D2)§.5236:X1­¦»(A):X2­є(A) wЛ
‡B8­±(X1):Љ±(X2)¬±(X1)ўB8­±(X2) ЁЛ‡X1­X1ЁB8:Y1­Y1ЁB8:N­°(10§D1§B8Ґ.5):X­S6:Y­S7 ·Л‡ЉN­0ў34660 ВЛ(‡ЃL­1џN лЛ2‡X­XҐX1:Q­°(XҐ.5):Љ(Q®1)«(Q¬10)ў34660 М<‡Y­YҐY1:R­°(YҐ.5):Љ(R®1)«(R¬10)ў34660 +МF‡ЉQ$(Q,R)­"."ў34650 8МP‡Q4­0:W­0 ?МZ‡‚L SМd‡Њ15001:ЉA2®¬0ўЌ |Мn‡E1­E1¦D1§W1§W1§W1§(S4Ґ1):ЉE1¬0ў34690 ЋМx‡F9­4:Њ10000:Ќ «М‚‡T1­10§D1ЁW2:ЉW®¬0ўЊ30001 »МЊ‡ЉQ4­0ў34740 сМ–‡—:—"ENGINEERINGAVELING "; кє:uЉS0®¬0ў30050  »DuT1­¦.5§I5§ё(·(1)) +»Nu—"FORWARD IN TIME"; R(T1);"STARDATES." E»XuF1(2)­F1(2)ҐT1:€30200 W»buM­D0:D0­D9(1) Љ»lu—"BACKWARD IN TIME"; R(M¦D0);"STARDATES.":S0­0 »»vuR1­D9(2):R2­D9(3):R3­D9(4):R4­D9(5):R5­D9(6) д»ЂuS1­D9(7):B1­D9(8):K1­D9(9):K2­D9(10) јЉuЃI­1џ8:ЃJ­1џ8:G(I,J)­D9(I¦1Ґ8§(J¦1)Ґ11):‚J:‚I 4ј”uЃI­75џ84:C1(I¦74)­D9(I):‚ RјћuЃI­85џ94:C2(I¦84)­D9(I):‚ pјЁuЃI­95џ99:B2(I¦94)­D9(I):‚ ¦јІuЃI­100џ104:B3(I¦99)­D9(I):‚:B4­D9(105):B5­D9(106) БјјuF1(1)­D0¦.5§I5§ё(·(1)) ејЖuЉR2®¬0ўF13ў32350 	Б}}I­S6¦2:V$(1,2)­Q$:Љ(I¬0)Є(J¬0)ўV$(1,2)­Q$(I,J) 5Б‚}I­S6¦2:V$(1,3)­Q$:ЉI¬0ўV$(1,3)­Q$(I,S7) aБ‡}I­S6¦1:V$(2,3)­Q$:ЉI¬0ўV$(2,3)­Q$(I,S7) vБЊ}N­NҐ1:ЉN­3ў32350 ±Б‘}I­S6¦2:J­S7Ґ1:V$(1,4)­Q$:Љ(I¬0)Є(J®11)ўV$(1,4)­Q$(I,J) мБ–}I­S6¦2:J­S7Ґ2:V$(1,5)­Q$:Љ(I¬0)Є(J®11)ўV$(1,5)­Q$(I,J) 'В›}I­S6¦1:J­S7Ґ1:V$(2,4)­Q$:Љ(I¬0)Є(J®11)ўV$(2,4)­Q$(I,J) <В }N­NҐ1:ЉN­3ў32350 pВҐ}J­S7Ґ2:V$(2,5)­Q$:Љ(I¬0)Є(J®11)ўV$(2,5)­Q$(I,J) ќВЄ}J­S7Ґ2:V$(3,5)­Q$:ЉJ®11ўV$(3,5)­Q$(S6,J) КВЇ}J­S7Ґ1:V$(3,4)­Q$:ЉJ®11ўV$(3,4)­Q$(S6,J) ЯВґ}6­1 вЖЃЉZ5®­0ўR6­0 оЖЃЉR6­0ўЌ юЖ$ЃT1­Z5:Z6­Z5 З.ЃЉK3­0ў33100 )З8ЃT1­1Ґ·(1):ЉZ5®T1ўT1­Z5 3ЗBЃZ6­T1 DЗLЃЉT1®Z5ўЊ1000 QЗVЃЉA2®¬0ўЌ iЗ`ЃЊ9000:J3­1:ЉA2®¬0ўЌ }ЗjЃZ5­Z5¦Z6:€33040 –ЗС„J3­0:ЉD4(6)®¬0ў34750 МЗЪ„„"ENTER COURSE...";D2:ЉD2®.01«D2¬12ўЊ40000:Й34013 ТЗЬ„Ќ сЗЭ„„"DISTANCE...";D1:ЉD1®­0ўЌ Ио„P­(D1Ґ.05)§W1§W1§W1§(S4Ґ1):ЉP®E1ў34150 BИш„J3­0:—:—"ENGINEERING TO BRIDGE--" ^И…Љ(S4­0)«(.5§P¬E1)ў34080 ’И…—"  WE HAVEN'T THE ENERGY TO GO THAT FAR WITH"; ¬И…—" THE SHIELDS UP.":Ќ ЧИ …W­°((E1Ё(D1Ґ.05))©.333333):ЉW® TO BRIDGE--":—"   SCOTT HERE-  "; Н›‡—"'WE'VE JUST BLOWN THE WARP ENGINES." RН ‡—"   WE'LL HAVE TO SHUT 'ER DOWN HERE, CAPTAIN.'" jНҐ‡D4(6)­D5§(3§·(1)Ґ1) uНґ‡J3­1:Ќ ”Нѕ‡—"WARP ENGINES DAMAGED.":Ќ ·Н№€‘Ї(D4(10))Ґ2€35010,35030,35020 зНВ€—"YE FAERIE QUEENE HAS NO SHUTTLE CRAFT.":Ќ ОМ€—"SHUTTLE CRAFT DAMAGED.":Ќ 0ОЦ€—:—"***ABANDON SHIP!  ABANDON SHIP!" TОа€—"***ALL HANDS ABANDON SHIP!":— ЉОк€—"YOU AND THE BRIDGE CREW ESCAPE IN THE GALILEO." ¶Оф€—"THE REMAINDER OF THE CREW BEAMS DOWN" лОю€—"TO THE NEAREST HAB(2)­D0¦(I5ЁR2)§ё(·(1))  ЅРuF1(3)­D0¦.5§I5§ё(·(1)) 'ЅЪuЃI­1џ8:ЃJ­1џ8:Љ1®S2(I,J)ўS2(I,J)­1 1Ѕдu‚J:‚I 7Ѕйu— xЅоu—"SPOCK HAS RECONSTRUCTED A CORRECT STAR CHART FROM MEMORY." …ЅшuЊ18000:Ќ џЅyJ3­0:ЉD4(12)®¬0ў31120 ДЅ,y„"NUMBER OF UNITS TO SHIELDS";Z3 РЅ6yЉZ3®0ўЌ жЅ@yЉE1ҐS3¦Z3¬0ў31060 !ѕJy—"SCOTT HERE-  'WE ONLY HAVE"; R(E1ҐS3);"UNITS LEFT.'" 'ѕKyЌ ]ѕTyE1­E1ҐS3¦Z3:S3­Z3:—"--ENERGY TRANSFER COMPLETE--" ™ѕ^y—"(SHIP ENERGY="; R(E1);"    SHIELD ENERGY="; R(S3);")" ўѕcyJ3­1 ЙѕhyT1­.1:P5­(K3Ґ4§C3)Ё48:ЉP5®.1ўP5­.1 ЬѕryЉN­NҐ1:ЉN­3ў32350 Г№}I­S6Ґ1:J­S7Ґ2:V$(4,5)­Q$:Љ(I®11)Є(J®11)ўV$(4,5)­Q$(I,J) WГѕ}I­S6Ґ2:J­S7Ґ2:V$(5,5)­Q$:Љ(I®11)Є(J®11)ўV$(5,5)­Q$(I,J) “ГГ}I­S6Ґ1:J­S7Ґ1:V$(4,4)­Q$:Љ(I®11)Є(J®11)ўV$(4,4)­Q$(I,J) ЁГИ}N­NҐ1:ЉN­3ў32350 ЭГТ}I­S6Ґ2:V$(5,4)­Q$:Љ(I®11)Є(J®11)ўV$(5,4)­Q$(I,J) 
ДЬ}I­S6Ґ2:V$(5,3)­Q$:ЉI®11ўV$(5,3)­Q$(I,S7) 7Дж}I­S6Ґ1:V$(4,3)­Q$:ЉI®11ўV$(4,3)­Q$(I,S7) LДр}N­NҐ1:ЉN­3ў32350 ‡Дъ}I­S6Ґ2:J­S7¦1:V$(5,2)­Q$:Љ(I®11)Є(J¬0)ўV$(5,2)­Q$(I,J) ВД~I­S6Ґ2:J­S7¦2:V$(5,1)­Q$:Љ(I®11)Є(J¬0)ўV$(5,1)­Q$(I,J) эД~I­S6Ґ1:J­0ў34130 Й*…—"  WE HAVEN'T THE ENERGY.  BUT WE COULD DO IT AT WARP";W &Й4…ЉS4®¬0ў34120 ,Й>…Ќ TЙH…—"  IF YOU'LL LOWER THE SHIELDS.":Ќ ’ЙR…—"  WE CAN'T DO IT, CAPTAIN.  WE HAVEN'T GOT THE ENERGY." Й\…Ќ ёЙf…T1­10§D1ЁW2:ЉT1®.8§R5ў34500 тЙp…—:—"MR. SPOCK - 'CAPTAIN, I COMPUTE THAT SUCH A TRIP" $Кz…—" WILL REQUIRE APPROXIMATELY"; R(100§T1ЁR5); `К„…—"PERCENT":—"   OF OUR REMAINING TIME.  ARE YOU SURE "; ‹КЋ…„ "THIS IS WISE";B$:ЉД(B$,1)­"Y"ў34500 –К…J3­0:Ќ °КД†Q4­0:W­0:ЉW1®­6ў34660 ЧКО†P­D1§(6¦W1)©2Ё66.6667:ЉP¬·ITABLE PLANET.":ЉR3®¬0ў35090 эО‰F9­9:Њ10000:Ќ 3П‰—:—"YOU ARE CAPTURED BY KLINGONS AND RELEASED TO" hП‰—"THE FEDERATION IN A PRISONER-OF-WAR EXCHANGE." ћП&‰—"STARFLEET PUTS YOU IN COMMAND OF ANOTHER SHIP," РП0‰—"THE FAERIE QUEENE WHICH IS ANTIQUATED, BUT" Р:‰—"STILL USABLE.":N­°(·(1)§R3Ґ1):Q1­B2(N):Q2­B3(N) )РD‰S6­5:S7­5:Њ18000:Q$(S6,S7)­"." FРI‰ЃL­1џ3:S6­°(3§·(1)¦1ҐB6) `РN‰Љ(S6®1)«(S7¬10)ў35180 ЊРX‰S7­°(3§·(1)¦1ҐB7):Љ(S7®1)«(S7¬10)ў35180 ҐРb‰ЉQ$(S6,S7)­"."ў35190 іРl‰‚L:€35140 лРv‰S5$­"FAERIE QUEENE":Q$(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                H 8K BASIC. UNFORTUNATELY LARGER INTERPRETERS
				LEAVE INSUFFICIENT MEMORY FOR PROGRAM. CONTAINS
				THE AUTHOR CREDITS.
22.4	21K	STRTRK/2.ASC	A SECOND APPEARENCE OF PROGRAM 21.21 WHICH ZOSO
				INCLUDED FOR IMPROVEMENT HINTS FOR SERIOUS
				TREKKIES WHO DON'T HAVE VOLUME 21
22.5	5K	TREKINFO.DOC	DETAILED RULES AND FEATURES OF STARTREK.TXT AND
				BIGTREK
22.6	42K	TREKMOD.ASC	BIGTREK TRIMMED SOME MORE AND ABLE TO LOAD WITH
				MICROSOFT DISK BASIC
VOLUME 24

CP/M UTILITIES, MACRO LIBRARIES AND RATFOR

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.24	CONTENTS OF CP/M VOL 24
		VOLUME24.DOC	COMMENTS ON CERTAIN PROGRAMS IN VOLUME
24.1	19K	DUMP.ASM	REVISION OF 14.7 TO INCORPORATE MANY
				ENHANCEMENTS, AND ASSEMBLE WITH DIGITAL
				RESEARCH MACRO ASSEMBLER, USING 24.4
24.2	3K	DUMP.COM	ASSEMBLY OF 24.1
24.3	3K	MAC40.LIB	LIBRARY OF MACROS TO CROSS-ASSEMBLE 4004/4040
				CODE USING DIGITAL RESEARCH MACRO ASSEMBLER
24.4	17K	MACRO.LIB	EXTENSIVE MACRO LIBS6,S7)­Д(S5$,1):C5$­"DOCKED" СЂ‰ЃL­1џ12:D4(L)­0:‚:D4(10)­¦1:E1­3000:I7­E1 QСЉ‰S3­1500:I8­S3:T4­6:I9­T4:L1­3:J1­L1:S4­0:W1­5:W2­25 WС”‰Ќ kСЎЊЉD4(11)­0ў36030 ¦СЄЊ—"COMPUTER DAMAGED - CANNOT EXECUTE DESTRUCT SEQUENCE" ¬СґЊЌ ЗСѕЊ—:—"    ---WORKING---" жСИЊ—"IDENTIFICATION-POSITIVE" ТТЊ—"SELF-DESTRUCT-SEQUENCE-ACTIVATED":J­3 7ТЬЊЃI­10џ6¤¦1:—ЎJ);I:Њ36210:J­JҐ3:‚ fТжЊ—"ENTER-YOUR-MISSION-PASSWORD-TO-CONTINUE" —ТрЊ—"SELF-DESTRUCT-SEQUENCE-OTHERWISE-DESTRUCT" ·ТъЊ—"SEQUENCE-WILL-BE-ABORTED" НТЌ„B$:ЉB$®¬X$ў36190 л                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                RARY FOR USE WITH
				DIGITAL RESEARCH MACRO ASSEMBLER
24.5	3K	OPCODE.LIB	EXTENDED REGISTER OPERATION MACRO LIBRARY
				FOR DIGITAL RESEARCH MACRO ASSEMBLER
24.6	32K	RATFOR.COM	PRE-PROCESSOR TO TRANSLATE FROM THE STRUCTURED
				LANGUAGE RATFOR, DESCRIBED IN SOFTWARE TOOLS,
				TO STANDARD FORTRAN.  TYPE "RATFOR FILENAME", TO
				CREATE FILENAME.FOR FROM FILENAME.RAT
24.7	5K	TAPELIB.COM	OBJECT OF 24.9
24.8	12K	TAPELIB.DOC	DESCRIPTION OF 24.9
24.9	37K	TAPELIB.MAC	PIP-LIKE PROGRAM TO TRANSFER FILES FТЌ—"PASSWORD-ACCEPTED":J­10 УЌЃI­5џ1¤¦1:—ЎJ);I:Њ36210:J­JҐ3:‚ ?У"Ќ—:—"*****ENTROPY OF ";S5$;" MAXIMIZED*****" QУ,Ќ—:ЉK3­0ў36180 zУ6ЌW­20§E1:ЃL­1џK3:ЉK6(L)§K7(L)¬Wў36170 ¤У@ЌA5­K4(L):A6­K5(L):T2$­Q$(A5,A6):Њ6000 «УJЌ‚L ѕУTЌF9­10:Њ10000:Ќ ЧУ^Ќ—"PASSWORD-REJECTED" цУhЌ—"CONTINUITY-EFFECTED":—:Ќ ФrЌK­12345:ЃM­1џ90:K­KҐ1:‚M:Ќ *Ф‰ђЃI­1џ10:€29040:Ќ RФ@њ—"---> COURSE(S) .01-12 ONLY !!!":Ќ                                                                                                                            VOLUME 22

MONSTEROUS STARTREK GAMES

WELL DOCUMENTED GAMES FOR MEMBERS WITH LOTS OF
MEMORY AND LOTS OF TIME

NUMBER	SIZE	NAME		COMMENTS

		CATALOG.22	CONTENTS OF CP/M GROUP VOL 22
		ZOSO.22		DESCRIPTION AND APPLICATION NOTES
				ON THE PROGRAMS BY ZOSO AND EDISON DOGGE
22.1	48K	BIGTREK.ASC	22.3 TRIMMED TO LOAD UNDER TDL DISK BASIC
				WITH 64K MEMORY
22.2	39K	BIGTREK.BAS	COMPACTED VERSION OF 22.1 FOR MUCH FASTER LOAD
22.3	54K	STARTREK.TXT	STARTING POINT OF BIGTREK. PURPORTED TO WORK
				WIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ROM
				CP/M DISK TO TARBELL TAPE. PERMITS VIEWING
				ON CONSOLE (IF YOUR HARDWARE IS FAST ENOUGH)
				WRITTEN IN TDL MACRO ASSEMBLER
24.10	11K	XDIR.ASM	DIRECTORY PROGRAM GIVING NEAT 3-WIDE
				DISPLAY, SORTED AND WITH FILES SIZED IN K'S
				AND REPORTING CORRECT NUMBER OF FILES AND
				REMAINING DISK SPACE. USES DIGITAL RESEARCH
				MACRO ASSEMBLER AND MACRO LIBRARY 24.4
24.11	2K	XDIR.COM	OBJECT OF 24.10
NPUT. 
;OPERATION IN THIS MODE IS SIMILAR TO OTHER UTILITIES LIKE PIP OR DDT.
;	THE OPERATION DESIRED MAY THEN BE TYPED IN AS FOLLOWS:
;
;		DUMP FILE.NAM
;		DUMP A:FILE.NAM
;		DUMP B:FILE.NAM
;
;	OR DUMP MAY BE TYPED SEPARATELY AS:
;
;		DUMP
;
;		*FILE.NAM
;		*B:FILE.NAM	(THE * IS A PROGRAM PROMPT)
;
;	THE PROGRAM MAY ALSO BE USED TO DUMP DISK SECTORS DIRECTLY,
;DUMP ANY CP/M EIGHT SECTOR GROUP, A MAP OF THE GROUP ALLOCATIONS FOR THE
;ENTIRE DISK OR THE DIRECTORY SORTED ALPHABETICALLY.
;
 BACK THE ADDR ENTERED AND THE PRESENT CONTENTS OF THAT
;ADDRESS. TO CHANGE THE CONTENTS OF THE ADDRESS ENTER THE NEW BYTE FOLLOWED
;BY A CARRIAGE RETURN. THE PROGRAM WILL DISPLAY THE NEXT ADDRESS AND ITS
;CONTENTS. TO STOP ENTERING DATA TYPE A PERIOD. THE PROGRAM WILL REDISPLAY
;THE SECTOR SHOWING THE CHANGES MADE. THE EDIT FEATURE WORKS ALMOST EXACTLY
;LIKE THE S ENTRY FEATURE IN DDT. TYPING ONLY A CARRIAGE RETURN OMITS ENTRY.
;	TYPING A PERIOD MERELY REDISPLAYS THE SECTOR FROM MEMORY, IT DOES
;NOT THE EDIT FEATURE
;CHANGE THE BYTE PRECEEDING THE FILE NAME FROM E5 TO 00 AND WRITE THE SECTOR
;BACK ON THE DISK. THIS WILL RESTORE THE FILE PROVIDED NONE OF THE SECTORS
;IN THE FILE WERE CHANGED AFTER THE FILE WAS "ERASED".
;
;	AN ADDITIONAL FEATURE OF DUMP IS THE ABILITY TO VALIDATE A DISK.
;
;		DUMP VALIDATE
;		DUMP A:VALIDATE
;		DUMP B:VALIDATE
;
;	THIS CAUSES THE ENTIRE DISK SELECTED TO BE READ ONE SECTOR AT A
;TIME. THE SECTOR NUMBER OF ANY SECTOR CAUSING A READ ERROR WILL BE DISPLAYED.
;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ;		DUMP TRACK 3 SECTOR 7
;		DUMP TRACK 5   SECTOR  3 - 9
;		DUMP TRACK   6   (DUMPS ALL 26 SECTORS)
;		DUMP GROUP  19
;		DUMP MAP
;		DUMP DIR	(DUMPS DIRECTORY)
;
;	THE WORDS TRACK, SECTOR AND GROUP MAY BE ABREVIATED AS FOLLOWS
;
;		DUMP G 4
;		DUMP T 7 S 3-4
;		*TRACK 5 S 6
;		*SECTOR 2- 9  T 14
;
;
;		DUMP B:  TRACK 3
;		DUMP A: T 9   S 4-6
;		DUMP B:   G  5
;		DUMP B:MAP
;
;	NOTE THAT THE FORMAT IS QUITE FREE. SPACES ARE USUALLY IGNORED
;THEY ARE ONLY REQUIRED AFTER THE WORDS TRACK AN CAUSE IT TO BE WRITTEN BACK ON THE DISK. WHEN EDITING IS COMPLETE,
;REDISPLAY THE SECTOR BY TYPING A PERIOD AND TYPE EITHER
;
;		WRITE		(WRITE SECTOR BACK ON DISK)
;		STOP		(STOP EDITING WITHOUT WRITING ON DISK)
;
;	ALL EDIT ENTRIES MUST BE MADE IN HEX. ENTERING NON HEX CHARACTERS
;RESULTS IN AN ERROR MESSAGE. THE PERMISSABLE ADDRESS RANGE IS 0000 TO 007F.
;LARGER ADDRESSES GIVE AN ERROR MESSAGE. WHEN ENTERING A GROUP OF BYTES THE
;ADDRESSES ARE COMPUTED MODULO 128, THE NEXT ADDRESS AFTER 007F IS WHEN VALIDATING THE PROGRAM READS EVERY FIFTH SECTOR FOR SPEED.
;
;	AS WITH OTHER CP/M UTILITIES ^S "FREEZES" THE DISPLAY, AND ^C
;RETURNS TO THE MONITOR. DUMP CONTAINS MANY ERROR AND CONSISTANCY
;CHECKS. THE RESULTING MESSAGES SHOULD BE SELF EXPLANATORY.
;
;	DUMP WAS ASSEMBLED USING THE CP/M MACRO ASSEMBLER, AND USES A LARGE
;NUMBER OF MACROS INCLUDED IN A LIBRARY CALLED MACRO.LIB
;
$-PRINT
	MACLIB	MACRO		;INCLUDE MACRO LIBRARY
	ORG	100H		;SET PROG START
	LXI	H,0
	DAD	SP		;GET STACK POINTER
	;			--- DUMP ---
;
;					BY: S. J. SINGER
;
;	THIS PROGRAM IS AN IMPROVED DUMP UTILITY FOR CP/M. ANY CPM FILE
;MAY BE DUMPED TO THE CONSOLE IN A FORMAT SIMILAR TO THAT USED BY THE
;DDT DUMP COMMAND. IN ADDITION, ANY SECTOR OR GROUP OF SECTORS MAY
;BE DUMPED IN THE SAME FORMAT.
;
;			-- OPERATION --
;
;	THE PROGRAM MAY BE RUN EITHER BY TYPING DUMP, OR DUMP FOLLOWED
;BY THE FILE NAME OR TRACK AND SECTOR. IF DUMP  IS TYPED THE PROGRAM
;RESPONDS WITH A HEADING FOLLOWED BY A '*' AND WAITS FOR MORE ID SECTOR OR T AND S,
;AND AFTER THE WORD DUMP.
;	A LIMITED EDITING FEATURE IS INCLUDED IN THE DUMP UTILITY TO
;ALLOW CHANGING DATA ON THE DISK. THE EDIT FEATURE WORKS AS FOLLOWS.
;ANY SINGLE SECTOR ON EITHER DRIVE MAY BE EDITED BY REQUESTING DISPLAY
;OF THE SECTOR FOLLOWED BY THE WORD EDIT.
;
;		DUMP B:TRACK 4 SECTOR 2  EDIT
;
;	THE REQUESTED SECTOR WILL BE DISPLAYED FOLLOWED BY AN EDIT PROMPT
;
;	EDIT -
;
;	ENTER THE ADDRESS OF THE FIRST BYTE TO BE CHANGED. THE PROGRAM WILL
;RESPOND BY TYPING0000.
;	THE EDIT FEATURE SHOULD BE USED WITH CAUTION SINCE IT IS POSSIBLE
;TO EDIT CP/M TO "DEATH" BY CHANGING A SINGLE BYTE. ONE OCCASIONAL VALUABLE
;USE IS TO RESTORE FILES THAT HAVE BEEN ACCIDENTALLY ERASED. ERASING A FILE
;USING THE ERA COMMAND DOES NOT ERASE THE DATA FROM THE DISK, BUT ONLY ENTERS
;AN E5 INTO THE FIRST BYTE OF THE DIRECTORY. TO RESTORE A FILE, DISPLAY
;THE DIRECTORY BY DISPLAYING GROUPS 0 AND 1. FIND THE SECTOR CONTAINING THE
;NAME OF THE FILE TO BE RESTORED AND DISPLAY IT USINGSHLD	OLDSTK
	LXI	SP,NEWSTK	;SET UP NEW STACK
	DISKIO	?DRIVE		;GET CURRENTLY LOGGED DRIVE NO
	STA	NEWDRV		;ALSO SAVE IN NEW DRIVE NO
	LDA	81H		;CONSOLE INPUT ALREADY HERE ?
	ORA	A
	JZ	SIGNON		;BUFFER EMPTY, INPUT FROM CONSOLE
	LDA	80H		;GET NO OF CHAR INPUT
	ORI	80H		;ADD 128
	MOV	L,A		;TO L
	XRA	A		;ZERO
	MOV	H,A		;HL CONTAINS ADDR OF END OF BUFFER
ZBFF:	INR	L
	JZ	START		;REMAINDER OF BUFFER ZEROED
	MOV	M,A
	JMP	ZBFF		;LOOP
SIGNON:	PRINT	<CR,LF,'CP/M DUMP UTILITY VERS 1.3',CR,LF>
	PRINT	<'C
	INSTR	82H,40H,'DIR'	;DIRECTORY REQUEST
	JC	DIR		;DISPLAY DIRECTORY
	INSTR	82H,40H,'TRACK'	;SEARCH FOR TRACK
	JC	TRK1
	INSTR	82H,40H,'T '	;SEARCH FOR 'T'
	JNC	FILNAM		;NO TRACK GO TO READ FILE
TRK1:	SCAN			;FIND AND CONVERT NUMBER
	DECIN
	JC	INERR		;INPUT ERROR ON CARRY
	STA	TRACK		;SAVE TRACK NO
	INSTR	82H,40H,'SECTOR'	;SEARCH FOR SECTOR
	JC	SEC1
	INSTR	82H,40H,'S '	;TRY 'S'
	JNC	WHLTRK		;DUMP ENTIRE TRACK
SEC1:	SCAN	
	DECIN
	JC	INERR		;INPUT ERROR ON CARRY
	STA	BSEC		;BEGINNING SECTOR
		;GET ASCII CHAR
	CPI	'.'		;CHECK FOR EXIT CHAR
	JZ	EDIT3		;BACK FOR MORE EDITING
	JMP	ADERR		;ADDRESS ERROR
CKLIM:	LXI	D,0080H		;CHECK ADDR LIMIT
	CPHL
	JP	ADERR		;ADDRESS ERROR
	SHLD	IPOINT		;SAVE ADDRESS
	PRINT	CRLF,$
PTX:	HEXOUT	IPOINT+1
	HEXOUT	IPOINT		;ECHO THE ADDRESS
	PRINT	SPACE,$
	LHLD	IPOINT		;ECHO PRESENT CONTENTS
	LXI	D,0080H
	DAD	D		;COMPUTE MEMORY ADDR
	MOV	A,M		;GET BYTE FROM MEMORY
	HEXOUT
	PRINT	SPACE,$
	FILL	INBUF,INBUF+5	;ZERO INPUT BUFFER
	INPUT	INBUF,4		;INPUT 4 CHAR	;SELECT NEW DEIVE IF SPECIFIED
	CALLBIOS DREAD		;READ TRACK AND SECTOR
;
;  PRINT DRIVE, TRACK AND SECTOR HEADING
;
PRTSEC:	LDA	NEWDRV		;NEW DRIVE NO
	ORA	A
	JNZ	PRNB		;PRINT DRIVE B
	PRINT	<CR,LF,'               DRIVE A -'>
PRNTRK:	PRINT	' TRACK '
	LXI	H,0
	LDA	TRACK
	MOV	L,A
	DECOUT
	PRINT	'  SECTOR '
	LXI	H,0
	LDA	BSEC
	MOV	L,A
	DECOUT
	PRINT	CRLF,$
	CALL	PRTBUF		;PRINT IT
	LXI	H,BSEC		;ADDR OF SECTOR NUMBER
	LDA	ESEC		;END SECTOR NUMBER
	CMP	M		;COMPARE THEM
	RZ			;EXIT IF THEY OPYRIGHT 1978 BY S. J. SINGER',CR,LF>
NEWIN:	PRINT	<CR,LF,'*'>
	MVI	A,0FFH		;SET SWITCH TO RETURN HERE AGAIN
	STA	INFLAG
	LXI	SP,NEWSTK	;RESET STACK POINTER
	XRA	A
	STA	VALFLG		;RESET VALIDATION ERROR FLAG
	LXI	H,0
	SHLD	LINE		;SET LINE COUNT TO ZERO
	FILL	80H,0FFH	;ZERO INPUT BUFFER
	INPUT	80H		;READ FILE NAME
;
;  SELECT DISK DRIVE AND SET UP FILE CONTROL BLOCK
;
START:	FILL	FCB,FCB+32	;ZERO FILE CONTROL BLOCK
	MATCH	82H,'A:'	;DRIVE A
	JZ	ADISK
	MATCH	82H,'B:'	;DRIVE B
	JZ	BDISK
	JMP	GESTA	ESEC		;SAVE IN END SECTOR ALSO
	XCHG			;SET BUFFER POINTER FOR SCAN
	SHLD	IPOINT		;SAVE BUFFER POINTER FOR EDIT
	INSTR	,40H,'-'	;SEARCH FOR '-'
	JNC	EDIT		;CHECK FOR EDITION OF SECTOR
	SCAN
	DECIN			;SCAN AND CONVERT ANOTHER NO
	JC	INERR		;ERROR IF CARRY SET
	STA	ESEC		;SAVE IN END SECTOR
	LXI	H,BSEC		;POINTS TO BSEC
	CMP	M		;COMPARE BEGIN AND END
	JP	DOREAD		;OK IF END>=BEGIN
	MOV	B,A		;OTHERWISE
	MOV	A,M		;SWITCH THEM
	STA	ESEC
	MOV	M,B
DOREAD:	CALL	RDISK0		;READ DIRECT
	JMP	ENDFIL		; MAX
	HEXIN	INBUF+2		;CONVERT
	JNC	EDIT2		;HEX CHAR
	LDAX	D		;GET ASCII CHAR
	CPI	'.'		;PERIOD ENDS INPUT
	JZ	EDIT3		;BACK FOR MORE EDITING
	JMP	HEXERR		;ERROR NOT HEX CHAR
EDIT2:	LDA	INBUF+1		;LOAD NO OF CHAR TYPED
	ORA	A
	JZ	EDITX		;NO REPLACEMENT IF JUST CR
	MOV	A,L		;CONVERTED CHAR BACK TO A
	LHLD	IPOINT		;LOAD MEMORY BUFFER POINTER
	LXI	D,0080H		;OFFSET
	DAD	D		;CALC MEMORY ADDR
	MOV	M,A		;STORE NEW INPUT TO MEMORY
EDITX:	PRINT	CRLF,$
	LDA	IPOINT		;LEAST SIGNIFICANT HALF OF ADDR
	INR	AARE EQUAL
	INR	M		;INCR BSEC
	JMP	RDISK
PRNB:	PRINT	<CR,LF,'               DRIVE B -'>
	JMP	PRNTRK		;PRINT TRACK AND SECTOR
;
;  DUMP ENTIRE TRACK IF NO SECTOR INPUT
;
WHLTRK:	MVI	A,1		;BEGIN SECTOR
	STA	BSEC
	MVI	A,26		;END SECTOR
	STA	ESEC
	CALL	RDISK0		;TO READ DISK
	JMP	ENDFIL		;BACK FOR MORE INPUT
;
;  FILL IN FCB FOR NAMED FILE
;
FILNAM:	FILFCB	FCB,82H	;FILL IN FCB NAME FROM INPUT BUFFER
	JC	NAMERR		;ERROR IN FILE NAME
	MATCH	FCB+9,'COM'	;TEST FOR COM FILE
	JNZ	SELDR
	LXI	H,100H	TNAM		;NO DRIVE SPECIFIED
ADISK:	XRA	A
	STA	NEWDRV		;SELECT DRIVE A
	JMP	DOWN
BDISK:	MVI	A,1
	STA	NEWDRV		;SELECT DRIVE B
DOWN:	MOVE	82H,80H,40H	;SHIFT BUFFER DOWN TWO BYTES
;
;  SEARCH FOR DIRECT READ OF TRACK AND SECTOR OR VALIDATE
;
GETNAM:	INSTR	82H,40H,'VALIDATE'
	JC	VALID		;VALIDATE DISK
	INSTR	82H,40H,'GROUP'
	JC	GROUP		;DISPLAY CPM 8 SECTOR GROUP
	INSTR	82H,40H,'G '	;SEARCH FOR 'G'
	JC	GROUP		;DISPLAY GROUP
	INSTR	82H,40H,'MAP'	;ALLOCATION MAP
	JC	MAP		;DISPLAY GROUP ALLOCATION MAPBACK FOR MORE INPUT
EDIT:	LHLD	IPOINT		;RESET BUFFER POINTER
	INSTR	,40H,'EDIT'	;CHECK EDIT FUNCTION
	JNC	DOREAD		;GO TO DISPLAY SECTOR
	CALL	RDISK0		;DISPLAY SECTOR
EDIT1:	PRINT	<CR,LF,'EDIT - '>
	FILL	INBUF,INBUF+9
	INPUT	INBUF,6		;INPUT MAXIMUM 6 CHAR
	INSTR	INBUF,8,'WRITE'	;WRITE EDITED SECTOR ON DISK?
	JC	WRTDSK		;WRITE BUFFER BACK ON DISK
	INSTR	INBUF,8,'STOP'	;STOP EDITING WITHOUT WRITING?
	JC	ENDFIL		;EXIT
	HEXIN	INBUF+2		;CONV ASCII TO HEX
	JNC	CKLIM		;IF NO ERROR, CHECK ADDR
	LDAX	D			;INCR BY ONE
	ANI	7FH		;COUNT MOD 128
	STA	IPOINT
	JMP	PTX		;INPUT MORE DATA
EDIT3:	LXI	H,0
	SHLD	LINE		;RESET LINE NO TO ZERO
	CALL	PRTSEC		;PRINT BUFFER WITH HEADING
	JMP	EDIT1		;BACK FOR ADDITIONAL EDITING
WRTDSK:	CALLBIOS DWRITE		;WRITE BUFFER BACK ON DISK
	JMP ENDFIL		;EXIT
;
;  READ TRACK AND SECTOR DIRECT
;
RDISK0:	CALL	FIXB
RDISK:	SETSEC	BSEC		;SET SECTOR
	JC	BADSEC		;WRONG SECTOR NO
TRK2:	SETTRK	TRACK		;SET TRACK
	JC	BADTRK		;WRONG TRACK NO
	LDA	NEWDRV
	MOV	E,A
	DISKIO	LOGIN		
	SHLD	LINE		;SET LINE NO. TO 100
SELDR:	LDA	NEWDRV		;SELECT NEW DRIVE
	MOV	E,A
	DISKIO	LOGIN
	DISKIO	OPEN,FCB	;0PEN FILE
	CPI	255		;CHECK FILE PRESENT
	JZ	OPNERR		;EXIT IF ERROR
RDFILE:	DISKIO	READ,FCB	;READ A BLOCK
	ORA	A		;ZERO INDICATES SUCESSFUL READ
	JNZ	ENDFIL		;1 INDICATES EOF
	CALL	PRTBUF		;DO PRINT SUBROUTINE
	JMP	RDFILE		;BACK FOR NEXT BLOCK
ENDFIL:	LDA	INFLAG		;SEE WHERE TO GO
	ORA	A
	JZ	MONITOR
	JMP	NEWIN
;
;
;  PRTBUF - PRINT BUFFER IN HEX AND ASCII
;
PRTBUF:	MVI	B,8		;8 LI	H,B
DECC2:	DCR	C		;DECR CHAR COUNT
	JNZ	PLOOP1		;PRINT SOME MORE
	SAVE	B
	PRINT	CRLF,$		;CARRIAGE RETURN
	CALL	PRNCON		;PRINT CONTROL?
	POP	B
	INDEX	LINE,16		;INCR LINE NO BY 16
	DCR	B		;DECR	LINE COUNT
	RZ			;RETURN IF LINE COUNT ZERO
	INDEX	IPOINT,16	;INCR POINTER BY 16
	JMP	BPRN		;LOOP BACK
;
;    THIS SECTION VALIDATES A DISK
;
VALID:	MVI	A,1		;START WITH SECTOR 1
	STA	SNUM
	XRA	A		;START WITH TRACK 0
	STA	TNUM
	LDA	NEWDRV		;SELECT NEW DRIVE
	MOV	E,A
	DISKIO	LOGIN
RS0:	SETTRK	TNUM
	CHARIN			;READ CONSOLE
	CPI	3		;TEST FOR CONTROL C
	JZ	ENDFIL		;EXIT IF CONTROL C
	RET
;
;    THIS SECTION DISPLAYS A CPM GROUP OF 8 SECTORS
;
GROUP:	SCAN			;GET THE GROUP NO
	DECIN			;CONVERT TO BINARY
	JC	INERR		;INPUT ERROR IF CARRY SET
	STA	G		;SAVE GROUP NO
	ADI	13		;CHECK LEGAL RANGE
	JC	BADGRP
	XRA	A
	STA	S		;SET SECTOR COUNT TO 0
	CALL	FIXB		;RESTORE DRIVE B IF SELECTED
GRP1:	CALL	GRPTS		;CONVERT TO TRACK AND SECTOR
	CALL	RDISK		;PRINT THE SECTOR
	LDA	S		;CHECK SECTOR COUNT
	IN'>
	LDA	NEWDRV		;LOGGED DRIVE
	ORA	A
	JNZ	DRB		;DRIVE B
	PRINT	<' A',CR,LF,LF>
	JMP	MAP1
DRB:	PRINT	<' B',CR,LF,LF>
MAP1:	LHLD	IPOINT		;POINTER TO DISK ALLOCATION MAP
	MVI	D,8		;NO OF LINES
MAP2:	MVI	C,4		;WORDS PER LINE
MAPX:	SAVE
	PRINT	'            '
	RESTORE
MAP3:	MVI	B,8		;BITS PER WORD
	MOV	A,M		;GET A BYTE FROM ALLOC MAP
MAP4:	RAL			;SHIFT LEFT THRU CARRY
	SAVE	B,D,H,PSW
	JC	MAP5		;PRINT A ONE
	PRINT	'0'		;PRINT A ZERO
	LDA	G		;UNUSED GROUPS
	INR	A		;ADD 1
	STA	G		;STORE IT BACKNES
	LXI	H,80H		;INITIAL BUFFER POINTER
	SHLD	IPOINT		;STORAGE FOR POINTER
BPRN:	LHLD	IPOINT		;LOAD POINTER
	MVI	C,16		;CHAR PER LINE
	LDA	LINE+1		;LINE NUMBER
	SAVE	B,H
	HEXOUT
	LDA	LINE		;SECOND TWO DIGITS
	HEXOUT
	PRINT	'  '
	RESTORE	H,B
PLOOP:	MOV	A,M		;GET A BYTE
	SAVE	B,H
	HEXOUT
	PRINT	SPACE,$
	RESTORE	H,B
	INX	H		;INCR MEMORY POINTER
	MOV	A,C
	CPI	9		;CHECK 8 CHAR
	JNZ	DECC		;SKIP IF NOT
	SAVE	B,H
	PRINT	SPACE,$
	RESTORE	H,B
DECC:	DCR	C		;DECR CHAR COUNT
	JNZ	PLOOP		;PRINT S
	JC	BADTRK
RS1:	SETSEC	SNUM
	JC	BADSEC
	CALLBIOS DREAD
	ORA	A
	CNZ	VALERR		;ERROR IF NOT ZERO
	CALL	PRNCON		;ESCAPE ON CONTROL C
	LDA	SNUM		;SECTOR NO
	ADI	5		;INCR BY 5
	STA	SNUM		;STORE IT BACK
	SBI	27		;CALC SECTOR MOD 26
	JM	RS1		;SECTOR OK IF MINUS
	INR	A		;SECTOR MOD 26
	STA	SNUM		;STORE IT BACK
	CPI	1		;ARE WE BACK TO ONE YET
	JNZ	RS1		;READ SOME MORE
	LDA	TNUM		;TRACK NUMBER
	INR	A		;INCR BY ONE
	CPI	77		;CHECK LIMIT
	JZ	VALOUT		;TO EXIT
	STA	TNUM		;STORE BACK TRACK NO
	JMP	RSR	A
	STA	S		;INCR S BY 1
	CPI	8		;CHECK LIMIT
	JNZ	GRP1		;PRINT ANOTHER SECTOR
	JMP	ENDFIL		;BACK FOR MORE INPUT
;
;   GRPTS  CONVERT CPM GROUP AND SECTOR NUMBER TO TRK AND SEC
;
GRPTS:	MVI	H,0		;ZERO H
	LDA	G		;GROUP NO
	MOV	L,A		;TO L
	MOV	D,H		;ZERO	D
	DAD	H
	DAD	H
	DAD	H		;SHIFT LEFT 3
	LDA	S		;GET SECTOR NO
	MOV	E,A		;TO DE
	DAD	D		;HL HAS G*8+S
	LXI	D,-26		;DIVISOR
	MVI	A,1		;CONTAINS DIVIDEND
DIV:	DAD	D		;SUB 26
	INR	A
	JC	DIV		;LOOP TILL MINUS
	LXI	D,TABLE+26	;INDEX INTO TABLE
	JMP	MAP6
MAP5:	PRINT	'1'		;PRINT A ONE
MAP6:	RESTORE	PSW,H,D,B
	SAVE	PSW		;SAVE BIT MAP BYTE
	MOV	A,B		;BIT COUNT
	CPI	7
	JNZ	MAPY
	MOV	A,C		;WORD COUNT
	CPI	2
	JNZ	MAPY
	MOV	A,D		;LINE COUNT
	CPI	1
	JNZ	MAPY
	RESTORE	PSW
	JMP	MAP7		;TO PRINT UNUSED GROUPS
MAPY:	RESTORE	PSW
	DCR	B		;DCR BIT COUNT
	JNZ	MAP4		;PRINT MORE BITS
	DCR	C		;DECR WORD COUNT
	INX	H		;INCR ALLOC MAP POINTER
	JNZ	MAP3
	SAVE
	PRINT	CRLF,$
	RESTORE
	DCR	D		;DECR LINE COUNT
	JMP	MAP2
MAP7:	PRINT	<CR,LF,LF,'    OME MORE
	SAVE	B
	PRINT	SPACE,$
	RESTORE	B
	LHLD	IPOINT		;RESET POINTER FOR ASCII
	MVI	C,10H		;RESET CHAR COUNT
PLOOP1:	MOV	A,M		;GET A BYTE
	ANI	7FH		;MASK OFF HIGH BIT
	CPI	7FH		;DELETE CODE
	JZ	PERIOD		;PRINT PERIOD FOR DELETE
	CPI	20H		;TEST FOR CONTROL CHAR
	JP	SKIPX		;SKIP SUBSTITUTION
PERIOD:	MVI	A,2EH		;ASCII PERIOD
SKIPX:	SAVE	B,H
	CHAROUT			;PRINT IT SAVE REGS
	RESTORE	H,B
	INX	H		;INCR MEMORY POINTER
	MOV	A,C
	CPI	9		;CHECK 8 CHAR
	JNZ	DECC2
	SAVE	B,H
	PRINT	SPACE,$
	RESTORE0		;BACK TO READ ROUTINE
VALOUT:	LDA	VALFLG		;CHECK ERROR FLAG
	ORA	A
	JNZ	ENDFIL
	PRINT	<CR,LF,'SUCCESSFUL VALIDATION'>
	LDA	NEWDRV
	ORA	A
	JNZ	VAL2
	PRINT	' DRIVE A'
	JMP	ENDFIL
VAL2:	PRINT	' DRIVE B'
	JMP	ENDFIL
VALERR:	PRINT	<CR,LF,'ERROR - TRACK '>
	LDA	TNUM
	LXI	H,0
	MOV	L,A
	DECOUT
	PRINT	'  SECTOR '
	LXI	H,0
	LDA	SNUM
	MOV	L,A
	DECOUT
	PRINT	CRLF,$
	MVI	A,-1
	STA	VALFLG		;SET ERROR FLAG
	RET
;
;  PRINT CONTROL AND ESCAPE
;
PRNCON:	MVI	C,11
	CALL	5
	ANI	1
	RZ			;RETURN
	DAD	D
	STA	TRACK		;STORE TRACK NO
	MOV	A,M		;GET SECTOR NO
	STA	BSEC		;SAVE IN BEGINNING SECTOR
	STA	ESEC		;SAVE IN END SECTOR TOO
	RET
$+PRINT
;
;    THIS ROUTINE DISPLAYS THE DISK SECTOR ALLOCATION MAP
;
MAP:	LDA	NEWDRV
	MOV	E,A
	DISKIO	LOGIN		;LOG IN SELECTED DRIVE
	DISKIO	?ALLOC		;GET POINTER TO ALLOCATION MAP
	MOV	H,B
	MOV	L,A		;TO HL
	SHLD	IPOINT		;SAVE MAP POINTER
	LXI	H,0		;ZERO HL
	SHLD	G		;ZERO COUNT OF UNUSED GROUPS
	PRINT	<CR,LF,LF,'             GROUP ALLOCATION MAP DRIVE -      '>
	DECOUT	G		;PRINT NO OF UNUSED SECTORS
	PRINT	<' GROUPS REMAINING ON DISK OUT OF 243',CR,LF>
	JMP	ENDFIL		;EXIT
;
;    THIS ROUTINE SORTS AND DISPLAYS THE DIRECTORY
;	(NOT IMPLEMENTED IN THIS VERSION)
;
DIR:	JMP	ENDFIL		;EXIT
;
;    THIS ROUTINE RESTORES DRIVE B
;
FIXB:	LDA	NEWDRV		;CHECK DRIVE NO
	ORA	A
	RZ			;RETURN IF DRIVE A
	LDA	NEWDRV		;SELECT DRIVE B
	MOV	E,A
	DISKIO	LOGIN
	XRA	A
	STA	TNUM		;SELECT TRACK ZERO
	INR	A		;SELECT SECTOR 1
	STA	SNUM
	SETSEC	SNUM
	SETTRK	TNUM	;FILE CONTROL BLOCK
SPACE:	DB	' $'		;ASCII SPACE
CRLF:	DB	0DH,0AH,24H	;ASCII CR LF
I:	DW	0		;PSEUDO INDEX REGISTER
LINE:	DW	0		;LINE NUMBER FOR LISTING
IPOINT:	DW	00		;VARIABLE BUFFER POINTER
INBUF:	DS	10		;USED AS CONSOLE INPUT BUFFER
LASTIN:	DB	0		;LAST CONSOLE INPUT CHAR
INFLAG:	DB	0		;FLAG, RET FOR MORE CONSOLE INPUT
DRVNO:	DB	0		;STORAGE FOR ORIGINALLY LOGGED DRIVE
NEWDRV:	DB	0		;STORAGE FOR NEW DRIVE NO
TRACK:	DB	0		;SELECTED TRACK
BSEC:	DB	0		;SELECTED BEGINNING SECTOR
ESEC:	DB	0		;SELE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                !  9"·1СН 2­:Ѓ ·К):Ђ цЂoЇg,КёwГ!ГK
CP/M DUMP UTILITY VERS 1.3
$,	Н ГwCOPYRIGHT 1978 BY S. J. SINGER
$V	Н Г†
*$‚	Н >я2«1СЇ2і!  "њ!Ђ Ђ s#В§
Ђ >Н !\ ! s#ВїГУИ–А#ГЙ‚ !бНИГгA:Кь‚ !фНИГцB:КГ"Ї2­Г>2­Гx±И~#Г!‚ Ђ @ НГBx‘?РGЕХеНИбСБК=§ш#Г* 	7Й!‚ @RН%ГZVALIDATEЪђ!‚ @mН%ГrGROUPЪУ!‚ @…Н%Г‡G ЪУ!‚ @љН%ГќMAPЪ+	!‚ @°Н%ГіDIRЪ‡
!‚ @ЖН%ГЛTRACKЪг!‚ @ЮН%ГаT Т1Го~ю!р#ГжНжю:Г  лЦ0§шю
	CALLBIOS DHOME		;HOME DRIVES
	CALLBIOS DREAD		;READ TRACK ZERO DIRECT
	RET
;
;  ERROR AND EXIT ROUTINES
;
;
INERR:	PRINT	<CR,LF,'INPUT ERROR'>
	JMP	ENDFIL
;
BADSEC:	PRINT	<CR,LF,'INCORRECT SECTOR NUMBER'>
	JMP	ENDFIL
;
BADTRK:	PRINT	<CR,LF,'INCORRECT TRACK NUMBER'>
	JMP	ENDFIL
;
BADGRP:	PRINT	<CR,LF,'INCORRECT GROUP NUMBER (GREATER THAN 242)'>
	JMP	ENDFIL
;
OPNERR:	LDA	NEWDRV		;CURRENT DRIVE NO
	ORA	A
	JNZ	OPNER1
	PRINT	<CR,LF,'NO FILE BY THAT NAME ON DRIVE A'>
	JMP	ENDFIL
OPNER1:CTED ENDING SECTOR
TNUM:	DB	0		;TRACK NO FOR VALIDATE
SNUM:	DB	0		;SECTOR NO FOR VALIDATE
VALFLG:	DB	0		;VALIDATION ERROR FLAG
G:	DB	0		;CPM GROUP NO
S:	DB	0		;SECTOR NO WITHIN GROUP G
COUNT:	DB	0		;COUNT OF DIRECTORY ENTRIES
OLDSTK:	DW	0		;STORAGE FOR OLD STACK POINTER
ENDSTK:	DS	24		;STORAGE FOR NEW STACK
NEWSTK:	DW	0		;NEW STACK
INB:	DW	0		;STORES POINTER TO INPUT BUFFER AREA
OUTB:	DW	0		;STORES POINTER TO DIRECTORY BUFFER AREA
TABLE:	DB	01H		;SECTOR LOOK UP TABLE
	DB	07H
	DB	0DH
	DB	13H
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
?Ш)е))Б	O 	ГъНц}Ъж
2®!‚ @+Н%Г1SECTORЪI!‚ @DН%ГFS Т!Нжю:Нц}Ъж
2Ї2°л"ћ@lН%Гm-Т’Нжю:Нц}Ъж
2°!ЇѕтЊG~2°pНГП*ћ@ўН%Г¦EDITТЊНГ№
EDIT - $Ї	Н ! 
 s#ВИ
 >Н ! йН%ГоWRITEЪх! Н%ГSTOPЪПГ.!  ·ИЦ0ШЖйШЖтЖШЖ
·O ))))	ГўН}ТAю.КйГ5Ђ |єВK}»т5"ћ—	Н ГsхНeсжЖђ'О@'_Г :џН\:ћН\•	Н *ћЂ ~Н\•	Н !  s#ВЎ
 >Н ўН}ТЕю.КйГT:Ў·КХ}*ћЂ w—	Н :ћ<ж2ћГY!  "њНOГ¬* .*"юН  	PRINT	<CR,LF,'NO FILE BY THAT NAME ON DRIVE B'>
	JMP	ENDFIL
;
RDERR:	PRINT	<CR,LF,'DISK DEAD ERROR'>
	JMP	MONITOR
NAMERR:	PRINT	<CR,LF,'ERROR IN FILE NAME'>
	JMP	ENDFIL
;
ADERR:	PRINT	<CR,LF,LF,'ADDRESS ERROR'>
	JMP	EDIT1		;ADDRESS ERROR ON EDIT
;
HEXERR:	PRINT	<CR,LF,'  ERROR - HEX INPUT ONLY',CR,LF>
	JMP	PTX
;
MONITOR: PRINT	CRLF,$
	LDA	DRVNO		;RESTORE LOGGED DRIVE NO
	MOV	E,A
	DISKIO	LOGIN
	LHLD	OLDSTK
	SPHL			;RESET OLD STACK POINTER
	RET
;
;
;   DATA ALLOCATIONS
;
FCB	EQU	5CH		DB	19H
	DB	05H
	DB	0BH
	DB	11H
	DB	17H
	DB	03H
	DB	09H
	DB	0FH
	DB	15H
	DB	02H
	DB	08H
	DB	0EH
	DB	14H
	DB	1AH
	DB	06H
	DB	0CH
	DB	12H
	DB	18H
	DB	04H
	DB	0AH
	DB	10H
	DB	16H
PDIR	DW	0		;POINTER TABLE TO DIRECTORY (64 ENTRIES MAX)
DIRBUF:	EQU	PDIR+130	;START OF AREA USED TO STORE AND SORT DIRECTORY
	END
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ГПНЉ
:Ї·7К ю?Ъ O* .!"Н  Ъ:®юM?Ъ8O* ."6Н  Ъ*:­_Н * .'"MН  :­·ВшГt
               DRIVE A -$Y	Н Г‡ TRACK $	Н !  :®oГїЕХецяяя	Ъў
 	л|µД™{Ж0__Н бСБЙН™ГП  SECTOR $Е	Н !  :ЇoН™—	Н НЩ!Ї:°ѕИ4ГГ
               DRIVE B -$ы	Н Г|>2Ї>2°НГПГЂ6 #е> w#В<бю ВOГEю Ию Ию.Кdw#тO7Йy·Кo#Вjю Ию Иw#ВqЙ‚ !\ Н4лЪe !›НИГћCOMВ§! "њ:­_Н \ Н юяК‹\ Н ·ВПНЩГЅ:«·КГ!Ђ "ћ*ћ:ќЕеН\:њН\Гъ  $ч	НПГ
INCORRECT SECTOR NUMBER$	Н ГПГF
INCORRECT TRACK NUMBER$-	Н ГПГЂ
INCORRECT GROUP NUMBER (GREATER THAN 242)$T	Н ГП:­·ВВГ·
NO FILE BY THAT NAME ON DRIVE A$•	Н ГПГз
NO FILE BY THAT NAME ON DRIVE B$Е	Н ГПГ
DISK DEAD ERROR$х	Н ГГ*
ERROR IN FILE NAME$	Н ГПГI

ADDRESS ERROR$8	Н Г¬Гt
  ERROR - HEX INPUT ONLY
$W	Н ГY—	Н :¬_Н *·щЙ $
$      Y THAT NAM               	Н ГПГз
NO FILE BY      	
               !  9""1":m 2$—2%2ЩН "(}·Кaя Н 2%:)·Кa/	Н :%ю
ЪO>1Нь:%Ц
Ж0НьC	Н >2Щ!\ ~·ВrН <2\ Ж@2ї!] ~ю В‰6?#В‚>?2h :\ =_Н —2\ :(·КИН ##~2П#~2Р##^#Vл"Сл#^#Vл"УГз* .;^ Х#~2П#~2Р#^ л"Сб"У#)+"Ъ"Ьл* {•zњТ«\ Н <ВS:)·В«НЄNO FILE$File not found.$Directory for user $:
$\ Н <Кї=ж‡‡‡‡‡!Ѓ …Ж	o:$юSКp~жЂВG}Ц
o:%ѕВG#л*Ьжw#В‚w#"Ьл*Ю#"Ю! л* {•zњЪGНЄOut of	memory.
$*Ю}ґК
е*Ъл!+ s#r#л	лг+}ґгВТб*Ю"а+}ґКZ*а·|g}oґКZ}цo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 бБ~ЕеН\•	Н бБ#yю	В'Ее•	Н бБВЕ•	Н Б*ћ~жюКGю тI>.Ее_Н бБ#yю	ВfЕе•	Н бБВ:Е—	Н НАБ*њ "њИ*ћ "ћГб>2ІЇ2±:­_Н :±юM?Ъ·O* ."µН  Ъ*:І·7КФю?ЪФO* .!"ТН  Ъ* .'"аН  ·ДmНА:ІЖ2ІЮъє<2ІюВє:±<юMК2±Гў:і·ВПГ0
SUCCESSFUL VALIDATION$	Н :­·ВVГK DRIVE A$B	Н ГПГb DRIVE B$Y	Н ГПГЃ
ERROR - TRACK $p	Н :±!  oН™Г   SECTOR $–	Н !  :ІoН™—	Н >я2іЙН жИН юКПЙНжю:Нц}Ъж
2ґЖЪQЇ2µНЉ
Н	Н:µ<2µюВо                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Н#"Зл*Н{•ozњg"Йл*Н"Л>НЋтE*Йл*ЛНy*Йл*Н{•ozњgъEµКEГ*ал*З#{•zњт*НГс!+"Ь!  "Х"Ч*Ю+}ґКќЕН ·КЃГВ*Ь>НbБВќ##"Ь*Ю+"ЮГkй*Ь^#V#"ЬлН	> НьН	^ #~л))))л!Р†жo& :Рж/Ґoл*Х"Х*Ч#"ЧлН
>kНь*Ю+}ґКP"ЮхДтсМГk—2*ьН&њяН&цяН&>0…Гь0еТ2сГ(бxю0ВJ:*·>0Вь:г·ИГъ2*ГьЇ2гНї	Н *ХН
М	Н *ЧН
Т	Н Н л*С#  ХЪ‘W+}ґКўzВЊСГ€i`:ПЦК±)=В¬Н
Я	Н ГВ : Total of $k in $ files with $k space remaining.$Нъ>:Нь> ЕХе_ГОЙ  Й        (INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)(INP:/OUT:SPACE)   COPYRIGHT (C) 1979, DIGITAL RESEARCH,  PIP VERS 1.5 $$$     SUB    =.:,<>_[]INPIRDPTRUR1UR2RDROUTLPTUL1PRNLSTPTPUP1UP2PUNTTYCRTUC1CONNULEOF DISK READ ERROR$DISK WRITE ERROR$VERIFY ERROR$NOT A CHARACTER SINK$READER STOPPING
$NOT A CHARACTER SOURCE$ГП& :ґoT))):µ_жя><Ъ	с2®~2Ї2°Й:­_Н Н `o"ћ!  "ґГt	

             GROUP ALLOCATION MAP DRIVE -$G		Н :­·В—	ГЊ	 A

$†		Н ГЁ	Г 	 B

$љ		Н *ћЕХеГВ	            $µ		Н бСБ~ЕХехЪп	ГЭ	0$Ы		Н :ґ<2ґГь	Гф	1$т		Н сбСБхxюВ
yюВ
zюВ
сГ3
сВР	#ВН	ЕХе—	Н бСБГ­	ГD


          $6
	Н *ґН™Г|
 GROUPS REMAINING ON DISK OUT OF 243
$U
	Н ГПГП:­·И:­_Н Ї2±<2І:І·7Кє
ю?Ъє
O* .!"ё
Н  :±юM?ЪП
O* ."Н
Н  * ."Ш
Н  * .'"г
Н  ЙГч

INPUT ERROR$й
	Н Г                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Н бСБЙ~Нь#В	Й* .	НњжЙ:Щ<юЪ3C	Н Н—2Щ>Нь>
НьЙ
(Strike any key to continue)$е^#V#N#Fл_
ѕ#ВwВlбЙ))	л)	Nлq#NлqЙ))	л)	лN#Fл^#Vл_
ѕ#АВ ЙС	Н Нї	Н Ї2гГ{*"щЙ                            яЂ                                                                                                                                                                                                                                                                                           ABORTED$BAD PARAMETER$INVALID USER NUMBER$RECORD TOO LONG$INVALID DIGIT$END OF FILE, CTL-Z?$CHECKSUM ERROR$CORRECT ERROR, TYPE RETURN OR CTL-Z$INVALID FORMAT$HEX$$$$NO DIRECTORY SPACE$NO FILE$COM$START NOT FOUND$QUIT NOT FOUND$CANNOT CLOSE DESTINATION FILE$DESTINATION IS R/O, DELETE (Y/N)?$**NOT DELETED**$$$$$$$NOT FOUND$COPYING -$REQUIRES CP/M 2.0 OR NEWER FOR OPERATION.$UNRECOGNIZED DESTINATION$CANNOT WRITE$INVALID PIP FORMAT$CANNOT READ$INVALID SEPARATOR$1тЂ ЕЂМН
:МЦ Цџ2ҐНLл> Н„ТэMН9Н  Н	Н Й!Гp+q*ВлН Йя  Н Й!Дq*Д& л Н Й*АMН	Й*БMН	Й!Жp+q*Ел!Н Й!Иp+q*Зл"Н Й!Кp+q*Йл$Н Й!Л6ЂЛ
Н Й  Н Й!kp+q*jлН Й>У>УЫЪЄ	Гћ	ЫжЙ!qp+qН/	*pDMН9:Н Н:M2r:N!rѕЪш	!М:rѕТс	*r& Н	NН!r4ВР	!М6 :Н”:®юяК
:НіН.ГЙ!ws+p+q+СБp+qХ:w=2wюяКN
*sе*uБ
w*s#"s*u#"uГ'
Й!  "ќ*MН^Н7	!x6 :ы!xѕЪѕ
*ќл*DMН†	НГ2yю К­
:yюК—
”НЇ	*ќ"џл*6:ы2xГ·
Ђ *ќ"ќ!x4Вd
!  "ќН/	Й!ЎНj}=2|юяВЫ
Й!  "Ў*KMН^'Н_	!z6 :|!zѕЪ1*Ўџ/БHЎТ:Њж_2Њ:ЊЙ!Ќq:ЌЦAџ/х>Z!Ќ–џ/БHЎТ8:Ќц 2Ќ:ЌЙ:¤=O>№Ъm:W!Q¶хН}	БHЎТmНюВd>ЙЧН9>Й!ђ6: 2Ћ*¤M !E		^#VлйэќНЋЪ—НO
*ќл*~2Џ*ќ#"ќГmНу2ЏГmН–	2ЏГm! 6ГаГm! 6ГаГm! 6ГаГm  Н ж2ЏГmГГГГГГГГйНЇ	Гm! 6 Г2Гm! 6Г2Гm! 6Г2Гm!ђ6   Н 2ЏГm€­¶їКХаруцщья'2:Ћ2 :TТ’:Ј2Ћ!Ј6*ЏMНE:Ћ2Ј:ђТЬ:ТІ:§<2§Ц Цџ2ђГЅ:ЏЦ
Цџ2ђ:ђТЬН}	ТЬНюВЦ>Й НЇ	:iТл:Џж2Џ:dТъ*ЏMНоЙ:[Т	Г·:ЁЦSЦџх:ЁЦQЦџБH±ТI:N<2џНт2ЁЦЦџх:ЁЦЦџБH±Ъ@Г"Нт2ЁГЌНт2ЁЦ02џO>	№Тc!џ6ГЌНт2ЁЦ02™O>	№ЪЌ*џ& НOе*™& Б	л!џsГc*ћ& P	:џw:ћюВ·>!џѕТ±НЇ	:џ2БГВНт2ЁЙ:Ёю_ВО!Ё6=Й!Ј6 >'!ЈѕЪй НE!Ј4ВФЙ!©p+q*Ёе0Н
Й!­r+s+p+q*¬~ю$К7*¬>¦*Єх>¦БH№К&> Й*Є#"Є*¬#"¬Г>ЙН2Ё:ТRќџНЋџЙ:ЁЦЦџЙ!Ї6!њ6 Н=2µю:К™!њ6 :µюВ“HН9НюВЋ>Й!њ6 Н-Гe!µ6 Н»2ґю ВЗН=2ґюКєН-Г©:ЇТД>Й>ЙНД"·Н»2¶:ґЦ Жяџ!Ї¦Тр!ґ5Н»2іГУН¬!µ†ю К\Н2А  Н 2ь1тН@:А2Б!o6 +6 +6 !¦6#6 !у6 #6ю:ҐТG*ННo	Н.!N6я:Мю В^*ьMН^Н  !K6 !6 !¤6 +6 'Н :©юВЃГ$:©юВГ:”=2KНН :©юК¤Н\:хТ·\ НоНxГА'НоНІГЫ:©ЦЖяџ!х¶ТЦН\НўНН :©юВН€НЖ'Е!Н
НЯНІГЫ:©юВ$Н:ЁюКГ$Н€НІГЫ!N6я'Н :©Цџ!х¶ТCwНЇ	!6 :©юВ^НўНc!Ё6яГ{:ЁЦџ/х>!Ё–џ/БH±Т{ђНЇ	:Ё<2ЈюВЉНПН :©ЦЖяџх:ЁЦ=ЖяџБH±Т®ќНЇ	!§6:§Тѕ:А2БН !6 :©ЦЦџх:х/БHЎТнН€Нѕ!Ё6яГ:©ЦЖяџх>
!Ё–џ/х>К	"}*}DMН†	'НУю К ¤НЇ	Ђ *Ў"Ў!z4Ву
:eТЙ!  "ЎЂ Н†	!z6 :|!zѕЪА'Н?	Ц Цџ2*H#"H!{6 :{ЦЂџ!¦Тў*{& Ђ 	:{ЎеН4К	Б
–Цџ2!{4ГmЂ *Ў"Ў:Ъ№µНЇ	!z4ВI'НУ2!  "ЎЙ!Ђq:Ђю Ъф!у4> !SѕТф:S!уѕТфЙ: 2Ѓ*ЈM !Э		^#VлйяЎНЋЪНИ
*ЎК	:Ђw*Ў#"ЎГГ=Г=Г=Г=Г=ВНЇ	Г*ЂMНжГ! 6ЂГqГ! 6АГqГ! 6ЂГqГ*Ђ& лН Г! 6Г Г! 6 Г Г! 60Г Г*Ђ& лН Г! 6 ГПГ! 6ГПГ! 6ГПГ*Ђ& лН Г
.147:=FP[fqЉ• ®№*ЏMНЙ:ЏЙ> !ъѕТ(:ъ=2ъюВ%>
Й>Й> !шѕТF!ш5+N !Н	~2‘!ч4ЙН<2‘юВT>Й> !bѕТ}*bMН­Тz:b2ч!b6 :щ<2шГ©> !`ѕТҐ*`MН­Тћ!`6 !ъ6>Й:‘ЙГ©:‘ЙГ(Й!’q:щ!’†wO !Н	~2“юВЩ*’& Н	:‘w>Й!‘:“ѕВк!щ4Гп!щ6 > Й:N<2N!МѕЪ>Й*N& Н	NНоЙНт2Ёю ВГЙ!–p+q!х6 !©6 +6 !Є6 :Єю ТS:ЄюВM!Ё6 НgГ8Н:N2M*ЁMН8ТpНБ!©6Й!”6 !—6 >!—ѕЪ•*—& P	6 !—4Вz!ц6 !ш6 #6 #6 !Є6 *ЁMН8ЪЪ:ЄюЪѕЙ:Ёю*ВОН‡ГСНgНт2ЁГЄ:Ёю:Вї:”ю КлЙ:ЄюВ,НЎЦA<2”O>Н-:ЇТ> Й>Й!±p+q:ЇТ,!Ї6 *°DMН9Й:®Т<!®6 НЙ:ЇТzН2ІюВW!®6ГD*њ& L	:Іw:њ<2њюOЪv*Н:ІЙ>ЙН=2№Ц0O>	№Ъ’:№Ц0Й:№ЦAO>№Т¤:Н:№ЦAЖ
ЙН}‡‡‡‡хН}БH±ЙН¬!µ†wЙН»O `iНdеН»бНVЙН[2єO>№Ъ2:єЦЦџ!X¦Ъ!»6:њ!»ѕЪ:»=O !L	NНE!»4ВьНE
НE:єюВ/ЙГЪН.*њ& L	6$LН9kН9Н.НюВXЙГЪЙЏНЇ	Й*KMН^ћ0Нэ20Е¤Н
:0ж20:1ж21ўНк'Ні'Нг:®юяВІҐНЇ	!G6 !  "ЎЙ!яя"џН7	*MН^НnН/	:a/х:БHЎТм!®6я:®юяВъёНЇ	!&6 –џБHЎБH±Т°НЇ	:^!¶w:Ё<2¤:ЁюВ0НПГ}:ЁюВ@НEГ}:ЁЦџ!¦ТS!W6:Јю
Вz!]6:cю Вm!c6:_ю Вz!_6НlНН :©ЦЖяџх:ЁЦ,Жяџх:ЁЦЖяџБHЎБH±Т°јНЇ	:ЁЦЖяџ2§Гі:ЈюВОНEНП:Јю ВЫ Н1:Ґ2МГыv!тq!те*8йЙ!ые*6й:	Й>ъН¦>ъН¦Й  Н Й  Н Й!«q:«ж_ Н ЙН
НЙ!­p+qН.*¬л	Н Й  Н Й  Н Й!Їq*Ї& лН Й!±p+q*°лН 2®Й!іp+q*ІлН 2®Й!µp+q*ґлН 2®Й  Н 2®Й!·p+q*¶лН Й!№p+q*ёлН Й!»p+q*єлН Й!Ѕp+q*јлН 2®Й!їp+q*ѕлДП:Ѓ2 Й!‚q:‚ю	К"*‚MНРГn:cю В4*‚MНРГn:у2ѓ!c:ѓѕЪQ!c:ѓ–2ѓГ:!ѓ:c–w> !ѓѕТn!ѓ5 НРГY:‚юВ{!у6 Й!„q:„Ц Цџ!l¦wТ™ НГў:„Ж0OНЙ!…q:…жшOН|:…жOН|Й!†6:]ЦЦџ2l:o†'2o:nО '2n:mО '2m*mMНЈ*nMНЈ*oMНЈ:]юВ:Н НГ	НЙ*Ў}ж2‰ЂяНD"‡НИ
*‡К	е*‰лН
*‰& "ЎЙ!Љq:UТY:ЉюВYЙ:¦Т©:ЉюК©:_2‹ю К:‹юВЂ!‹6<:ф<2ф!‹ѕЪ!ф6 Н> !]ѕТ¤Нѕ!¦6 :QТМ:ЉЦЦџх:ЈЦ ЦџБHЎТМНЙ:ЉюВЩ!ф6 *ЉMН:Љю
Вн!¦6Й!Њq:ЊЦaџ/х>z!Њ–№ТЙН*ЁMН8Т):Ёю[ВН±!N5!©6ЙГ±:ЄюК5Й!Ў6я#6 >!ўѕЪ°! 6 : <2 O>‘џ/х: !Ў†O !T	е* MНЎб–ЦџБHЎТ~ГK: юВЎ!©6Нтю[В–Н±!N5:ў2ЁЙ:ЎЖ2Ў!ў4В=Й:Ёю[ВјН±Г4:Єю ВИЙ!Є6:Ёю.ВНт2ЁOН8Ъ:ЄюЪмЙ:Ёю*ВьН‡ГяНgГХ:Ёю[ВН±!N5!©6:”ю В%:ь<2”*•6   *•	6 ЙГҐЙ!љq!›6 >
!›ѕЪd*›& I	:љѕВ]>Й!›4ВA> Й:Є<2ЄO *•	:Ёw:Ёю?В†!х6Й!њq!Ё6?!њ:ЄѕТ НgГђЙ!ќq*ќ& л*•~Й!ц6:А2БНт2Ё:ЁЦЦџх:ЁЦ]ЦџБH±Ъє:ЁЦA2ћO>№Т:Ёю ВъНт2ЁГ НЇ	АНэ2*э"ќЙ> !bѕТ!ДНЇ	> !`ѕТ0ФНЇ	Й!јq:јТE:24ГJ!46 *Ў}жю Кa!44НEГJННИ
*KMН^'НЃ:®юяВ‚гНЇ	¤Нк!36 'Нn:®юяКй:0Тг:fЪХН9НOНоюYКТ#Н9Н.3Нк'НіЙН.:0ж20'Н	'Ні'Е7Н
6Нк'НцЙ!яНj>яНA+л!ыsЙ!К" @яН“Ъ1!Ђ"яГ<*эл*я"яНЙК Н“еНnК	" ябНDНn"э"яНЙ:¤Ц Жяџ!Q¦2ЅТ‚Н:X!W¶Т“НЪГ¤Н:Ъ¤*ЁMНEГ“:ЅТ±НН@ЙН@:O2MНcНѕ!ѕ6#6 >!їѕЪ)*ї& P	~ю К":їЦЦџх:їЦЦџБH±х:їЦЦџБH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ТюхxДьсЖ:Г	ц7х*Hл*JлН›К©
~жGсхТ;~ж@В€/2:ж`В€е~·> тH>/Н	х+^+V+~Н	ВMсю/М	г~ж@Вk>*2Н	НлНЎл~·гт„Н+^+VлНЎН0б~·тЏ<<жЖ/Oя	Г|’А}“Й:·КЖЇ)О0Н	ЕЇ)ЏВµЖ0Н	ВІБЙ|НЛ}ЕGНЦxБжЖ0ю:ЪбЖГ	НкГдЇgo":2":*@">л*"ь"ъ"<{•_zњW{_л#"B"Dел>2729"шбНЕН

Т9НQГ-ВBННГ-е !«
		~#foBKй:7·К’ХЕе#:9=лК•*<|’КrТ|Вw}“Т|л"<л*B|’В†}“Ь3бНЕБp#СЙp#Й*D|’КЈТ­ВЁ}“Т­л"Dл*>|’К»Т‰ВА}“Т‰*BDMНыГ‰:7·КяХ:8=Вуе>НЋлгНЬелџжЂw+p+qбС#BНXе++sбСЙs:7·К)*B	гГ)*HЕхл*Jл|ЄG}«°К`~жOсх®ъMю©ВMеA+++ѕВL+В;лбсБЇЙб~·тTyЖ/Oя	ГБюO°wеЇ+w+w+w+ВpС·ет„Їw+w+"JлСБ7Йдэ.m:7·ИЇ27*Bл*<"шН›КіФ3Ьц*@еС*>|’ВВ}“Ил~‡ъЭ_ ·Е+ех!Њ^#Vлсй+++еГ·бV+^+ге*шлЪуN#Fл	лr+sЙбV+^++F+N+"Fгех*ш	слџжЂ26ХНђСХ~s#_~rWН¬ТСЙбV+^++F+N+"FгеЕХџжЂ26лНђеГUНђлr+sл^#VеН¬СТMблгFr#Nsбp+qЙбF+N++V+^+ге*ш	DMл~_q+¶VpИл~_q#Г„:6·ВћDM*B	ЙХл*ъ{•OzњGлСЙ*@Хл*FГ№##|’ВА}“Кк#yѕВ·#xѕВё#~жВ№:6®ъ№~ц@w"FЇ26бЙб}ґ7И>Ђ26·Й*<DM*BНґ±х:їЦЦџБH±х:їЦЦџБH±Ъ"!ѕ6 !ї4ВЙ:ѕТ_ННjЪYНO
НjТM*џ"ЎГS*я"ЎНИ
Г3Н@ГbНl*ѕMН1ЙяяџН“µЖяџЙ!  "А"ДН7	*MН^Ђ Н†	\ Н”!  "В:®ЦяЖяџАВхНЋџБHЎТД*В#"ВН§ГќН/	:®юяВе> ДН›µВб9НЇ	Н.Й*В#"А:®ж‡‡‡‡‡_ !Ђ е'Н
!'6 !36 'ЕН
:1/!a¶ТE*Д#"Д>НzµВ?CН9НIНІГЃЙН.!Ж6>!ЖѕЪ‡*Ж& '	~2Зю КЂ:Жю	Вy.Н*ЗMН!Ж4ВQЙ> !”ѕТ›:”=2ГЎ:ь2Й:цТ¬Н\> !”ѕТї:”=2KГЕ:ь2KЙ!А:БѕКСЙ!:KѕВЮН\ЙН:ЁюКнН\Й!Йp+qН€НЯЕ*И* +щГe$"H"J ш"@Їgo"22! "Г{?No Start Addresу ?Loading Erroт ?Fatal Table Collisioо !@Гo!OГu!…Н”2Ђ *
щНёЇ2НЪrю,КсюКсю/ВrНћдЕюMВЄЂЙюG@ИюRК юSИюUИюEВП Й*Н‘Г  юOВЪ2 ЙЦHВr2GЙ:°2НћГЊ"z·2ДЊЇ2Ђ VЕ!~жюѕwК·ъ:·К~жэѕwВ*:·ИГдН

Ъ*К*yюИ·В*НЪJ~ж@В*ГP"JГ*НкГ**~юВ†:·:К}юЂНGж@Вexж ВЖГxюЂФГn?Command Erroт ~·ИН	#Г”~ж#ю Кћю
Кћю`ЪіЦ юА+ЙХЕ!Ђ ~·GКЯ#~ю ВОГА;x+#Кф~ГФН0>*Н	
:Н >
Н	:;!<е…o> Њ#r#ЙНЊю:7> ВлНћюC?ШЦ@Шл2ФЊxюЪ)ЕлХК<НћГ0бБ>
ђЪMл6 #=тEлyЕ ю.хМЊглХxюЪeКrНћГfсК‡!~ю В‡6R#6E#6LбСy·Й еНћю[ТЄю0ЪЄюAТ¦ю:ТЄГЏOСЙлБЕ:7·ВК|µК)~_q#¶VpлВјГ)Нѓ	:9=Выл>НЋ:8=Кг>Ђ<w+r+s+гНЬгџжЂ<w+p+qГ)Н«	Г)>ЂНЪе/o/g	ЪLгбГ)~ц@wлq+p*ъе}|	"ъ"л*<е	"<Н›DMСбДrНЃГ&!rН”бНa>/Н	Н0Г)~жW+++~Н	+ВhЙ%2nd COMMON Larger Ї *ъ	""<еН”бГ&ББГVzіБИл"ЙЇН~ж@Вб~ц@w+:7·ВД~_q+ГА:8=ВЅл>НЋ6+p+q+6+r+sГ)е!тН”бНaН0Г)%Mult. Def. Glл*DН›Ег"BгБК z”В{•В`i"D*<л*BН›ЪlЙ*Dл*<DM*BНґН›х{•OzњG*<	"DсКaDM*BНr`i"B*Dл*>Н›ЪlЙ|’В|}“ИГrел*BН›Ь3бЙХЕ/Oя*>е	">л*DН›Ъ°*B	DMНыбБСЙ:9=Аеy•oxњg":бЙХ:9=ВТл*:л!  ":лСЙНЕВрХл*B{•OzњGлСЙDM7Й ю  2~2~2~$DTBF7 e$’>             REL   ulmnopqrstuvwxyz t        2~o‰o‰2~2~c‰o‘љ‹                                                   НГ‘Н[=*ѓН6<НЫD:ІюКR*{Н6<Ї2І>Но@*yН6<=ВЧ>>Нф>:ЁН)?>•Нф>>>Нф>:©Н)?>њНф>Гя>лНф>НЫD:Ф·ДЧ
>лНф>>{Нф>>•Нф>>zНф>>њНф>>DM!Н
НЖЙН :©ЦЦџх:ЁЦ=ЦџБHЎЪ-Н\:N2OЙл_ л…oЊgЙ_ {Ґoz¤gЙ^#Vл)е))Б	Й_ {µozґgЙ^#Vл)ВdЙ^#Vл|·g}oВnЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙHВ©=ВЁЙ                                                                                                                                                                                                                                                                                                                                              g6бБСЙ>	хЕХеж_Н бСБсЙ! Гo?File Not Founд >Н	>
Г	P/ELIB/S                                                                       >Ђ2д!Їw#В—!2w!лН <К>я2хЙеХ:д·ьМ_ <2д!е~СбЙЕеН Н Б<КfЇЙ»АЭр	o ·„p  ћ                                                                                                                *|µл!.КuлеН‘!Н”Г0[BEGIN EXECUTIONЭ е:·Кё!о~ж#ВЎНЊН*Ї2Нб>[Н	">Г2НЎН*"еНЎНб Ї•|О ’Нь>]Н	Г0FORLIB  REL	‰яЦ
obal  ЕЇН~++Ъ6	#N+Fж@лбВL	:7·В^	PYOG±В#	|}Г)лб|µК):7·В^	л#q+pГ):7·К·ЕНѓ	БН®	Г)Нѓ	ле>НЋ:8=Кq	>ЂЖw+r+s+6+Сr+sГ)ХеЕ:8=ъ§	жЂ26НЮ	|µК§	Нђ^#VН¬Т›	БбСЙНР	:8=жЂ26НЮ	ЕНђСХ~s#_~rWН¬Тј	БЙ:9=Ае*B	DMбЙе*>"FбЙе!ф~#4Вц	Нґ6ш‡+wбЙ Нз	xGВя	ЙЇ28Нз	Ъ
Ны	7ЙНэ	·К'
Нz
ЇЙеНэ	юхЪ@
юКi
Нэ	Нz
схю
Тi
ХНэ	!ю·wВV
4#6 _ъh
Ны	жw#ГZ
Сс! яюВu
"фO<·бЙх28Ны	XНы	PсюМќ
‡еO !ц	N#Fл	лбЙх:7·К©
сгбЙсЙ)в
)ff	§ff‡х
­Л
ћ™:7·лКЬ
еН”*С"Г)>ЂНЪf+^+Vл"ьГ)бЕ:829=В)тх*"]>2a=2·!яясН«E*wл*ДНЛWDMХ!цяе"wСе*В"ВбСx±КHw#x±В=л"Д!  "уЙ*yН6<:·=х*{Н6<>2ІсВ€>Но@>юНф>*yН6<:Ё<Н)?>ъГ:·=Кґ>Но@>GНф>*yН6<>2ІНЫD>ёНф>>xНф>Гя:Ё=ВЏ*yН6<Н E>ѕНф>*{Н6<>2І=Но@>ЪГ*]|µКп:І·АН4Й>2ІГшP>
НL*Дл0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z a b c d e f g h i j k l m n o p q r s t u v w x y z A B C D E F G H I J K L M N O P Q R S T U V W X Y Z A B C D E F G H I J K L M N O P Q R S T U V W X Y Z ! " # $ 
¬т`ir+s*1лХ*pе"1л"p>2aНшPб"pб"1Н1В№ГгхХЕ~#еюdх<2“НµPсх>?ТN>%Н‡P!€Нт:О·Вg*[НH,Гm!ОНтd o 'i f 'e l s e 'w h i l e 'b r e a k 'n e x t 'f o r 'r e p e a t 'u n t i l '('('('('('('('('('  Й!Q?~#Н‡   	 
     Ў#|µК+л*µН
Т8Н9<сG:C°*Аw:І+wл*Ўл+r+s+"АЙНЛW+~2Іс·ВG+~жюКл*А####Н
ВЙНґ2oЙ·х2–Ї2с2Dgo"иН6схъУНЇ·КЯ=Вс: ·Кс:с·Ке*›НJX:ЁWНкК°Н6?Г¤!:H"Ё*ћ#"ћ@A	"¦>2‹=2·Н2НX*З"›*ЙНGXНL>ГыН0L*¦"ЁНL>Н2юТЁџ НS:зІ>2aГшP!ЧN#FЕНђ	Н+
!ЇеЕНґБбюК1w+ВНґ:s0·	Н‡P!°+еЕ~Н)?БбВKсюPК‘Гн$х!ЇеН+
НґбБwШИ+ЕеГi::ЦИН?\ *›"7ЕеН™б"]##е>2aНшP::ю,бБК‰Е"›НХOс25Й:o·::ВХНю КѕюaЪХю{ТХЦ 2:юAЪЯю[Ърю0Ъйю:ЪнЇ<7Ї=Ї::Gх!o~6 ·xМ!LсЙ!^4! ~юК2:Й:Ј·>/ВНаOюCК!!6CГ:·юКPН4*ЎеН3$>2·>2І:Ь2a2‹*"Ё*"¦*"¤*µ"Л"ЎНИНшPбН6<>2·НшPГ9<>НeНьНґ!ъї5:Н·КёН4‡<2НГ[5НHН]QН\!*Ў"єН:\Н\!*Ў"јН:\Н\!*Ў"ѕГн$: =ВцІК%ХНН!LСюН
ГX!©·~w+В!Й¬!¦ЇЋw#В!Й!¦Ї~w#В/!ЙН$>Н)!Н)!Н!Г)!!Ї·~w+ВO!ВI!ЙНѓ$:І·ИН4ЙН™юТw!:aюАН4oНП$ЇН®E*O"'"%"Ў!  ::ю,ВС!Н^тЁ!Нѓ$НЭГО!НЇ::ю=ВГ!2¦Н$>ЇgoеН®EГг!:·Н¦юВв$*ЎеЇН®E::ю,В">Нa!x¬НК"!|¬НВ{"Нѓ$"%ГЦ!Нѓ$"'ГЦ!*'ЇН«E*%ЇН«E*ЧDMyюEВ+"Нђ	Ї2р!яя|2'"""%НХO::ю,ВP"НґГE"юбВ"|µВr"Н4
Гr"*%#|µКo"Н4tНHDNНђ	ГЕ
Н4s>2oНЈВЛ">(НA\*Ал*µеНЛWгБx±К°"~цЂw++++Гњ"*%"Ў*Ал*µНЛW"%>НэГ„"ЦКШ"=Къ"Н4s::ю=К‰# НЖ#::ю,К„"*%#|µВ™#Гb"::ю(К% & ' ( ) * + , - . / : ; < = > ? @ [ \ ] _ { | } \ 	 ^ ^ ! " # $ % & ' ( ) * + , - . / : ; < = > ? @ [ \ ] _ { | }  	 ! !       *‘Н
Ъj*Џл`iН
ЪjГd*µНЛWЪг~жю7А++V+^лН6<:·ю*§К°:aюКЮ*]еНJ\С+DM*p:a=ИЇgoЙЇ!яяЙлН6<:·юКую7А:aюКЮ*]л:Ko& ГО*Э"Ў:зюК±л*µН
Т:зюВNН9<=ВJ:І=В!©¶И+~оЂwН2*Ў"ЭЙ*ЎлНfXВ±~жВxX~·ъxX++++:зG~жёВxX~жЂВxX++V+^е*ЯН
бВxX###л*µНЛW"Э:ґ2іЙ!Q"*Ў" л*µНЛW"юГ_НьГЈ:зюК:±=КнЇ2°:зюЪЬюЪtюТt*Эл*Я"Эл"ЯГt:зюТЖ*ЯН6<*Ё"Я·В::юКН4vюКBюК`юК42Dю	Ъ~юК~Ї2DГ~:–·ВF\<2–Г-*и|µВ\Н НSН6Їgo"иГ-Н4w*и+"и|·т‹:с·К‘=2сНХOН схты:с·ВысЙНХOГысК\ГNS*и|µВ\сКNSН4f::ю(КБю,Кыю)КыН4Гы:·юТУНњLЇ2ЪГы>2з!с4ГM::ю(К!D45В4:з=К~!  "ЎНS:зюК~юК~ГН4x*и"Ў#"иНSЇ2DГ~Н™Нп
Г
*pеН6<С*—НЛW|µЙ*|µхД6<сВVН4Гh!  "]НЭ*›"]НшPЇхНґН?\*›НJX::Н6?Н^КТ|µВђ::Гэ::юHКюXКюPКю(КOюEКюFКюAКПюIКПюGКюLКП*ЙНGXН4~Н†ю-Кчю'Кю,Кю/Кю)КоГўс=ъЏхГН^КЕюPВК,Ц'Кy·Й: =КХНН!LСЦ'КyЦ В*ХНґСЇЙН4{ЇхН( Ѕ     ё u     СхН)!ВS!¦~іwГ2юAЪoЦ7юЪ:с>'НA\ГґНж$:·=ИН4m>!S6 #=В‰ЙЇ2;<Гт$НЈюРН4iНЇ·Д2:··ЙЇ2·2з2 og""Н
Ї2ІНґъ®OG:І·ВЯ2<2І>2‹yю.Кk:··ВУyЦ'В2І=2 >2·Й:·Вў:ь·Кyю+Књю-КњxЪ‘yюZК-юXВZЕНґБю'ВWН0*Ё|µВф*¦"ЁЇ2І<2·<2‹Г‘2o!І6yюIЪkюOТk5>2·щ!©yКw+еЕНґБбТvю$Кv>Ђ2‹НL>:·ЙН4u2ГД:2:2oГ‘!·6!4:©жрВИН8!ЇН-
::Ц02¬Н!ТИН!>Ђ2©ГИxЪ? ::юEКя>я2зГ.:Ј·ВТWН4hН~#:aюВx#Нї<:ЩG:·Кx#O!p#е*Ўе:Іх*"ЭКb#>2з*ВM#yЪD#Н"ЯНmГb  ЯЕНmБy*ЪD#ГA#*Э"Ўсх2'ГЯ#!'6яГж"НJ\Гг"НњL!'6яГа"*%#|µВ–#Н4tНХ*…"ЎDM*%л*µНЛW++Vp+^qл"%>НэНХO!'6яГж":'·тф#:І2'*Ўехл""НН$с2'>НэбН6<>Гэ!ІѕВН#*"Н
Кп#ГН#:'RATFOR TRANSLATOR - VER 1.0$ $INPUT FILENAME: $ЬRATOUTPUT FILENAME: $FOR** END OF INPUT **$!
$Н5a!&$Н5a!($Н5a!ш#Нц$пШ}µжґЦџ29$·Вq$:$ш#!Ы$НаN"ц#!=$Н5a!ш#Нц$пШ}µжґЦџ29$·ВП$O$ш#!Э$НаN"ц#Н+X!R$Н5aН~  ш=ИН4ЂЅ%Ѕ%(9A1)2;2‚Г"в$ж$к$!*ЭН6<:з=К.=К9=К]=Кj=Кw*ЁНн>"ЁН2"ЭЙ*Ёл*ЯГ$!  "Э*ЁDM*ЯлНЫ>"Ё*Э+"Э|·ъ'Г?*Ял*ЁНЛWГ$*Ял*ЁНsГ$*Я"Э|·*Ё"Я! "ЁтN*Я|µ!  В$Н4Г$:зхНNSс2зЙНґН?\!  "Нi!!  ")л:·юКкН3$:ЬюКа!ЩѕК  Н4Нї<Н№	")л*Ў"—*]л*)НЛW"+*|µК0л*ЎН
В<*+|µКН4::ю,КёНХO:з·КЕ
Г¬*Ў":a2-:a=К*+л*]"]:-юКї2aНшPН1*В++++F+Nл*pлs#r`i"pНшPГ*)л*]"/*p"1*Ўл*Н
К:-=В«Н4Г>2-*"—Н6<!  "+*]л*/НЛW"]|·тХН4*+л*/НЛW"/НJ\л*]л*1+~жю+DM~+ngКоНЕГН†>.НA\Н†ВТ>U>я2 НкВ6: <В/>'Н6?Ї<2oГхХН6?С: <БВxю'ХМ6?СГс<хюЪН4ГЇGgoЕеНґхН6?сбБOт‚T])))Ц0_ ГbyЙН^АН4Й*З"›*ЙНGXНґ>Гт$Н^!  "ЎтХНHН\!:Н·ВЛ*Ў"є"ј"ѕГн$НGЇ2НГЕ
х:Н·>КДІ@сВНЙ$НьНH>йНф>>2::ю,К:Н·Кн$ГЕ
НHЇ2go9"1хНґ>(НA\Н\!:·В6Н†Z*Ўг$ЇґКВе
 	·ВюН:\Нј$НЫD:Ф·К^НЧ
2ФGCНђ	:s0·ВzНЇPНпН*,!ЙНтсхН)?*1+V+^+гелН6<:s0·В¦НЇPНпН*,!ЖНтНў,НМEс=gгВѓ*1щ:Н·ВЕ
2;<Гт$Н4~	DЧ	DB‰2ІхOЖA2Ґ !:T"Ё!>	~4ЖAg:<ЖAo"¦>2·>2‹Н2с2ґъ ю-К ю+К 2o:з·КфНґюQВфНґю.Вф>	2‰Ї2І††YU      |·ъф"Ё:ю-*ЁМн>"Ё:з·К‘т”2oН>Г”Нґъ®Ъ? >2з:··Вд<2o::юNКe>Нa!«hНКИ!«mНВф>я2Ё2©>2‹=2·<2ІНґГ‘Нґю.КµГфxЪ.yЦHВд2І>2‹=2 *Ё}ґВф*¦|·Вф"Ё:ю-В”Н4mГ”!4Нґтф!~‡‡Ъф†ЪфЪфw::Ц0†ЪфъфwНґъ :·!~КH /<л!–Ї2з!¦~#¶#¶#¶К‘> 2:©·ъx !5К!Н)!Гd !~·КК ъ  5Н!Н$>Н!Н!Н!!>†wТd Гф4Н!Н$>Н!Н!Н$>>хНG!Н!с=ВІ Н!Н!Н!Гd ЇН-
>Ђ2¬Н!Те >Ђ2©!4Кф*§"¦:ю-?:©o:g"ЁГXБ%НХj*в$л!ї%>НЏjНyq! "п$*п$)++"с$л*в$"у$*у$НFл*у$s#r*с$л*в$~#foая}µжґЦџ2х$·Кp%*п$)++л*в$"с$!'л*с$s#r*п$#>•> њт%! л*в$"с$!'л*с$s#r! "а$*в$~#foоШ}µжґЦџ2х$·К№%!'"а$*а$Й  	  ncorrect Num"Ж%!  "Д%*Ж%~#foоШ}µжґЦџ/2М%·Вш%*Д%Й! "К%*К%)++л*Ж%~#foоШ}µжґЦџ2М%·ВU&*К%)++л*Ж%"Н%*Н%НЬc++}µжґЦџ2М%·ВK&*Д%Й*К%#"К%Гю%! "Д%Йral String is too largеInvalid Data List Element in I/ПUnbalanced DO NesфIdentifier Too LonзIllegal OperatoтMismatched ParenthesiуConsecutive OperatorуImproper Subs++л*П*"н*~#foчя}µжґЦџ2п**н*~#foая}µжґЦџ!п*¶/2р*·ВP+*С*~#fo#л*С*s#rГш*!  "Н**С*~#fo)++л*П*~#foоШ}µжґЦџ2п*·ВХ+*С*~#fo)++л*П*"н**н*л!Ч*НvE"Х*}µжґЦџ/2п*·В°+ГХ+*Н*л!
 Нtj+л*Х*"Н**С*~#fo#л*С*s#rГV+*Н*Й,|Нж+}Нж+бБЙЕG:r0·В",xНэ+xНэ+БЙжЖ0ю:Ъ‡PЖГ‡PЇГ,Ї)Џ)Џ)ЏНэ+В,бБЙеЇ`Г,е*ЗюеНТ+>'Н‡PбЙе*›юеНТ+>"Г5,еЕХѓ,>·хлN#F#лЇе	Тd,<33ГY,бOс=хЪw,Кw,y·КR,с7хyНэ+сВQ,СБбЙрШьњяцяяяНТ+> Н‡P>(Н‡PНH,>)Г‡PН…P:©ю*ВЮ,*Ўе*]е*§Н6<Н+-*]лбНЛW|·>+тП,>-хН‡Pсьн>НТ+бГ6<:·юх>/М‡Pсх=В->[Н‡P:‹O/_я!«cdef        еNEWRAT  BAK  Ђ©Є«¬­®Ї°±Ііґµ¶ПР FORLIB  REL   ulmnopqrstuvwxyz еNEWRAT  BAK  ЂСТУФХЦЧШЩЪЫЬЭЮЯа@	€    Й€(Hи©СђpћЄЁ†ћќ ЙкЄ‰К©±’°’ЊЋџ52 ЋЂ et„”ДT9А  …•ТSTаet„”ДU1 `h  *А бЮ#`0 fЂ ™@(d§ЄЄ#§ЖF 2zЄўztФl                                                                                                                                                      UNEXPECTED BRACE OR EOF.$UNBALANCED PARENTHESES.$!  "~2:4!о0Н@?"м0ця}µжґЦџ2Ђ2*м0Ея}µжґЦџ!Ђ2¶/2Ѓ2·Вф2Г 4*м0ѓя}µж!А9НјPВ9!5Н@?Шя}µжґЦџ2ї6·В*7!А6НOcЙВ9!5Н@?Ея}µжґЦџ2ї6·ВV7!5Нr[Н}TНі2НтPВ9!5Н@?Ея}µжґЦџ/2ї6·В}7*5НјPГ„8!5Нr[*5НSН}T!­6НgS!Ж9Н$P!  "«6*«6}µжґџ2ї6·ВM8В9!5Н@?"5Ея}µжґЦџ/2ї6·ВФ7ГM8*5Шя}µжґЦџ/2ї6·Вц7*«6#"«6Г8*5Чя}µжґЦџ/2ї6·В8*«6+"«6*5Ўя}µжґЖяџ2ї6*5ця}µжґЖяџ!ї6¦/2Ф6·ВJ8!5НgSГћ7!И9Н$P!И9Н$P*5~#fo##"Х6!Х6Н?Q*«6}µжґџ/2ї6·В„8!Ч6НOc*Ъ#"Ъ! "©6! "§6*§6л*Ъ{•ozњg}µжґџ/2ї6·ВШ8*©6)Ъ"Х6*Х6НеJ#л*©6"©6*§6#"§6Г—8*©6)Ъ"Х6!'л*Х6s#r!  "«6*«6}µжґџ2їcript SyntaшIllegal Integer QuantitщIllegal Hollerith ConstuctioоBackwards DO referencеIllegal Statement Function NamеIllegal Character for SyntaшStatement is out of SequencеMissing Integer QuantitщInvalid Logical OperatoтIllegal Item in Type DMISSING LEFT PAREN.$EndMISSING PARENTHESIS IN CONDITION.$b)!a&Н@?Шя}µжґЦџ2у'·ВQ(!ф'НOcЙ!a&НgS! "с'b)!a&Н@?"_&нШ}µжґЦџ2у'*_&ѓя}µжґЦџ2(*_&…я}µжґЦџ2	(*_&Ея}µжґЦџ!	(¶!(¶!у'¶/2
(·ВМ(!a&Нr[ГH)*_&ця}µжґЦџ/2у'·Вн(!'"a&Г.)*_&Шя}µжґЦџ/2уЕеН…P~Нж+б#БВ ->]Н‡PГ-Н+-сх>/М‡Pсю>LМ‡PЙ:‹O!©~Н‡P+В2-Й
 *›лНW?*wл!†\Н
КW-Н4:b·Кm-*З|µК%.Н4Г%.*|µВ|-:;·д+b."Ь+л"Ю+`i"а+*а+DM*Ю+л*Ь+НЦ@"t-*t-нШ}µжґЦџ2x-·В=.*t-ЊШ}µжґЦџ2x-·ВО-Г=.д+*Ь+Н@M}µжґЦџ/2x-·Вл-Г=.*д+жШ}µжґЦџ/2x-·В".*а+"}-y-*Ю+л*Ь+Н(=д+*Ь+НИGГ(.!д+Нr[*а+DM*Ю+л*Ь+НЦ@"t-Гќ-*t-"Ъ+ЊШ}µжґЦџ/2x-·В^.*Ь+Нm.*Ъ+ЙИ НµPН\ТL."e.! "g.*g.)++л*e.~#foоШ}µжґЦџ2i.·В/*g.)++л*e."j.~#fo¦я}µжґ=ЖЃџ2i.*j.~#foїя}µжґ?џ!i.¦/2l.·Вщ.*g.)++л*e."j.~#fo  л*j.s#r*g.#"g.ґЦџ/2Ђ2·В3!о0Нr[Г 4*м0нШ}µжґЦџ2Ђ2*м0…я}µжґЦџ!Ђ2¶/2Ѓ2·ВS3!‚2НOc!о0Нr[Г 4*м0Ўя}µжґЦџ2Ђ2*м0Фя}µжґЦџ!Ђ2¶/2Ѓ2·ВЖ3:4!\/Н@?ця}µжґЦџ2Ђ2·ВҐ3!\/Нr[*м0Ўя}µжґЦџ/2Ђ2·ВГ3!'"о0Г4*м0Шя}µжґЦџ/2Ђ2·Ви3*~2#"~2Г4*м0Чя}µжґЦџ/2Ђ2·В4*~2+"~2!о0НgS*~2}µжґџ/2Ђ2·В№2*~2}µжґЦџ2Ђ2·В94!›2НOcЙИ    Ђ"=4*=4~#fo#"?4!?4Н?Q*=4НјPЙ  ЙКЛ         "_4л"a4! "c4*c4)++"e4л*_4"g4*e4л*a4"i4*g4~#foл*i4~#fo{•ozњg}µжґЦџ/2k4·Вр4*c4)++л*_4~#foоШ}µжґЦџ/2k4·Вж4! "]4Й*c4#"c4Гy4!  "]4ЙLL "ш4*ш46·В®9В9!5Н@?"5Шя}µжґЦџ/2ї6·В09*«6#"«6ГO9*5Чя}µжґЦџ/2ї6·ВO9*«6+"«6*5Ўя}µжґЖяџ2ї6*5ця}µжґЖяџ2Ф6*«6}µжґ?џ!Ф6¦!ї6¦/2л6·В«9м6ѕ9!5Нюa!5НеJл*©6"©6Гу8*5~#fo#л*5s#rЙ   И  ( ) n0Гв9хЕХем0"Л9*Л9НS! "С9! "П9*П9л*Ъ{•ozњg}µжґџ/2У9·В,:*С9)Ъ"Ф9*Ф9НеJ#л*С9"С9*П9#"П9Гл9*С9)Ъ"Ф9*Ф9НеJ}µжґ=Цџ/2У9·Вf:Н}T*С9)Ъ"Ф9*Ф9НgSНтP*Л9~#fo+"Ф9!Ф9Н?Q*Л9~#fo#"Ф9!Ф9НјP*Ъ+"ЪЙ;>Н;е*м1о1Е–0Нз:о1Н Бб–0Гe:х:p0·К¬7Х:u0·ъq:>Нr;е*к0м0Еu0Нз:м0Н Ббu0Гe:|µИ}жКт:ЖЂж)„`iГF;>Н'·В)*с'#"с'Г.)*_&Чя}µжґЦџ/2у'·В.)*с'+"с'!a&НgS*с'}µжґ=Цџ2у'·В](*с'}µжґЦџ2у'·Вa)!(НOcЙИ MMON Base LowereдILLEGAL BREAK.$ILLEGAL NEXT.$"e)л"g)>!i)Н«x*e)~#fo"m)*m)}µжґ=Цџ/2o)·ВЏ**m))++л*g)"p)~#foгЧ}µжґЦџ2o)*p)~#foдЧ}µжґЦџ2r)*p)~#foжЧ}µжґЦџ2s)*p)~#foйЧ}µжґЦџ!s)¶!r)¶!o)¶/2t)·В…**k)~#foиЧ}µжґЦџ/2o)·Вp**m))++л*i)~#fo#"p)!p)Н?QГ„**m))++л*i)"p)*p)Н?QЙ*m)+"m)Г«)*k)~#foиЧ}µжґЦџ/2o)·Вґ*!u)НOcГє*!„)НOcЙeme"ј**ј*~#foН#qЙеNo Path to0 1 2 3 4 5 6 7 8 9 ' Do "П*л"С**С*~#fo)Гv.Й\ТЫ.>d o   '"/Н}T!	/НgS!7/НГJл*/s#r*/НSНі2НтPЙ !0Нт":/*:/НјP*:/~#fo#"</!</НјPЙm/*
Н6<  НW?   НW?*Y|юшКЇН?GГw/
Program Unit LengthЅ Bytes
Data Area LengthЅ Bytes

Subroutines Referenced:
Љ
Variables:
Љ
COMMON	Length
Љ
LABELS:
Љ Warning(s) IssuedЉ Fatal Error(s) DetectedЉ:a=*]Вb0<2+е*Ўе*pН6<Нў,бН6<>+Н‡PбГТ+Н…PГ?,@’Я   Ђ    RF      REL  =_`abcdef        = NEWRAT  PRN                     NEWRAT  FOR  ЙКЛ             DEWRAT  FORREМPRО  RF      REL  =_`abН5aНхi        RETURN
       END
C
C WHILES - GENERATE CODE FOR END OF WHILE
C
       SUBROUTINE WHILES(LAB)
       INTEGER LAB
       CALL OUTGO(LAB)
       CALL OUTCON(LAB+1)
       RETURN
       END
PB:RF.REL,=B:NEWRAT
                                                            6?COMMAND ERROТ ?FILE NOT FOUNД ?CAN'T ENTER FILЕ ~жНw9·#ИГu6!D6Гђ6!S6Гђ6!c6Нu6Г±6"Ш0* +щ++"i0*Ш0е:q0·В i f ( . n o t . '6MISSING LEFT PAREN.$Ѓ6INVALID FOR CLAUSE.$ Ь©6"5!Д9НГJл*5s#r;>
Н;>Н;СсЙх:n0·К¬7:–0<Кv9ък;геХ*м1|юМ>;#"м1н1Ссхж
 сбQ о1!– <Љ<(80A1)"“:л"•:*=;)—:"?;*=;Їя}µжґ?џ2A;*?;~#foця}µжґЦџ!A;¶/2B;·Вn<C;G;*•:НХj! ";;*;;)—:"?;*?;л!ћ<>НЏj*;;#>P•> њтЎ;Нyq! ";;*;;°я}µжґ=Цџ2A;·В<*;;)—:"?;*?;НFл*?;s#r*;;#";;ГС;!P ";;*;;}µжґ=Цџ/2A;·ВS<*;;)—:~#foая}µжґЦџ2A;·ВI<ГS<*;;+";;Г<*;;)™:"?;!
 л*?;s#r!  "=;*=;#"=;)—:~#foл*“:s#rл"‘:ЙНђi!'л*“:s#r!'"‘:Й   2Щ+V+^л"]:Іов·<<2MISSING LEFT PAREN.$NON-ALPHANUMERIC NAME.$MISSING COMMA IN DEFINE.$DEFI*«@чя}µжґЖяџ2­@*«@ая}µжґЖяџ!­@¦/2®@·В2AГ5AГв@!«@НЩ[! "©@*Ў@~#fo+"Ї@*©@л*Ї@{•ozњg}µжґџ/2­@·ВБA*©@)++л*џ@"Ї@*Ј@л*Ї@Н`N"±@!±@НЬc"ќ@++}µжґЖяџ2­@*ќ@+}µжґЖяџ!­@¦/2®@·В·AГБA*©@#"©@ГAA*Ў@~#fo+"Ї@*©@л*Ї@{•ozњg}µжґџ2­@·ВоA!і@НOc*©@+}µжґ=Цџ/2­@·В9B*©@)++л*џ@"Ї@*Ї@НЩ[*©@)++л*џ@"Ї@!'л*Ї@s#r!t'"ќ@ГОD*џ@~#foЬя}µжґЦџ/2­@·ВЪB! л*џ@"Ї@*Ј@л*Ї@Н`NШя}µжґЦџ/2­@·В’B!{ л*џ@s#r!{ "ќ@ГЧB! л*џ@~#foЧя}µжґЦџ/2­@·ВЖB!} л*џ@s#r!} "ќ@ГЧB! л*џ@"Ї@*Ї@НЩ[ГОD*џ@~#foЮя}µжґЦџ2­@*џ@~#foЩя}µж~#fo{•ozњg}µжґЦџ/2F·В+G*F)В~#fo"FЙ*F#>•> њтзF! "F*F)ц"F*	F~#foл*F~#fo{•ozњg}µжґЦџ/2F·ВG*F)8~#fo"FЙ*F#>!•> њт;G*	F~#fo"FЙ>>iНф>НДG>"Н«: TOO MANY DEFINITIONS.$TAНђ”ѕG”јG"Gл"љG*GНеJ#" G*љGНеJ#"ћG* 8я}µжґ?џ2ўG*л* Gл*ћG$ъ}µжґ=Цџ!ўG¶/2ЈG·В,HЂH*GНГ]!¤GН5a* #" )"јG*#"ѕGл*јGs#rАG~H*GНюa*#л* G"јGДG~H*љGНюa*л* Gл*ћG"Й  К9JхН]QсеHЕЦВћH>Нф>0 1 2 3 4 5 6 7 8 9 ')?=ВїH>Ж"…Hл"‡H`i"‰H*…HНLj"“H!'л*‡Hs#r! "‘H*‘H#"‘H'J!“HН“i"ЏH*‘H)++л*‡H"ЇH*ЏHl4+}µжґЦџ/2(K·ВM*ж"KГ#M!("K*KЙИ rБy!7ѕК<MЕН:\ГєLНХRN",Mл".M* "0M*0M}µжґ=Цџ/26M·ВKN*0M)~#fo"2M! "4M*4M)++л*,M"7M*2M)’"9M*7M~#foоШ}µжґЖяџ26M*7M~#foл*9M~#fo{•ozњg}µжґЦџ!6M¦/2;M·ВвM*2M#"2M*4M#"4MГwM*4M)++л*,M"7M*2M)’"9M*7M~#foл*9M~#fo{•ozњg}µжґЦџ/26M·ВAN*2M#"7M*.M"<M<M7M!”Нюa! "*MЙ*0M+"0MГMM!  "*MЙ х*pеН2бс2"WNл"YN*Ђ}µжґ=Цџ/2]N·В’N*Ђ)Ђ~#foл*WNs#rГ±N! "Ђ)Ђ"^N*YNл*WNНM;л*^Ns#r*Ђ+"Ђ*WN~#fo"UNЙН"Я>2зН€O*"Я >'Н€O"ЖNл"ИN`i"КN>2ШN:ШNЛNoџg"ЬN:NITION TOO LONG.$·MISSING RIGHT PAREN.$"Ј<л"Ґ<>!§<Н«x*«<л!µ<Н`NШя}µжґЦџ2·<·В[=!ё<Н5a*«<DM*Ґ<л*Ј<НЦ@ЊШ}µжґЦџ2·<·В‡=!М<Н5aГ«=*«<л!µ<Н`NФя}µжґЦџ2·<·В«=!г<Н5a!  "і<! "±<*і<}µжґџ2·<·ВЋ>*±<л*©<~#fo{•ozњg}µжґ=Цџ/2·<·Вх=!ь<Нъ4Г„>*±<)++л*§<"=*«<л*=Н`NнШ}µжґЦџ/2·<·В+>!=Нъ4Г„>*±<)++л*§<~#foШя}µжґЦџ/2·<·ВY>*і<#"і<Г„>*±<)++л*§<~#foЧя}µжґЦџ/2·<·В„>*і<+"і<*±<#"±<Г·=*±<)ьял*§<"=!'л*=s#rЙТWН4Ѓ>ѓ_::ю.Кo>ХНґю.СКo>Г >Нґю* Кo>2oГo>!  >)л)лТи>	=Ва>ЙЇ•oњ•gЙG:i n c l u ґЦџ!­@¶/2®@·ВЧC! "©@*©@)++л*џ@"Ї@*Ј@л*Ї@Н`Nл*џ@~#fo{•ozњg}µжґЦџ2­@·ВФC*©@)++л*џ@"Ї@*Ў@~#fo+"±@*©@л*±@{•ozњg}µжґ?џ2­@*Ї@~#foця}µжґЦџ!­@¶/2®@·ВКC!Г@НOc*©@)++л*џ@"Ї@*џ@~#foл*Ї@s#r!EНЩ[ГФC*©@#"©@ГCГОD*џ@~#foЭя}µжґЦџ/2­@·ВD*Ј@л*џ@Н`Nця}µжґЦџ2­@·ВDГуC!
 "ќ@ГОD*џ@~#fo„я}µжґЦџ2­@*џ@~#foЪя}µжґЦџ2®@*џ@~#foГя}µжґЦџ2Т@*џ@~#foЯя}µжґЦџ2У@*џ@~#foДя}µжґЦџ2Ф@*џ@~#foВя}µжґЦџ!Ф@¶!У@¶!Т@¶!®@¶!­@¶/2Х@·ВОD*Ј@DM©@*џ@НІ^*©@)л*џ@"Ї@!'л*Ї@s#r*џ@~#foця}µжґЦџ/2­@·ВE)™H~#foл*ЇHs#r*“Hл!
 Н%j"“H*‘Hл*‰H~#fo{•ozњg}µжґ?џ2±H*“H}µжґЦџ!±H¶/2ІH·ВЬH*‘Hл*‰H~#fo{•ozњg}µжґџ2±H*…H~#fo}µжґџ!±H¦/2ІH·ВҐI*‘H#"‘H)++л*‡H"ЇH!- л*ЇHs#r*‘H+"ѓH! "•H*•Hл*‘H{•ozњg}µжґџ/2±H·В#J*‘H)++л*‡H"ЇH~#fo"—H*•H)++"іHл*‡H~#foл*ЇHs#r*іHл*‡H"µH*—Hл*µHs#r*‘H+"‘H*•H#"•HГІI*ѓHЙ
 :aюК|WARNING: POSSIBLE LABEL CONFLICT.$"*J**JНеJыя}µжґЦџ/2.J·ВІJ! л**J~#foНя}µжґЦџ2.J**J~#foОя}µжґЦџ!.J¦/2/J·ВІJ!0JНOc**JНgSН}TЙ*µШY"їJ*БJ"ЅJ*БJл*їJ~#fo"БJ*ЅJЙКxXюЪ"вJ!  "аJ*аJ)л*вJ~#foоШ}ЧN*ЬNw:ШN<ю	ъоN>2ЩN:ЩNoџg)++л*ИN"ЬN:ЩNЦ=Цџ2ЮN*ЬN~#foл*ЪN{•ozњg}µжґЦџ!ЮN¶2ЯN·ВјO:ЩNЛNoџg"ЬN:ЩNoџg)++л*ИN~#fo}*ЬNw*ЬN~Цaџ2ЮN*ЬN~Цz=Цџ!ЮN¶2ЯN·ВІO:ЩNЛNoџg"ЬN~Ц *ЬNw:ЩN<2ЩNГO>2ШN:ШN2ЮNУNoџg"ЬN:ЮNoџgл!яял*КN~*ЬNw:ШN<юъѕOPМN*ЖNН,|!  "ДNЙ  ;Ъ)"PН}T*PНgSНі2НтPЙН…PсГ0PН"P*L#ёя}µжґџ2!P·В€PНтP! "P*Pъя}µжґџ/2!P·В|P*P)L#""P!  л*"Ps#r*P#"PГFP!* "X#! "L#*L##"L#)L#""P*P~#foл*"Ps#rЙВ«Pc o n t i n u e '
"§P*§P~#fo}µжґ=Цџ/2»P·ВЮP*§PНSН}T!©PНgSНтPЙЎНьН*L#)"мPN#"оPd e 'xѕ#INCLUDES NESTED TOO DEEPLY.$RAT?G:sCAN'T OPEN INCLUDE.$"¬>л"®>*к}µжґ=Цџ/2?·В“@*к)ф"?*?DM*®>л*¬>Н-"Є>*Є>нШ}µжґЦџ2?·Вb@ц>*¬>Нl4}µжґЦџ/2?·В®?*Є>Й*к)ф"?*?DMљ@!є>Н-"¶>*кыя}µжґџ2?·Вй?!	?НOcГB@*к)"?ц"(?%?є>*(?НаN"°>*?м"*?! л**?s#r*°>пШ}µжґЦџ/2?·В;@!,?НOcГB@*к#"к*к)ф"?*?DM*®>л*¬>Н-"Є>Гy?*к+}µжґ=Цџ/2?·В‰@*к)ф"?*?Нѕ**к+"кГG?!'"Є>Й Oя	юх~еН)?бс=#Вў@Й>ГхTOKEN TOO LONG.$MISSING QUOTE.$Нф>>"џ@л"Ў@`i"Ј@*Ј@л!«@Н`NнШ}µжґЦџ2­@·В5A*к)к"Ї@~#fo#л*Ї@s#r*ќ@Й
 1EН E"E!9EНГJл*Es#r*EНPEЙ ·:ai f ( . n o t . '"<EН}T!>EНgSН-(!lEН$P*<EН?QЙ) ·К†E:Ё·"qEл"sE! "oE*oE)++л*qE~#foоШ}µжґЦџ2uE·ВвE*oE)++л*qE~#foл*sE~#fo{•ozњg}µжґЦџ/2uE·ВШE*oEЙ*oE#"oEГѓE!  "oEЙхd e f i n e '''шE!кEНИGЙF*Ў|"	F*	F~#foл*|{•ozњg}µжґЦџ/2F·В<F*~"FЙ! "F*F)ю"F*	F~#foл*F~#fo{•ozњg}µжґЦџ/2F·ВѓF*F)~#fo"FЙ*F#>
•> њт?F! "F*F)&"F*	F~#foл*F~#fo{•ozњg}µжґЦџ/2F·ВЧF*F)Z~#fo"FЙ*F#>•> њт“F! "F*F)Ћ"F*	F~#foл*FµжґЦџ2дJ·ВK*аJ#"аJГоJ*аJЙ2І>2aНшPНKС" K'M* KН@?ця}µжґЦџ/2(K·ВPKГ/K* K~#fo"Kѓя}µжґЦџ2(K*K…я}µжґЦџ2)K*KЕя}µжґЦџ2*K*KнШ}µжґЦџ!*K¶!)K¶!(K¶/2+K·ВёK*KЙ* KНП%+}µжґЦџ/2(K·ВЩK!("KГ#Mr* KНl4+}µжґЦџ/2(K·ВэK*К"KГ#Mx* KНl4+}µжґЦџ/2(K·В!L*О"KГ#M‚* KНl4+}µжґЦџ/2(K·ВEL*Т"KГ#Ml* KНl4+}µжґЦџ/2(K·ВiL*Ж"KГ#MЋ* KНl4+}µжґЦџ/2(K·ВЌL*Ц"KГ#Mљ* KНl4+}µжґЦџ/2(K·В±L*Ъ"KГ#M¤* KНl4+}µжґЦџ/2(K·ВХL*Ю"KГ#M¬* KНl4+}µжґЦџ/2(K·ВщL*в"KГ#Mє* KН!
 л*оPs#r*мPP#"рP!'л*рPs#r.Q!N#НГ]!  "L#Й wg o t o   '"1QН}T!3QНgS*1QНSНтPЙл++r+sЙ:Ф"XQ*XQ~#foл*~{•ozњg}µжґЦџ/2\Q·В‹Q*|"VQЙ! "ZQ*ZQ)"]Q*XQ~#foл*]Q~#fo{•ozњg}µжґЦџ/2\Q·ВТQ*ZQ)ю~#fo"VQЙ*ZQ#>
•> њтЋQ! "ZQ*ZQ)Z"]Q*XQ~#foл*]Q~#fo{•ozњg}µжґЦџ/2\Q·В&R*ZQ)&~#fo"VQЙ*ZQ#>•> њтвQ! "ZQ*ZQ)В"]Q*XQ~#foл*]Q~#fo{•ozњg}µжґЦџ/2\Q·ВzR*ZQ)Ћ~#fo"VQЙ*ZQ#>•> њт6R! "ZQ*ZQ)8"]Q*XQ~#foл*]Q~#fo{•ozњg}µжґЦџ/2\Q·ВОR*ZQ)ц~#fo"VQЙ*ZQ#>!•> њтЉR*XQ~#fo"VQЙ"/НJ\СНЛW:9·КSл*-леНЛWґЦџ29$·В  O$ш#!  Н6 "ц#Н  !R$Н? 2ЪЙ"в$ж$к$!  Н  *в$л!  >Н  Н  ! "п$*п$)++"с$л*в$"у$*у$Н  л*у$s#r*с$л*в$~#foая}µжґЦџ2х$·К  *п$)++л*в$"с$!"Ж%!  "Д%*Ж%~#foоШ}µжґЦџ/2М%·В  *Д%Й! "К%*К%ILLEGAL ELSE.$Ш}µжSTACK OVERFLOW IN PARSER.џ2уILLEGAL RIGHT BRACE.$5VЗW5VЗWUNEXPECTED EOF.$НьE! "ЕW!'"эV!ЎTН,K"ЗW*ЗWнШ}µжґЦџ2ЙW·ВM[*ЗWлЧ}µжґЦџ/2ЙW·В{X!3VН"EГsY*ЗWжЧ}µжґЦџ/2ЙW·ВњX!3VН/ГsY*ЗWйЧ}µжґЦџ/2ЙW·ВЅX!3VН>iГsY*ЗWдЧ}µжґЦџ/2ЙW·ВЮX!3VНр6ГsY*ЗWгЧ}µжґЦџ/2ЙW·ВяX!3VНѕaГsY*}µжґ?џ!Ж\¶/2З\·В}]*Д\}µжґ=Цџ2Ж\·В;]И\М\*\НШjНyqГw]П\Х\*\НШj! "В\*В\)\"У\*У\л!µ]>НЏj*В\#л*Д\л{•zњтJ]Нyq!  "Д\*\~#foця}µжґЦџ2Ж\·Вґ]*Д\#"Д\)\"У\*\Н_Qл*У\s#rЙ   !о0Н  *~2}"є]л"ј]*ј]л! ^НЫ\! "ѕ]*ѕ])++л*є]~#foоШ}µжґЦџ2А]·В^*ѕ])++л*є]"Б]*ј]л*Б]НЫ\*ѕ]#"ѕ]ГЪ]Й  TP
       . g e . '. g t . '. l t . '. l e . '. n e . '. n o t . '. e q . '. a n d . '. o r . 'G(26)aINaIGa6)aEXaHRa3)aINaHRa"#^л"%^`i"'^! л*#^"‹^*'^л*‹^Н`NГя}µжґЦџ2Ќ^·Вш^! л*#^"‹^*‹^НЩ[*#^~#fo";;ГД *;;"Ј<л"Ґ<>!§<Н  *«<л!µ<Н  Шя}µжґЦџ2·<·В  !ё<Н  *ERROR AT LINE.$ЊШ"“b!=cН5a! "9c*9cл*к{•ozњg}µжґ=Цџ2Lc·ВІcНc!СcНЫ\*9c)к"McЛc•b*McН·H";cНc!•bНГ]*9c#"9cГ^cНc!УcНЫ\Нc!ПcНЫ\*“bН5aЙQ  
   :  *±<)++"Шc*Шc~#foЗя}µжґ=ЖЃџ2Ъc*Шc~#foРя}µжґ?џ!Ъc¦/2Ыc·В d! "ЦcГ¬d*Шc~#fo†я}µжґ=ЖЃџ2Ъc*Шc~#foџя}µжґ?џ!Ъc¦/2Ыc·Вad! "ЦcГ¬d*Шc~#fo¦я}µжґ=ЖЃџ2Ъc*Шc~#foїя}µжґ?џ!Ъc¦/2Ыc·Вўd! "ЦcГ¬d*Шc~#fo"Цc*ЦcЙН  Г  *к)"?"±dл"іd>!µdН«x*±d~#fo+}µжґ=Цџ/2№d·В1g*±d~#fo)++л*іd~#fo…я}µС|·ъS"зRXSйR*зRН·H"S! "яR*яRл*S{•ozњg}µжґ=Цџ2S·ВWS*яR)зR"S*SН$P*яR#"яRГSЙ
 Ж2ќџхБyж *"[S! "_S*_S)++л*[S~#foоШ}µжґЦџ2cS·ВxT*_S)++л*[S~#fo"]SЮя}µжґЖяџ2cS*]SЩя}µжґЖяџ!cS¦/2dS·ВЪS!]SН$PГnT*_S#"_S"aS*aS)++л*[S~#foл*]S{•ozњg}µжґЦџ2cS·ВT*aS#"aSГдS*aSл*_S{•ozњg"eS!eSНS!yTН$P*_Sл*aS{•ozњg}µжґџ/2cS·ВnT*_S)++л*[S"eS*eSН$P*_S#"_SГ3T*_S#"_SГpSЙh Ъ*L#ъя}µжґџ/2|T·ВќT!ћTН$PГ}TЙ  ++"Д*Влkb####Н\	*ДН
Т©TНWWxюВ‘S!ќ~ЦwГ‘S*Дшя"Д:ќ·ВU*Э"и:Ы·КW*Я"ЭНРVЇ2Ъ*Э"ЎЗWмЧ}µжґЦџ/2ЙW·В Y!ЎTНRJГsY*ЗWкЧ}µжґЦџ/2ЙW·ВsY*ЕW)ыV~#foлЧ}µжґЦџ/2ЙW·ВmY*ЕW)3V"КW*КWНA4ГsY!МWНOc*ЗW…я}µжґЦџ2ЙW*ЗWмЧ}µжґЦџ2ЪW*ЗWжЧ}µжґЦџ2ЫW*ЗWгЧ}µжґЦџ2ЬW*ЗWдЧ}µжґЦџ2ЭW*ЗWйЧ}µжґЦџ2ЮW*ЗWкЧ}µжґЦџ2ЯW*ЗWлЧ}µжґЦџ!ЯW¶!ЮW¶!ЭW¶!ЬW¶!ЫW¶!ЪW¶!ЙW¶/2аW·В~Z*ЕW#"ЕWњя}µжґ=Цџ/2ЙW·ВOZ!бWНъ4*ЕW)"КWыV"ъW*ЗWл*ъWs#r*КW3V"ьW*3Vл*ьWs#rГA[*ЗWѓя}µжґЦџ/2ЙW·ВКZ*ЕW)ыV~#fo…я}µжґЦџ/2ЙW·ВБZ*ЕW+"ЕWГЗZ!юWНOcГ&[*ЗWеЧ}µжґЦџ/2ЙW·ВлZ!ЎTН	PГ&[*ЗWзЧ}µжґЦџ2ЙW*ЗВя}µжґЦџ/2Ќ^·В__! л*#^~#foГя}µжґЦџ/2Ќ^·ВJ_*#^"Ћ^Ћ^a!-^НюaГ\_*#^"’^’^a!7^НюaГa*#^~#foДя}µжґЦџ/2Ќ^·ВЖ_! л*#^~#foГя}µжґЦџ/2Ќ^·В±_*#^"–^–^a!K^НюaГГ_*#^"љ^љ^a!A^НюaГa*#^~#foЯя}µжґЦџ/2Ќ^·В-`! л*#^~#foГя}µжґЦџ/2Ќ^·В`*#^"ћ^ћ^a!U^НюaГ*`*#^"ў^ў^a!_^НюaГa*#^~#foГя}µжґЦџ/2Ќ^·В—`! л*#^~#foГя}µжґЦџ/2Ќ^·В`*#^"¦^¦^a!k^НюaГ”`! л*#^"‹^!'л*‹^s#rГa*#^~#foЪя}µжґЦџ/2Ќ^·ВИ`*#^"Є^Є^a!u^НюaГa*#^~#fo„я}µжґЦџ/2Ќ^·Вщ`*#^"®^®^a!Ѓ^НюaГa! л*#^жґЦџ/2№d·ВeГ1g*±d~#fo)++л*іd"єd*·d~#foкЧ}µжґЦџ2№d*єd~#foлЧ}µжґЦџ!№d¦/2јd·В]eГ1g*±d~#fo)++л*іd~#foлЧ}µжґЦџ/2№d·В e*±d~#fo)++л*µd"єd*єdНјPГg*±d~#fo)++л*іd~#foкЧ}µжґЦџ/2№d·Вf*±d~#fo++}µжґ=Цџ/2№d·Втe*±d~#fo+л*±ds#r*±d~#fo)++л*µd~#fo#"єd!єdНјPГg*±d~#fo)++л*іd~#foжЧ}µжґЦџ/2№d·ВUf*±d~#fo)++л*µd"єd*єdН>/Гg*±d~#fo)++л*іd~#foйЧ}µжґЦџ/2№d·Вf*±d~#fo)++л*µd"єd*єdНuiГg*±d~#fo)++л*іd~#foдЧ}µжґЦџ/2№d·ВЫf*±d~#fo)++л*µd"єd*єdНЦ9Гg*±d~#fo)++л*іd~#foгЧ}µжґЦџ/2№d·Й*Влkb 	Н\	*ДН
ВU*Ял:ЫG*В~ж°w#:ґw#s#rГЅT:Ы·КCU>2з:Ъ·К’T!з>–w=К’T*µл*ЭН
Ъ’TЇ2ЪГtU!Ъ:Ы®wГ’TН(WГ’T*Ял*µНЛWЪ¦U~жюЪ¦UюТ¦Uл!µO 	Fл~жа°wГ›TН(W:і2ґ:Ъ·ДЮV*Э"Я>2зЇ2Ъ:і=КГ’T*В####~оЂwГ›T:з2*В"Ї2:°=КV:±·КKV:ЪНэVНWНЇW!4*В####"Вл*Д++++лН
Т1VНЈV:з!ѕКнU*"В:·ВDVНЈVГ8TЇ2Г$V*µе*Эл*ЯН
Ъ^VС>бКVН
ТVГыUНWWx2зy2і*В~жЂ2ЪЇ2°##^#V*µл"ЭН
ШН6<=А:І·А<2°Й*Ве####"ВНkV!
$Н  !&$Н !($Н
 !ш#Н  пШ}µжґЦџ29$·В :$ш#!  Н  "ц#!=$Н !ш#Н пШ}µжWиЧ}µжґЦџ!ЙW¶/2ЪW·В&[XэV!ЕWН’)!ЎTН,K"ЗW!ЎTНr[XэV!ЕWНЅd!ЎTН,K"ЗWГCX*ЕW+}µжґЦџ2ЙW·Вg[!XНOcЙ+ЊШ}µж"i[*i[НеJ"m[*m[}µжґ=Цџ/2o[·В±[*m[)++л*i["p[*p[НЩ[*m[+"m[Г~[Йє[НкTOO MANY CHARACTERS PUSHED BACK.$·"і[*Ђ#"ЂФю}µжґ=Цџ/2µ[·Вя[!¶[Нъ4*Ђ)Ђ"Ч[*і[~#foл*Ч[s#rЙ)++л*e."j.~#fo¦я}µжґ=ЖЃџ2i.*"/Н  !	/Н  !  Н  л*/s#r*":/*:/Н  *:/~#fo!  "~2  !о0Н  "м0ця}µжґЦџ2Ђ2*м0Ея}µжґЦџ!Ђ2¶/2Ѓ2·В  Г  *м0ѓя}µжґЦџ/2Ђ2·В  !о0Н     *·]·](/)·]·]ґЦ(80A1)"\л"\*\~#foця}µжґЦџ2Ж\*Д\Їя"‹^!'л*‹^s#r*#^НеJл*%^s#rЙ 6#"§6$§µaµa)(1X,100A1)"a>2"a:"a2!a:"aoџgл!яял*a~!#a–Цџ2$a·Вla:"a<юeъ:a:!a=2!a%a+a!·aНШj>2"a:"aoџgл!яял*a")a*)aл!іa>Н›j:"a!!aѕ<ЪЃaНyqЙ    {•ozњ"єa!кaНјP!мaНГJл*єas#r*єaНјP*єa~#fo#л*єas#rЙ   П9Г *С9)Ъ"Ф9"пaл"сa>!уaН«x*хa~#fo"щa*сa~#fo"чa*чa)++л*пa~#foоШ}µжґЦџ2ыa·Вyb*щa)++л*уa"ьa*чa)++л*пa~#foл*ьas#r*щa#"щa*чa#"чaГ!b*щa)++л*уa"ьa!'л*ьas#rЙЦџ2A;·В  *;;)—:"?;*?;Н  л*?;s#r*;;#";;Г„ !P ";;*;;}µжґ=Цџ/2A;·В  *;;)—:~#foая}µжґЦџ2A;·В  ГЧ *;;+Вg*±d~#fo)++л*µd"єd*·dл*єdНОh*±d~#fo+л*±ds#rГМdЙЦџ!­@¶/2®@·В  ! "©@"E!  Н  л*Es#"<EН  !>EН  Н  !  Н  *<EН"qEл"sE! "oE*oE)++л*qE~#foоШ}µжґЦџ2uE·В  *oE)++л*qE~#fшE!кEН  Й•ozњ"	F*	F~#foл*|{•ozњg}µжґЦџ/2F·В  *~"FЙ! "F*F)ю"F*	F~#foл*F~#fo{•ozњg}µжґЦџ/2F·В  *F)~#fo"FЙ*F#>
•> њт/ ! "F*F)&"F*	F~#foл*F~#fo{•ozњg}µжґЦџ/2F·В  *F)Z~#fo"FЙ*"Gл"љG*GН  #" G*љGН #"ћG* 8я}µжґ?џ2ўG*л* Gл*ћG$ъ}µжґ=Цџ!"3gл"5g*3gНS*5g~#foвЧ}µжґЦџ/2Лh·Вi!7gН,K"Йh~|/W}/_*р~"р~Й:т~юВњoНtu:L~G:·ъ(mЂxx2K~Н‰l:·т7mЇ2O~Нr:·тXmх0НSr!K~5Кimс<ВFmх:K~·ъimКimНаqГYmEНSr:M~!–2M~ъЂm+Г‡m-/<2M~НSr:M~_ !
 НSxсе{Ж0GНSrг}Ж0GНSrсЙ:т~юВњoНtu:L~G!M~:†wЂ·ъИmН‰lЇ2O~:L~2K~:M~·ъбm2O~!K~†wНrх:M~/·ъn*р~"о~!яя"р~Наq!M~4Выm*о~"р~НаqГn:т~юВњoНtu:M~·ъm!L~/<†ъmw!Щ~~Цw2м~!~хЇw<2н~Нґmс2Ї2н~>2м~х НSrГSn*к~л*д~DM*еХЕН©nБСб+|µВhn"л"к~Гot*к~л*д~FеНSr*к~#"к~*+"|µб#ВЊnГot!м~:@~O5КМn:?~№КСn*=~ 	~2
·!@~qЙ>яГГn> ГГn:г~юIВo:L~·КйnН[vљ*х~|µКхnН[v:·КTu*у~|:ш~=тs!	4*щ~"к~Г€s2ш~Вot*я~+"я~|µКot*щ~"к~!ш~4Гot!<~6:ч~·ВRs:@~·ВLs<*=~6 2?~Нv:<~2@~·И:ч~·Вqs>Ђ2?~ !S~p#=ВksДнsЇ2@~Гot!	~·К€sЇwГ—s*:~+":~|·шµИГ—s:	·В3s*|µКot+":R~2L~Ї22M~2<~go"у~"х~:Щ~!м~w:ч~·КХs4*й:т~G*6~у~~#ВЯs"6~ГСsЇГ5qЇ2<~go"у~*к~л*д~~#ю Кtю-Вt<~
оГtл"к~2
GЦ0ъ;tю
Т;t*у~T])))_ Гчs*у~|µВFt#xЙ:<~·КWtЇ•o> њg"у~|µxЙ*у~л*х~xLCZUН‰xajSXЙНсs"ВЊtю,Кotю/К3sю)К sю'КџrюPВљt:у~2Гotх|·тЄtН[v! "с2г~  !'uѕКГt#ю	ВґtН[vЂyO!Bu:ч~·КУt!0u	^#Vл"yюТпtл*к~"р~л>x2м~йНсsВщtН[vЃ}2Щ~Ї2R:5~<25~W:2~єСТyбЙгбЙd~#fo)++л*µd"єd*єdН  Г  *±d~#          ~#foгЧ}µжґЦџ/2№FORT DAT  ГПj {Вz zhz[z[y=z!2y: _~Й!;y:‡_ ^#VЙНly·фТyж@~А:_ !(y6 !|"~Нxy! Їw#В®yХНf|Н <СВЛyН <К[yНly>АwЙе*л!y:‡ O	s#r!Ђ еНxyСr+sл6 #Qyw#·Выy:GЦ
џЖ1wxю
ЪzЇЖ0#w> #w#Uyw#·В z "б>ЂwT]ця	6 лЙНly‡т[y6Ђ‡тNz‡ьЙ{НxyНf|Н ЇЙНlyж@Д=zН‡yЇЙН‡yюаК[yж Мь{6ш*=~ел*?~& лЇъЋzw#Г…zСН НxyН ·И7ЙН‡yюрК[y6а*=~лН Нxy>Ђ2?~Н ·ЙН‡yюаК[yж Мь{Ї2Zy:?~·Ие*=~г~6рюр:?~бх>М§{~ю+К{ю1Вяz>Н§{Г{ю*3g~#fo+"Мh!МhНPEГ%i*3g~#fo+"Мh!МhН?Q*3g~#fo#"Мh!МhНјPЙл*‡H"Ї"8i!niНјP!liНГJл*8is#r*8iНS*8i~#fo#"<i!<iНPEЙ   }µж"qi*qiН?Q*qi~#fo#"si!siНјPЙбгЙНVwzіИ|µИ|ЄхХлН%jбсьXjлЙНдi> 2S~!PA"T~!US"V~!E "X~>2?~>2!S~"=~НvНнs:S~юTК~ЙбгZ~~#ВлiгйНдi> 2S~!ST"T~!OP"V~!  "X~>2?~>2!S~"=~НvГ~лzіКHjz·BьXj|ЁG|µИ|·льXjЕНSxс·ьXjлЙН[v‰~#fo|·льXjлЙЇO“_yљWЙ!~/wЇoђG}›_}љW}™OЙ|µИл|µИDM!  >)л)лТЉj	=В‚jЙх>Гћjх>Гћjх>2т~сНЅxНСx~#fo"Ч~НСxШ"6~*Ч~":~:·КЙjНнkГЇjН—sГЇjН[vЇЙ>юЇ2ч~~#fo"л~#¶+Воj!  "д~!ж~>Н«x*ж~~#¶В/g}/o#"у~ГTu> 2<~!L~:N~·В&o:Ы~·В&o:R~w~/<G:Ы~·xВ6o!–2M~НЋq:ц~·КTu!<~~ђw:M~·В‚o*у~л*х~{z €_}€W|€o:<~Тko<g}жo:·К{o}цЂo"х~лГo!9oеъЌoНйvЙН°wЙ:т~=К o=К«oН[vљ:у~oџg"у~Ї2х~>2ц~Нtu:M~Н‰l:M~2K~2O~ НrН©nю ВФo>0ю0Ъеoю:ТеoЦ02
·Й>я·ЙЇ2L~2N~НТpю-В p>2Гpю+ВpНТp·ъTu!@~5!м~4Н–p:
ю.В-p>2N~2M~Н–p:
·ъЦnюE В=pНТpю+КLpю-ВQp>2<~НТpy2Ы~!@~5!м~4 ЕНКoБъpOxю
ЪtpН[v>	··ЂЃGГ_p:<~·xК‰p/<2M~G!L~~ђwГЦnНКoш*х~O|жрВ–pGЕT])))л*у~DM))	О )Б	"у~& o"х~!L~:M~†wГ–pН©nю КТpЙ:Щ~2м~НТpъњoюFКфpюTВњo>яюЇ2у~Н©nтшpГT~yюЪu:
ю.В#uНсs*у~}2R~*к~+"к~Г{sН[v‚XH(AILEFGv[nѓrckйoЫpйoйoйo7v„nѓrґk‘oqm©mn:т~G*6~у~w#В^u"6~*|µКotГ{s!ц~~·КvЦx2<~Їw:т~=Кќu=Кќu+>Ђ¦2>Ђ¶wГіu++~·тюu/W+~/_s#r>27Ф°wНЋq!<~~ђwИтґuЖтПuНйvГ·uВпu*у~е*х~еНйvСбТ·u"у~л"х~!M~4Ї/ЖGН[t"х~л"у~Й+¶Віu2<~go"у~"х~!M~4Й>Г5q*@~|·В,v…Ъ,vГotН[v:?~Гotе НSr*+"|µВ8vбГot:т~жG:Щ~ђ2M~Йб~#е·хO *=~е:х:?~х!Э~+"=~>2>2?~!­v	^#Vл"Я~Нvс2?~с2б"=~:Ъ~<2Ъ~юТ~сРГ~IDF0MPIRFWITPRDOMLDZLGSQIBTLOBDEISBEINOVCNGLGSSNA2IODTBIRCEF!<~>†w!M~5Н[tеХН[t0>
М§{>
Н§{с#=К{х~Н§{Г{:Zy·И7ЙН‡yюрК[y6аЇ2?~2ZyНk{Ъf{жю
К1{юКi{х*?~& л*=~сwл"?~юКf{}юЂЪ1{Н[vЇЙ:Zy·Й!(y: _~·МЋ{Ш5!y/ЖЃ†_#> ЋW·ЙеХНf|НxyН 2Zy·Сб>ЂwИ7Йех!(y: _~·ьз{4!y†_#> ЋWсбЙ‡ш>Н§{>
Н§{>Н§{!(y: _~·ИеХНf|НxyН 2ZyСбЇwЙеНxyНf|Н Нly6ЂН‡yбЙ !2y~‡Х{2ь=zС{юВ|Й~юТ[y2ХНly·ЕфТyБНxyлС
w·КT|#wВH|:‡ _!Aw^yp+qЙЕХ:‡_ !y^#VН СБЙ Ў|¤|Ў|Ў|Ў|Ў|Ќ|:~|·КЎ|>Нл|Нь|Ї2~|ЙГПj:~|·Мч|:?~·И*=~=х>Нл|~ю+КЭ|ю1ВН|>Нл|ГЭ|>
Нл|~ю0ВЭ|>
Нл|с#Их~#Нл|с=ГЯ|ехж_Н сб>2~|Й}?k!  "ж~*и~~#¶Вk!  "и~Ї2ш~2	222н~go"к~":~*д~|µ!S~"=~КOkНсs*к~"щ~ю(КZsН[v€2@~2?~<2:ч~·И>Г5qНMv*у~л*х~ХеН©nбСъ…kюВ~k> ZUlgГmk:M~/<ъ™kК™kZUl& =Вђk2M~:т~юКЄkл=ВЄkZ"х~л"у~ГTuНMv:M~·ъПkКПk хНSrс=ВГk2M~х:у~GНSr*у~л*х~ZUl& "х~л"у~ГРk:ч~·Кl:@~O:?~2 *=~	л*6~Н1ly2@~"6~Й:?~O >Ђ2*6~л*=~	Н1ly2?~лГl:т~G:=‘ТqlеХ:ч~·В[l:2?~>Н5qСб *=~Г1l>Н5q:?~2*=~лбб Г1lw#В5lе*:~+":~|µбВ1lЙ<ю	Ъ‘l>G>02A~!A~#еЕНйvБ!M~4б:ц~жЖ0wл*у~Ї))))"у~*х~))))…o"х~лВљl"р~~Ђю:ЪиlЦ
w+ГШlwл!A~|єВэl}»Вэl!M~4лю#"Pu!у~~·Кq>T>Fw> #w#w#wГґk}2>
Г5q}2>Г5q}2>Г5qO!Aw:ѕТПj·КПj=_ ^#Vл 	^#Vл[qХйЪkqИ*и~|µВwqН[vќ*ж~|µВwqН[v…Сй:!<~w·К8s:ч~·А>Г5q*у~л*х~ |·ВВqµВ©qІВІqіВ»qЙejSXГВqл  ГВqch  |·ъЧq{_zW}o|gГГq"х~л"у~xЙ!K~5шВсq:о~·*ъSr!р~50ъSr*P~F#"P~ГSr!Щ~~ђ!–!K~–2о~К#rтDr†2K~/т?r:·-ДSr!O~5т9r.НSrЙНаqГ,rН[vЙ НSr!о~5ВDrГ#r:?~!@~ѕЪnr^4 *=~p!м~5АГrrН[vбб:н~·А:·КotГ{s!ш~~4·КђrН[v*р~"щ~*"я~Гot!x "м~*к~л*д~:ч~·КЦr~ю'КЗrеХН©nСбw#Гґr#~ю'Кєrл"к~Гot~ю'КнrGеНSr*к~#"к~б#ГЦrл*к~#"к~л#~ю'КЬrГotг"у~Сб{ЌozЊg"х~Й*wХН[vяяJ!qЙx!·ь4wF#~жЂ©OГywАААЂ4АГwэ||э|э|э|^y^y^y^y^y~#foл~#foлЙеН‡wбs#r#q#pГ™wН‘wеН|wбЙН™wл"л`i"Й*л*DMЙ^#V#N#F#x·ИyГЁw:·И:џ·7АЖЙ*у~л*х~"ЇOGgo""х~>2Н1xНx:=2КйwН1xНxН1xН1xГКw*)€oyО g"у~Т x*х~#"х~!M~4ЙХе*л*}‹o|Љg"> €G> ‰O*х~> Ќo> Њg"х~бСЙ)е*}o|g"xGyO*х~}o|g"х~бЙ|/G}/O!  >х·Гnxхе	Тmxс7>б{_zW}o|gс=Вdx|·g}oЙ ЦЪ–xCZQ Г‰xЖ	oЇ-ИyOzW{_xGГ™xл`iN#F#лq#p#л=В®xЙ22~"ы~л"э~`i"3~Ї25~ЙеХ:5~юТжx!ы~‡_ Гъxх:2~ю*3~ЪяxсЦ‡_ ~#foхс}}}}}}ЇЙГПjЇ2?~Н“}жю
К}х*?~& л*=~сwл"?~юИ}юЂЪ}Н[vЇЙ:?~·И*=~=х>Н„}~ю+Кv}ю1Вa}>Н„}Гv}>
Н„}~ю Кv}ю0Вv}>
Н„}с#Их~#Н„}с=Гx}ЕХех_Н сбСБЙе*~~ю
М¤}#~"~бЙЕХ
Д}Н !Е}^ л#6#>
Н„}wлСБЙP 
 IF(.NOT.(EQUAL(LEXSTR, SUNTIL) .EQ. 1))	 GOTO 23251
       LEX = VUNTIL(1)
   Ж}1~!$~е*~й>
Н„}>Н„}Г  ЙTINUE
       LEX = 10267
23252  CONTINUE
23250  CONTINUE
23248  CONTINUE
23246  CONTINUE
23244  CONTINUE
23242  CONTINUE
23240  CONTINUE
23238  CONTINUE
23236   **TI**E
23234  CONTINUE
       RE
22 DATA DAMAGES,DESTRUCT,DOCK,IDLE,IMPULSE,LRSCAN,NAVIGATE,PHASERS,QUIT
23 DATA SHIELDS,SOS,SRSCAN,STATUS,TORPEDO,TRANSFER,VISUAL,WARP,SHORT
24 DATA MEDIUM,LONG,BEGINNER,NOVICE,SENIOR,EXPERT,COURSE,WCOST,ICOST
25 DATA PEFFECT,SCORE,END,ANTARES,SIRIUS,RIGEL,MERAK,PROCYON,CAPELLA
26 DATA VEGA,DENEB,CANOPUS,ALDEBARAN,ALTAIR,REGULUS,BELLATRIX,ARCTURUS
27 DATA POLLUX,SPICA,10.5,12,1.5,9,0,3,7.5,6,4.5
28 DEF FNA(X)=INT(8*RND(X))+1:DEF FNB(X)=INT(10*RND(X))+1
29 DEF FND(X)=X/60
30 DEFFNR(X)=INT(X*10+.5)/10
290 REM - DESTRUCT
291 GOSUB36000:GOTO70
300 REM-DOCK
301 GOSUB7000
310 GOTO70
325 REM-IOLE
326 GOSUB33000
330 IFJ3=0THEN70
331 IFA2<>0THEN900
332 IFG(Q1,Q2)=1000THEN750
340 GOSUB1000
345 GOTO70
350 REM-IMPULSE
351 GOSUB13000
352 IFJ3=0THEN70
353 GOTO700
375 REM-LRSCAN
376 GOSUB14000
377 GOTO70
400 REM-NAVIGATE
401 GOSUB34000
402 IFJ3=0THEN70
410 GOTO700
425 REM-PHASERS
426 GOSUB20000
427 IFJ3=0THEN70
428 GOSUB1000
429 GOTO70
450 REM-QUIT
455 GOTO900
460 PRINT"TOO BAD...WE H020 IFK3=0THENRETURN
1030 IFA2<>0THENRETURN
1040 P2=1/I8
1050 J5=0
1060 PRINT
1070 IFC5$="DOCKED"THEN1780
1080 H2=0:H3=0:C6=1
1090 IFS9=1THENC6=.5+.5*RND(1)
1100 A3=0
1110 FORL=1TOK3
1120 IFK6(L)<0THEN1540
1130 A3=1
1140 D6=.8+.05*RND(1)
1150 H4=K6(L)*D6^K8(L)
1160 IF(S4=0)AND(S9=0)THEN1230
1170 P3=.1:IFP2*S3>P3THENP3=P2*S3
1180 H5=P3*C6*H4+1
1190 IFH5>S3THENH5=S3
1195 S3=S3-H5
1200 H4=H4-H5
1210 IF(P3>.1)AND(H4<.005*E1)THEN1540
1230 J5=1
1240 PRINTFNR(H4);"UNIT HIT ON THE ";S5$;" FROMTURN
       END
C
C LOOKUP - LOCATE NAME, EXTRACT DEFINITION FROM TABLE
C
       INTEGER FUNCTION LOOKUP(NAME, DEFN)
       INTEGER DEFN(200), NAME(200)
       INTEGER I, J, K
       INTEGER EXTDIG
       INTEGER INTDIG
       INTEGER EXTLET
                                                                                                                                                                                                                                                                   0:DEFFNS(X)=INT(X*100+.5)/100
40 FORI=1TO12:READD$(I):NEXT:FORI=1TO20:READC$(I):NEXT
43 FORI=1TO3:READT$(I):NEXT:FORI=1TO4:READS$(I):NEXT:FORI=1TO6
44 READC2$(I):NEXT:FORI=1TO16:READG1$(I):NEXT:FORI=1TO9:READC5(I):NEXT
45 REM CALL SETUP
46 GOSUB24000:S7$(1)="":S7$(2)="  ":S7$(3)=" ":S7$(4)=""
70 IFA2<>0THEN900
75 J4=0:T1=0:PRINT:INPUT"COMMAND";A$:IFLEN(A$)>1THEN110
80 PRINT"USE AT LEAST 2 LETTERS, PLEASE.":GOTO75
110 FORI=1TO20
120 IFA$=LEFT$(C$(I),LEN(A$))THEN150
130 NEXT
135 INPUT"ILLEGAL COMMATE TO LOSE GOOD ASTRONAUTS!"
465 GOTO37010
475 REM-SHIELDS
476 GOSUB26000
477 IFJ3=0THEN70
478 IFA2<>0THEN900
479 GOSUB1000
480 S9=0
485 GOTO70
500 REM-SOS
501 GOSUB11000
502 GOTO70
525 REM-SRSCAN
526 GOSUB29000
530 GOTO70
540 REM - STATUS
541 PRINT
545 GOSUB37000:GOTO70
550 REM-TORPEDOS
551 GOSUB21000
552 IFJ3=0THEN70
555 GOTO700
575 REM-TRANSFER
576 GOSUB31000
580 IFJ3=0THEN70
585 IFA2<>0THEN900
590 IFG(Q1,Q2)<>1000THEN70
595 GOTO750
600 REM-VISUAL
601 GOSUB32000
602 IFJ3=0T ";
1250 J6=K4(L):J7=K5(L)
1260 IFQ$(J6,J7)="K"THENPRINT"KLINGON AT";
1270 IFQ$(J6,J7)="C"THENPRINT"COMMANDER AT";
1280 PRINTJ6;"-";J7
1290 IFH4>H2THENH2=H4
1300 H3=H3+H4
1310 IFH4<(275-25*S8)*(1+.5*RND(1))THEN1530
1320 N4=1+INT(H4/(500+100*RND(1)))
1330 PRINT"***CRITICAL HIT--";
1340 K9=1
1350 FORW4=1TON4
1360 J9=INT(12*RND(1))+1
1370 C5(W4)=J9
1380 E3=(H4*D5)/(N4*(75+25*RND(1)))
1390 IFJ9=6THENE3=E3/3
1395 D4(J9)=D4(J9)+E3
1400 IFW4=1THEN1470
1420 FORV=1TOW4
1430 IFJ9=C5(V-1)THEN1480
11 REM   *** SUPER STAR TREK ***
2 REM     INTELLEC MDS VERSION
3 REM WRITTEN IN BASIC BY RON WILLIAMS
4 REM      INTEL CORP. - 5/15/76
5 REM ADAPTED FROM A FORTRAN VERSION WRITTEN
6 REM    FOR THE CDC 6600 IN 1974.
7 DIM G1$(16),V$(5,5),C$(20),G(8,8),D$(12),Q$(10,10),D4(12),D9(106)
10 DIM S2(8,8):Q$="?"
15 DATA S.R. SENSORS,L.R. SENSORS,PHASERS,PHOTON TUBES,LIFE SUPPORT
20 DATA WARP ENGINES,IMPULSE ENGINES,SHIELDS,SUBSPACE RADIO
21 DATA SHUTTLE CRAFT,COMPUTER,TRANSFER PANEL,ABANDON,CHART,COMPUTERAND - DO YOU NEED A LIST";B$
136 IFLEFT$(B$,1)="N" THEN70
140 PRINT:FORI=1TO20STEP4
141 PRINTC$(I);TAB(12);C$(I+1);TAB(22);C$(I+2);TAB(32);C$(I+3)
142 NEXT:PRINT:GOTO70
150 ONIGOTO200,225,250,275,290,300,325,350,375,400
160 ONI-10GOTO425,450,475,500,525,540,550,575,600,625
170 PRINT"ERROR AT 170 - SHOULD NOT BE HERE"
180 STOP
200 REM-ABANDON
201 GOSUB 35000
210 GOTO70
225 REM-CHART
226 GOSUB 3000
230 GOTO70
250 REM-COMPUTER
251 GOSUB5000
260 GOTO70
275 REM-DAMAGES
276 GOSUB8000
280 GOTO7HEN70
603 IFA2<>0THEN900
610 IFG(Q1,Q2)<>1000THEN70
615 GOTO750
625 REM-WARP
627 GOSUB25000
630 GOTO70
700 REM-AFTERMOVINGSTARSHIP
710 IFA2<>0THEN900
720 IFT1<>0THENGOSUB9000
730 IFA2<>0THEN900
740 IFG(Q1,Q2)<1000THEN790
750 GOSUB2000
760 IFA2<>0THEN900
770 GOTO740
790 GOSUB1000
795 GOTO70
900 REM-WE'RE FINISHED
901 PRINT:PRINT:INPUT"WOULD YOU LIKE TO TRY AGAIN";A$
910 IFLEFT$(A$,1)="Y"THEN45
920 GOTO460
940 REM-BEGINSUBROUTINES
1000 REM-ATTACK
1010 IF(C3<>0)AND(J4=0)THENGOSUB16000
1440 NEXTV
1450 K9=K9+1
1460 IFK9=3THENPRINT
1465 PRINT " AND ";
1470 PRINTD$(J9);
1480 NEXTW4
1490 PRINT " DAMAGED."
1500 IFD4(8)=0THEN1530
1510 IFS4<>0THENPRINT"*** SHIELDS KNOCKED DOWN."
1520 S4=0
1530 E1=E1-H4
1540 NEXTL
1550 IFA3=0THENRETURN
1560 IFE1<=0THEN1750
1570 P4=100*P2*S3+.5
1580 IFJ5<>0THEN1610
1590 PRINT"KLINGONS ATTACK--SHIELD STRENGTH REDUCED TO ";
1600 GOTO1650
1610 PRINT"ENERGY LEFT:";FNS(E1);"   SHIELDS ";
1620 IFS4<>0THENPRINT"UP,";
1630 IF(S4=0)AND(D4(8)=0)THENPRINT"N2190
2160 PRINT"IMPULSE ENGINES DAMAGED."
2165 F9=8
2170 GOSUB10000
2180 RETURN
2190 P2=.75*E1
2200 D6=.004*(P2-50)
2210 D7=1.4142+1.2*RND(1)
2220 D1=D6
2230 IFD6>D7THEND1=D7
2240 T1=D1/.4
2250 D2=12*RND(1)
2260 J4=0
2270 GOSUB13200
2280 GOTO2400
2290 W1=6+2*RND(1)
2300 W2=W1*W1
2310 P2=.75*E1
2320 D6=P2/(W1*W1*W1*(S4+1))
2330 D7=1.4142+2*RND(1)
2340 D1=D6
2350 IFD6>D7THEND1=D7
2360 T1=10*D1/W2
2370 D2=12*RND(1)
2380 J4=0
2390 GOSUB34500
2400 IFJ4<>0THEN2440
2410 F9=8
2420 GOSUBOR I=1TO3
4110 IFA$=LEFT$(T$(I),LEN(A$))THEN4150
4120 NEXTI
4130 PRINT"WOULD YOU LIKE A SHORT, MEDIUM OR LONG GAME";
4140 GOTO4095
4150 L2=I
4160 PRINT"ARE YOU A BEGINNER, NOVICE, SENIOR OR EXPERT PLAYER";
4170 INPUTA$
4180 FORI=1TO4
4190 IFA$=LEFT$(S$(I),LEN(A$))THEN4220
4200 NEXTI
4210 GOTO4160
4220 S8=I
4230 INPUT"ENTER YOUR MISSION PASSWORD...";X$
4244 PRINT
4245 PRINT"....SETTING UP THE GALAXY...."
4250 J=RND(1)
4260 REM-INITIALIZE
4270 D5=.5*S8
4280 I2=INT(L2+1+RND(1)*3)
4290 IFI2>+(K-1)/10:K=INT(A4-K*100)
5233 IF(K<1)OR(K>10)THEN5990
5234 C6(2)=C6(2)+(K-1)/10
5235 X=Q1+((S6-1)/10)-C6(1):Y=Q2+((S7-1)/10)-C6(2)
5236 D1=0:D2=0:IF(X=0)AND(Y=0)THEN5250
5237 D1=SQR(X*X+Y*Y)
5238 IFX<0THENZ7=SGN(Y)*(3.1416-ATN(ABS(Y/X)))
5239 IFX=0THENZ7=SGN(Y)*1.5708
5240 IFX>0THENZ7=ATN(Y/X)
5245 D2=12-Z7*1.9098593:IFD2>12THEND2=D2-12
5250 PRINT"COURSE IS";FNS(D2);" FOR A DISTANCE OF";
5260 PRINTFNS(D1);"QUADRANTS.":GOTO5040
5300 REM-COST FOR WARP DRIVE
5302 INPUT"ENTER DISTANCE AND WARP FACDOWN, ";
1640 IFD4(8)>0THENPRINT"DAMAGED, ";
1650 PRINTINT(P4);"%"
1660 IF(H2<200)AND(H3<500)THEN1800
1670 J8=INT(H3*RND(1)*.015)
1680 IFJ8<2THEN1800
1690 PRINT
1700 PRINT"MCCOY - 'SICKBAY TO BRIDGE.  WE SUFFERED ";
1710 PRINTJ8;"CASUALTIES"
1720 PRINT"          IN THAT LAST ATTACK'"
1730 C4=C4+J8
1740 GOTO1800
1750 F9=5
1760 GOSUB10000
1770 RETURN
1780 PRINT"*** KLINGONS ATTACK-- STARBASE SHIELDS PROTECT ";
1790 PRINT"THE ";S5$
1800 FORW4=1TOK3
1810 K8(W4)=K7(W4)
1820 NEXTW4
1830 GOSUB210000
2430 RETURN
2440 IFR1<>0THENRETURN
2450 F9=1
2460 GOSUB10000
2470 RETURN
3000 REM-CHART
3001 PRINT:PRINT"      1   2   3   4   5   6   7   8"
3010 PRINT"     --- --- --- --- --- --- --- ---"
3020 FORI=1TO8
3030 PRINTI;" ";
3040 FORJ=1TO8
3060 ONSGN(S2(I,J))+2GOTO3070,3090,3110
3065 PRINT"ERR AT 3065":STOP
3070 PRINT" .1.";
3080 GOTO 3160
3090 PRINT" ...";
3100 GOTO3160
3110 IFS2(I,J)>1000THEN3150
3120 IFG(I,J)<1000THENPRINTS7$(LEN(STR$(G(I,J))));STR$(G(I,J));
3130 IFG(I,J)=1000THEN5THENI2=5
4300 R3=I2
4310 I5=7*L2
4320 R5=I5
4340 R7=(S8-2*RND(1)+1)*S8*.1+.1
4350 IFR7<.2THENR7=R7+.1
4360 I1=INT(2*R7*I5)
4370 R1=I1
4380 I4=INT(S8+.0625*I1*RND(1))
4390 R2=I4
4400 I3=(I1+4*I4)*I5
4410 R4=I3
4420 RETURN
5000 REM-COMPUTE
5001 IFD4(11)=0THEN5030
5010 PRINT"LIBRARY COMPUTER DISABLED"
5020 RETURN
5030 PRINT"----LIBRARY COMPUTER ACTIVE----"
5040 INPUT"PROGRAM NAME";B$
5050 FORI=1TO6
5060 IFB$=LEFT$(C2$(I),LEN(B$))THEN5120
5070 NEXT
5080 PRINT"VALID PROGRAMS ARE:"
5090 PRTOR";D1,A4
5304 IF(D1<0)THEN5040
5310 C7=D1*A4*A4*A4
5315 T1=(10*D1)/(A4*A4)
5320 PRINT"IT WOULD TAKE";FNS(T1);"STARDATES AND USE"
5325 PRINTFNR(C7);"UNITS OF ENERGY  (";FNR(C7+C7);"IF SHIELDS ARE UP)"
5330 GOTO5040
5400 REM-COST FOR IMPULSE POWER
5410 INPUT"ENTER DISTANCE...";D1
5420 IFD1<0THEN5040
5430 C7=250*D1+50:T1=D1/.4
5440 PRINT"IT WOULD TAKE";FNR(T1);"STARDATES AND USE"
5450 PRINTC7;"UNITS OF ENERGY"
5460 GOTO5040
5500 REM-PHASER EFFECTIVENESS
5510 INPUT"ENTER PHASER RANGE IN QUADRAN8000
1840 RETURN
2000 REM-AUTOVER
2001 PRINT
2010 IFJ4=0THEN2050
2020 PRINT"*** RED ALERT!  RED ALERT!"
2030 PRINT"***THE ";S5$;" HAS STOPPED IN A QUADRANT ";
2040 PRINT "CONTAINING A SUPERNOVA."
2050 PRINT "*** EMERGENCY AUTO-OVERRIDE ATTEMPTS TO HURL ";
2060 PRINTS5$
2070 PRINT"   SAFELY OUT OF THE QUADRANT."
2080 S2(Q1,Q2)=1
2090 GOSUB18000
2100 IFD4(6)=0THEN2290
2110 PRINT
2120 PRINT"WARP ENGINES DAMAGED."
2130 PRINT
2140 PRINT"ATTEMPTING TO ENGAGE IMPULSE ENGINES..."
2150 IFD4(7)=0THEPRINT" ***";
3140 GOTO3160
3150 PRINTS2(I,J)-1000;
3160 NEXTJ
3170 PRINT
3180 NEXTI:GOSUB18400
3185 PRINT
3190 PRINT"THE ";S5$;" IS CURRENTLY IN ";G2$;" (";Q1;"-";Q2;")"
3200 RETURN
4000 REM-CHOOSE
4001 FORI=1TO10:PRINT:NEXT:FORI=1TO41:PRINT"*";:NEXT:PRINT
4002 PRINT"**";TAB(39);"**"
4003 PRINT"**  WELCOME TO THE WORLD OF STAR TREK  **"
4008 PRINT"**";TAB(39);"**":FORI=1TO41:PRINT"*";:NEXT:PRINT
4010 PRINT:PRINT
4070 S8=0:L2=0
4090 PRINT"HOW LONG A GAME WOULD YOU LIKE";
4095 INPUTA$
4100 FINT"  COURSE    WCOST   ICOST"
5100 PRINT"  PEFFECT   SCORE   END"
5110 GOTO5040
5120 ON IGOTO5200,5300,5400,5500,5600,5700
5200 REM-COURSE&DIRECTION
5210 INPUT "ENTER QUADRANT AND SECTOR - ";A3,A4
5220 IF(A3<>INT(A3))OR(A4<>INT(A4))THEN5990
5221 IFA3<0THEN5040
5222 IFA3=0THENA3=10*Q1+Q2
5223 A3=A3+.5
5225 K=INT(A3/10)
5226 IF(K<1)OR(K>8)THEN5990
5227 C6(1)=K:K=INT(A3-C6(1)*10)
5228 IF(K<1)OR(K>8)THEN5990
5229 C6(2)=K:A4=A4+.5
5230 K=INT(A4/100)
5231 IF(K<1)OR(K>10)THEN5990
5232 C6(1)=C6(1)TS";A3
5520 IFA3<0THEN5040
5530 A3=A3*10:C7=(.9^A3)*100
5540 PRINT"PHASERS ARE ";LEFT$(STR$(C7),5);"% EFFECTIVE AT THAT RANGE"
5550 GOTO5040
5600 REM- SCORE
5610 GOSUB23000
5620 GOTO5040
5700 RETURN
5990 PRINT"FORMAT IS MN,XXYY...WHERE MN IS THE QUADRANT"
5991 PRINT"AND XXYY IS THE SECTOR...E.G. 64,0307 REFERS"
5992 PRINT"TO QUADRANT 6-4, SECTOR 3-7."
5993 PRINT"NOTE: SECTOR COORDINATES MUST BE 4 DIGITS."
5995 GOTO 5040
6000 REM - DEADKL
6001 IFT2$<>"C"THEN6100
6010 C3=0:PRINT"***COMMANDER AEADY DOCKED!'"
7110 RETURN
8000 REM-DREPORT
8001 J=0
8003 PRINT
8005 FORI=1TO12
8010 IFD4(I)<=0THEN8070
8020 IFJ<>0THEN8060
8030 PRINT"     DEVICE";SPC(12);"-REPAIR TIMES-"
8040 PRINTSPC(21);"IN FLIGHT    DOCKED"
8050 J=1
8060 PRINT"  ";D$(I);TAB(23);FNS(D4(I));TAB(33);FNS(D3*D4(I))
8070 NEXTI
8080 IFJ=0THENPRINT"MR. SPOCK - 'ALL DEVICES FUNCTIONAL, CAPTAIN'"
8090 RETURN
9000 REM-EVENTS
9001 M=0:D7=D0+T1
9010 FORL=1TO5
9020 IFF1(L)>D7THEN9040
9030 M=L:D7=F1(L)
9040 NEXTL
9050 X6=D7-D0:DLLED TO QUADRANT";Q1;"-";Q2;", SECTOR";S6;"-";S7
9301 IFR6<>0THENPRINT"(REMAINDER OF IDLE PERIOD CANCELLED)"
9302 R6=0
9303 IFS4<>0THEN9320
9304 IF(D4(8)=0)AND(S3>0)THEN9310
9305 PRINT"(SHIELDS NOT CURRENTLY USABLE.)"
9307 GOTO9320
9310 GOSUB26500
9315 S9=0
9320 GOSUB18000
9325 F1(2)=D0+T1-1.5*(I5/R2)*LOG(RND(1))
9326 GOTO9001
9330 F1(2)=1E30:GOTO9001
9340 D9(1)=D0:D9(2)=R1:D9(3)=R2:D9(4)=R3:D9(5)=R4:D9(6)=R5
9342 D9(7)=S1:D9(8)=B1:D9(9)=K1:D9(10)=K2
9343 FORI=1TO8:FORJ=1TO8:D9(I-1+8*(J-1)+11R(R3=0)THEN9001
9485 K=INT(G(B4,B5)/100):IFG(B4,B5)-K*100<10THEN9001
9490 FORI=1TOR2:IF(C1(I)=B4)AND(C2(I)=B5)THEN9520
9510 NEXT:GOTO9001
9520 IFS2(B4,B5)=-1THENS2(B4,B5)=0
9530 IFS2(B4,B5)>999THENS2(B4,B5)=S2(B4,B5)-10
9540 IF(B4<>Q1)OR(B5<>Q2)THEN9630
9550 FORI=1TOK3:K=K4(I):L=K5(I)
9560 IFQ$(K,L)="C"THEN9570
9565 NEXT
9570 IFK6(I)<25+50*RND(1)THEN9001
9580 Q$(B6,B7)=".":B6=0:B7=0
9590 GOSUB17000
9600 PRINT:PRINT"MR. SPOCK-  'CAPTAIN, I BELIEVE THE STARBASE HAS";
9610 PRINT" BEEN DESTROYED.'T";
6020 FORF=1TOR2
6030 IF(C1(F)=Q1)AND(C2(F)=Q2)THEN6050
6040 NEXTF
6050 C1(F)=C1(R2):C2(F)=C2(R2):C1(R2)=0:C2(R2)=0
6060 R2=R2-1:F1(2)=1E30
6070 IFR2<>0THENF1(2)=D0-(I4/R2)*LOG(RND(1))
6080 K2=K2+1
6090 GOTO6120
6100 PRINT"***KLINGON AT";
6110 K1=K1+1
6120 PRINTA5;"-";A6;"DESTROYED."
6130 Q$(A5,A6)=".":R1=R1-1
6140 IFR1=0THENRETURN
6150 R5=R4/(R1+4*R2)
6160 G(Q1,Q2)=G(Q1,Q2)-100
6170 FORF=1TOK3
6180 IF(K4(F)=A5)AND(K5(F)=A6)THEN6200
6190 NEXTF
6200 K3=K3-1
6210 IFF>K3THEN6250
6220 FO0=D7
9060 R4=R4-(R1+4*R2)*X6
9070 R5=R4/(R1+4*R2)
9080 IFR5>0THEN9120
9090 F9=2
9100 GOSUB10000
9110 RETURN
9120 IF(D4(5)=0)OR(C5$="DOCKED")THEN9180
9130 IF(L1>=X6)OR(D4(5)<=L1)THEN9160
9140 F9=3:GOSUB10000
9150 RETURN
9160 L1=L1-X6
9170 IFD4(5)<=X6THENL1=J1
9180 R=X6
9190 IFC5$="DOCKED"THENR=X6/D3
9200 FORL=1TO12
9210 IFD4(L)<=0THEN9230
9220 D4(L)=D4(L)-R
9225 IFD4(L)<0THEND4(L)=0
9226 IFD4(L)<>0THEN9230
9227 PRINT:PRINT"DAMAGE CONTROL-  '";D$(L);" NOW OPERATIONAL.'"
9230 NEXTL
9240 I)=G(I,J):NEXTJ:NEXTI
9344 FORI=75TO84:D9(I)=C1(I-74):NEXT
9345 FORI=85TO94:D9(I)=C2(I-84):NEXT
9346 FORI=95TO99:D9(I)=B2(I-94):NEXT
9347 FORI=100TO104:D9(I)=B3(I-99):NEXT
9348 D9(105)=B4:D9(106)=B5
9349 S0=1:F1(3)=D0-.3*I5*LOG(RND(1)):GOTO9001
9350 REM - STARBASE ATTACK
9355 IF(R2=0)OR(R3=0)THEN9400
9360 FORI=1TOR3:FORJ=1TOR2:IF(B2(I)=C1(J))AND(B3(I)=C2(J))THEN9410
9370 NEXTJ:NEXTI
9380 F1(4)=D0+.5+3*RND(1)
9390 F1(5)=1E30:GOTO9001
9400 F1(4)=1E30:F1(5)=1E30:GOTO9001
9410 B4=B2(I):B5=B3(I)
94"
9620 GOTO9680
9630 IF(R3=1)OR(D4(9)>0)THEN9680
9640 PRINT
9650 PRINT"LT. UHURA-  'CAPTAIN, STARFLEET COMMAND REPORTS THAT"
9660 PRINT"  THE STARBASE IN QUADRANT";B4;"-";B5;"HAS BEEN"
9670 PRINT"  DESTROYED BY A KLINGON COMMANDER.'"
9680 G(B4,B5)=G(B4,B5)-10
9690 IFR3<=1THEN9730
9700 FORI=1TOR3:IF(B2(I)=B4)AND(B3(I)=B5)THEN9720
9710 NEXT
9720 B2(I)=B2(R3):B3(I)=B3(R3)
9730 R3=R3-1
9740 GOTO9001
10000 REM-FINISH
10001 A2=1:PRINT:PRINT"IT IS STARDATE";FNR(D0):PRINT
10010 ONF9GOTO10020,10130,1RG=FTOK3
6230 K4(G)=K4(G+1):K5(G)=K5(G+1):K6(G)=K6(G+1)
6235 K7(G)=K7(G+1):K8(G)=K7(G)
6240 NEXTG
6250 K4(K3+1)=0:K5(K3+1)=0:K7(K3+1)=0:K8(K3+1)=0:K6(K3+1)=0
6260 RETURN
7000 REM-DOCK
7001 IFC5$="DOCKED"THEN7100
7010 IFB6=0THEN7020
7015 IF(ABS(S6-B6)<=1)AND(ABS(S7-B7)<=1)THEN7040
7020 PRINTS5$;" NOT ADJACENT TO A BASE."
7030 RETURN
7040 C5$="DOCKED"
7050 PRINT"HELMSMAN SULU - 'DOCKING MANEUVER COMPLETED.'"
7060 E1=I7:S3=I8:T4=I9:L1=J1
7070 RETURN
7100 PRINT"MR. SULU - 'BUT CAPTAIN, WE'RE ALRFM=0THENRETURN
9250 T1=T1-X6
9260 ONMGOTO9270,9290,9340,9350,9470
9270 REM-SUPERNOVA
9280 X2=0:Y2=0:GOSUB27000
9285 F1(1)=D0-.5*I5*LOG(RND(1))
9286 IFG(Q1,Q2)=1000THENRETURN
9287 GOTO9001
9290 REM-TRACTOR BEAM
9291 IFR2=0THEN9330
9292 IFC5$="DOCKED"THEN9325
9293 I=INT(RND(1)*R2)+1
9294 Y6=(C1(I)-Q1)^2+(C2(I)-Q2)^2
9295 IFY6=0THEN9325
9296 Y6=SQR(Y6):T1=.17778*Y6
9297 PRINT:PRINT"***";S5$;" CAUGHT IN LONG-RANGE TRACTOR BEAM--"
9298 Q1=C1(I):Q2=C2(I)
9299 S6=FNB(1):S7=FNB(1)
9300 PRINT"   PU20 IF(B4=Q1)AND(B5=Q2)THEN9380
9430 F1(5)=D0+.5+3*RND(1)
9440 F1(4)=F1(5)-.3*I5*LOG(RND(1))
9450 IFD4(9)>0THEN9001
9455 PRINT
9460 PRINT"LT. UHURA-  'CAPTAIN, THE STARBASE IN";B4;"-";B5
9461 PRINT"  REPORTS THAT IT IS UNDER ATTACK AND CAN HOLD OUT"
9462 PRINT"  ONLY UNTIL STARDATE";FNR(F1(5));"'"
9465 IFR6=0THEN9001
9466 PRINT
9467 INPUT"MR. SPOCK-  'CAPTAIN, SHALL WE CANCEL THE IDLE PERIOD";B$
9468 IFLEFT$(B$,1)="Y"THENR6=0
9469 GOTO9001
9470 REM - STARBASE DESTROYED
9475 F1(5)=1E30:IF(R2=0)O0160,10185,10195,10205,10220,10235
10015 ONF9-8GOTO10245,10270,10280
10020 REM-THE GAME HAS BEEN WON
10025 PRINT"YOU HAVE DESTROYED THE KLINGON INVASION FLEET"
10027 PRINT
10030 PRINT"     ***THE FEDERATION IS SAVED***":G1=1
10035 IF(A1=0)OR(B1<>0)THEN10110
10040 IFLEFT$(S5$,1)<>"E"THEN10110
10045 IF3*S1+35*N1+C4>=100THEN10110
10050 IFD0-J2<=6THEN10070
10060 R8=.1*S8*(S8+1)+.1
10065 IF(K1+K2)/(D0-J2)<R8THEN10110
10070 PRINT
10075 PRINT"IN FACT, YOU HAVE DONE SO WELL THAT STARFLEET COMMAND"
1000175 PRINT"YOUR STARSHIP IS A DERELICT IN SPACE."
10180 GOTO10300
10185 REM-ENERGY GONE
10190 PRINT"YOUR ENERGY SUPPLY IS EXHAUSTED.":GOTO10172
10195 REM-BATTLE DEFEAT
10200 PRINT"THE ";S5$;" HAS BEEN DESTROYED IN BATTLE."
10201 GOTO10300
10205 PRINT"F9=6 INVALID":RETURN
10220 REM-NOVA
10225 PRINT"YOUR STARSHIP HAS BEEN DESTROYED BY A NOVA."
10230 PRINT"NICE SHOT, YOU HOCKEY PUCK!":GOTO10300
10235 REM-SUPERNOVA
10240 PRINT"THE ";S5$;" HAS BEEN INCINERATED BY A SUPERNOVA."
10241 GOTO10300
1024550
10340 PRINT"HIGHLY UNFAVORABLE TO THE FEDERATION.":GOTO10350
10345 PRINT"THE FEDERATION WILL BE DESTROYED!"
10350 GOSUB23000:RETURN
10355 PRINT"SINCE YOU TOOK THE LAST KLINGON WITH YOU, YOU ARE"
10360 PRINT"A MARTYR AND A HERO.  SOMEDAY MAYBE THEY'LL ERECT"
10370 PRINT"A STATUE IN YOUR MEMORY.  REST IN PEACE AND TRY NOT"
10380 PRINT"TO THINK ABOUT PIGEONS!":G1=1:A1=0
10390 GOSUB23000:RETURN
11000 REM - HELP
11001 IFC5$<>"DOCKED"THEN11020
11010 PRINT"ENSIGN CHEKOV-  'BUT CAPTAIN, WE'RE ALREADY 260 NEXTL:PRINT"FAILS.":GOTO11210
11270 PRINT"SUCCEEDS.":S6=I:S7=J:Q$(I,J)=LEFT$(S5$,1)
11280 GOSUB7000:PRINT"LT. UHURA-  'CAPTAIN, WE MADE IT!'":RETURN
12000 REM-HITEM
12001 P4=2:L5=K3:N=1
12010 FORK=1TOL5
12020 IFH3(K)=0THEN12240
12030 D6=.9+.01*RND(1):H2=H3(K)*D6^K7(N)
12040 P3=K6(N)
12050 P=ABS(P3):IFP4*H2<PTHENP=P4*H2
12060 K6(N)=P3-SGN(P3)*ABS(P)
12070 X8=K4(N):Y8=K5(N)
12080 IFH2>4.99THEN12100
12090 PRINT"VERY SMALL HIT ON ":GOTO12110
12100 PRINTFNR(H2);"UNIT HIT ON ";
12110 M$=Q$(X8,Y76 IFS8=4THEN10090
10080 PRINT"PROMOTES YOU ONE STEP IN RANK, ";
10085 IFS8=1THEN PRINT"FROM BEGINNER TO NOVICE CLASS!"
10086 IFS8=2THENPRINT"FROM NOVICE TO SENIOR CLASS!"
10087 IFS8=3THENPRINT"FROM SENIOR TO EXPERT CLASS!"
10088 PRINT"   ***CONGRATULATIONS***":GOTO10110
10090 PRINT"PROMOTES YOU TO 'COMMODORE EMERITUS'."
10095 PRINT
10100 PRINT"NOW YOU CAN RETIRE AND WRITE YOUR OWN STAR TREK GAME!"
10110 GOSUB23000
10120 RETURN
10130 REM-FED RESOURCES DEPLETED
10135 PRINT"YOUR TIME HAS RUN OUT,  REM-ABANDON(NO BASES)
10250 PRINT"YOU HAVE BEEN CAPTURED BY THE KLINGONS.  IF YOU STILL"
10255 PRINT "HAD A STARBASE TO BE RETURNED TO, YOU WOULD HAVE BEEN"
10260 PRINT"REPATRIATED AND GIVEN ANOTHER CHANCE.  SINCE YOU HAVE"
10265 PRINT"NO STARBASES, YOU WILL BE MERCILESSLY TORTURED TO DEATH!"
10266 GOTO10300
10270 REM - SELF-DESTRUCT
10271 PRINT:PRINT"THE ";S5$;" IS NOW AN EXPANDING CLOUD"
10272 PRINT"OF SUB-ATOMIC PARTICLES...":GOTO10300
10280 REM-NOT REMATERIALIZED
10285 PRINT"STARBASE WAS UNABDOCKED!'"
11015 RETURN
11020 IFD4(9)=0THEN11030
11025 PRINT"SUBSPACE RADIO DAMAGED...CANNOT TRANSMIT.":RETURN
11030 IFR3<>0THEN11050
11040 PRINT"LT. UHURA-  'CAPTAIN, I'M NOT GETTING ANY RESPONSE";
11045 PRINT" FROM STARBASE!'":RETURN
11050 N1=N1+1:IFB6=0THEN11070
11060 GOTO11130
11070 D1=1E30
11080 FORL=1TOR3:X=10*SQR((B2(L)-Q1)^2+(B3(L)-Q2)^2)
11090 IFX>D1THEN11110
11100 D1=X:K=L
11110 NEXTL
11120 Q1=B2(K):Q2=B3(K):GOSUB18000
11130 Q$(S6,S7)="."
11135 PRINT
11140 PRINT"STARBASE IN QUADRAN8)
12120 IF M$="K"THENPRINT"KLINGON AT";
12125 IFM$="C"THENPRINT"COMMANDER AT";
12130 PRINTX8;"-";Y8
12140 IFK6(N)<>0THEN12180
12150 A5=X8:A6=Y8:T2$=Q$(X8,Y8):GOSUB6000
12160 IFR1<>0THEN12250
12170 F9=1:GOSUB10000:GOTO12250
12180 IFK6(N)<0THEN12240
12190 IFRND(1)<.9THEN12240
12200 IFK6(N)>(.4+.4*RND(1))*P3THEN12240
12205 PRINT
12210 PRINT"***MR. SPOCK - 'CAPTAIN, THE VESSEL AT SECTOR";
12215 PRINTX8;"-";Y8
12220 PRINT"   HAS JUST LOST ITS FIREPOWER.'"
12225 PRINT
12230 K6(N)=-K6(N)
12240 N=AND THE"
10136 PRINT"FEDERATION HAS BEEN CONQUERED.":PRINT
10137 PRINT"YOUR STARSHIP IS NOW KLINGON PROPERY, AND YOU ARE PUT"
10138 PRINT"ON TRIAL AS A WAR CRIMINAL.  ON THE BASIS OF YOUR RECORD,"
10139 IFR1*3>I1THEN10150
10140 PRINT"YOU ARE FOUND GUILTY AND SENTENCED TO DEATH!"
10145 A1=0:GOSUB23000:RETURN
10150 PRINT"YOU ARE ACQUITTED":GOSUB23000:RETURN
10160 REM- L.S. FAILURE
10165 PRINT"YOUR LIFE SUPPORT RESERVES HAVE RUN OUT, AND"
10170 PRINT"YOU WILL SOON DIE OF ASPHYXIATION"
10172 PRINT
1LE TO RE-MATERIALIZE YOUR STARSHIP."
10300 PRINT
10310 IFLEFT$(S5$,1)="F"THENS5$=""
10315 IFLEFT$(S5$,1)="E"THENS5$="FAERIE QUEENE"
10316 A1=0
10320 IFR1=0THEN10355
10325 G3=R4/I3:B8=(R1+2*R2)/(I1+2*I4)
10326 A3=G3/B8
10327 IF A3<1+.5+RND(1)THEN10345
10330 PRINT"AS A RESULT OF YOUR ACTIONS, A TREATY WITH THE KLINGON"
10331 PRINT"EMPIRE HAS BEEN SIGNED.  THE TERMS OF THE TREATY ARE"
10332 IFA3<3*RND(1)THEN10340
10335 PRINT"FAVORABLE TO THE FEDERATION.":PRINT
10336 PRINT"CONGRATULATIONS.":GOTO103T";Q1;"-";Q2;"RESPONDS --";
11145 PRINT"  ";S5$;" DEMATERIALIZES."
11146 P2=(1-.98^D1)^.333333
11150 FORL=1TO3
11155 IFL=1THENPRINT"1ST ";
11160 IFL=2THENPRINT"2ND ";
11170 IFL=3THENPRINT"3RD ";
11180 PRINT"ATTEMPT TO RE-MATERIALIZE THE ";S5$;". . . . .";
11190 IFRND(1)>P2THEN11220
11200 PRINT"FAILS.":NEXTL
11210 F9=11:GOSUB10000:RETURN
11220 FORL=1TO5:I=B6+INT(3*RND(1))-1
11230 IF(I<1)OR(I>10)THEN11260
11235 J=B7+INT(3*RND(1))-1
11240 IF(J<1)OR(J>10)THEN11260
11250 IFQ$(I,J)="."THEN11270
11N+1
12250 NEXTK
12260 RETURN
13000 REM - IMPULSE
13001 J3=0
13010 IFD4(7)<>0THEN13250
13020 IFE1<=75THEN13070
13030 INPUT"ENTER COURSE AND DISTANCE";D2,D1
13040 IFD2<0THENRETURN
13050 P3=50+250*D1
13060 IFP3<E1THEN13140
13070 PRINT
13080 PRINT"1ST OFFICER SPOCK-  'CAPTAIN, THE IMPULSE ENGINES"
13090 PRINT"REQUIRE 50 UNITS OF ENERGY TO ENGAGE, PLUS 250 UNITS"
13091 PRINT"PER ";
13100 IFE1>75THEN13120
13110 PRINT"QUADRANT.  THEY ARE, THEREFORE, USELESS NOW.'":RETURN
13120 PRINT"QUADRANT.  WE WARNING*** - COMPUTER DISABLED - SCAN NOT RECORDED."
14170 RETURN
14180 PRINT"LONG RANGE SENSORS DAMAGED.":RETURN
15000 REM - MOVE
15001 A5=(15-D2)*.5235988
15010 D4=-SIN(A5):D6=COS(A5)
15020 B8=ABS(D4)
15030 IFABS(D6)>B8THENB8=ABS(D6)
15040 D4=D4/B8:D6=D6/B8:T5=0:T6=0
15050 IFD0+T1<F1(2)THEN15080
15060 T5=1:C5$="RED":D1=D1*(F1(2)-D0)/T1+.1
15070 T1=F1(2)-D0+1E-5
15080 Q$(S6,S7)=".":X7=S6:Y7=S7:H9=INT(10*D1*B8+.5)
15090 IFH9=0THEN15115
15100 FORL=1TOH9
15102 X7=X7+D4:X1=INT(X7+.5):Y7=Y7+D6:Y15160 IFG(Q1,Q2)<>1000THENGOSUB1000
15162 IFA2<>0THENRETURN
15165 X7=10*(Q1-1)+S6:Y7=10*(Q2-1)+S7
15170 X1=INT(X7+10*D1*B8*D4+.5)
15175 Y1=INT(Y7+10*D1*B8*D6+.5):L6=0
15180 L5=0
15185 IFX1>0THEN15195
15190 X1=-X1+1:L5=1
15195 IFY1>0THEN15210
15200 Y1=-Y1+1:L5=1
15210 IFX1<=80THEN15220
15215 X1=161-X1:L5=1
15220 IFY1<=80THEN15230
15225 Y1=161-Y1:L5=1
15230 IFL5=0THEN15240
15235 L6=1:GOTO15180
15240 IFL6=0THEN15270
15260 PRINT:PRINT"*** MESSAGE FROM STARFLEET COMMAND.....STARDATE";
15261 PRIN((C5$="DOCKED")AND((B4<>Q1)OR(B5<>Q2)))THENN=-S8
16070 IFN=0THENN=INT(((F+200*RND(1))/150)-5)
16071 IFN=0THENRETURN
16072 IF(N>0)AND(K7(K)<1.5)THENRETURN
16075 IFABS(N)>S8THENN=SGN(N)*ABS(S8)
16080 T=ABS(N):P=S6-C:Q=S7-D
16085 IF2*ABS(P)<ABS(Q)THENP=0
16090 IF2*ABS(Q)<ABS(P)THENQ=0
16095 IFP<>0THENP=SGN(P*N)
16100 IFQ<>0THENQ=SGN(Q*N)
16105 R=C:S=D:Q$(C,D)="."
16110 FORL2=1TOT:L=R+P:M=S+Q
16115 IF(L>0)AND(L<=10)THEN16120
16117 ONSGN(N)+2GOTO16240,16165,16165
16120 IF(M>0)AND(M<=10)THEN16130
1CAN GO, THEREFORE, A MAXIMUM OF ";
13130 PRINTFNR(.004*(E1-50)-.05);"QUADRANTS.'":RETURN
13140 T1=D1/.4
13150 IFT1<R5THEN13200
13160 PRINT"1ST OFFICER SPOCK-  'CAPTAIN, OUR SPEED UNDER IMPULSE"
13170 PRINT"POWER IS ONLY 4 SECTORS PER STARDATE.  ARE YOU SURE"
13180 INPUT"WE DARE SPEND THE TIME'";B$
13190 IFLEFT$(B$,1)<>"Y"THENRETURN
13200 GOSUB15000:J3=1
13210 IFA2<>0THENRETURN
13220 E1=E1-P3
13230 IFE1>0THENRETURN
13240 F9=4:GOSUB10000:RETURN
13250 PRINT"IMPULSE ENGINES DAMAGED.":RETURN
14000 =INT(Y7+.5)
15105 IF(X1<1)OR(X1>10)THEN15150
15106 IF(Y1<1)OR(Y1>10)THEN15150
15108 IFQ$(X1,Y1)="O"THEN15111
15109 IFQ$(X1,Y1)<>"."THEN15125
15110 NEXTL
15111 D1=.1*SQR((S6-X1)^2+(S7-Y1)^2)
15112 S6=X1:S7=Y1
15115 F4=S6:F5=S7
15116 IFQ$(X1,Y1)<>"O"THEN15320
15120 T2=FNA(1):T3=FNA(1)
15122 Q1=FNA(1):Q2=FNA(1):S6=FNB(1):S7=FNB(1):PRINT
15123 PRINT"*** SPACE PORTAL ENTERED ***":GOTO15307
15125 T6=1:K=50*D1/T1:D1=.1*SQR((S6-X1)^2+(S7-Y1)^2)
15127 IF(Q$(X1,Y1)="K")OR(Q$(X1,Y1)="C")THEN15145
15129 TFNR(D0):PRINT:PRINT"'PERMISSION TO CROSS GALACTIC ";
15262 PRINT"PERIMETER IS HEREBY DENIED.'"
15263 PRINT"        'SHUT DOWN ENGINES IMMMEDIATELY!'"
15264 PRINT
15265 PRINT"SCOTT HERE - 'ENGINES SHUT DOWN AT ";
15266 Z1=INT((X1+9)/10):Z2=INT((Y1+9)/10)
15267 PRINT"QUADRANT";Z1;"-";Z2;",  ";
15268 PRINT"SECTOR";X1-10*(Z1-1);"-";Y1-10*(Z2-1);"'"
15270 IFT5<>0THENRETURN
15295 Q1=INT((X1+9)/10):Q2=INT((Y1+9)/10)
15296 S6=X1-10*(Q1-1):S7=Y1-10*(Q2-1)
15307 GOSUB18400
15310 PRINT:PRINT"ENTERING THE 6125 ONSGN(N)+2GOTO16240,16135,16135
16130 IFQ$(L,M)="."THEN16195
16135 IF(Q=B)OR(P=0)THEN16165
16140 M=S+B
16145 IF(M>0)AND(M<=10)THEN16155
16150 ONSGN(N)+2GOTO16240,16160,16160
16155 IFQ$(L,M)="."THEN16195
16160 B=-B
16165 IF(P=A)OR(Q=0)THEN16200
16170 L=R+A
16175 IF(L>0)AND(L<=10)THEN16185
16180 ONSGN(N)+2GOTO16240,16190,16190
16185 IFQ$(L,M)="."THEN16195
16190 A=-A:GOTO16200
16195 R=L:S=M
16200 NEXTL2
16205 Q$(R,S)="C"
16210 IF(R=C)AND(S=D)THENRETURN
16215 K4(K)=R:K5(K)=S:K7(K)=SQR((S6REM - LRSCAN
14001 N$="    #"
14005 PRINT
14010 IFD4(2)<>0THEN14180
14020 PRINT"L.R. SCAN FOR QUADRANT";Q1;"-";Q2:PRINT
14030 I=Q1-1:J=Q1+1:K=Q2-1:L=Q2+1
14040 FORM=ITOJ:FORN=KTOL
14050 IF(M<=0)OR(M>8)THEN14110
14060 IF(N<=0)OR(N>8)THEN14110
14070 IFD4(11)=0THENS2(M,N)=1
14080 IFG(M,N)>=1000THEN PRINT"  ***";
14090 IFG(M,N)<1000THENPRINTSPC(5-LEN(STR$(G(M,N))));G(M,N);
14100 GOTO14120
14110 PRINTN$;
14120 NEXTN
14130 PRINT
14140 NEXTM
14150 IFD4(11)=0THENRETURN
14155 PRINT
14160 PRINT"***PRINT:PRINTS5$;" BLOCKED BY ";
15130 IFQ$(X1,Y1)="*"THENPRINT"STAR AT";
15131 IFQ$(X1,Y1)="B"THENPRINT"STARBASE AT";
15132 PRINT" SECTOR";X1;"-";Y1;"...."
15133 PRINT"EMERGENCY STOP REQUIRED";FNR(K);"UNITS OF ENERGY."
15135 E1=E1-K
15137 S6=INT(X7-D4+.5):F4=S6:S7=INT(Y7-D6+.5):F5=S7
15140 IFE1>0THEN15320
15141 F9=4:GOSUB10000:RETURN
15145 S6=X1:S7=Y1:GOSUB22000:F4=S6:F5=S7:GOTO15320
15150 IFK3=0THEN15165
15155 FORL=1TOK3
15156 F3=SQR((X1-K4(L))^2+(Y1-K5(L))^2)
15158 K8(L)=.5*(F3+K7(L)):NEXTL
1";G2$;" QUADRANT  (";Q1;"-";Q2;")"
15315 Q$(S6,S7)=LEFT$(S5$,1):GOSUB18000:RETURN
15320 Q$(S6,S7)=LEFT$(S5$,1)
15321 IFL6=1THENRETURN
15325 IFK3=0THEN15390
15330 FORL=1TOK3
15340 F3=SQR((F4-K4(L))^2+(F5-K5(L))^2)
15350 K8(L)=.5*(K7(L)+F3)
15360 K7(L)=F3
15370 NEXTL
15380 GOSUB28000
15390 GOSUB17000:RETURN
16000 REM-MOVECOM
16001 A=1:B=1
16010 FORK=1TOK3
16020 C=K4(K):D=K5(K)
16030 IFQ$(C,D)="C"THEN16050
16040 NEXTK
16050 N=0:F=K6(K)+100*K3
16060 IFF>1000THENN=INT(RND(1)*K7(K)+1)
16065 IF-R)^2+(S7-S)^2)
16220 K8(K)=K7(K):IFN>0THENPRINT"***COMMANDER ADVANCES TO";
16225 IFN<0THENPRINT"***COMMANDER RETREATS TO";
16230 PRINT" SECTOR";R;"-";S:GOSUB28000:RETURN
16240 I=Q1+INT((L+9)/10)-1:J=Q2+INT((M+9)/10)-1
16245 IF(I<1)OR(I>8)THEN16350
16250 IF(J<1)OR(J>8)THEN16350
16260 FORL3=1TOR2
16265 IF(C1(L3)=I)AND(C2(L3)=J)THEN16350
16270 NEXTL3:PRINT"***COMMANDER ESCAPES TO ";
16275 PRINT"QUADRANT";I;"-";J;"  (AND REGAINS STRENGTH)"
16280 K4(K)=K4(K3):K5(K)=K5(K3):K7(K)=K7(K3):K8(K)=K8(K3)
1NB(1):B7=FNB(1):IFQ$(B6,B7)<>"."THEN18170
18180 Q$(B6,B7)="B"
18190 GOSUB17000:IFU<1THENRETURN
18200 FORA=1TOU
18210 S=FNB(1):T=FNB(1):IFQ$(S,T)<>"."THEN18210
18220 Q$(S,T)="*":NEXTA
18230 IF(T2<>Q1)OR(T3<>Q2)THENRETURN
18240 S=FNB(1):T=FNB(1):IFQ$(S,T)<>"."THEN18240
18250 Q$(S,T)="O":PRINT
18260 PRINT"MR. SPOCK - 'CAPTAIN, THE SHORT-RANGE SENSORS DETECT A"
18270 PRINT"SPACE WARP SOMEWHERE IN THIS QUADRANT.'"
18280 RETURN
18290 FORA=1TO10:FORB=1TO10:Q$(A,B)=".":NEXTB:NEXTA
18300 Q$(S6,S7)=LEFT$Q2)THEN19125
19120 B2(V)=B2(R3):B3(V)=B3(R3)
19125 NEXTV:R3=R3-1:B6=0:B7=0:B1=B1+1:GOSUB17000
19130 PRINT"***STARBASE AT SECTOR";J5;"-";J6;"DESTROYED."
19135 GOTO19255
19140 IF(S6<>J5)OR(S7<>J6)THEN19190
19145 PRINT"***STARSHIP BUFFETED BY NOVA.":IFS4<>0THEN19155
19150 E1=E1-1000:GOTO19170
19155 IFS3>=1000THEN19180
19160 D6=1000-S3:E1=E1-D6:GOSUB17000:S3=0:S4=0
19165 PRINT"***STARSHIP SHIELDS KNOCKED OUT.":D4(8)=.005*D5*RND(1))*D6
19170 IFE1>0THEN19185
19175 F9=7:GOSUB10000:RETURN
19180 S3=S3-1030
20025 PRINT"PHASERS CAN'T BE FIRED THRU BASE SHIELDS.":GOTO20080
20030 IFD4(3)=0THEN20050
20040 PRINT"PHASER BANKS DAMAGED.":GOTO20080
20050 IFS4=0THEN20060
20055 PRINT"SHIELDS MUST BE DOWN TO FIRE PHASERS.":GOTO20080
20060 IFK3>0THEN20090
20065 PRINT
20070 PRINT"MR. SPOCK - 'CAPTAIN, THE SHORT-RANGE SENSORS"
20075 PRINT"    DETECT NO KLINGONS IN THIS QUADRANT.'"
20080 J3=0:RETURN
20090 PRINT"PHASERS LOCKED ON TARGET.  ENERGY AVAILABLE=";
20095 PRINT.01*INT(100*E1)
20100 INPUT"UNITS TO FIRE6285 K6(K)=K6(K3):K3=K3-1:C3=0
16290 IFC5$<>"DOCKED"THENGOSUB17000
16300 GOSUB28000
16310 G(Q1,Q2)=G(Q1,Q2)-100:G(I,J)=G(I,J)+100
16320 FORL3=1TOR2
16330 IF(C1(L3)=Q1)AND(C2(L3)=Q2)THEN16340
16335 NEXTL3
16340 C1(L3)=I:C2(L3)=J:RETURN
16350 A=-A:B=-B:GOTO16200
17000 REM - NEWCOND
17001 C5$="GREEN"
17010 IFE1<1000THENC5$="YELLOW"
17020 IFG(Q1,Q2)>99THENC5$="RED"
17030 RETURN
18000 REM- NEW QUAD
18001 J4=1:B6=0:B7=0:K3=0:C3=0
18010 U=G(Q1,Q2)
18020 IFU>999THEN18290
18030 K3=INT(.01*U):FORA=1(S5$,1):RETURN
18400 G4$="III":L=2:IFQ2>=5THEN18420
18410 L=1
18420 G2$=G1$(2*(Q1-1)+L):L=Q2
18425 IFL<=4THEN18440
18430 L=Q2-4
18440 G3$="IV":IFL=4THEN18460
18450 G3$=LEFT$(G4$,L)
18460 G2$=G2$+" "+G3$:RETURN
19000 REM - NOVA
19001 IFRND(1)>.1THEN19015
19010 GOSUB27000:RETURN
19015 Q$(A5,A6)=".":PRINT"***STAR AT SECTOR";A5;"-";A6;"NOVAS."
19020 G(Q1,Q2)=G(Q1,Q2)-1:S1=S1+1
19025 B9=1:T6=1:T7=1:K=0:X1=0:Y1=0
19030 H4(B9,1)=A5:H4(B9,2)=A6
19035 FORM=B9TOT6:FORQ=1TO3:FORJ=1TO3
19040 IFJ*Q=4THE000
19185 X1=X1+S6-H4(M,1):Y1=Y1+S7-H4(M,2):K=K+1:GOTO19260
19190 IFQ$(J5,J6)<>"C"THEN19250
19195 FORV=1TOK3
19200 IF(K4(V)=J5)AND(K5(V)=J6)THEN19210
19205 NEXTV
19210 K6(V)=K6(V)-800:IFK6(V)<=0THEN19250
19215 N5=J5+J5-H4(M,1):N6=J6+J6-H4(M,2)
19220 PRINT"***COMMANDER AT SECTOR";J5;"-";J6;"DAMAGED";
19225 IF(N5<1)OR(N5>10)OR(N6<1)OR(N6>10)THEN19245
19230 PRINT" AND BUFFETED TO SECTOR";N5;"-";N6
19235 Q$(N5,N6)="C":K4(V)=N5:K5(V)=N6
19240 K7(V)=SQR((S6-N5)^2+(S7-N6)^2):K8(V)=K7(V)
19241 Q$(J5,J6";P1:IFP1<E1THEN20120
20110 PRINT"ENERGY AVAILABLE =";:GOTO20095
20120 IFP1>0THEN20140
20130 J3=0:RETURN
20140 E1=E1-P1
20142 IFD4(11)=0THEN20147
20144 P1=P1*(RND(1)*.5+.5)
20145 PRINT:PRINT"COMPUTER MALFUNCTION HAMPERS PHASER ACCURACY.":PRINT
20147 E=P1:IFK3=0THEN20310
20150 E=0:T5=(K3*(K3+1))/2
20160 FORI=1TOK3:H3(I)=((K3+1-I)/T5)*P1
20170 H5(I)=ABS(K6(I))/(P*.9^K7(I))
20180 IFH3(I)<=H5(I)THEN20200
20190 E=E+(H3(I)-H5(I)):H3(I)=H5(I)
20200 NEXTI
20210 IFE=0THEN20280
20220 FORI=1TOK3:R7=H5(TO10:FORB=1TO10:Q$(A,B)=".":NEXTB:NEXTA
18040 Q$(S6,S7)=LEFT$(S5$,1):U=G(Q1,Q2):IFU<100THEN18150
18050 U=U-100*K3:FORA=1TOK3
18060 S=FNB(1):K4(A)=S:T=FNB(1):K5(A)=T
18070 IFQ$(S,T)<>"."THEN18060
18080 Q$(S,T)="K":K7(A)=SQR((S6-S)^2+(S7-T)^2):K8(A)=K7(A)
18090 K6(A)=RND(1)*150+325:NEXTA
18100 IFR2=0THEN18140
18110 FORA=1TOR2
18115 IF(C1(A)=Q1)AND(C2(A)=Q2)THEN18130
18120 NEXTA:GOTO18140
18130 Q$(S,T)="C":K6(K3)=1000+400*RND(1):C3=1
18140 GOSUB28000
18150 IFU<10THEN18190
18160 U=U-10
18170 B6=FN19260
19045 J5=H4(M,1)+Q-2:J6=H4(M,2)+J-2
19050 IF(J5<1)OR(J5>10)THEN19260
19055 IF(J6<1)OR(J6>10)THEN19260
19060 IFQ$(J5,J6)="."THEN19260
19065 IFQ$(J5,J6)="O"THEN19260
19070 IFQ$(J5,J6)<>"*"THEN19105
19075 IFRND(1)>=.1THEN19085
19080 X2=J5:Y2=J6:GOSUB27000:RETURN
19085 T7=T7+1:H4(T7,1)=J5:H4(T7,2)=J6:G(Q1,Q2)=G(Q1,Q2)-1
19090 S1=S1+1:PRINT"***STAR AT SECTOR";J5;"-";J6;"NOVAS."
19100 GOTO19255
19105 IFQ$(J5,J6)<>"B"THEN19140
19110 G(Q1,Q2)=G(Q1,Q2)-10:FORV=1TOR3
19115 IF(B2(V)<>Q1)OR(B3(V)<>)="."
19245 PRINT:GOTO19260
19250 A5=J5:A6=J6:T2$=Q$(J5,J6):GOSUB6000:GOTO19260
19255 PRINT:Q$(J5,J6)="."
19260 NEXTJ:NEXTQ:NEXTM
19265 IFT6=T7THEN19280
19270 B9=T6+1:T6=T7:GOTO19035
19280 IFK=0THENRETURN
19290 D1=K*.1
19300 IFX1<>0THENX1=SGN(X1)
19310 IFY1<>0THENY1=SGN(Y1)
19320 I=3*(X1+1)+Y1+2
19330 D2=C5(I)
19340 IFD2=0THEND1=0
19350 IFD1=0THENRETURN
19360 PRINT:PRINT"FORCE OF NOVA DISPLACES STARSHIP."
19370 GOSUB15000:RETURN
20000 REM-PHASERS
20001 P=2:J3=1
20020 IFC5$<>"DOCKED"THEN20I)-H3(I)
20230 IFR7<=0THEN20260
20240 IFR7>=ETHEN20270
20250 H3(I)=H5(I):E=E-R7
20260 NEXTI:GOTO20280
20270 H3(I)=H3(I)+E:E=0
20280 GOSUB12000
20290 IF(E<>0)AND(A2=0)THEN20310
20300 J3=1:RETURN
20310 PRINTFNR(E);"EXPENDED ON EMPTY SPACE.":J3=1:RETURN
21000 REM - PHOTONS
21001 J3=1:IFD4(4)=0THEN21015
21010 PRINT"PHOTON TUBES DAMAGED.":GOTO21035
21015 IFT4<>0THEN21025
21020 PRINT"NO TORPEDOS LEFT.":GOTO21035
21025 INPUT"TORPEDO COURSE";C6
21030 IFC6>=0THEN21040
21035 J3=0:RETURN
21040 INPUT"=ABS(Y4)
21150 X4=X4/B8:Y4=Y4/B8:X5=S6:Y5=S7
21155 FORL9=1TO15:X5=X5+X4:A5=INT(X5+.5)
21160 IF(A5<1)OR(A5>10)THEN21430
21165 Y5=Y5+Y4:A6=INT(Y5+.5)
21170 IF(A6<1)OR(A6>10)THEN21430
21175 IF(L9=5)OR(L9=9)THENPRINT
21180 PRINTFNR(X5);"-";FNR(Y5);", ";
21185 IFQ$(A5,A6)<>"."THEN21195
21190 GOTO21425
21195 PRINT:IFQ$(A5,A6)="K"THEN21220
21200 IFQ$(A5,A6)<>"C"THEN21325
21205 IFRND(1)>.1THEN21220
21210 PRINT"***COMMANDER AT SECTOR";A5;"-";A6;"USES ANTI-PHOTON";
21215 PRINT" DEVICE!":PRINT"   TORPEDOORW=1TOR3
21345 IF(B2(W)<>Q1)OR(B3(W)<>Q2)THEN21355
21350 B2(W)=B2(R3):B3(W)=B3(R3)
21355 NEXTW:Q$(A5,A6)=".":R3=R3-1:B6=0:B7=0
21360 G(Q1,Q2)=G(Q1,Q2)-10:B1=B1+1:GOSUB17000:GOTO21435
21365 IFQ$(A5,A6)<>"*"THEN21405
21370 IFRND(1)>.15THEN21385
21375 PRINT"***STAR AT SECTOR";A5;"-";A6;"UNAFFECTED BY PHOTON BLAST"
21380 GOTO21435
21385 X2=A5:Y2=A6:GOSUB19000:A5=X2:A6=Y2
21390 IFG(Q1,Q2)=1000THENRETURN
21395 IFA2<>0THENRETURN
21400 GOTO21435
21405 PRINT:PRINT"AAAAAIIIIIIIEEEEEEEAAAAAAAUUUUUUGGGGGG3020 N=(K2+K1)/P:K=INT(500*N+.5):L=0
23030 IFG1<>0THENL=100*S8
23035 I=0
23040 IFLEFT$(S5$,1)="E"THENM=0
23045 IFLEFT$(S5$,1)="F"THENM=1
23050 IFLEFT$(S5$,1)=""THENM=2
23060 IFA1=0THENI=200
23070 J=10*K1+50*K2+K+L-I-100*B1-100*M-35*N1-3*S1-C4
23080 PRINT:IFJ<>0THEN23100
23090 PRINT"AS YET, YOU HAVE NO SCORE.":RETURN
23100 PRINT"YOUR SCORE --":PRINT:IFK1=0THEN23120
23110 PRINTK1;TAB(5);"ORDINARY KLINGON(S) DESTROYED";TAB(36);10*K1
23120 IFK2=0THEN23140
23130 PRINTK2;TAB(5);"KLINGON COMMANDER(S) BURST OF 3";B$:N=1
21045 IFLEFT$(B$,1)="N"THEN21066
21050 IFLEFT$(B$,1)<>"Y"THEN21040
21051 IFT4>2THEN21060
21055 PRINT"NO BURST.  ONLY";T4;"TORPEDOS LEFT.":GOTO21035
21060 INPUT"SPREAD ANGLE (3 - 30 DEG)";G2
21061 IFG2<0THEN21035
21062 IF(G2<3)OR(G2>30)THEN21060
21063 G2=FND(G2)
21065 N=3
21066 REM - CONTINUE
21070 FORZ6=1TON
21075 IFC5$<>"DOCKED"THENT4=T4-1
21080 Z7=Z6:R=RND(1)
21085 R=(R+RND(1))*.5-.5
21090 IF(R>=-.4)AND(R<=.4)THEN21125
21095 R=(RND(1)+1.2)*R:IFN=3THEN21105
21100 PRINT"* NEUTRALIZED.":GOTO21435
21220 FORV=1TOK3
21225 IF(A5=K4(V))AND(A6=K5(V))THEN21235
21230 NEXTV
21235 K=K6(V):W3=200+800*RND(1)
21240 IFABS(K)<W3THENW3=ABS(K)
21245 K6(V)=K-SGN(K)*ABS(W3):IFK6(V)<>0THEN21255
21250 T2$=Q$(A5,A6):GOSUB6000:GOTO21435
21255 IFQ$(A5,A6)="K"THENPRINT"***KLINGON AT";
21260 IFQ$(A5,A6)="C"THENPRINT"***COMMANDER AT";
21265 PRINTA5;"-";A6;
21270 A7=A8+2.5*(RND(1)-.5)
21275 W3=ABS(-SIN(A7)):IFABS(COS(A7))>W3THENW3=ABS(COS(A7))
21280 X7=-SIN(A7)/W3:Y7=COS(A7)/W3
21285 P=INGHHHHHHHHHH!!!"
21410 PRINT"    HACK!     HACK!    COUGH!      *CHOKE!*"
21415 PRINT:PRINT"MR. SPOCK-  'FASCINATING!'":Q$(A5,A6)="."
21420 T2=0:T3=0:GOTO21435
21425 NEXTL9
21430 PRINT:PRINT"TORPEDO MISSED!"
21435 NEXTZ6
21440 IFR1<>0THENRETURN
21445 F9=1:GOSUB10000:RETURN
22000 REM - RAM
22001 PRINT:PRINT"*** RED ALERT!!   RED ALERT!! ***":PRINT
22010 PRINT"*** COLLISION IMMINENT!!":PRINT
22020 PRINT"*** ";S5$;" RAMS ";:W7=1:IFQ$(S6,S7)="C"THENW7=2
22030 IFW7=1THENPRINT"KLINGON AT ";
22040 IFWDESTROYED";TAB(36);50*K2
23140 IFK=0THEN23160
23150 PRINTFNR(N);TAB(5);"KLINGONS PER STARDATE, AVERAGE";
23155 PRINTTAB(36);K
23160 IFS1=0THEN23180
23170 PRINTS1;TAB(5);"STAR(S) DESTROYED";TAB(36);-3*S1
23180 IFB1=0THEN23200
23190 PRINTB1;TAB(5);"STARBASES DESTROYED";TAB(36);-100*B1
23200 IFN1=0THEN23220
23210 PRINTN1;TAB(5);"SOS CALL(S) TO A STARBASE";TAB(36);-35*N1
23220 IFC4=0THEN23240
23230 PRINTC4;TAB(5);"CASUALTIES INCURRED";TAB(36);-C4
23240 IFM=0THEN23260
23250 PRINTM;TAB(5);"SHIP(S) LO**TORPEDO MISFIRES...":GOTO21110
21105 PRINT"***TORPEDO NUMBER";Z6;"MISFIRES..."
21110 IF RND(1)>.2THEN21125
21115 PRINT"***PHOTON TUBES DAMAGED BY MISFIRE."
21120 D4(4)=D5*(1+2*RND(1)):GOTO21440
21125 IF(S4<>0)OR(C5$="DOCKED")THENR=R+.001*S3*R
21130 A3=C6+.25*R:IFN=1THEN21140
21135 A8=(15-A3+(2-Z6)*G2)*.5235988:PRINT
21137 PRINT"TRACK FOR TORPEDO NUMBER";Z7;"--":GOTO21145
21140 PRINT:PRINT"TORPEDO TRACK --":A8=(15-A3)*.5235988
21145 X4=-SIN(A8):Y4=COS(A8):B8=ABS(X4)
21146 IFABS(Y4)>ABS(X4)THENB8T(A5+X7+.5):Q=INT(A6+Y7+.5)
21290 IF(P<1)OR(P>10)OR(Q<1)OR(Q>10)THEN21320
21295 IFQ$(P,Q)<>"."THEN21320
21300 Q$(P,Q)=Q$(A5,A6):Q$(A5,A6)=".":PRINT"DAMAGED--"
21305 PRINT"   DISPLACED BY BLAST TO SECTOR";P;"-";Q
21310 K4(V)=P:K5(V)=Q:K7(V)=SQR((S6-P)^2+(S7-Q)^2)
21311 K8(V)=K7(V)
21315 GOSUB28000:GOTO21435
21320 PRINT"DAMAGED, BUT NOT DESTROYED.":GOTO21435
21325 IFQ$(A5,A6)<>"B"THEN21365
21330 PRINT"***STARBASE DESTROYED...CONGRATULATIONS...YOU TURKEY!"
21335 IFS2(Q1,Q2)<0THENS2(Q1,Q2)=0
21340 F7=2THENPRINT"COMMANDER AT ";
22050 PRINT"SECTOR";S6;"-";S7:A5=S6:A6=S7:T2$=Q$(S6,S7)
22060 GOSUB6000:PRINT"***";S5$;" HEAVILY DAMAGED."
22070 K=INT(5+RND(1)*20):PRINT"***SICKBAY REPORTS";K;"CASUALTIES!"
22080 C4=C4+K:FORL=1TO12:I=RND(1)
22090 J=(3.5*W7*(RND(1)+I)+1)*D5
22100 IFL=6THENJ=J/3
22110 D4(L)=D4(L)+T1+J:NEXTL:D4(6)=D4(6)-3
22120 IFD4(6)<0THEND4(6)=0
22130 S4=0:IFR1<>0THENRETURN
22140 F9=1:GOSUB10000:RETURN
23000 REM - SCORE
23001 P=D0-J2:IF(P<>0)AND(R1=0)THEN23020
23010 IFP<5THENP=5
2ST OR DESTROYED";TAB(36)-100*M
23260 IFA1<>0THEN23280
23270 PRINT"PENALTY FOR GETTING YOURSELF KILLED";TAB(36);-200
23280 IFG1=0THEN23300
23290 PRINTTAB(5);"BONUS FOR WINNING ";S$(S8);" GAME";TAB(36);L
23300 PRINTTAB(5);"-------------------------------------"
23310 PRINTTAB(28);"TOTAL";TAB(36);J;"**":RETURN
24000 REM-SETUP
24001 A2=0:G1=0:GOSUB4000:S5$="ENTERPRISE"
24010 I7=5000:E1=I7:I8=2500:S3=I8:S4=0:S9=S4:J1=4:L1=J1
24020 Q1=FNA(1):Q2=FNA(1):S6=FNB(1):S7=FNB(1):I9=10:T4=I9
24030 W1=5:W2=25:FON24250
24290 NEXTJ
24300 G(X,Y)=G(X,Y)+100:C1(I)=X:C2(I)=Y:NEXTI
24305 I=INT(D0):PRINT:S0=0
24310 T2=FNA(1):T3=FNA(1):IFG(T2,T3)<100THEN24310
24320 IFS8<>1THEN24440
24330 PRINT"IT IS STARDATE";I;"...THE ORGANIAN PEACE TREATY BETWEEN"
24340 PRINT"THE UNITED FEDERATION OF PLANETS AND THE KLINGON EMPIRE"
24350 PRINT"HAS COLLAPSED AND THE FEDERATION IS BEING ATTACKED BY A"
24360 PRINT"DEADLY KLINGON INVASION FLEET.  AS CAPTAIN OF THE STARSHIP"
24370 PRINT"U.S.S. ENTERPRISE, IT IS YOUR MISSION TO SEEK ETURN
25080 PRINT"ENGINEER SCOTT - 'AYE, BUT OUR MAXIMUM SAFE SPEED";
25090 PRINT" IS WARP 6.'":RETURN
25100 IFW1=10THEN25130
25110 PRINT"ENGINEER SCOTT-'AYE, CAPTAIN, BUT OUR ENGINES MAY NOT ";
25120 PRINT"TAKE IT.'":RETURN
25130 PRINT"ENGINEER SCOTT-'AYE, CAPTAIN, WE'LL GIVE IT A TRY.'":RETURN
25140 PRINT"ENSIGN CHEKOV-'WE CAN'T GO BELOW WARP 1, CAPTAIN.'":RETURN
25150 PRINT"ENSIGN CHEKOV-'OUR TOP SPEED IS WARP 10, CAPTAIN.'"
25160 RETURN
26000 REM - SHIELDS
26001 J3=0:IFD4(8)<>0THEN26600
2601TED AT SECTOR";X3;"-";Y3
27120 X=Q1:Y=Q2:K=(X2-S6)^2+(Y2-S7)^2
27130 IFK>1.5THEN27180
27140 PRINT"*** EMERGENCY AUTO-OVERRIDE JAMMED ***":A2=1:GOTO27180
27150 IFD4(9)<>0THEN27180
27160 PRINT:PRINT"MESSAGE FROM STARFLEET COMMAND...STARDATE";INT(D0)
27170 PRINT"'SUPERNOVA IN QUADRANT";X;"-";Y;
27175 PRINT"....CAUTION ADVISED'"
27180 N=G(X,Y):R=INT(N/100):Q=0
27190 IF(X<>Q1)OR(Y<>Q2)THEN27210
27200 K3=0:C3=0
27210 IFR=0THEN27270
27220 R1=R1-R:IFR2=0THEN27270
27230 FORL=1TOR2:IF(C1(L)<>X)OR(C2(L)<>RI=1TO12:D4(I)=0:NEXT
24040 J2=100*INT(31*RND(1)+20):D0=J2:K1=0:K2=0:N1=0:N2=0:R6=0:C4=0
24050 A1=1:D3=.25:FORI=1TO8:FORJ=1TO8:S2(I,J)=0:NEXTJ:NEXTI
24060 F1(1)=D0-.5*I5*LOG(RND(1)):F1(5)=1E30
24070 F1(2)=D0-1.5*(I5/R2)*LOG(RND(1)):I6=0
24080 F1(3)=D0-.3*I5*LOG(RND(1)):F1(4)=D0-.3*I5*LOG(RND(1))
24090 FORI=1TO8:FORJ=1TO8:K=INT(RND(1)*9+1):I6=I6+K
24100 G(I,J)=K:NEXTJ:NEXTI:S1=0
24110 FOR I=1TOI2
24120 X=INT(RND(1)*6+2):Y=INT(RND(1)*6+2)
24130 IFG(X,Y)>=10THEN24120
24140 IFI<2THEN24180
24150 K=I-OUT AND"
24380 PRINT"DESTROY THIS INVASION FORCE OF";I1;"BATTLE CRUISERS."
24390 PRINT:PRINT"YOU HAVE AN INITIAL ALLOTMENT OF";INT(I5);
24400 PRINT"STARDATES":PRINT"TO COMPLETE YOUR MISSION."
24410 PRINT"AS THE MISSION PROCEEDS, YOU MAY BE GIVEN MORE TIME."
24420 PRINT:PRINT"YOU WILL HAVE";I2;"SUPPORTING STARBASE(S).":PRINT
24430 GOTO24515
24440 PRINT"STARDATE..............";I
24450 PRINT"NUMBER OF KLINGONS....";I1
24460 PRINT"NUMBER OF STARDATES...";INT(I5)
24470 PRINT"NUMBER OF STARBASES...";I20 IFS4<>0THEN26530
26500 INPUT"SHIELDS ARE DOWN.  DO YOU WANT THEM UP";B$
26510 IFLEFT$(B$,1)="Y"THEN26560
26520 RETURN
26530 INPUT"SHIELDS ARE UP.  DO YOU WANT THEM DOWN";B$
26540 IFLEFT$(B$,1)="Y"THEN26590
26550 RETURN
26560 S4=1:S9=1:IFC5$<>"DOCKED"THENE1=E1-50
26570 PRINT"SHIELDS RAISED.":IFE1<=0THEN26610
26580 J3=1:RETURN
26590 S4=0:S9=1:PRINT"SHIELDS LOWERED.":J3=1:RETURN
26600 PRINT"SHIELDS DAMAGED AND DOWN.":RETURN
26610 PRINT:PRINT"SHIELDS USE UP LAST OF THE ENERGY."
26620 F9=4:GOSUB10Y)THEN27260
27240 C1(L)=C1(R2):C2(L)=C2(R2):C1(R2)=0:C2(R2)=0
27250 R2=R2-1:R=R-1:Q=1:IFR2=0THENF1(2)=1E30
27260 NEXTL
27270 IFR3=0THEN27310
27280 FORL=1TOR3:IF(B2(L)<>X)OR(B3(L)<>Y)THEN27300
27290 B2(L)=B2(R3):B3(L)=B3(R3):B2(R3)=0:B3(R3)=0:R3=R3-1
27300 NEXTL
27310 IFX2=0THEN27350
27320 N=G(X,Y)-INT(G(X,Y)/100)*100
27330 S1=S1+(N-INT(N/10)*10):B1=B1+INT(N/10)
27340 K1=K1+R:K2=K2+Q
27350 IF(S2(X,Y)<>0)AND(D4(9)<>0)THENS2(X,Y)=1000+G(X,Y)
27360 IF(D4(9)=0)OR((Q1=X)AND(Q2=Y))THENS2(X,Y)=1
273701:FORJ=1TOK:D1=SQR((B2(J)-X)^2+(B3(J)-Y)^2)
24160 IFD1<2THEN24120
24170 NEXTJ
24180 B2(I)=X:B3(I)=Y:S2(X,Y)=-1:G(X,Y)=G(X,Y)+10:NEXTI
24190 B1=0:K=I1-I4:L=INT(.25*S8*(9-L2)+1)
24200 M=INT((1-RND(1)^2)*L):IFM>KTHENM=K
24210 N=100*M
24220 X=FNA(1):Y=FNA(1):IFG(X,Y)+N>999THEN24220
24230 G(X,Y)=G(X,Y)+N:K=K-M:IFK<>0THEN24200
24240 FORI=1TOI4
24250 X=FNA(1):Y=FNA(1):IF(G(X,Y)<99)AND(RND(1)<.75)THEN24250
24260 IFG(X,Y)>899THEN24250
24270 IFI=1THEN24300
24280 M=I-1:FORJ=1TOM:IF(C1(J)=X)AND(C2(J)=Y)THE
24480 PRINT"STARBASE LOCATIONS....";
24490 FORI=1TOI2:PRINTB2(I);"-";B3(I);
24500 IFI<>I2THENPRINT", ";
24510 NEXTI:PRINT:PRINT
24515 GOSUB18400
24520 PRINT"THE ";S5$;" IS CURRENTLY IN THE ";G2$;" QUADRANT."
24530 GOSUB18000:RETURN
25000 REM - SETWARP
25010 INPUT"WARP FACTOR";K
25020 PRINT
25025 IFK<1THEN25140
25026 IFK>10THEN25150
25030 J=W1:W1=K:W2=W1*W1
25040 IF(W1<=J)OR(W1<=6)THEN25070
25050 IFW1<=8THEN25080
25060 IFW1>8THEN25100
25070 PRINT"ENSIGN CHEKOV - 'WARP FACTOR";W1;"CAPTAIN'":R000:RETURN
27000 REM - SUPERNOVA
27001 IFX2<>0THEN27100
27010 N=INT(RND(1)*I6+1):FORX=1TO8:FORY=1TO8
27020 N=N-(G(X,Y)-INT(G(X,Y)/10)*10):IFN<=0THEN27040
27030 NEXTY:NEXTX:RETURN
27040 IF(X<>Q1)OR(Y<>Q2)THEN27150
27050 IFJ4<>0THEN27150
27060 N=INT(RND(1)*(G(X,Y)-INT(G(X,Y)/10)*10))+1
27070 FORX3=1TO10:FORY3=1TO10:IFQ$(X3,Y3)<>"*"THEN27090
27080 N=N-1:IFN=0THEN27100
27090 NEXTY3:NEXTX3
27100 PRINT:PRINT"*** RED ALERT!!  RED ALERT!! ***
27105 X3=X2:Y3=Y2
27110 PRINT"*** INCIPIENT SUPERNOVA DETEC G(X,Y)=1000
27380 IF(R1<>0)OR((X=Q1)AND(Y=Q2))THEN27430
27390 PRINT:PRINT"MR. SPOCK-  'CAPTAIN, A SUPERNOVA IN QUADRANT";
27400 PRINTX;"-";Y;"HAS JUST DESTROYED THE LAST OF THE KLINGONS.'"
27420 F9=1:GOSUB10000:RETURN
27430 IFA2=0THENRETURN
27440 F9=8:GOSUB10000:RETURN
28000 REM - SORTKL
28001 IFK3<=1THENRETURN
28005 Z4=0
28010 FORO=1TOK3-1:IFK7(O)<=K7(O+1)THEN28080
28020 K=K7(O):K7(O)=K7(O+1):K7(O+1)=K
28030 K=K8(O):K8(O)=K8(O+1):K8(O+1)=K
28040 K=K4(O):K4(O)=K4(O+1):K4(O+1)=K
28050 K=K5(O):0 IFD4(8)>0THENB$="DAMAGED,"
29190 PRINTB$;INT(100*S3/I8+.5);"%":GOTO29220
29200 PRINT" KLINGONS LEFT ";R1:GOTO29220
29210 PRINT" TIME LEFT     ";FNS(R5)
29220 NEXTI:RETURN
29230 PRINT"SHORT RANGE SENSORS DAMAGED.":RETURN
30000 REM - TIMEWARP
30001 PRINT:PRINT"*** TIME WARP ENTERED ***":PRINT"YOU ARE TRAVELING ";
30010 IFS0<>0THEN30050
30020 T1=-.5*I5*LOG(RND(1))
30030 PRINT"FORWARD IN TIME";FNR(T1);"STARDATES."
30040 F1(2)=F1(2)+T1:GOTO30200
30050 M=D0:D0=D9(1)
30060 PRINT"BACKWARD IN TIME";FN(S3);")"
31075 J3=1
31080 T1=.1:P5=(K3+4*C3)/48:IFP5<.1THENP5=.1
31090 IFP5>RND(1)THENGOSUB1000
31100 IFA2<>0THENRETURN
31110 GOSUB9000:RETURN
31120 PRINT"TRANSFER PANEL DAMAGED.":RETURN
32000 REM - VISUAL
32001 INPUT"WHICH DIRECTION";Z
32005 PRINT
32010 J3=0:IFZ<0THENRETURN
32012 IFZ<=12THEN32020
32014 PRINT"DIRECTIONS ARE FROM 0 TO 12 ONLY":GOTO32001
32020 T1=.05:P=(K3+4*C3)/48:IFP<.05THENP=.05
32030 IFP>RND(1)THENGOSUB1000
32040 IFA2<>0THENRETURN
32050 GOSUB9000:J3=1:IFA2<>0THENRETURN
32Q$(I,J)
32190 I=S6+2:J=S7+2:V$(5,5)=Q$:IF(I<11)AND(J<11)THENV$(5,5)=Q$(I,J)
32195 I=S6+1:J=S7+1:V$(4,4)=Q$:IF(I<11)AND(J<11)THENV$(4,4)=Q$(I,J)
32200 N=N+1:IFN=3THEN32350
32210 I=S6+2:V$(5,4)=Q$:IF(I<11)AND(J<11)THENV$(5,4)=Q$(I,J)
32220 I=S6+2:V$(5,3)=Q$:IFI<11THENV$(5,3)=Q$(I,S7)
32230 I=S6+1:V$(4,3)=Q$:IFI<11THENV$(4,3)=Q$(I,S7)
32240 N=N+1:IFN=3THEN32350
32250 I=S6+2:J=S7-1:V$(5,2)=Q$:IF(I<11)AND(J>0)THENV$(5,2)=Q$(I,J)
32260 I=S6+2:J=S7-2:V$(5,1)=Q$:IF(I<11)AND(J>0)THENV$(5,1)=Q$(I,J)
32270 IK5(O)=K5(O+1):K5(O+1)=K
28060 K=K6(O):K6(O)=K6(O+1):K6(O+1)=K
28070 Z4=1
28080 NEXTO
28090 IFZ4<>0THEN28005
28100 RETURN
29000 REM-SRSCAN
29001 IFD(1)<>0THEN29230
29010 PRINT:PRINT"    1 2 3 4 5 6 7 8 9 10"
29020 FORI=1TO10:IFI<10THENPRINT" ";
29030 PRINTI;:FORJ=1TO10:PRINTQ$(I,J);" ";:NEXTJ
29040 ONIGOTO29050,29060,29080,29090,29140
29045 ONI-5GOTO29150,29160,29170,29200,29210
29050 PRINT" STARDATE      ";FNR(D0):GOTO29220
29060 IFC5$<>"DOCKED"THENGOSUB17000
29070 PRINT" CONDITION      ";C5R(M-D0);"STARDATES.":S0=0
30070 R1=D9(2):R2=D9(3):R3=D9(4):R4=D9(5):R5=D9(6)
30080 S1=D9(7):B1=D9(8):K1=D9(9):K2=D9(10)
30090 FORI=1TO8:FORJ=1TO8:G(I,J)=D9(I-1+8*(J-1)+11):NEXTJ:NEXTI
30100 FORI=75TO84:C1(I-74)=D9(I):NEXT
30110 FORI=85TO94:C2(I-84)=D9(I):NEXT
30120 FORI=95TO99:B2(I-94)=D9(I):NEXT
30130 FORI=100TO104:B3(I-99)=D9(I):NEXT:B4=D9(105):B5=D9(106)
30140 F1(1)=D0-.5*I5*LOG(RND(1))
30150 IFR2<>0THENF1(2)=D0-(I5/R2)*LOG(RND(1))
30160 F1(3)=D0-.5*I5*LOG(RND(1))
30170 FORI=1TO8:FORJ=1TO8:IF1080 D5=INT((Z/12)*8+1.5):IFD5>8THEND5=1
32085 FORI=1TO5:FORJ=1TO5:V$(I,J)=" ":NEXTJ:NEXTI:N=0
32087 V$(3,3)=LEFT$(S5$,1)
32090 OND5GOTO32100,32130,32150,32170,32190,32220,32260,32300
32100 I=S6-2:J=S7-2:V$(1,1)=Q$:IF(J>0)AND(I>0)THENV$(1,1)=Q$(I,J)
32110 I=S6-1:J=S7-1:V$(2,2)=Q$:IF(I>0)AND(J>0)THENV$(2,2)=Q$(I,J)
32120 N=N+1:IFN=3THEN32350
32125 I=S6-2:V$(1,2)=Q$:IF(I>0)AND(J>0)THENV$(1,2)=Q$(I,J)
32130 I=S6-2:V$(1,3)=Q$:IFI>0THENV$(1,3)=Q$(I,S7)
32135 I=S6-1:V$(2,3)=Q$:IFI>0THENV$(2,3)=Q$(I,S7)
3=S6+1:J=S7-1:V$(4,2)=Q$:IF(I<11)AND(J>0)THENV$(4,2)=Q$(I,J)
32280 N=N+1:IFN=3THEN32350
32290 J=S7-2:V$(4,1)=Q$:IF(I<11)AND(J>0)THENV$(4,1)=Q$(I,J)
32300 J=S7-2:V$(3,1)=Q$:IFJ>0THENV$(3,1)=Q$(S6,J)
32310 J=S7-1:V$(3,2)=Q$:IFJ>0THENV$(3,2)=Q$(S6,J)
32320 N=N+1:IFN=3THEN32350
32330 I=S6-1:J=S7-2:V$(2,1)=Q$:IF(I>0)AND(J>0)THENV$(2,1)=Q$(I,J)
32340 GOTO32100
32350 FORI=1TO5
32360 IF(V$(I,1)=" ")AND(V$(I,3)=" ")AND(V$(I,5)=" ")THEN32390
32370 PRINT"  ";
32380 FORJ=1TO5:PRINTV$(I,J);" ";:NEXTJ:PRINT
32$:GOTO29220
29080 PRINT" POSITION      ";Q1;"-";Q2;", ";S6;"-";S7:GOTO29220
29090 PRINT" LIFE SUPPORT   ";:IFD4(5)<>0THEN29110
29100 PRINT"ACTIVE":GOTO29220
29110 IFC5$<>"DOCKED"THEN29130
29120 PRINT"DAMAGED, SUPPORTED BY STARBASE":GOTO29220
29130 PRINT"DAMAGED, RESERVES=";FNS(L1):GOTO29220
29140 PRINT" WARP FACTOR   ";FNR(W1):GOTO29220
29150 PRINT" ENERGY";SPC(8);.01*INT(100*E1):GOTO29220
29160 PRINT" TORPEDOS      ";T4:GOTO29220
29170 PRINT" SHIELDS        ";:B$="DOWN,":IFS4<>0THENB$="UP,"
2918<S2(I,J)THENS2(I,J)=1
30180 NEXTJ:NEXTI
30185 PRINT
30190 PRINT"SPOCK HAS RECONSTRUCTED A CORRECT STAR CHART FROM MEMORY."
30200 GOSUB18000:RETURN
31000 REM - TRANSFER
31001 J3=0
31010 IFD4(12)<>0THEN31120
31020 INPUT"NUMBER OF UNITS TO SHIELDS";Z3
31030 IFZ3<0THENRETURN
31040 IFE1+S3-Z3>0THEN31060
31050 PRINT"SCOTT HERE-  'WE ONLY HAVE";FNR(E1+S3);"UNITS LEFT.'"
31051 RETURN
31060 E1=E1+S3-Z3:S3=Z3:PRINT"--ENERGY TRANSFER COMPLETE--"
31070 PRINT"(SHIP ENERGY=";FNR(E1);"    SHIELD ENERGY=";FNR2140 N=N+1:IFN=3THEN32350
32145 I=S6-2:J=S7+1:V$(1,4)=Q$:IF(I>0)AND(J<11)THENV$(1,4)=Q$(I,J)
32150 I=S6-2:J=S7+2:V$(1,5)=Q$:IF(I>0)AND(J<11)THENV$(1,5)=Q$(I,J)
32155 I=S6-1:J=S7+1:V$(2,4)=Q$:IF(I>0)AND(J<11)THENV$(2,4)=Q$(I,J)
32160 N=N+1:IFN=3THEN32350
32165 J=S7+2:V$(2,5)=Q$:IF(I>0)AND(J<11)THENV$(2,5)=Q$(I,J)
32170 J=S7+2:V$(3,5)=Q$:IFJ<11THENV$(3,5)=Q$(S6,J)
32175 J=S7+1:V$(3,4)=Q$:IFJ<11THENV$(3,4)=Q$(S6,J)
32180 N=N+1:IFN=3THEN32350
32185 I=S6+1:J=S7+2:V$(4,5)=Q$:IF(I<11)AND(J<11)THENV$(4,5)=390 NEXTI:RETURN
33000 REM - WAIT
33001 J3=0:INPUT"HOW MANY STARDATES";Z5
33010 IF(Z5<R5)AND(K3=0)THEN33030
33020 INPUT"ARE YOU SURE";B$:IFLEFT$(B$,1)<>"Y"THENRETURN
33030 R6=1
33040 IFZ5<=0THENR6=0
33050 IFR6=0THENRETURN
33060 T1=Z5:Z6=Z5
33070 IFK3=0THEN33100
33080 T1=1+RND(1):IFZ5<T1THENT1=Z5
33090 Z6=T1
33100 IFT1<Z5THENGOSUB1000
33110 IFA2<>0THENRETURN
33120 GOSUB9000:J3=1:IFA2<>0THENRETURN
33130 Z5=Z5-Z6:GOTO33040
34000 REM:WARP
34001 J3=0:IFD4(6)<>0THEN34750
34010 INPUT"ENTER COURSE0
34540 IF.25*D1>RND(1)THENW=1
34550 IF(Q4=0)AND(W=0)THEN34660
34560 A=(15-D2)*.5235998:X1=-SIN(A):X2=COS(A)
34570 B8=ABS(X1):IFABS(X2)>ABS(X1)THENB8=ABS(X2)
34580 X1=X1/B8:Y1=Y1/B8:N=INT(10*D1*B8+.5):X=S6:Y=S7
34590 IFN=0THEN34660
34600 FORL=1TON
34610 X=X+X1:Q=INT(X+.5):IF(Q<1)OR(Q>10)THEN34660
34620 Y=Y+Y1:R=INT(Y+.5):IF(R<1)OR(R>10)THEN34660
34630 IFQ$(Q,R)="."THEN34650
34640 Q4=0:W=0
34650 NEXTL
34660 GOSUB15000:IFA2<>0THENRETURN
34670 E1=E1-D1*W1*W1*W1*(S4+1):IFE1>0THEN34690
34680 F9=4:"THE FAERIE QUEENE WHICH IS ANTIQUATED, BUT"
35130 PRINT"STILL USABLE.":N=INT(RND(1)*R3+1):Q1=B2(N):Q2=B3(N)
35140 S6=5:S7=5:GOSUB18000:Q$(S6,S7)="."
35145 FORL=1TO3:S6=INT(3*RND(1)-1+B6)
35150 IF(S6<1)OR(S7>10)THEN35180
35160 S7=INT(3*RND(1)-1+B7):IF(S7<1)OR(S7>10)THEN35180
35170 IFQ$(S6,S7)="."THEN35190
35180 NEXTL:GOTO35140
35190 S5$="FAERIE QUEENE":Q$(S6,S7)=LEFT$(S5$,1):C5$="DOCKED"
35200 FORL=1TO12:D4(L)=0:NEXT:D4(10)=-1:E1=3000:I7=E1
35210 S3=1500:I8=S3:T4=6:I9=T4:L1=3:J1=L1:S4=0:W1=5:W2=2510 END
                                                                                                                                                                                                                                                                                                                                                                                                 AND DISTANCE";D2,D1
34020 IFD2<0THENRETURN
34030 P=(D1+.05)*W1*W1*W1*(S4+1):IFP<E1THEN34150
34040 J3=0:PRINT:PRINT"ENGINEERING TO BRIDGE--"
34050 IF(S4=0)OR(.5*P>E1)THEN34080
34060 PRINT"  WE HAVEN'T THE ENERGY TO GO THAT FAR WITH";
34070 PRINT" THE SHIELDS UP.":RETURN
34080 W=INT((E1/(D1+.05))^.333333):IFW<=0THEN34130
34090 PRINT"  WE HAVEN'T THE ENERGY.  BUT WE COULD DO IT AT WARP";W
34100 IFS4<>0THEN34120
34110 RETURN
34120 PRINT"  IF YOU'LL LOWER THE SHIELDS.":RETURN
34130 PRINT"  WE CAN'T GOSUB10000:RETURN
34690 T1=10*D1/W2:IFW<>0THENGOSUB30000
34700 IFQ4=0THEN34740
34710 PRINT:PRINT"ENGINEERING TO BRIDGE--":PRINT"   SCOTT HERE-  ";
34715 PRINT"'WE'VE JUST BLOWN THE WARP ENGINES."
34720 PRINT"   WE'LL HAVE TO SHUT 'ER DOWN HERE, CAPTAIN.'"
34725 D4(6)=D5*(3*RND(1)+1)
34740 J3=1:RETURN
34750 PRINT"WARP ENGINES DAMAGED.":RETURN
35000 REM - ABANDON
35001 ONSGN(D4(10))+2GOTO35010,35030,35020
35010 PRINT"YE FAERIE QUEENE HAS NO SHUTTLE CRAFT.":RETURN
35020 PRINT"SHUTTLE CRAFT DAMAGED.
35220 RETURN
36000 REM - DESTRUCT
36001 IFD4(11)=0THEN36030
36010 PRINT"COMPUTER DAMAGED - CANNOT EXECUTE DESTRUCT SEQUENCE"
36020 RETURN
36030 PRINT:PRINT"    ---WORKING---"
36040 PRINT"IDENTIFICATION-POSITIVE"
36050 PRINT"SELF-DESTRUCT-SEQUENCE-ACTIVATED":J=3
36060 FORI=10TO6STEP-1:PRINTSPC(J);I:GOSUB36210:J=J+3:NEXT
36070 PRINT"ENTER-YOUR-MISSION-PASSWORD-TO-CONTINUE"
36080 PRINT"SELF-DESTRUCT-SEQUENCE-OTHERWISE-DESTRUCT"
36090 PRINT"SEQUENCE-WILL-BE-ABORTED"
36100 INPUTB$:IFB$<>X$THEN36190                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                DO IT, CAPTAIN.  WE HAVEN'T GOT THE ENERGY."
34140 RETURN
34150 T1=10*D1/W2:IFT1<.8*R5THEN34500
34160 PRINT:PRINT"MR. SPOCK - 'CAPTAIN, I COMPUTE THAT SUCH A TRIP"
34170 PRINT" WILL REQUIRE APPROXIMATELY";FNR(100*T1/R5);
34180 PRINT"PERCENT":PRINT"   OF OUR REMAINING TIME.  ARE YOU SURE ";
34190 INPUT "THIS IS WISE";B$:IFLEFT$(B$,1)="Y"THEN34500
34200 J3=0:RETURN
34500 Q4=0:W=0:IFW1<=6THEN34660
34510 P=D1*(6-W1)^2/66.66666:IFP>RND(1)THENQ4=1
34520 IFQ4<>0THEND1=RND(1)*D1
34530 W=0:IFW1<10THEN3455":RETURN
35030 PRINT:PRINT"***ABANDON SHIP!  ABANDON SHIP!"
35040 PRINT"***ALL HANDS ABANDON SHIP!":PRINT
35050 PRINT"YOU AND THE BRIDGE CREW ESCAPE IN THE GALILEO."
35060 PRINT"THE REMAINDER OF THE CREW BEAMS DOWN"
35070 PRINT"TO THE NEAREST HABITABLE PLANET.":IFR3<>0THEN35090
35080 F9=9:GOSUB10000:RETURN
35090 PRINT:PRINT"YOU ARE CAPTURED BY KLINGONS AND RELEASED TO"
35100 PRINT"THE FEDERATION IN A PRISONER-OF-WAR EXCHANGE."
35110 PRINT"STARFLEET PUTS YOU IN COMMAND OF ANOTHER SHIP,"
35120 PRINT
36110 PRINT"PASSWORD-ACCEPTED":J=10
36120 FORI=5TO1STEP-1:PRINTSPC(J);I:GOSUB36210:J=J+3:NEXT
36130 PRINT:PRINT"*****ENTROPY OF ";S5$;" MAXIMIZED*****"
36140 PRINT:IFK3=0THEN36180
36150 W=20*E1:FORL=1TOK3:IFK6(L)*K7(L)>WTHEN36170
36160 A5=K4(L):A6=K5(L):T2$=Q$(A5,A6):GOSUB6000
36170 NEXTL
36180 F9=10:GOSUB10000:RETURN
36190 PRINT"PASSWORD-REJECTED"
36200 PRINT"CONTINUITY-EFFECTED":PRINT:RETURN
36210 K=12345:FORM=1TO90:K=K+1:NEXTM:RETURN
37000 REM - STATUS
37001 FORI=1TO10:GOTO29040:RETURN
370Г3   Copyright (c) 1979, Digital Research????????????   CON:RDR:PUN:LST:DEV:VAL:USR:DSK:TTY:CRT:BAT:UC1:TTY:PTR:UR1:UR2:TTY:PTP:UP1:UP2:TTY:CRT:LPT:UL1:R/O R/W SYS DIR R/O R/W SYS DIR ** Aborted ** Active User : Active Files:       Drive Characteristics 65536:  128 Byte Record Capacity Kilobyte Drive  Capacity 32  Byte Directory Entries Checked  Directory Entries Records/ Extent Records/ Block Sectors/ Track Reserved Tracks  is  Temp R/O Disk: d:=R/O Set Indicator: d:filename.typ $R/O $R/W $SYS $DIR Disk SЙ!gr+s+p+q!h6> fНкµКr*dл*fН!is*dлНЃ"dPY!
 Нл"f> НУµЖяџ!h¦#х~“ЦџБHЎТaН«Гo!h6 :iЖ0OНђГЙ!mr+s+p+q*lTеНZлбs#r*lл НвЪ¶*lл Нвл+s#r*jN#F+q#pГЊЙ!nq!  "o"q}2uo& "s *	лsНЭЪ:nТс*sDMНЫ2u:uЪqoНs *s"sТО*oЙ№НТЙЗНТНЉO 
 НХНТ!v6 >!vѕЪQ*v& w	6 `i+4В6П)НA*Н:'юяК“:'ж‡‡‡‡‡O !П)	~2vюеКЌ:vжO !w	6Н,Г]!v6 >!vѕЪВ*v& w	~Т»*vM 
 Н!v4ВЙгНТН8ЖAOНђ:НђиН±*##N! НЅ"— *	N#F*—лН "™Н ЙНQ" Н8ЖAOНђjН±ЙН·DMНЏЙmНТННЙНZ"іНl"µ!·6 > іНкµКҐ*і}Т†*·MНМНЃН±*µ}ТxOНђГ}WНђ„Н±Н!іНГл+s#r!µНГл+s#r#4ГDН Й:\ ю К№:\ =OНМЙНіН©!6 !М)6яНlТд:М)ю ВЪЙ:М)=2М)Гр:] ю ВрН&Й!  "ё}2\ !h 6?!j 6?\ Н:'юяКC:'ж‡‡‡‡‡ЖЂo& "є)!Л)6 !  "ѕ):Л)/ёѕ)хНЭџБHЎТН]!Ж)6>!Ж)ѕЪЋ*Ж)& л*є)е*Ж)& л*ј)Б
ѕКy!Ж)6Г„:Ж)ЦЦџ2Л):Ж)<2Ж)ВM*ѕ)#"ѕ)Г/:Л)Т©*ѕ)+"ѕ)Г`*ё"ѕ)#"ёН] !ёНшџ *ј)л! хНшџ/БH±ТнҐНТ!  "ѕ)! "ёН]*ѕ)є)	е*ѕ)лбs#r!Ж	wГ
 *ј)	>¦*ј)	wГПбу.е*ј)DM\ б
-В+!\ 6 НuмН±:М)‡‡O !™	DMН±*А)#"А)Г™Й*ѕ)))))П)"ј)Й:m ю Вw> Й.Yn 
-В:YЦSЦџх:ZЦ ЦџБHЎТ§!6>юЙ©Н
2М)ю ВЅЋНТ>Й!Н)6>!Н)ѕЪ*Н)& л*ј)>¦2О)ю Кч:Н)ю	Вр.Нђ*О)MНђ:Н)<2Н)ВЕЙН9Н9:Yю=В/Н9хНюТ&Н©НcГ,щНТГHН©9Н
юВEНГГHНєЙГ  Г Г Н ЙЙЙi`N#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ	с=В†ЙDM!  >)л)лТ­	=ВҐЙ~ВіЙ^#Vл)ВЅЙ^#Vл|·g}oВЗЙ_ {•ozњgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлtatus  : DSK: d:DSK: User Status  : USR: Iobyte Assign:  = Bad Delimiter Invalid Assignment Bad Delimiter :  Bytes Remaining On  R/ , Space:  Invalid File Indicator ** Too Many Files ** File Not Found  Size   Recs  Bytes  Ext Acc 65536  set to  R/O Invalid Disk Assignment Wrong CP/M Version (Requires 2.0) !  9"2!TщНню ТOНТГ‹!]6:\ Ц Цџх:] Ц ЦџБHЎТrН3Г‹:\ ю КЂНГ‹Н‡
/Т‹Нє*2щЙ!"q*"& лНLЙНђ
НђЙ НђЙ!$p+q*#~ю КС*#NНђ*##"#Г·Й!&p+qН *%DMН±Й  НOЙ  НOЙ!(q*(& л> НУµЦџ!—хНшµЖяџБHЎТ%	яНТГ-	*™DMНА	Н± Н·DMНА	 Н± *	N#FНА	9Н± *	^#Vл))DMНА	TН± *	~<o& Ђ НћDMНА	oН±*—DMНА	Н±*N#FНА	ЋН± *	N#FНА	ќН±Н Й!њp+qН *›DM'Н:НђН«ЙНZ"ќ!џ6 > ќНкµК
*ќ}Т
*џMНМНГ!ќНГл+s#r#4Ги	Й!ўs+p+q!¤6 !¦6 6:ў!¦ѕЪ„
!Ґ6!Ј6 >!ЈѕЪr
*¤& л* е*Ј& Y	СѕКi
!Ґ6 !¤4+4ВA
:ҐТ}
:¦Й!¦4В-
> Й!Є6 Н99Н
2§ю ВЁ
:ЄЦ ЖяџЙ!Є4:§юВ: 2©!Ё6 +6 >!§ѕЪ:§‡‡O !9	DMНi­Н±:©ж‡‡!Ё†O !Y	DMНi:ЁЖ2Ё)6 >!Ж)ѕЪ.*Ж)& л*є)е*Ж)& л*ј)Б
w:Ж)<2Ж)В*ѕ)є)	> w#6 *ѕ)є)	w#6 *ѕ)є!)	w#6 *ѕ)є%)	w#6 *ѕ)є)	N#F*ѕ)Еє)	Бq#p*ѕ)є%)	 е*є)	~СНe е*є)	 е*	~б¦o& Ђ НћБ	е*ѕ)є%)	Бq#p!З)6 *	>яНхТТ!З)6!Ж)6>!Ж)ѕЪ=Гс:З)!Ж)†wТЧГ=*Ж)& л*є)~2И):З)юВ*Ж)&  	л*є):И)¶2И):И)ю К:*ѕ)є!)	е*ѕ)є)	лБНsГгН,Г
> ёНкµВXєНТГ\:М)юяВ“>!ёНхТd! "А)> !А)НхТd!  "А)!  "Д)*ё++л!Д)НшЪa*Д)ј)	^#Vл"ѕ)Н]*ј)"є)*Д)є)	^#Vл"ѕ)Н]!Ж)6>!Ж)ѕЪT*Ж)& л*є)~2Й)е*Ж)& л*ј)~2К)OС№Т;*Д)є)	^#Vл"Й                                                                                                                                                                                                                                                                                                                                                                                                НLЙ!*p+q*)лНO2'Й!,p+q*+лНO2'Й  НO2'Й  НOЙ!.p+q*-лНLЙ  НRЙ  НRЙ  НLЙ  НRЙ\ НLЙ  НR"Йя  НOЙ!/q*/& л НLЙ!1p+q*0л#НLЙН~*##N! НЅЂ Нћ"TЙ!Vq*VMНцНіЙ!Xp+q!WНГл* >WеНr#MбНІЙ!_p+q!`6 >!`ѕЪ6*`& л*^е*`& Y	СѕК/> Й!`4В	>Й*]& Ђ 	~ю ВO!]4Г9!a6 :aюТж*]& Ђ 	~2bO>№Тz*bMНлГ Нл>!b–џ/х~Ц,ЦџБH±х~Ц:ЦџБH±х~Ц*ЦџБH±х~Ц.ЦџБH±х~Ц>ЦџБH±х~Ц<ЦџБH±х~Ц=ЦџБH±ТЯ*]& Ђ 	6Гг!]4ГT!]4Й!cq*a& Y	:cw!a4:©жю2©Н !§4ВВ
ГF:§юВ®ІНТИНТъНТНТ)НТ!§6 >!§ѕЪ«Н :§‡‡O !9	DMНi8Н±!Ё6 >!ЁѕЪ¤Г…:ЁЖ2ЁТkГ¤ Нђ:§‡‡‡‡!Ё†O !Y	DMНiГw!§4ВCГF:§юВїН>ЙГF:§юВННЭ	ГF:§=2§‡‡‡‡2ЁН9:Yю=Кп;НТ>ЙН9*Ё& Y	DMН
=2ЁюяВIНТ>Й!©6ь:§=2§юяК8:©2©:Ё‡‡2ЁГ:©! ¦!Ё¶2 Н9:Yю ВT>Й:Yю,Кe\НТ>ЙГЊ
Й!¬p+q*«~ю:К‰*«NНђ*«#"«Гo:НђЙ!®p+q!'"±!°6 > ±НкµКь*­л*±Н{2Ї*­лНЃ"­PY!
 Нл"±> НУµЦџ!°¶+х~“ЖяџБH±Тщ!°6:ЇЖ0OНђГ kНђВ)*Д)ј)	е*Д)є)	гN#Fбq#p*Д)ј)	е*В)лбs#r*А)#"А)!Ж)6ГJ:К)!Й)ѕТJ!Ж)6:Ж)<2Ж)ВЖ *Д)"Д)Т€Гq:ТtЙНТГwН РН±!  "А)ёА)НЭТЌ*А)є)	^#Vл"ѕ)Н]Н .е*ј)DM\ б
-В°!\ 6 :Тй\ НЈ: ю КЫжН±Гж*} DM'НН«*ѕ)є%)	N#F'НН«*ѕ)є!)	N#F'НkНђН«*ѕ)є)	N#FиНН«RНђ/Нђ	 *ј)	~ТIOНђГNWНђН«Н8ЖAOНђ:Нђ
 *ј)	~2И)Тt(НђНА:И)Тѓ)Нђ*А)#"А)ГѓН&Г\!  "А)ёА)НЭТ\НдТ°НЙ*А)"ѕ)Н]Н НА*М)M !		^#Vлй	 *ј)	>Ђ¶*ј)	wГ	 *ј)	>¦*ј)	wГ
 *ј)	>Ђ¶*ј)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                G RANGE SENSORS
1028 DATA PHASERS, PHOTON TORPEDOES,SHIELD CONTROL
1029 DATA DAMAGE CONTROL, COMPUTER,DAMAGE REPAIR,COMMUNICATIONS
1030 FOR A=1TO10:READ D$(A):NEXT A
1031 A$(0)=" . ":A$(1)=" E ":A$(2)=" * ":A$(3)=" K ":A$(4)=" B "
1032 F1=.86:F2=.01:F3=.95:F4=.99:K9=0:B9=K9
1033 FORI=1TO8:FORJ=1TO8:R1=RND(1):R2=RND(1):R3=INT(8*RND(1)+1)
1034 K3=-(R1>F1-F2*R9)-(R1>F3-F2*R9)-(R1>F4-F2*R9):K9=K9+K3
1035 B3=-(R2>F3):B9=B9+B3:G(I,J)=100*K3+10*B3+R3:NEXTJ,I
1036 IF NOT(B9>0ANDK9>0)THEN1032
1037 PRINT"OB,1);",";MID$(STR$(S2),2,1);")"
1062 IFKP<>0THEN1404
1063 IF DT=1 THEN 1267
1064 IFS<200*K3THENPRINTAR$;"SHIELD ENERGY TOO LOW":SL=1:A=6:GOTO1074
1065 A=2: GOTO1074
1066 PRINT
1067 PRINTD$(2):FORA=1TO8:FORB=1TO8:PRINTA$(S(A,B));:NEXTB:PRINT:NEXTA
1068 PRINT:PRINT"SHIELDS";S;SPC(4);"ENERGY";E;SPC(4);"PHOTONS";P;
1069 PRINTSPC(4);"STARDAYS";T9-T
1070 GOSUB1321:INPUT"COMMAND";A
1071 IF A>10 OR A<0 THEN INPUT" ----> COMMAND";A
1072 IFA>10ORA<0THENPRINT"WARNING - PROPER COMMANDS ONLY !! ":GOTO 1070
101)>.1THEN1112
1102 IFRND(1)>.1THEN1112
1103 GOTO1109
1104 IFRND(1)>R9/10THENRETURN
1105 R1=INT(RND(1)*8+1):IFD(R1)<0THENRETURN
1106 D(R1)=D(R1)-10*RND(1)-1:IFD(7)<0THENRETURN
1107 IFD(7)<0THENRETURN
1108 PRINT:PRINT"DAMAGE CONTROL REPORT: "D$(R1)" OUT.":PRINT:RETURN
1109 R1=INT(RND(1)*8+1):IFD(R1)>=0THEN1112
1110 IFD(7)<0THEN1112
1111 PRINT:D(R1)=0:PRINT"DAMAGE CONTROL REPORT: "D$(R1)" REPAIRED.":PRINT
1112 W1=W1*8:A1=8*Q2+S2-9:B1=72-8*Q1-S1:IFW1<1THENW1=W1*1.25
1113 E=E-2*W1:T=T+W1/25:IFT>T9THE1000 'EXPANDED APRIL 1977 BY W.A.BURTON
1001 'PIRATED JAN. 1978 BY ZOSO
1002 DIM G(8,8),S(8,8),K(3,3)
1003 PRINTCHR$(26)
1004 PRINT TAB(21)"--STARTREK--":PRINT
1005 PRINT
1006 INPUT "WHAT IS YOUR SECURITY CLEARANCE NUMBER (1 TO 1000)";T9
1007 E8=T9
1008 IF T9<1 OR T9>1000 THEN PRINT AR$;"INVALID!! REENTER!!":GOTO 1006
1009 FOR A=1 TO T9/2
1010 R9=RND(1):R9=RND(2)
1011 NEXT
1012 CLEAR:PRINTCHR$(26):INPUT"       ENTER RANK     (1=LOW,12=HIGH)";R9
1013 RR=R9
1014 X4=R9:R9=R9+1E-03:W1=W1+1E-03
10JECTIVE:DESTROY"K9"KLINGONS USING"B9"STARBASE";
1038 U=K9:Y=B9
1039 IFB9=1THENPRINT" ";:GOTO1041
1040 PRINT"S ";
1041 T9=K9+RND(1)*K9/R9+10-R9:PR=T9/K9:PRINT"IN"T9"STARDAYS."
1042 GOSUB 1425
1043 S3=0:B3=S3:K3=B3:FORA=1TO8:FORB=1TO8:S(A,B)=0:NEXTB,A
1044 FORA=1TO3:FORB=1TO3:K(A,B)=0:NEXTB,A:S(S1,S2)=1
1045 X=.01*G(Q1,Q2):K3=INT(X):Y=(X-K3)*10:B3=INT(Y)
1046 S3=G(Q1,Q2)-100*K3-10*B3
1047 IF K3=0THENFORA=1TO3:FORB=1TO3:K(A,B)=0:NEXTB,A:GOTO1051
1048 PRINTAR$;"CONDITION RED !!!!!":FORA=1TOK3
1049 R73 IFA=1THEN1077
1074 IFD(A)>=0THEN1077
1075 PRINTAR$;"CAPTAIN, WE DON'T HAVE ";D$(A);" ANYMORE."
1076 IF DT=1 THEN 1267 ELSE 1070
1077 ONAGOTO1081,1066,1146,1152,1178,1213,1222,1267,1489,1389
1078 PRINT:FORA=1TO9:PRINTA;" = ";D$(A):NEXTA
1079 A=10
1080 PRINTA;"= ";D$(A):GOTO1070
1081 INPUT"COURSE";C1:IF C1<0 OR C1>359.99 THEN1084
1082 INPUT"WARP FACTOR";W1
1083 SL=0:KP=0:GOTO 1085
1084 PRINTAR$"REJECTED ! COURSE MUST BE IN RANGE OF O TO 359.99 DGRS."
1085 IFNOT(W1>0)THEN1070
1086 IFD(1)>=0ORW1N1251
1114 A2=INT(A1+W1*COS(C1*CX)+.5)
1115 B2=INT(B1+W1*SIN(C1*CX)+.5)
1116 IFNOT(A2<0ORA2>63ORB2<0ORB2>63)THEN1119
1117 PRINTAR$;"CAPTAIN, HEED STARFLEET REGULATIONS! ( STAY IN GALAXY ) !!
1118 T=T+W1/24:GOTO1070
1119 DEF FNA1(X)=INT(.5+A1+X*COS(C1*CX))
1120 DEF FNB1(X)=INT(.5+B1+X*SIN(C1*CX))
1121 FORX=0TOINT(W1)
1122 IFNOT(Q1=8-INT(FNB1(X)/8)ANDQ2=INT(FNA1(X)/8+1))THENX=W1:GOTO1139
1123 S3=8-FNB1(X)+8*INT(FNB1(X)/8):S4=FNA1(X)+1-8*INT(FNA1(X)/8)
1124 IFS(S3,S4)<2THEN1139
1125 S(S1,S2)=0:S1=815 PRINT CHR$(26)
1016 PRINT "COMMAND ORDER : STAND BY !"
1017 PRINT "YOU ARE PRESENTLY BEING ASSIGNED TO A MISSION..."
1018 PRINT " WITH A FAILURE FACTOR OF"; (RR*20)
1019 PRINT"       GOOD-BYE, SIR..."
1020 CX=.017453:AR$=" ---> "
1021 XA=INT(X4*50):AC=(1/(X4+.1))
1022 IFX4>=9THEN1379
1023 E=3000-XA+100:P=10:S9=200
1024 DEF FND(D)=SQR((K(I,1)-S1)^2+(K(I,2)-S2)^2)
1025 Q1=INT(RND(1)*8+1):Q2=INT(RND(1)*8+1)
1026 S1=INT(RND(1)*8+1):S2=INT(RND(1)*8+1)
1027 DATA WARP ENGINES,SHORT RANGE SENSORS,LON1=INT(RND(1)*8+1):R2=INT(RND(1)*8+1):IFS(R1,R2)<>0THEN1049
1050 S(R1,R2)=3:K(A,1)=R1:K(A,2)=R2:K(A,3)=S9:NEXT A:IFB3=0THEN1054
1051 IFB3=0THEN1054
1052 R1=INT(RND(1)*8+1):R2=INT(RND(1)*8+1):IFS(R1,R2)<>0THEN1052
1053 S(R1,R2)=4
1054 IFS3=0THEN1058
1055 FORA=1TOS3
1056 R1=INT(RND(1)*8+1):R2=INT(RND(1)*8+1):IFS(R1,R2)<>0THEN1056
1057 S(R1,R2)=2:NEXTA
1058 G(Q1,Q2)=INT(G(Q1,Q2))+.5
1059 PRINT
1060 PRINT"QUADRANT (";MID$(STR$(Q1),2,1);",";MID$(STR$(Q2),2,1);")"
1061 PRINT"SECTOR   (";MID$(STR$(S1),2<=ACTHEN1089
1087 PRINTAR$;"WARP ENGINES ARE DAMAGED, MAXIMUM SPEED = ";AC
1088 GOTO1081
1089 TEC=TEC+1:C$="":IFK3>0THENGOSUB1228
1090 IFE>5*W1THEN1097
1091 IFS<1THEN1244
1092 PRINT"CAPTAIN, YOU ONLY HAVE"E"UNITS OF ENERGY. "
1093 PRINT"REFUEL FROM YOUR SHIELD RESERVES, WHICH HAVE"S"UNITS?"
1094 A=6
1095 IFD(A)<0THEN1244
1096 GOTO1070
1097 FORI=1TO10:IFD(I)>=0THEN1101
1098 D(I)=D(I)+1:IFD(I)<0THEN1101
1099 IFD(7)<0THEN1101
1100 PRINT"DAMAGE CONTROL REPORT: "D$(I)" REPAIRED."
1101 NEXTI:IFRND(-FNB1(X-1)+8*INT(FNB1(X-1)/8)
1126 S2=FNA1(X-1)+1-8*INT(FNA1(X 1)/8):S(S1,S2)=1
1127 PRINTAR$;"NAVIGATIONAL ERROR :ENGINES SHUT DOWN AT (";
1128 PRINTMID$(STR$(S1),2,1);","MID$(STR$(S2),2,1);")"
1129 T=T+(W1/24)
1130 PRINT" YOU LOST "T" UNITS STARTIME RESTARTING ENGINES."
1131 PRINT
1132 IF S(S3,S4)<>4 THEN 1070
1133 PRINT"SHIELDS LOWERED FOR REFUELING"
1134 S=0:P=10:C$="D":E=3000-XA+100
1135 GOSUB 1228
1136 FORR1=1TO 10
1137 IFD(R1)>=0THENNEXTR1:GOTO1070
1138 D(R1)=D(R1)+(11*RND(1)/R9):NEXTR1:76
1167 H=(X/FND(0))+SGN(RND(1)-.5)*8*RND(1)
1168 K(I,3)=K(I,3)-H
1169 PRINTH"UNIT HIT ON VESSEL AT (";MID$(STR$(K(I,1)),2,1);",";
1170 PRINTMID$(STR$(K(I,2)),2,1);"), LEAVING"K(I,3)"
1171 IFK(I,3)>0THEN1176
1172 PRINT"KLINGON AT (";MID$(STR$(K(I,1)),2,1);",";MID$(STR$(K(I,2)),2,1);
1173 PRINT") DESTROYED":K3=K3-1:K9=K9-1:IFK9=0THEN1264
1174 G(Q1,Q2)=G(Q1,Q2)-100:S(K(I,1),K(I,2))=0:K(I,1)=0:K(I,2)=0
1175 K(I,3)=0
1176 NEXT I
1177 GOTO1070
1178 PRINT
1179 IFP>0THEN1182
1180 PRINTAR$;"ALL PHOTONYOU CAN'T DESTROY A STAR":GOTO1070
1205 G(Q1,Q2)=G(Q1,Q2)-10:GOTO1070
1206 NEXT W1
1207 GOTO1070
1208 FORW1=0TO8
1209 S3=INT(S1-W1*SIN(C1*CX))
1210 S4=INT(S2+W1*COS(C1*CX))
1211 IFS3>8ORS4>8ORS3<1ORS4<1THEN1070
1212 GOTO1194
1213 PRINT
1214 PRINT"ENERGY AVAILABLE="E+S"    NUMBER OF UNITS TO SHIELDS";
1215 INPUT X
1216 IFX<0THEN1070
1217 IFE+S-X<0THEN1214
1218 E=E+S-X
1219 S=X
1220 IFSL=1THEN1065
1221 GOTO1070
1222 PRINT
1223 PRINT"DEVICE        STATE OF REPAIR"
1224 FORR1=1TO10:PRINTD$(RRINT:PRINT
1257 CY=0
1258 PRINT"THERE ARE"K9"KLINGONS REMAINING.":IFCY<>0THEN1355
1259 PRINT"YOU HAVE FAILED !!":PRINT
1260 L=INT(RND(1)*5)
1261 ONL+1GOTO 1343,1346,1348,1350,1353
1262 PRINT:INPUT"DO YOU WANT TO TRY AGAIN";X$
1263 IF LEFT$(X$,1)="Y" THEN 1012 ELSE 1541
1264 PRINT"THE FEDERATION IS SAVED !!"
1265 PRINT"YOU ARE HEREBY PROMOTED TO ADMIRAL!!!!":PRINT
1266 GOTO1262
1267 DT=1
1268 INPUT"COMPUTER ON--COMMAND";A
1269 IF A>=10 THEN PRINT AR$;" NO SUCH COMMAND !!":GOTO 1268
1270 ONA+1GOGOTO1070
1139 NEXT X:S(S1,S2)=0:S1=8-B2+8*INT(B2/8):S2=A2+1-8*INT(A2/8)
1140 Q3=8-INT(B2/8):Q4=INT(A2/8)+1
1141 IFNOT(Q1=Q3ANDQ2=Q4)THENQ1=Q3:Q2=Q4:GOTO1043
1142 S(S1,S2)=1:FORA=S1-1TOS1+1:FORB=S2-1TOS2+1
1143 IFA>8ORB>8ORA<1ORB<1THEN1145
1144 IFS(A,B)=4THEN1133
1145 NEXTB,A:GOTO1070
1146 PRINT
1147 FOR A=(Q1-1) TO (Q1+1):FOR B=(Q2-1) TO (Q2+1)
1148 IFA<1ORB<1ORA>8ORB>8THENPRINT" ***";:NEXTB:PRINT" ":PRINT:NEXTA:GOTO1070
1149 PRINT" "SPC(3-LOG(G(A,B)+1)/LOG(10));
1150 PRINTMID$(STR$(G(A,B)),2,LO TORPEDOES EXPENDED"
1181 GOTO1070
1182 INPUT"DIRECTION";C1
1183 T=T+.05:IFT>T9THEN1251
1184 P=P-1:IF C$<>"D" THEN GOSUB 1228
1185 A1=8*Q2+S2-9:B1=72-8*Q1-S1:IFC1=90*INT(C1/90)THEN1208
1186 DEF FNA1(W1)=INT(.5+A1+W1*COS(C1*CX))
1187 DEF FNB1(W1)=INT(.5+B1+W1*SIN(C1*CX))
1188 FORW1=0TO10STEP.9
1189 IFW1=0THENS3=S1:S4=S2:GOTO1194
1190 IFNOT(Q1=8-INT(FNB1(W1)/8)ANDQ2=INT(FNA1(W1)/8+1))THEN1070
1191 S3=8-FNB1(W1)+8*INT(FNB1(W1)/8):S4=FNA1(W1)+1-8*INT(FNA1(W1)/8)
1192 IFFNA1(W1)=A2ANDFNB1(W1)=B2THEN11);TAB(21) D(R1):NEXTR1
1225 IF DT=1 THEN 1267 ELSE 1070
1226 PRINT"SHORT RANGE SENSORS REPORT NO KLINGONS IN THIS QUADRANT"
1227 IF DT=1 THEN 1267 ELSE 1070
1228 IF C$="D" AND K3<>0 THEN PRINT"STARBASE PROTECTS ENTERPRISE" ELSE 1230
1229 GOTO1070
1230 PRINT
1231 FORI=1TO3
1232 IFK(I,3)<=0THEN1242
1233 H=K(I,3)/FND(0)+SGN(RND(1)-.5)*RND(1)*7
1234 S=S-H:PRINTH"UNIT HIT FROM ("MID$(STR$(K(I,1)),2,1);",";
1235 PRINTMID$(STR$(K(I,2)),2,1);"), LEAVING"S
1236 IFS<0THEN1254
1237 GOSUB1104
1238 IFRND(TO1289,1294,1299,1283,1059,1339,1341,1510,1070
1271 PRINT"FUNCTIONS AVAILABLE FROM COMPUTER"
1272 PRINT"   0 = GALACTIC MEMORY MAP"
1273 PRINT"   1 = GENERAL STATUS REPORT"
1274 PRINT"   2 = PHOTON TRAJECTORY"
1275 PRINT"   3 = NEW MISSION"
1276 PRINT"   4 = PRESENT POSITION"
1277 PRINT"   5 = SELF-DESTRUCT"
1278 PRINT"   6 = WARP-COMPASS"
1279 PRINT"   7 = MISSION PROGRESS REPORT"
1280 PRINT"   8 = EXIT COMPUTER"
1281 GOTO1267
1282 PRINT:PRINT"--TEMPORARY MALFUNCTION--":GOTO 1070
1283 IF XM<0 G(G(A,B))/LOG(10)+1);
1151 G(A,B)=INT(G(A,B))+.5:NEXTB:PRINT" ":PRINT:NEXTA:GOTO1070
1152 PRINT
1153 IFK3<=0THEN1226
1154 IFD(8)>=0THEN1156
1155 PRINTAR$;" COMPUTER FAILURE HAMPERS ACCURACY"
1156 PRINT"PHASERS LOCKED ON TARGET.  ENERGY AVAILABLE="E
1157 PRINT"NUMBER OF UNITS TO FIRE:";
1158 INPUT X
1159 IF E-X<0THENPRINT"NOT ENOUGH POWER":GOTO1070
1160 T=T+.05:IFT>T9THEN1251
1161 E=E-X
1162 IF C$<>"D"THEN GOSUB 1228
1163 IFD(8)>=0THEN1165
1164 X=X*RND(1)
1165 FORI=1TO3
1166 IFK(I,3)<=0THEN11206
1193 A2=FNA1(W1):B2=FNB1(W1)
1194 PRINT"(";MID$(STR$(S3),2,1);",";MID$(STR$(S4),2,1);")";A$(S(S3,S4))
1195 ON S(S3,S4)+1GOTO1206,1206,1204,1196,1203
1196 IFRND(1)<(.1*X4) THENPRINT"SHIELDS DEFLECT TORPEDO":GOTO1070
1197 PRINT"KLINGON DESTROYED":S(S3,S4)=0:G(Q1,Q2)=G(Q1,Q2)-100
1198 K3=K3-1:K9=K9-1:IFK9=0THEN1264
1199 FORA=1TO3
1200 IFK(A,1)=S3ANDK(A,2)=S4THENK(A,1)=0:K(A,2)=0:K(A,3)=0
1201 NEXTA
1202 GOTO1070
1203 PRINTAR$;"STARBASE DESTROYED":B3=0:B9=B9-1:S(S3,S4)=0:GOTO1205
1204 PRINTAR$;"1)>R9/10THEN1242
1239 R1=INT(8*RND(1)+1):R2=INT(8*RND(1)+1)
1240 IFNOT(S(R1,R2)=0)THEN1239
1241 S(R1,R2)=3:S(K(I,1),K(I,2))=0:K(I,1)=R1:K(I,2)=R2
1242 NEXTI
1243 RETURN
1244 PRINT AR$;" ENTERPRISE DEAD IN SPACE"
1245 PRINT
1246 CY=1:PRINT:GOTO1258
1247 IFK3<=0THEN1258
1248 GOSUB1228
1249 GOTO1247
1250 PRINT
1251 PRINT:PRINT:PRINT:PRINT:PRINT:PRINTAR$;
1252 PRINT"IT IS STARDATE"T:PRINT
1253 GOTO1258
1254 PRINT
1255 PRINT:PRINT:PRINT:PRINT:PRINT:PRINTAR$;
1256 PRINT"ENTERPRISE DISABLED !!":PTHEN 1287
1284 PRINT AR$;"SAFETY CHECK -- DO YOU WISH TO ABORT MISSION":INPUT AN$
1285 IF LEFT$(AN$,1)<>"Y" THEN 1288 ELSE 1012
1286 PRINT
1287 PRINT"YOU HAVE NOT BEEN AUTHORIZED FOR NEW MISSION !!":PRINT
1288 GOTO 1267
1289 PRINT"QUADRANT CODE MEMORY MAP"
1290 FORA=1TO :FORB=1TO8:IFG(A,B)=INT(G(A,B))THENPRINT" ???";:GOTO1293
1291 PRINT" "SPC(3-LOG(G(A,B)+1)/LOG(10));
1292 PRINTMID$(STR$(G(A,B)),2,LOG(G(A,B))/LOG(10)+1);
1293 NEXTB:PRINT" ":NEXTA:GOTO 1267
1294 PRINT"   STATUS REPORT"
1295 PRINTRB=1TO8
1326 IFG(A,B)-100*INT(G(A,B)/100)>9THENK1=A:K2=B:IFRND(1)>.5THENA=8:B=8
1327 NEXTB,A:TK=T+.09*SQR((Q1-K1)^2+(Q2-K2)^2)*(10-R9)
1328 TK=TK+1
1329 PRINTAR$;"!!! STARBASE IN QUADRANT ("MID$(STR$(K1),2,1)",";
1330 PRINTMID$(STR$(K2),2,1)") IS UNDER ATTACK!!"
1331 PRINT"YOU HAVE"TK-T"STARDATES TO SAVE IT!":RETURN
1332 IFT<TKTHEN1337
1333 PRINT"TOO LATE!":KA=0:G(K1,K2)=G(K1,K2)-10:B9=B9-1
1334 IFNOT(Q1=K1ANDQ2=K2)THENRETURN
1335 FORA=1TO8:FORB=1TO8:IFS(A,B)=4THENS(A,B)=0
1336 NEXTB,A:RETURN
13 .      ."
1369 PRINT"          .   .   ."
1370 PRINT"18O .  .  .   .   .  .  .OOO       WARP-COMPASS"
1371 PRINT"          .   .   ."
1372 PRINT"       .      .      ."
1373 PRINT"  225         .        315"
1374 PRINT"             27O"
1375 PRINT
1376 RETURN
1377 XX=INT(RND(2)*10)+1
1378 RETURN
1379 PRINT:IFX4>12THEN1388
1380 PRINT"COMMAND CENTRAL ADVISES THAT YOUR RANKING-";X4;"-IS IN THE EXPERT"
1381 PRINT"CATEGORY. BE ADVISED THAT IF YOU ARE NOT PROPERLY QUALIFIED"
1382 PRINT"YOUR CHANCESRPRISE"
1417 GOSUB1377:A=XX
1418 GOSUB1377:I=(XX/2)+(X4/7)
1419 PRINT"YOUR ";D$(A);" WILL BE INOPERATIVE FOR ";I "UNITS OF STARTIME"
1420 D(A)=D(A)-I:GOTO1070
1421 PRINT
1422 PRINT"SECURITY CONTROL ADVISES THAT NO AUTHORIZATION HAS BEEN"
1423 PRINT"GIVEN TO ACTIVATE SELF- DESTRUCT SYSTEM."
1424 PRINT"PROCEED WITH ASSIGNED MISSION":PRINT:GOTO 1268
1425 PRINT
1426 PRINT"BE ADVISED, YOUR MISSION PROGRESS FACTOR IS";PR
1427 GOSUB 1377
1428 TF=(XX*X4)/1.6:IF TF<10 THEN TF=TF+10
1429 PRINT" THE TOLER"NUMBER OF KLINGONS LEFT ="K9
1296 PRINT"NUMBER OF STARDATES LEFT ="T9-T
1297 PRINT"NUMBER OF STARBASES LEFT ="B9
1298 A=7:GOTO1074
1299 IFK3=0THEN1226
1300 IFD(2)<0THENA=2:GOTO1073
1301 PRINT"COORD","LOWDIR","HIGHDIR","DIST"
1302 FORA=1TO47:PRINT"-";:NEXTA
1303 PRINT
1304 FORI=0TO3
1305 IFNOT(K(I,3)>0)THEN1318
1306 W1=SQR((S1-K(I,1))^2+(S2-K(I,2))^2)
1307 IF W1=0 THENPRINT"--->MALFUNCTION !":GOTO1070
1308 ON ERROR GOTO 1282
1309 C1=1.5708-ATN((K(I,2)-S2)/W1/SQR(1-((K(I,2)-S2)/W1)^2))
1310 ON37 IFQ1=K1ANDQ2=K2THENPRINT"YOU ARRIVED IN TIME! STARBASE SAVED!"
1338 KA=0:GOTO1070
1339 IF SD<>1 THEN 1421 ELSE 1530
1340 GOTO1070
1341 GOSUB 1365
1342 GOTO 1267
1343 PRINT"YOU HAVE SCREWED UP ONCE TOO OFTEN !"
1344 PRINT"OFF TO THE VULCAN TORTURE CAMPS !!"
1345 IFT<= 0THEN1262ELSE1355
1346 PRINT"YOU WILL BE EXECUTED AT SUNRISE"
1347 GOTO1355
1348 PRINT"YOU WILL BE PUT TO DEATH FOR YOUR INCOMPETENCE"
1349 GOTO1355
1350 PRINT"YOU WILL BE CONFINED TO YOUR QUARTERS UNTIL"
1351 PRINT"VULCAN'S MO OF AVOIDING FAILURE ARE NIL."
1383 PRINT
1384 PRINT"DO YOU WISH REASSIGNMENT TO A LESS HAZARDOUS MISSION (Y OR N)"
1385 INPUTAN$
1386 IFLEFT$(AN$,1)="Y"THEN1012
1387 PRINTCHR$(26):GOTO1023
1388 PRINT"YOU HAVE REQUESTED A SUICIDE MISSION":GOTO1383
1389 PRINT"--COMMUNICATIONS ACTIVE--"
1390 PRINT
1391 GOSUB1377
1392 PD=XX
1393 GOSUB1377
1394 PE=XX
1395 GOSUB1377
1396 PF=XX
1397 GOSUB1377
1398 PG=XX
1399 PH=PD*10+PE
1400 PJ=PF*10+PG
1401 IFPH=PJTHEN 1282
1402 KP=1:IFPD=PEORPF=PGTHEN1403ELSANCE FACTOR FOR THIS MISSION IS [+/-]";TF;"PERCENT"
1430 PRINT
1431 RETURN
1432 ONSGN(XM)+2GOTO1433,1437,1439
1433 IFABS(XM)>(TF*1.5)THEN1445
1434 IFABS(XM)>TFTHEN1442
1435 PRINT:PRINT"CAPTAIN, YOU ARE BEHIND SCHEDULE - LET'S GO !!"
1436 GOTO 1070
1437 PRINT:PRINT"YOU ARE EXACTLY ON COMPUTED SCHEDULE; PROCEED WITH MISSION"
1438 GOTO1070
1439 IFXM>TFTHEN1454:IFXM>(TF*1.5)THEN1457
1440 PRINT:PRINT"YOU ARE AHEAD OF COMPUTED SCHEDULE, KEEP UP THE GOOD WORK !!"
1441 GOTO1070
1442 PRINT:PRINT"YOU ARE ERROR GOTO 1282
1311 C1=C1*SGN(S1-K(I,1))/CX
1312 C2(I)=C1-(10*RND(1))
1313 C3(I)=C1+(10*RND(1))
1314 IF C3(I)<0 THEN C3(I)=C3(I)+360
1315 IF C2(I)<0 THEN C2(I)=C2(I)+360
1316 PRINT"(";MID$(STR$(K(I,1)),2,1);",";MID$(STR$(K(I,2)),2,1);
1317 PRINT")",C2(I),C3(I),W1
1318 NEXTI
1319 IF DT=1 THEN 1267 ELSE 1070
1320 RETURN
1321 MR=(T9-T)/K9:DT=0
1322 XM=((MR-PR)/PR)*100
1323 IFKA=1THENPRINTTK-T"STARDATES LEFT TO SAVE STARBASE.":GOTO1332
1324 IFRND(1)>.01*R9ORB9=0THENRETURN
1325 KA=1:FORA=1TO8:FOONS BECOME TOURIST TRAPS !!"
1352 IFT<=0THEN1262ELSE1355
1353 PRINT"IMBECILE !! WE HOPE YOU CONSIDER SUICIDE!"
1354 IFT<=0THEN1262ELSE1355
1355 L=(U-K9)*10+((U-K9)*500/T)-100*(Y-B9)
1356 IFE<=0ORS<0THENL=L-200
1357 IFK9=0THENL=L+(R9*100)
1358 PRINT:PRINT
1359 PRINT"YOUR MISSION RATING IS: ";L
1360 PRINT:PRINT:PRINT:PRINT:PRINT
1361 GOSUB 1543
1362 PRINTCHR$(26)
1363 GOTO1544
1364 GOTO1262
1365 PRINT
1366 PRINT"             O9O"
1367 PRINT"  135         .        O45"
1368 PRINT"       .     E1405
1403 PRINT"SUNSPOTS BLOCK TRANSMISSION AT : ":GOTO1060
1404 PRINT"MOVE ELSEWHERE AND TRY AGAIN":PRINT:GOTO 1081
1405 PRINT"AUTHORIZED FREQUENCIES":PRINT
1406 PRINT"FEDERATION COMMAND BASE = ";PH
1407 PRINT"KLINGON COMMAND CENTRAL = ";PJ
1408 PRINT
1409 INPUT"COMMUNICATION ON CHANNEL ";XF
1410 IFXF=PHTHEN1432
1411 IFXF=PJTHEN1461
1412 PRINT
1413 PRINTAR$;"ALERT !!"
1414 PRINT"ATTEMPTED COMMUNICATION ON UNAUTHORIZED FREQUENCY"
1415 PRINT
1416 PRINT"WHILE SECURITY CHECK IS CONDUCTED ON ENTE BEHIND SCHEDULE AND OUT OF TOLERANCE FACTOR !!"
1443 PRINT"COMMAND CONTROL PROJECTS FAILURE...YOU MAY SURRENDER TO ENEMY"
1444 EQ=1:SD=1:GOTO 1389
1445 YY=AC^X4
1446 PRINTCHR$(26)
1447 PRINTAR$;"---------COMPUTER PROJECTION----------":PRINT
1448 PRINT"PROJECTED LIKELIHOOD OF SUCCESS FOR YOUR MISSION =";YY;"PERCENT"
1449 PRINT"WE HAVE AUTO ACTIVATED SELF-DESTRUCT SYSTEM ON YOUR VESSEL"
1450 PRINT"GOODBYE, CAPTAIN.............":PRINT
1451 PRINT"END OF MESSAGE FROM FEDERATION COMMAND":PRINT:PRINT
147,1477,1474
1477 GF=TF*1.5
1478 IFXM>GFTHEN 1486
1479 IFXM>TFTHEN 1483
1480 PRINT:PRINT"CAPTAIN, DESPITE YOUR SLIGHT ADVANTAGE, YOU ARE NO MATCH FOR"
1481 PRINT"THE GLORIOUS KLINGON FLEET"
1482 PRINTTAB(25)"END OF MESSAGE FROM KLINGON COMMAND":GOTO1070
1483 GOSUB1377
1484 IFXX<=5THENPRINT" KLINGON COMMAND TO ENTERPRISE..":GOTO1473
1485 GOTO1487
1486 PRINTCHR$(26)
1487 PRINT:PRINT"MESSAGE FROM KLINGON LEADERS..."
1488 PRINT:PRINT"WE CONCEDE THE WAR, SIR, CONGRATULATIONS !!":GOTO1360
1489 AV=INT("YOUR COMBAT SITUATION HAS";PW$;"BY A FACTOR OF";XM;"PERCENT"
1517 IF ABS(XM)>=TF THEN EG$=" NOT "ELSE EG$=" "
1518 IF EG$=" "THEN EH$=""ELSE EH$=AR$
1519 PRINT EH$;"YOUR PROGRESS IS";EG$;"WITHIN TOLERANCE FOR THIS MISSION"
1520 PRINT
1521 IF EG$=" NOT "THEN 1522 ELSE 1267
1522 IF XM<0 THEN 1523 ELSE 1527
1523 PRINT:SD=1:KD=0
1524 PRINT"CAPTAIN, COMMAND CENTRAL PROJECTS DEFEAT BY ENEMY. YOU ARE NOW"
1525 PRINT"AUTHORIZED TO SURRENDER OR TO ACTIVATE SELF-DESTRUCT SYSTEM"
1526 GOTO1267
1527 PRINT:S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                52 GOSUB 1543
1453 GOTO 1530
1454 PRINT:PRINT"YOU ARE AHEAD OF SCHEDULE AND BEYOND TOLERANCE FACTOR"
1455 PRINT"CALL KLINGON LEADERS AND REQUEST THEIR SURRENDER":KQ=1
1456 PRINT:GOTO1389
1457 PRINTAR$;"MESSAGE FROM COMMAND BASE"
1458 PRINT:PRINT"ENEMY HAS SURRENDERED TO FEDERATION COMMAND !!"
1459 PRINT:PRINT:PRINT:PRINT
1460 GOTO1264
1461 IF KQ=1 THEN 1486:IF EQ=1 THEN 1464
1462 ON SGN(XM)+2 GOTO 1463,1469,1474
1463 IF ABS(XM)<=TFTHEN1469
1464 PRINT:PRINT"KLINGON COMMAND ON FREQUENCY"
1465 PRIX4/2)+1:DR=-1
1490 IF TEC<AV THEN 1492
1491 IF C$<>"D" THEN 1496 ELSE 1498
1492 AU=AV-TEC:IFAU=1THENKF$=""ELSEKF$="S"
1493 PRINT:PRINT"DAMAGE REPAIR INACTIVE !!"
1494 PRINT"REQUIRES";AU;"MORE RECHARGE UNIT";KF$
1495 PRINT:GOTO 1070
1496 PRINT:PRINTAR$"YOU MUST BE DOCKED AT STARBASE FOR DAMAGE REPAIR !!"
1497 PRINT:GOTO 1070
1498 PRINT
1499 PRINT:FORA=1TO10
1500 IFD(A)<0THENPRINT TAB(10)A;TAB(20)D$(A);TAB(40)"DAMAGED"
1501 NEXT
1502 PRINT:PRINT"IF NO DAMAGE INDICATED ABOVE, ANSWER WITH 0 (ZERO)"D=0:KD=1
1528 PRINT"CAPTAIN, FEDERATION COMMAND PROJECTS SUCCESS FOR YOUR MISSION."
1529 GOTO 1454
1530 PRINTCHR$(26)
1531 GOSUB 1542
1532 PRINT"SELF DESTRUCT SYSTEM ACTIVATED"
1533 PRINT:PRINT:PRINT:GOSUB 1542
1534 PRINT"COUNTDOWN BEGUN !":PRINT:PRINT
1535 PRINTTAB(25)"FIVE":PRINT:GOSUB 1542
1536 PRINTTAB(20)"FOUR":PRINT:GOSUB 1542
1537 PRINTTAB(15)"THREE":PRINT:GOSUB 1542
1538 PRINTTAB(10)"TWO":PRINT:GOSUB 1542
1539 PRINTTAB(5)"ONE":PRINT:GOSUB 1542
1540 PRINT"ZERO":GOSUB 1542
1541 PRINTCHR$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                NT"NATURALLY, WE ARE PLEASED THAT YOU ARE CONCEDING, CAPTAIN"
1466 PRINT"WE ARE PRESENTLY BOARDING YOUR CRAFT"
1467 PRINT:PRINT"HERE IS A MESSAGE FROM YOUR LEADERS-":PRINT:GOSUB 1543
1468 PRINTCHR$(26):GOTO 1260
1469 GOSUB 1377
1470 IFXX<=5THEN 1473
1471 PRINT:PRINT"MESSAGE FROM KLINGON COMMAND...."
1472 PRINT"NO FURTHER COMMUNICATIONS AT THIS TIME":GOTO 1482
1473 PRINT:PRINT"WE'LL TALK WITH OUR WEAPONS, EARTH-SWINE !!":GOTO 1482
1474 GOSUB 1377
1475 AQ=INT((XX+1)/2)
1476 ON AQ GOTO 1471,1473,147
1503 INPUT "WHICH ONE TO REPAIR ";A
1504 IFA<1ORA>10THENPRINTAR$;:GOTO 1070
1505 IF D(A)<0 THEN 1507
1506 PRINT:PRINTD$(A);"        NOT DAMAGED !!":GOTO 1503
1507 PRINT:PRINTTAB(20)D$(A);"---REPAIRED":PRINT
1508 D(A)=0:TEC=0:GOTO1070
1509 PRINT:PRINTAR$;"NOTHING DAMAGED AT PRESENT":GOTO1070
1510 PRINT
1511 GOSUB1429
1512 PRINT"INITIAL MISSION PROGRESS FACTOR WAS";PR
1513 PRINT"CURRENT MISSION PROGRESS FACTOR IS ";MR
1514 IF XM<0 THEN PW$=" WORSENED "ELSE PW$=" IMPROVED "
1515 PRINT
1516 PRINT(26):GOTO1544
1542 FOR I=1 TO 50:A=A+1:NEXT:RETURN
1543 FOR I=1 TO 1200:A=A+1:NEXT:RETURN
1544 RESET
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ Н ·К
7Ъщ*ал*ЪЂ w#x±В*в "в*ЪЂ "Ъл*Ш|єВ@}»Тэ	ДН 	VН ГpBLOCKED TAPE REQUESTED OR$	БН 	ѓН ГќFILE TOO LARGE FOR MEMORY$	БН 	°Н ГМWRITING BLOCKED OUTPUT TAPE$:Ц·ВЫ>я2ЦНі	ДН !Ђ w#x±ВмГ­юК$	БН 	Н Г!DISK READ ERROR$Гќ*в##|}хЪ\*Ъе*ЪЂ "Ъл*Ш|єВJ}»ЪCб>w#|єВY}»ВN:Ц·ВkНі>я2ЦНlБ!Н6	:Х·К§Нхй!\  w#x±ВЉНЪ§е	ДН бГ5НГќ\ Н юя?Вј7!h  > w#zіВВ!—Ѓ>w#zіВТ\ Н юя?Вл7!—"Ъ!Ђ "а>я2П>2ЧGН›ђВ
:С·В}:Ф·В<*аx'НГ-VERIFYТ8>я2ФГ<Н*аxKНГNRUNЪ§НH\ Н \ Н юя?\ Н юя?Вv7:в=2в:Ф·ВN!"Ъ*Ъл*аЂ w#x±В”\ Н ·К«7Ъ.*ЪЂ "Ъ:в=2вВЉ:СюКчЇ2Н2К>УnН›Н›2СН›!  oG)"в! >я2КГи
:Х·ВН:Ф·ВnГЙ!]  w#x±В:Ф·В*аx5НГ;VERIFYЪ*аxNНГQRUNЪГ:Й·ВГННH\ Н \ Н юя?\ Н юя?Вѓ7ЪЂ!—"Ъ*Ъл*аЂ w#x±В–\ Н ·К­7Ъ.*в+|µКЙ"в*ЪЂ "ЪГЊ\ Н юя?ВШ7\ !l  w#x±Вбж!u  w#x±Вф(TO EXECUTE PROGRAM FIRST LOAD TO DISK$НГќ	јН 	AН ГkDISK WRITE ERROR - DISK OR DIRECTORY FULL$	БН 	~Н Г•FILE DELETED FROM DISK$\ Н :О·В‹	БН :Л_Н Г  
$

$
$

$A                     € Ђ     KED TAPE$	БН 	Н Г(TO EXECUTE PROGRAM                                                                                                                                                                                                                                            1* Ђя P|єВ}»Ъл"ШН 2Л2М:Ђ ·Вб	БН 	@Н ГYTAPELIB UTILITY VERS 1.1$	БН 	lН Г‹COPYRIGHT 1977 BY S. J. SINGER$	ДН 	ћН Г *$>я2О!Ђ Ђ > w#zіВ«
Ђ >Н :Ѓ <2Ђ Ї2К2У2Ф2Х2Ц>A2И>€2Ю!\ ! > w#zіВз*аxНГ7BLOCKx‘?ъGеХЕъ"ѕВ#ГЇГ#7БСбЪ0ш#ГЙ  Y7ЙТ@! 0"Ш*аxP	НГYNODISPLAYТa>я2У!‚ oНuГ‰TAPE:=ъ‡ѕВѓ#ГuЇГ€7ЙЪ!‚ љНuГ DISK:=ЪЛ!‚ ±НuГґA:=Ъ№!‚ ЕНuГИB:=ЪА!‚ ЩНuГЮRUN:=Ъ«	БН 	фН ГERROR - NO S>2Р\ Н ·К7ЪC*ал*ЪЂ w#x±В :РюКp<2Р*ЪЂ "ЪГюВюЇ:Р<G!НћН6	!Ђ w#x±ВcГw:П·Вќ!НћН6	!>w#zіВЉ!"ЪГНl Ї2ПГ{!‡ "Ю>я2ЙГЛЇ2МГЕ>2М!… "Ю*Юл!\ НЪ	НАТц>я2Х\ !й w#x±ВмЂ !Ђ w#x±Вя:М_Н !Ђ Ђ w#x±В	ДН 	8Н ГcSTART CASSETTE TAPE - TYPE CARRIAGE RETURN$	ДН Н юКќГ‰	еХЕхНѕЫnж ВсхУoУя!Н†2НсНСБСбЙеХЕНѕЫnжВћЫoхУя!Н†2НсхНСсБСбЙН жИН юКќЙх:К·К	:У·В	:И=2ИВч	БН >@2Исют	ю тl Н \ Н Гџ!—"Ъ>я2Ф\ Н юя?В+7ЪЂ\ Н ·К;7Ъi*ЪЂ ЂъXѕВT#ГFЇГY7ТB*ЪЂ "ЪГ.юВю	јН 	ЃН Г—VERIFIED SUCCESSFULLY$	БН :Х·Кќй!\  w#x±ВЇЇ2h 2| Г‰	!e СНuГФCOMТeн!Ђ ( w#x±ВаГЂ  —*д|єВ‰ }»В‰ !  "Ђ Г *аxНГ#RENAMEР#~ю К$"Ь*Ьл!\ НЪ	Й\ Н юя?ВK7ЪЂ!"Ъ:вю	ъa>2в\ Н ·Кn7ТyюВюГч*ал*ЪЂ w#x±Вѓ*ЪЂ "Ъ:в=2вВa*Ъ+л!
ѕВB#|єВє}»В¬ГВ!] ?>*ѕВУp#ВН!e ѕВвp#ВЬ!] xѕКу#ВиЇЙ7Й> 2h \ Н                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                UCH DESTINATION$Гќ!€ !НuГ%SYNCЪ,!€ 6НuГ8A:ТBЇ2МГZ!€ PНuГRB:Тr>2М„ !‚ x w#x±Вc!Ђ 55*Юл!\ НГЩ6 #е> w#В‡бю ВљГђю КЧю КЧю.Кґw#тљГЦy·Кї#Вєю КЧю КЧw#ВБГЧ7лЙЪ	е!Ѓ > w#zіВг:Ђ ЖЃ!  oС"|єВ}»КВъНАТR\ !й w#x±В>я2Х:М_Н Нх\ ~#В:!h  > w#zіВH] ! w#x±В[:М_Н \ Н юя?В}7Тл	БН :М·ВЅ	љН ГєNO FILE BY THAT NAME ON DRIVE A$Гќ	ИН ГиNO FILE BY THAT NAME ON DRIVE B$Гќ!—"Ъ!Ђ "а!  "в	>._Н ЙсЙ	БН 	 	Н Г3	ERROR IN FILE NAME$Гќе!Ч4>ѕКH	<ѕВN	6НћНћб><Нx>жНxЇ2Н>яНxyНxxНx>я2К ~Нx#Вq	Вo	Ї2К:ННxЙЇ2КН‹Ї2Н>УnН›юяВ‰	Н›2Сют‰	Н›!  oG)+"в>я2К! ЂН›w#ВЕ	zіКЂ
 ВЕ	"д:НGЇ2КН›ђВ
:Х·Вщ	НГ	ДН Г	ёН 	
Н Г&
CHECKSUM ERROR$	БН 	9
Н Гk
TO RESTART - REWIND TAPE AND TYPE CARRIAGE RETURN$	БН Н юКќГ‰	еХЕ	БН !] ъё
ю?В«
~ю ъґ
ютґ
ГЇ
ѕВґ
#Г“
ЇГ№
7БСбЪВ
Г‰	:СюКГ	Е!]  w#x±ВФ
Ї2| Б!ЂН›w#Ви
 Ви
"дЇ2К:Н юя?юяКЂГ\ Н юя?юяВ7ЙжЖЂ!  oЇЙНі>я2К  >жНxzіВ7НГќe !ж w#x±ВQ!e  >$w#zіВaЙЬ><НxzіВod>жНx>vНxВЃЙd>УnН›юvВ‹В‘ЙеХЕ  ><НxzіВ¤БСбЙ	ДН 	ЖН ГьSTART CASSETTE TAPE <<RECORD>> - TYPE CARRIAGE RETURN$	ДН Н юКЙсГќ	јН 	&Н Г9STOP CASSETTE TAPE$	БН Й	јН 	UН ГbVERIFY ERROR$Гќ	јН 	xН Г¤ERROR - FILE TYPE NOT <COM> - CANNOT BE RUN$Гќ	ДН 	єН ГпERROR - A PROGRAM CAN NOT BE RUN FROM A BLOCKED TAPE$	БН 	Н Г                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                N THE TAPE COPY FOR EXTENSIVE COMMENTS.
	FILES MAY BE DISPLAYED ON THE CONSOLE DURING COPY OPERATIONS
FOR VISUAL VERIFICATION .  THE PROGRAM CONTAINS EXTENSIVE ERROR 
CHECKS, AND CONSOLE MESSAGES ARE UNABBREVIATED AND QUITE SPECIFIC.
EVERY EFFORT HAS BEEN MADE TO MAKE THE PROGRAM GENERAL AND EASY TO
USE. THE PROGRAM HAS BEEN OPTIMIZED TO PROVIDE THE FASTEST POSSIBLE
DATA TRANSFER RATES YET STILL MAINTAIN GOOD RELIABILITY.

II.  HARDWARE REQUIREMENTS

	TAPELIB REQUIRES AN 8080 OR Z-80 BASED COMPUTETAPES REQUIRE ABOUT 25 PER CENT MORE TIME TO WRITE.
	EACH TAPE FILE IS HEADED BY A 128 BYTE RECORD CONTAINING
THE FILE NAME. MOST OF THE REMAINDER OF THE 128 BYTES IS AVAILABLE
FOR COMMENTS. THE COMMENTS ARE DELETED DURING TAPE TO DISK COPIES.
	FILES ARE DISPLAYED ON THE TERMINAL DURING ALL COPY 
OPERATIONS UNLESS THE NODISPLAY OPTION IS USED. CHARACTERS ARE
DISPLAYED IN ASCII IN 64 CHARACTER LINES WITH NONDISPLAYABLE
CHARACTERS CONVERTED TO PERIODS.
	DURING TAPE TO DISK COPY OPERATIONS A SEARCH IS  C. THE FIRST CONTROL C
RETURNS TO THE INPUT SECTION OF THE PROGRAM. A SECOND CONTROL C RETURNS
BACK TO CP/M.
	THE COMMAND STRING HAS THE FOLLOWING FORM:

	    DESTINATION:=SOURCE  <OPTIONS> <COMMENT>

	THE SOURCE AND DESTINATION MAY BE EITHER A FILE NAME AND TYPE, A
DEVICE NAME OR SPECIAL FUNCTION. DEVICE NAMES AND FUNCTIONS MUST BE FOLLOWED
BY A COLON. THE FOLLOWING TABLE GIVES ACCEPTABLE NAMES AND THEIR 
INTERPRETATION.

		DEVICE/FUNCTION TABLE

	TAPE:		THE CASSETTE TAPE
	DISK:		THE CURREN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                R SYSTEM
RUNNING THE CP/M OPERATING SYSTEM, AT LEAST ONE FLOPPY DISK DRIVE,
A CASSETTE RECORDER AND TARBELL CASSETTE INTERFACE AND A CONSOLE
DEVICE.  THE DISPLAY DURING COPY OPERATIONS REQUIRES THE TERMINAL
TO OPERATE AT A MINIMUM OF 4800 BAUD IF THIS FEATURE IS TO BE USED.

III.  PROGRAM OPERATION

	TAPELIB OPERATES AS A TRANSIENT FILE UNDER CP/M, AND 
REQUIRES SLIGHTLY MORE THAN 4K OF MEMORY FOR CODE. THE REMAINDER
OF THE AVAILABLE MEMORY WILL BE USED FOR FILE BUFFERS.
	DURING DISK TO TAPE COPIMADE FOR
THE FILE NAME OR GROUP OF NAMES AND ONLY THE REQUESTED FILES
ARE COPIED. HOWEVER, THE HEADER RECORD CONTAINING THE FILE NAME
WILL BE DISPLAYED FOR EACH FILE ON THE TAPE. THIS PERMITS SCANNING
THE TAPE TO DETERMINE ITS CONTENTS, SINCE TAPES HAVE NO DIRECTORIES.
WHEN REQUESTED FILES ARE FOUND, THE ENTIRE CONTENTS WILL BE DISPLAYED.

IV.  TAPELIB COMMANDS

	TAPELIB MAY BE RUN BY ONE OF TWO METHODS. TYPE:

		TAPELIB		
		TAPELIB <COMMAND STRING>

ALL COMMANDS ARE TERMINATED BY A CARRIAGE RTLY LOGGED DISK
	A:		DISK A
	B:		DISK B
	RUN:		LOAD TAPE TO MEMORY AND EXECUTE
	SYNC:		WRITE SYNC STREAM ON TAPE

	ANY CP/M LEGAL FILE NAME INCLUDING AMBIGUOUS FILE NAMES MAY BE
USED WITH TAPELIB. THE FOLLOWING ARE EXAMPLES OF ACCEPTABLE NAMES

		XXXX.YYY	FILENAME.TYP
		*.COM		TAPELIB.???
		*.*		A:MYPROG.COM
		B:NEWNAME.ASM	B:????????.ASM

NOTE THAT THE DISK NAME MAY BE SPECIFIED AS PART OF A FILE NAME.

	THE OPTIONS AVAILABLE AND THEIR FUNCTIONS ARE LISTED IN THE
OPTION TABLE WHICH FOLLOWS			--  TAPELIB --

				BY  SAM J. SINGER
				    (714) 780-8853

I.  INTRODUCTION

	TAPELIB IS A GENERAL CASSETTE TAPE LIBRARY MANAGER FOR
CP/M. IT INCORPORATES MOST OF THE FEATURES OF THE CP/M PIP UTILITY.
ANY CP/M FILE OR GROUP OF FILES MAY BE COPIED FROM TAPE TO DISK
OR FROM DISK TO TAPE.
	IN ADDITION TO THE USUAL PIP COPY OPERATIONS, TAPELIB
PERMITS VERIFICATION OF TAPE FILES AGAINST DISK FILES AND DIRECT
EXECUTION OF BINARY PROGRAMS FROM TAPE.  TAPE FILES ARE NAMED AND
SPACE IS PROVIDED IES THE PROGRAM WILL FIRST ATTEMPT
TO READ THE ENTIRE FILE INTO MEMORY AND WRITE IT ON TAPE AS A
SINGLE RECORD. IF THERE IS INSUFFICIENT ROOM FOR THE ENTIRE FILE,
OR IF THE FILE CONTAINS MORE THAN ABOUT 14000 BYTES THE PROGRAM
WILL WRITE THE FILE ON TAPE IN 1K BLOCKS. A BLOCKED TAPE WILL ALSO
BE PRODUCED IF THE BLOCK OPTION IS USED. THIS OPTION IS USEFUL IF
TAPES ARE TO BE TRANSFERED FROM ONE SYSTEM TO ANOTHER OF A DIFFERENT
SIZE. A MESSAGE WILL BE DISPLAYED BEFORE A BLOCKED TAPE IS WRITTEN.
BLOCKED ETURN. IF THE FIRST METHOD IS
USED THE PROGRAM RESPONDS WITH A TITLE AND AN * PROMPT. THE COMMAND STRING
MAY THEN BE ENTERED. THE SECOND FORM EXECUTES THE COMMAND STRING
IMMEDIATELY.
	IF THE FIRST FORM OF THE CALL IS USED THE PROGRAM WILL RETURN TO
THE INPUT SECTION AFTER COMPLETION OF THE COMMAND. THE PROMPT WILL BE
DISPLAYED AND ANOTHER COMMAND EXECUTED WITHOUT RELOADING THE PROGRAM.
THE OTHER FORM WILL RETURN TO CP/M AFTER COMPLETION OF THE COMMAND.
ANY COMMAND MAY BE TERMINATED BY TYPING CONTROL.

			OPTION TABLE

	NODISPLAY		TURN OFF DISPLAY FEATURE (FOR SLOW TERMINALS)
	BLOCK			BLOCK FILES ON TAPE IF FILE WILL NOT FIT
				    IN 16K CP/M SYSTEM
	VERIFY			COMPARE TAPE FILE WITH DISK FILE OF SAME NAME
	RENAME			RENAME FILE ON DISK AFTER COPY FROM TAPE

	COMMAND STRINGS CAN BE CONSTRUCTED FROM VARIOUS COMBINATIONS OF
THE NAMES AND OPTIONS LISTED ABOVE. IN GENERAL MORE THAN ONE OPTION CAN
BE INCLUDED IN ANY COMMAND STRING. IF COMMENTS OR OPTIONS ARE INCLUDED
IN A CASE WHERE THEY ARE NOTTHE WORD VERIFY ANYWHERE FOLLOWING THE SOURCE. THE COPY
OPERATION WILL NOT ACTUALLY TAKE PLACE. INSTEAD THE FILE WILL BE READ
FROM TAPE AND COMPARED BYTE BY BYTE WITH THE FILE OF THE SAME NAME ON
THE DISK SPECIFIED. IF THE FILES ARE NOT THE SAME THE PROGRAM DISPLAYS

	VERIFY ERROR

IF THE FILES ARE THE SAME THE PROGRAM WILL DISPLAY:

	VERIFIED SUCCESSFULLY

	TO RUN A PROGRAM FROM TAPE TYPE RUN: AS THE DESTINATION. THE
PROGRAM CHECKS THE FILE TYPE BEFORE EXECUTION BEGINS AND WILL DISPLAY
AN ERRONCORRECT DESTINATION, MUST BE TAPE:
				DISK:, A:, B:, OR RUN: - REENTER

3.  NO FILE BY THAT NAME	INCORRECT NAME OR DRIVE - REENTER
    ON DRIVE A

4.  CHECKSUM ERROR		CHECK SUM ON TAPE DOES NOT AGREE WITH
				COMPUTED SUM. - VARIETY OF CAUSES
				CHECK TERMINAL SPEED 4800 BAUD OR GREATER
				REWIND TAPE TO BEGINNING OF FILE AND
				TYPE CARRIAGE RETURN

5.  VERIFY ERROR		A BYTE IN THE TAPE FILE DOES NOT MATCH
				THE DISK COPY - CHECK FOR INCORRECT TAPE
				OR DISK

6.  ERROR - FILE TYPE NSK OPERATIONS TO COMPLETE AND THE HALT BYTES SERVE TO INDENTIFY
THE BEGINNING OF A FILE. THE NUMBER OF BYTES IN A TAPE RECORD IS
ALWAYS A MULTIPLE OF 256 NOT COUNTING THE START,SYNC,TYPE,LENGTH
AND DECODE BYTES. IF DATA DOES NOT EXACTLY FILL A RECORD, THE
REMAINDER OF THE RECORD IS FILLED WITH 1AH BYTES (THE CP/M END OF FILE
CODE).
	THE BLOCKS OF A BLOCKED RECORD ARE SEPARATED BY APPROX 1 SECOND
BLOCKS OF START BYTES. TWO OF THE BLOCKS ARE APPROX 3 SECONDS LONG TO
ALLOW FOR THE EXTRA TIME REQUIRED I MEANINGFUL, THEY WILL BE IGNORED.

V.  EXAMPLES OF COMMANDS

			DISK TO TAPE

	TAPE:=FILENAME.TYP	'OPTIONAL COMMENTS'
	TAPE:=B:*.COM      RECORDED DEC 26 1977
	TAPE:=A:MYPROG.ASM    NODISPLAY

			TAPE TO DISK

	DISK:=*.COM
	A:=GAME.BAS   RENAME NEWGAME.BAS
	B:=TESTPROG.ASM     VERIFY

			OTHER COMMANDS

	TAPE:=SYNC:		(WRITE 6 MIN OF SYNC CODE)
	RUN:=ANYPROG.COM	(LOAD FROM TAPE AND EXECUTE)


	THE FORMAT OF COMMAND STRINGS IS FREE EXCEPT FOR THE SOURCE
AND DESTINATION. THE EQUAL SIGN R MESSAGE IF THE FILE IS NOT TYPE 'COM'. COM FILES ARE MOVED TO
STARTING LOCATION 100H BEFORE BEING EXECUTED.

VII.  PROMPTS AND ERROR MESSAGES

	TAPELIB ASSUMES THAT ONLY AN INEXPENSIVE NON CONTROLED CASSETTE
TAPE RECORDER IS BEING USED. THE PROGRAM HALTS AT THE PROPER TIMES AND
DISPLAYS INSTRUCTIONS FOR STARTING AND STOPPING THE TAPE. FOR EXAMPLE
TO COPY DISK TO TAPE THE PROGRAM WILL PAUSE AND DISPLAY:

	START CASSETTE TAPE <<RECORD>> - TYPE CARRIAGE RETURN

FOR TAPE TO DISK OPREATIONS THE MESOT <COM>	ONLY COM TYPE FILES CAN BE EXECUTED - LOAD
    - CANNOT BE RUN		FILE TO DISK AND RENAME

7.  DISK READ ERROR 		CP/M SYSTEM ERROR IN DISK READ

8.  DISK WRITE ERROR - DISK	DISK FILLED - CHANGE DISKS
    OR DIRECTORY FULL

VII.  TAPE FORMAT

	THE FORMAT FOR EACH RECORD ON THE TAPE IS AS FOLLOWS:


	1.  START BYTES		03CH  (100)
	2.  SYNC  BYTE		06EH
	3.  DECODE BYTE		0FFH   (CONTROLS DISPLAY)
	4.  TYPE  BYTE		0,1 OR 2
	5.  LENGTH BYTE		NO OF 256 BYTE RECORDS
	6.  NAME		CP/M FILE NAMEF THE FILE HAS MORE THAN ONE EXTENT.

VIII.  COMMENTS 

	SEVERAL POINTS SHOULD BE KEPT IN MIND WHEN USING TAPELIB
TAPE IS NOT NEARLY AS RELIABLE AS DISK FOR DATA STORAGE. ALWAYS
VERIFY TAPE COPIES OF DISK FILES BEFORE DESTROYING THE ORIGINALS.
USE REASONABLE QUALITY TAPE AND KEEP CASSETTE RECORDER HEADS CLEAN.
	BECAUSE THERE IS NO DIRECTORY ON TAPES, BLOCK COPY OPERATIONS
FROM TAPE TO DISK DO NOT WORK AS RELIABLY AS DISK TO DISK COPIES.
THE PROGRAM HAS NO WAY OF TELLING WHEN ALL THE FILES ON A TAPAND COLONS ARE REQUIRED AND NO SPACES
ARE PERMITTED IN THE SOURCE OR DESTINATION. THE OPTIONS AND COMMENTS
MAY BE TYPED ANYWHERE ON THE INPUT LINE. INTERVENING SPACES WILL BE
SKIPPED OVER.
	TO RENAME A FILE DURING A TAPE TO DISK COPY ENTER THE WORD
RENAME FOLLOWED BY THE NEW FILE NAME AND TYPE ANYWHERE ON THE INPUT
LINE FOLLOWING THE SOURCE. THIS FEATURE IS USEFUL IF A FILE WITH THE
SAME NAME ALREADY EXISTS ON THE DISK.
	TO VERIFY A FILE OR GROUP OF FILES EXECUTE A TAPE TO DISK COPY
OPERATION WITH SAGE WILL BE:

	START CASSETTE TAPE - TYPE CARRIAGE RETURN

THE TAPE SHOULD BE STARTED IN THE PROPER MODE BEFOR TYPING THE CARRIAGE
RETURN.
	TAPELIB IS EXTENSIVELY TRAPPED FOR ERRORS. IF AN ERROR OCCURS
THE PROGRAM WILL DISPLAY AN ERROR MESSAGE AND PAUSE TO ALLOW THE ERROR
TO BE CORRECTED IF POSSIBLE. THE FOLLOWING TABLE CONTAINS ERROR MESSAGES,
THEIR PROBABLE CAUSE AND POSSIBLE CORRECTION.

			ERROR TABLE

1.  ERROR IN FILE NAME		INCORRECT FILE NAME - REENTER NAME

2.  NO SUCH DESTINATION		I  (11 BYTES)
	7.  COMMENT		110 BYTES AVAILABLE BLANK IF NOT USED
	8.  DATA		MULTIPLES OF 256 BYTE RECORDS
	9.  CHECKSUM		ONE BYTE TARBELL CHECKSUM

	IF A FILE IS UNBLOCKED IT WILL CONTAIN ONLY ONE CONTINUOUS
RECORD IN THE FORMAT GIVEN ABOVE. IF A FILE IS BLOCKED ONLY THE
FIRST RECORD OF THE FILE CONTAINS THE NAME AND COMMENT, THE REMAINING
FIELDS HOWEVER ARE THE SAME.
	EACH FILE IS PRECEEDED BY A BLOCK OF 1500 START BYTES
FOLLOWED BY 100 HALT BYTES (76H). THE START BYTE BLOCK PROVIDES TIME
FOR DIE HAVE
BEEN FOUND. IT IS UP TO THE USER TO STOP THE TAPE AT THE PROPER
TIME WITHOUT PROMPTING FROM THE PROGRAM.
	TAPE RECORDS ARE LABLED AND THEREFORE TAPE POSITIONING IS
NOT AT ALL CRITICAL. AS LONG AS THE TAPE STARTS BEFORE THE RECORD
REQUESTED THE PROGRAM WILL FIND THE FILE. THE PROGRAM MAY EVEN BE
STARTED WHILE READING LEADER.  HOWEVER IF TAPES ARE NOT ERASED
BEFORE USE, OLD FILES AT THE END OF THE TAPE MAY BE FOUND AND READ
DURING BLOCK COPY OPERATIONS. THE COPY-ALL OPERATION:

	DISK:=*.*

	DATA TRANSFER RATES (APPROX)
		UNBLOCKED RECORDS		187 BYTES/SEC
		BLOCKED RECORDS			140 BYTES/SEC
	TIME BETWEEN FILES			8 SECONDS
	TIME BETWEEN BLOCKS			0.85 SECONDS

	LOAD TIME FROM TAPE FOR 10K BYTES
		UNBLOCKED RECORD		72 SECONDS
		BLOCKED RECORDS			83 SECONDS

	ONE SIDE OF A C-60 TAPE WILL USUALLY STORE THE CONTENTS OF ONE
FLOPPY DISK.
                                                                                                                                E COMMANDS
;GIVEN ABOVE MAY THEN BE ENTERED WITHOUT THE WORD TAPELIB.
;
;   FILES MAY BE RENAMED OR SIMPLY VERIFIED (NO ACTUAL TRANSFER) DURING
;ALL TAPE TO DISK OPERATIONS. A COM FILE MAY ALSO BE RUN FROM TAPE
;WITHOUT FIRST LOADING IT TO DISK. THE SYNC OPTION WRITES 65K OF SYNC
;BYTES ON THE TAPE.
;
;	TAPELIB DISK:=FILENAME.TYP   RENAME NEW.NAM
;	TAPELIB DISK:=FILENAME.TYP    VERIFY
;	TAPELIB DISK:=FILENAME.COM      RUN   NODISPLAY

;  (RENAME,VERIFY,RUN AND THE FILE NAME ARE FREE FORMAT AND M
;	1. START BYTES		03CH  (600)
;	2. SYNC BYTE		06EH
;	3. DECODE BYTE		0FFH  CONTROLS DISPLAY
;	4. TYPE BYTE		0 1 OR 2
;	5. LENGTH BYTE		THE NUMBER OF 256 BYTE RECORDS
;	6. NAME			CP/M NAME 11 BYTES  (NAME....TYP)
;	7. COMMENT		110 BYTES PROVIDED, BLANK (20H) IF NOT ENTERED
;	8. DATA			MULTIPLES OF 256 BYTE RECORDS
;	9. CHECKSUM		ONE BYTE TARBELL CHECKSUM
;
;	A STRING OF 600 START BYTES PROVIDES AT LEAST 3 SEC OF 'LEADER'
;BETWEEN RECORDS ON THE TAPE. ALL THE MEMORY BETWEEN THE END OF THE
;PROGRAIS THE WORST OFFENDER IN THIS RESPECT. IT IS RECOMMENDED THAT TAPES
BE COMPLETELY ERASED BEFORE BEING USED AS BACK UP FOR ALL THE
FILES ON A DISK.
	CASSETTE RECORDERS ARE NOT CONTROLABLE DEVICES. IN GENERAL 
THE PROGRAM HAS TO ACCEPT DATA AT THE FIXED SPEED COMING TO IT
FROM THE TAPE, 187 BYTES PER SECOND FOR TARBELL STANDARD. SUFFICIENT
SPACE MUST BE LEFT ON THE TAPE BETWEEN RECORDS TO ALLOW COPY TIME TO
DISK IF BLOCK COPIES ARE TO BE PERFORMED. ALTHOUGH LARGE GAPS ARE LEFT
ON THE TAPE BETWEEN FILE;			-- TAPELIB --
;
;					BY:  S. J. SINGER
;						(714) 780-8853
;
;	THIS PROGRAM IS A GENERAL CASSETTE TAPE LIBRARY MANAGER FOR CP/M.
;IT ACCEPTS A FUNCTION FOLLOWED BY A FILE NAME FROM THE CONSOLE AND
;PERFORMS A DISK TO TAPE OR TAPE TO DISK COPY. ANY CP/M FILE MAY BE COPIED.
;THE TAPE FORMAT IS TARBELL COMPATABLE, HOWEVER THE TAPES PRODUCED BY
;TAPELIB ARE NOT EASILY LOADED BY OTHER TARBELL INPUT ROUTINES.
;TAPE FILES ARE NAMED AND SPACE IS PROVIDED FOR EXTENSIVE COMMENTS.
;
;		    -- COMMANAY BE  
;ANYWHERE IN THE COMMENT FIELD). A FILE MUST BE TYPE COM TO BE RUN.
;NODISPLAY IN THE COMMENT FIELD TURNS OFF THE DISPLAY OF THE FILE ON
;THE TERMINAL DURING TRANSFER OPERATIONS.
;
;	A TOTAL OF 128 BYTES ARE AVAILABLE FOR THE COMMAND AND COMMENTS.
;WHEN COPYING TAPE TO DISK COMMENTS ARE OMITTED. DURING ALL TAPE TRANSFER
;OPERATIONS THE CONTENTS OF THE FILE ARE DISPLAYED ON THE CONSOLE. NON
;DISPLAYABLE CHARACTERS DISPLAY AS PERIODS. THE NAMES AND COMMENTS OF
;THE FILES SKIPPED OVER ARE DISPM AND THE OPERATING SYSTEM, IS USED AS A FILE BUFFER. IF A
;FILE IS TOO LARGE TO FIT IN THE AVAILABLE MEMORY, IT WILL BE
;WRITTEN ON TAPE IN 1K BLOCKS DURING DISK TO TAPE TRANSFERS.
;READING AND WRITING BLOCKED TAPES TAKES ABOUT TWICE AS LONG AS READING
;OR WRITING UNBLOCKED TAPES. PROGRAMS MAY NOT BE RUN DIRECTLY FROM
;BLOCKED TAPES. ENTERING THE WORD 'BLOCK' IN THE DESCRIPTION FIELD
;OF A DISK TO TAPE COMMAND WILL FORCE BLOCKING OF ALL FILES THAT
;WILL NOT FIT IN A 16K CP/M SYSTEM.
;
;
;	THE PROS THE TIME MAY NOT BE SUFFICIENT IN ALL CASES.
IF THE TAPE DENSITY IS NOT TARBELL STANDARD OR DISK ERRORS OCCUR 
REQUIRING MULTIPLE READS FOR ERROR CORRECTION ERRORS MAY OCCUR.
THE TYPE OF ERRORS WILL BE MISSED FILES DURING BLOCK COPIES OR MISSED
BLOCKS WHILE COPYING BLOCKED TAPES. SIMPLE INSPECTION WILL DETECT MISSING
FILES. SCAN THE TAPE AND COUNT THE RECORDS. MISSING BLOCKS ARE MORE
DIFFICULT BUT CAN USUALLY BE DETECTED BY REVERIFICATION OF THE TAPE.

IX.  TIMING DATA AND SPACE CONSIDERATIONS

D FORMATS --
;
;		DISK TO TAPE
;	TAPELIB TAPE:=FILENAME.TYP  'OPTIONAL DESCRIPTION OR COMMENTS'
;	TAPELIB TAPE:=A:FILENAME.TYP	BLOCK
;	TAPELIB TAPE:=B:FILENAME.TYP       NODISPLAY
;
;		TAPE TO DISK
;	TAPELIB DISK:=FILENAME.TYP
;	TAPELIB A:=FILENAME.TYP
;	TAPELIB B:=FILENAME.TYP
;
;
;		EXECUTE FILE 
;	TAPELIB RUN:=FILENAME.COM
;
;		WRITE SYNC
;	TAPELIB TAPE:=SYNC
;
;
;	TAPELIB MAY ALSO BE LOADED LIKE PIP, BY SIMPLY TYPING TAPELIB.
;THE PROGRAM WILL LOAD, PRINT A TITLE THEN A * PROMPT. THLAYED DURING THE SEARCH. NORMALLY
;FILES ARE NOT BLOCKED ON TAPE BUT READ INTO MEMORY IN THEIR ENTIRETY.
;IF A FILE WILL NOT FIT IN MEMORY IT WILL BE WRITTEN OUT IN 1K BLOCKS.
;
;	FILES ARE DISPLAYED ON THE CONSOLE FOR VERIFICATION DURING
;ALL TRANSFER OPERATIONS. NON DISPLAYABLE CHARACTERS DISPLAY AS PERIODS.
;THE CONSOLE DEVICE MUST BE CAPABLE OF OPERATING AT A MINIMUM OF
;4800 BAUD OR ERRORS WILL OCCUR. THE DISPLAY FEATURE MUST BE DISABLED
;IF SLOW TERMINALS ARE USED.
;
;			-- TAPE FORMAT--
;GRAM WAS ASSEMBLED USING A Z-80 MACRO ASSEMBLY PROGRAM,
;HOWEVER ONLY 8080 INSTRUCTIONS WERE USED SO THE PROGRAM WILL
;RUN ON EITHER AN 8080 OR Z-80 BASED PROCESSOR.
;
	.XLIST
;
	;	--------  MACROS   -------
;
;
;   1.   FILL - FILL A BLOCK OF MEMORY WITH A CONSTANT MAX 64K
;
	.DEFINE FILL [START,END,CONST(0)] = [
	LXI	H,START		;;SET START ADDR
	.IFB	[END],[
	XRA	A
	MOV	M,A]		;;STORE ONE BYTE IF NO END
	.IFNB	[END],[
	LXI	D,END-START+1	;;SET LENGTH
	MVI	A,CONST		;;LOAD CONSTANT IN A
	MOV	
;
	.DEFINE	MOVEI [SOURCE,DEST,LEN] = [
	.IFDIF [DE] [SOURCE],[
	LHLD	SOURCE		;SOURCE
	XCHG]
	.IFDIF [HL] [DEST],[
	LHLD	DEST]		;DESTINATION
	.IFDIF [BC] [LEN],[
	LXI	B,LEN]		;LENGTH
	LDAX	D		;GET A BYTE
	MOV	M,A		;STORE IT
	INX	H
	INX	D		;BUMP POINTERS
	DCX	B		;DECR LENGTH COUNT
	MOV	A,B
	ORA	C
	JNZ	.-7]		;TEST DONE
;
;   5.  READTB - READ CHAR STRING INTO INPUT TEXT BUFFER
;
	.DEFINE READTB [TEXT,MAX(127)] = [
	MVI	C,10
	LXI	D,TEXT
	MVI	A,MAX
	STAX	D	;SET MAXIMUM BUFFER LENGTH
	COR
;
;
;
;   9.5 WRITE - WRITE NEXT RECORD TO DISK
;
	.DEFINE WRITE [FCB] = [
	MVI	C,21		;;WRITE CODE
	LXI	D,FCB
	CALL	5
	ORA	A		;;SET FLAGS
	JZ	.+4
	STC]			;;SET CARRY ON ERROR
;
;
;    SEARCH - SEARCH DIRECTORY FOR FIRST FCB THAT MATCHES NAME
;
	.DEFINE SEARCH [FCB] = [
	MVI	C,17		;;SEARCH CODE
	LXI	D,FCB
	CALL	5
	CPI	0FFH		;;FFH = NO MATCH
	CMC			;;SET CARRY IF NO MATCH
]
;
;    SERNXT - SEARCH DIRECTORY FOR NEXT FCB MATCHING NAME
;
	.DEFINE SERNXT [FCB] = [
	LXI	D,FCB		;;NAMEDSTR		;;POINTER TO NAME STRING
	XCHG
	LXI	H,FCB		;;ADDR OF FILE CONTROL BLOCK
	.IFN $FCBSW,[
	CALL	FFCB]
	.IFE $FCBSW,[
	CALL	FFCB
$FCBSW	=	1		;;SET CONDITIONAL ASSEMBLY SWITCH
	JMP	ENDFCB
FFCB:	MVI	M,0		;CLEAR FIRST BYTE OF FCB
	INX	H
	PUSH	H		;;SAVE FCB NAME ADDR
	MVI	C,11		;;SIZE OF NAME
	MVI	A,' '		;;SPACE TO A
	MOV	M,A		;;SET NAME FIELD TO SPACES
	INX	H
	DCR	C
	JNZ	.-3
	POP	H		;;RECOVER NAME ADDR
	MVI	C,8		;;MAXIMUM SIZE OF NAME+1
	LDAX	D		;;GET ID BYTE
	CPI	' '		;;LEADING SPACES ?M,A		;;STORE THE CONST
	INX	H		;;INCR H
	DCX	D		;;DECR LENGTH
	MOV	A,D
	ORA	E		;;TEST LENGTH = ZERO
	JNZ	.-7]]		;;REPEAT IF DE AND HL NOT EQUAL
;
;   1.5  FILLI - FILL INDIRECT A BLOCK OF MEMORY WITH A CONSTANT
;
	.DEFINE FILLI [START,END,CONST(0),%FI] = [
	LHLD	START		;;START ADDR
	LXI	D,END+1		;;END ADDR
%FI:	MVI	A,CONST		;;CONSTANT TO A
	MOV	M,A		;;STORE CONST IN MEMORY
	INX	H		;;INCR POINTER
	CPHL			;;COMPARE HL AND DE
	JNZ	%FI]		;;REPEAT TILL ZERO
;
;  2.   CPHL - COMPARE DE AND HL AALL	5]
;
;   6.  PRINTL - PRINT A LITERAL CHARACTER STRING ENCLOSED IN ' '
;
	.DEFINE	PRINTL [A$,%OUT] = [
	MVI	C,9
	LXI	D,.+9
	CALL	5
	JMP	%OUT
	.ASCII	'A$'
%OUT:]
;
;   7.  PRINT - PRINT TEXT FROM MEMORY TO CONSOLE
;
	.DEFINE PRINT [B$] = [
	MVI	C,9
	LXI	D,B$
	CALL	5]
;
;
;   7.5 DELMAK - DELETE AND MAKE A DISK FILE
;
	.DEFINE DELMAK [FCB] = [
	MVI	C,19		;;DELETE CODE
	LXI	D,FCB
	CALL	5
	MVI	C,22		;;MAKE CODE
	LXI	D,FCB
	CALL	5
	CPI	0FFH		;;TEST FOR ERROR
	CMC]			;;COMPLIMENT OF FILE TO SEARCH FOR
	MVI	C,18		;;SEARCH NEXT CODE
	CALL	5
	CPI	0FFH		;;0FFH = NO MATCH
	CMC			;;SET CARRY IF NO MATCH
]

;   66.  DELETE - DELETE A DISK FILE
;
	.DEFINE DELETE [FCB] = [
	MVI	C,19
	LXI	D,FCB
	CALL	5]
;

;
;  10.  CONIN [$S] - CONSOLE INPUT TO A
;
	.DEFINE CONIN [$S] = [
	.IFIDN [$S] [SR], [
		PUSH	H
		PUSH	D
		PUSH	B]
	MVI	C,1
	CALL	5
	.IFIDN [$S] [SR],[
		POP	B
		POP	D
		POP	H]
	]		;END MACRO
;
;	
;  11.  CONOUT - CONSOLE OUTPUT FROM A
;
	.DEFINE CONOUT 
	JNZ	.+7		;;CONTINUE IF NOT
	INX	D		;;SKIP LEADING SPACES
	JMP	.-7
	LDAX	D		;;GET ID BYTE
	CPI	0		;;IS IT A ZERO BYTE
	JZ	%DONE		;;YES DONE
	CPI	' '		;;IMBEDDED SPACE?
	JZ	%DONE		;;YES DONE
	CPI	'.'		;;NAME.TYP SEPARATOR?
	JZ	.+13		;;YES, PROCESS TYPE
	MOV	M,A		;;STORE NAME BYTE
	INX	D
	INX	H		;BUMP POINTERS
	DCR	C		;DECREMENT MAX COUNT
	JP	.-20		;LOOP
	JMP	%ERROR		;ERROR, NAME TOO BIG
	INX	D		;SKIP OVER '.'
	MOV	A,C
	ORA	A
	JZ	.+8
	INX	H		;;SKIP TO TYPE FIELD
	DCR	C		
	JNZ	.-2	
	MVND SET FLAGS
;
	.DEFINE CPHL = [
	MOV	A,H
	CMP	D		;;COMPARE HIGH BYTES
	JNZ	.+5
	MOV	A,L
	CMP	E]		;;COMPARE LOW BYTES
;
;
;   3.  MOVE - MOVE A BLOCK OF LENGTH LEN FROM SOURCE TO DEST
;
	.DEFINE MOVE [SOURCE,DEST,LEN] = [
	LXI	D,SOURCE	;SOURCE
	LXI	H,DEST		;DEST
	LXI	B,LEN	;LENGTH
	LDAX	D	;GET A BYTE
	MOV	M,A	;STORE IT
	INX	H
	INX	D	;BUMP POINTERS
	DCX	B	;DECR LENGTH COUNT
	MOV	A,B
	ORA	C
	JNZ	.-7]	;TEST DONE?
;
;
;   4. MOVEI - MOVE INDIRECT BLOCK OF LENGTH LEN FROM SOURCE TO DEST CARRY
;   8.  OPEN - OPEN DISK FILE
;
	.DEFINE OPEN [NAME] = [
	MVI	C,15
	LXI	D,NAME
	CALL	5
	CPI	0FFH	;TEST FOR ERROR
	CMC		;COMPLIMENT CARRY
	JNZ	.+4
	STC]
;
;
;   8.5 CLOSE - CLOSE A DISK FILE
;
	.DEFINE CLOSE [FCB] = [
	MVI	C,16		;;CLOSE CODE
	LXI	D,FCB
	CALL	5
	CPI	0FFH		;;TEST FOR ERROR
	CMC			;;COMPLIMENT CARRY
	JNZ	.+4
	STC]
;
;
;   9.  READ - READ NEXT DISK FILE
;
	.DEFINE READ [FCB] = [ 
	MVI	C,20
	LXI	D,FCB
	CALL	5
	ORA	A
	JZ	.+4
	STC]			;;SET CARRY ON EOF OR ERR[$S] = [
	.IFIDN [$S] [SR],[
	PUSH	H
	PUSH	D
	PUSH	B]
	MOV	E,A
	MVI	C,2
	CALL	5
	.IFIDN [$S] [SR],[
	POP	B
	POP	D
	POP	H]
]		;END MACRO
;
;  12.  INDEX - INDEX AN ADDRESS POINTER BY A CONSTANT
;
	.DEFINE INDEX [POINTER,INDX] = [
	LHLD	POINTER
	LXI	D,INDX
	DAD	D
	SHLD	POINTER]
;  13.  FILFCB - FILL IN ID FIELDS OF FCB (FILE NAME ENDED BY ZERO BYTE)
;		ON EXIT - CARRY SET IF NAME TOO LONG
;			- HL POINTS TO NEXT BYTE AFTER NAME

;
	.DEFINE FILFCB [FCB,IDSTR,%ERROR,%DONE] = [
	LHLD	II	C,3		;;SIZE OF TYPE FIELD
	LDAX	D		;;GET ID BYTE	
	CPI	0		;;ZERO BYTE?
	JZ	%DONE		;;YES, DONE
	CPI	' '		;;SPACE?
	JZ	%DONE		;;YES, DONE
	MOV	M,A		;;STORE TYPE BYTE
	INX	D		;;BUMP POINTERS
	INX	H		
	DCR	C		;;DECREMENT MAX COUNT
	JNZ	.-15		;;LOOP
	JMP	%DONE		;;DONE
	
	
%ERROR:	STC			;;SET CARRY
%DONE:	XCHG			;;POINTER TO END OF NAME
	RET
ENDFCB:]]			;;END MACRO

;
;  14.  $INSTR - IN STRING FUNCTION SEARCHES STRING OF LEN LSRT FOR SUBSTRING
;		RETURNS WITH CARRY SET IF MATCH AND HL POIN
	RET
SSX:	LXI	D,0
	MOV	E,C
	DAD	D		;;ADD LENGTH TO POINTER
	STC			;;SET CARRY
	RET
%END:]]
;
;
;  15.  $MATCH - COMPARE STRING WITH LITERAL AND SET CARRY IF EQUAL
;
	.DEFINE $MATCH [STR1,STR2,%STR,%OVER] = [
	LXI	H,STR1
	.IFN	$MATSW,[
	LXI	D,%STR
	MVI	C,%OVER-%STR
	CALL	SMATCH
	JMP	%OVER
%STR:	.ASCII	'STR2'
%OVER:]
	.IFE	$MATSW,[
	LXI	D,%STR
	MVI	C,%OVER-%STR
	CALL	SMATCH
	JMP	MATEND
%STR:	.ASCII	'STR2'
%OVER:
$MATSW	=	1		;;CONDITIONAL ASSEMBLY SWITCH
SMATCH:	DCR	C		;;DECR LENGTI	D,X
	CALL	5]
;
;
;   20. RESDRV - RESTORE SAVED DISK DRIVE NUMBER
;
	.DEFINE RESDRV [SAVE] = [
	MVI	C,14
	LDA	SAVE
	MOV	E,A
	CALL	5]
;
;
	.LIST
	.PABS
	.SALL
	.XSYM
	.LOC	100H		;SET ORIGIN AT 100
;
;SET CONDITIONAL ASSEMBLY SWITCHES
;
$FCBSW	=	0
$MATSW	=	0
$STRSW	=	0
	LXI	SP,NEWSTK	;SET UP NEW STACK
	LHLD	6		;TOP OF MEMORY
	LXI	D,-128
	DAD	D		;SUBTRACT 128 FOR LAST BLOCK
	LXI	D,5000H		;MEMORY LIMIT
	CPHL			;COMPARE DE - HL
	JC	STEND
	XCHG
STEND:	SHLD	MEMEND		;SET END OF MEMOFF DISPLAY FOR SLOW TERMINALS
MAT1:	$MATCH	82H,'TAPE:='
	JC	DT1
	$MATCH	82H,'DISK:='
	JC	TDISK
	$MATCH	82H,'A:='
	JC	ADISK
	$MATCH	82H,'B:='
	JC	BDISK
	$MATCH	82H,'RUN:='
	JC	RUNFIL		;GO TO EXEC FILE IF TYPE COM
INERR:	PRINT	CRLF
	PRINTL	'ERROR - NO SUCH DESTINATION$'
	JMP	MOREIN	;ERROR IN INPUT COMMAND STRING EXIT
;
;    SELECT DISK DRIVE
;
DT1:	$MATCH	88H,'SYNC'	;TEST FOR WRITE SYNC STREAM
	JC	SYNC
	$MATCH	88H,'A:'	;DRIVE A
	JNC	DT2
	XRA	A		;0 - DRIVE A
	STA	NEWDRV
	JMP	DOWN
DT2:	TING TO END SUBSTR
;
	.DEFINE $INSTR [STRING,LSTR,SUBSTRING,%STR,%OVER] = [
	LHLD	STRING		;;GET STRING ADDR
	MVI	B,LSTR		;;STRING LENGTH
	.IFN	$STRSW,[
	LXI	D,%STR
	MVI	C,%OVER-%STR
	CALL	FSTR
	JMP	%OVER
%STR:	.ASCII	'SUBSTRING'
%OVER:]
	.IFE	$STRSW,[
	LXI	D,%STR
	MVI	C,%OVER-%STR
	CALL	FSTR
	JMP	%END
%STR:	.ASCII	'SUBSTRING'
%OVER:
	$STRSW = 1
FSTR:	MOV	A,B		;;STRING LEN
	SUB	C		;;SUBSTR LEN
	CMC
	JM	.+21		;;SUBSTR LONGER THAN STRING
	MOV	B,A		;;STRING LENGTH-SUBSTRING LENGTH
INSTRH COUNT
	JM	SM3		;;EXIT MATCH FOUND
	LDAX	D		;;GET A BYTE FROM FIRST STRING
	CMP	M		;;COMPARE WITH SECOND STRING
	JNZ	SM2		;;EXIT, NO MATCH
	INX	H
	INX	D		;;INCR ADDR POINTERS
	JMP	SMATCH		;;TRY AGAIN
SM2:	XRA	A		;;CLEAR CARRY
	JMP	.+4		;;EXIT
SM3:	STC			;;SET CARRY
	RET
MATEND:]]
;
;
;   17.  IMATCH - COMPARE INDIRECT STRINGS OF EQUAL LENGTH SET CARRY IF =
;
	.DEFINE IMATCH [STR1,STR2,LEN] = [
	LXI	D,STR1		;;ONE STRING
	.IFDIF	[STR2][HL],[
	LXI	H,STR2]		;;THE OTHER
	MVI	C,LEN		;;LENGTHORY
	GETDRV	DRVNO		;SAVE CURRENTLY LOGGED DISK DRIVE NO
	STA	NEWDRV		;SAVE IT IN NEWDRV TOO
	LDA	80H		;BUFFER ALREADY FILLED?
	ORA	A
	JNZ	START
	PRINT	CRLF
	PRINTL	'TAPELIB UTILITY VERS 1.1$'
	PRINT	CRLF
	PRINTL	'COPYRIGHT 1977 BY S. J. SINGER$'
NEWIN:	PRINT	CRLF2
	PRINTL	'*$'
	MVI	A,0FFH		;SET SWITCH TO RETURN HERE AGAIN
	STA	INFLAG
	FILL	80H,0FFH	;ZERO INPUT BUFFER
	READTB	80H		;READ TEXT INTO BUFFER
	LDA	81H		;POINTS TO END OF INPUT
	INR	A
	STA	80H		;MOVE IT TO 80H
	XRA	A
	STA	DISFLG	$MATCH	88H,'B:'	;DRIVE B
	JNC	DTAPE
	MVI	A,1		;1 - DRIVE B
	STA	NEWDRV
DOWN:	MOVE	84H,82H,120	;SHIFT BUFFER DOWN TWO BYTES
	LXI	H,80H		;POINTS TO LENGTH OF COMMENT
	DCR	M
	DCR	M		;DECR LENGTH BY 2
;
;  DTAPE - START OF DISK TO TAPE ROUTINE
;
DTAPE:	FILFCB	FCB,SLOC1	;FILL IN FCB FROM INPUT BUFFER
	JC	NAMERR		;ERROR IN NAME PRINT ERROR MESSAGE
	PUSH	H		;POINTER TO START OF COMMENT
	FILL	FILBUF,FILBUF+128,20H   ;BLANK COMMENT FIELD OF FILE
	LDA	80H		;POINTS TO LENGTH OF COMMENT
	ADI	81H
	LXI	H1:	PUSH	H
	PUSH	D
	PUSH	B
	DCR	C		;;DECR LENGTH COUNT
	JM	.+17		;;EXIT MATCH FOUND
	LDAX	D		;;GET A BYTE FROM FIRST STRING
	CMP	M		;;CONPARE WITH SECOND STRING
	JNZ	.+8		;;EXIT NO MATCH
	INX	H
	INX	D		;;INCR ADDR POINTERS
	JMP	.-11		;;TRY AGAIN
	XRA	A		;;CLEAR CARRY
	JMP	.+4		;;EXIT
	STC			;;SET CARRY
	POP	B
	POP	D
	POP	H
	JC	SSX		;;MATCH FOUND SET POINTER AND RET
	DCR	B		;;DECR STRING LEN
	RM			;;RETURN IF MINUS - NO MATCH
	INX	H		;;INCR STRING POINTER
	JMP	INSTR1		;;GO TRY SOME MORE
	DCR	C		;;DECR LENGTH COUNT
	JM	.+17		;;MATCH FOUND EXIT
	LDAX	D		;;BYTE FROM ONE STRING
	CMP	M		;;COMPARE WITH OTHER STRING
	JNZ	.+8		;;NO MATCH EXIT
	INX	H
	INX	D		;;INCR POINTERS
	JMP	.-11		;;TRY AGAIN
	XRA	A		;;CLEAR CARRY
	JMP	.+4		;;EXIT
	STC]			;;SET CARRY ON MATCH
;
;

;   18. GETDRV - INTERROGATE AND SAVE CURRENTLY LOGGED DISK NO
;
	.DEFINE GETDRV [SAVE] = [
	MVI	C,25
	CALL	5
	STA	SAVE]
;
;
;
;   19. SETDRV - SET DISK DRIVE NUMBER
;
	.DEFINE SETDRV [X] = [
	MVI	C,14
	LX	;TURN OFF DISPLAY
	STA	DFLAG1
	STA	VERFLG		;RESET VERIFY FLAG
	STA	AMBIG		;RESET AMBIGUOUS FILE NAME FLAG
	STA	FAMBIG		;RESET FIRST AMBIGUOUS FILE FLAG
	MVI	A,65
	STA	BCOUNT		;RESET DISPLAY CHAR PER LINE
	MVI	A,88H
	STA	SLOC1		;RESET FILE NAME POINTER
START:	FILL	FCB,FCB+32	;ZERO ALL FIELDS OF FCB
	$INSTR	IPOINT,120,'BLOCK'	;BLOCK TAPE ?
	JNC	NODIS
	LXI	H,3000H
	SHLD	MEMEND		;SET MEMORY LIMIT
NODIS:	$INSTR	IPOINT,120,'NODISPLAY'	;TURN OFF DISPLAY ?
	JNC	MAT1
	MVI	A,0FFH
	STA	DFLAG1		;TURN ,0		;ZERO HL
	MOV	L,A		;HL POINTS TO END OF COMMENT
	POP	D		;POINTS TO START OF COMMENT
	LXI	B,FILBUF+11	;POINTS TO OUTPUT BUFFER
MOVCOM:	CPHL			;FINISHED MOVE ?
	JZ	ENDMOV
	LDAX	D		;GET BYTE OF COMMENT
	STAX	B		;STORE IT
	INX	D
	INX	B
	JNZ	MOVCOM		;LOOP BACK
ENDMOV:	CALL	SCANFCB		;CHECK FOR AMBIGUOUS FILE NAME
	JNC	DTAPE1
	MOVE	FCB,AMBNAM,12	;SAVE AMBIGUOUS FILE NAME
	MVI	A,0FFH
	STA	AMBIG		;SET AMBIGUOUS NAME FLAG
	RESDRV	NEWDRV		;SELECT NEW DRIVE IF ANY
	CALL	GETNAM
DAM:	LXI	D,FCB		;POI TOO LARGE FOR MEMORY$'
	PRINT	CRLF
	PRINTL	'WRITING BLOCKED OUTPUT TAPE$'
	LDA	FAMBIG
	ORA	A
	JNZ	GOBLK		;DISPLAY MESS ONLY FOR FIRST BLK
	MVI	A,-1
	STA	FAMBIG		;START TAPE DISPLAY OFF
	CALL	STARTW		;DISPLAY START MESSAGE
GOBLK:	PRINT	CRLF2
	MOVE	FILBUF,FILBUF+1280,128	;SAVE COMMENT FIELD
	JMP	BLKOUT		;WRITE BLOCKED OUTPUT TAPE
ENDFIL:	CPI	1		;TEST FOR EOF
	JZ	TAPE
RDERR:	PRINT	CRLF
	PRINTL	'DISK READ ERROR$'
	JMP	MOREIN		;EXIT
TAPE:	LHLD	NBLOCKS		;GET NO OF 128 BYTE BLOCKS READ
	INX	H
	MORE NAMES
	PUSH	H
	PRINT	CRLF2		;SPACE AND RING BELL
	POP	H
	JMP	DAM		;WRITE THE FILE ON TAPE
PM2:	CALL	STOP		;DISPLAY STOP MESSAGE
	JMP	MOREIN		;EXIT
;
;    THIS ROUTINE WRITES BLOCKED OUTPUT TAPES FOR FILES
;    TOO LARGE FOR MEMORY
;
BLKOUT:	CLOSE	FCB
	FILL	FCB+12,FCB+8,0
	FILL	FILBUF+128,FILBUF+1024,1AH
	OPEN	FCB		;POSITION FILE TO FIRST RECORD
	LXI	H,FILBUF+128
	SHLD	BPOINT
	LXI	H,80H
	SHLD	IPOINT		;RESET DATA TRANSFER POINTERS
	MVI	A,0FFH
	STA	FIRST		;INDICATE FIRST RECORD
	MVI	ALL	WRID		;WRITE FILE HEADER
	MVI	C,0		;FIRST BLOCK TYPE 0
	MVI	B,5		;5 BLOCKS WITH HEADER
	XRA	A
	STA	FIRST		;NOT FIRST
	JMP	BLKN		;BACK TO OUTPUT
;
;
;    RUN TAPE FILE
;
RUNFIL:	LXI	H,87H
	SHLD	SLOC1		;POINTER TO FILE NAME
	MVI	A,0FFH
	STA	RUNFLG		;SET RUN FLAG TRUE
	JMP	TDISK
;
;    SELECT DISK DRIVE
;
ADISK:	XRA	A		;0 - DRIVE A
	STA	NEWDRV
	JMP	BD1
BDISK:	MVI	A,1		;1 - DRIVE B
	STA	NEWDRV
BD1:	LXI	H,85H
	SHLD	SLOC1		;POINTER TO NAME
;
;  TDISK - START OF TAPE TO DISK ROUTINE
NT TO FCB
	MVI	C,12		;LENGTH
MNAM:	MOV	A,M
	STAX	D
	INX	H
	INX	D
	DCR	C
	JNZ	MNAM		;MOVE NAME
	FILL	FCB+12,FCB+8	;ZERO REST OF FCB
DTAPE1:	MOVE	FCB+1,FILBUF,11	;MOVE NAME TO OUTPUT BUFFER
	RESDRV	NEWDRV		;SELECT NEW DRIVE
	OPEN	FCB
	JNC	LDFIL
OPNERR:	PRINT	CRLF
	LDA	NEWDRV
	ORA	A
	JNZ	OER1
	PRINTL	'NO FILE BY THAT NAME ON DRIVE A$'
	JMP	MOREIN
OER1:	PRINTL	'NO FILE BY THAT NAME ON DRIVE B$'
	JMP	MOREIN
LDFIL:	LXI	H,FILBUF+128	;SET DISK FILE BUFFER POINTER
	SHLD	BPOINT
	LXI	H,80H
	SHINX	H		;ADD 2 FOR ROUNDING
	MOV	A,H		;SHIFT RIGHT 1 BIT DOUBLE
	RAR
	MOV	A,L
	RAR
	PUSH	PSW		;STACK HAS NO OF 256 BYTE BLOCKS
	JC	PM1		;CARRY SET, PRINT MESSAGE
	LHLD	BPOINT		;NOT SET, FILL LAST 128 BYTES WITH ^Z
	PUSH	H
	INDEX	BPOINT,128
	XCHG			;END OF BLOCK IN D
	LHLD	MEMEND		;TOP OF MEMORY
	CPHL
	JC	MEMFUL		;MEMORY FILLED PRINT ERROR MESSAGE
	POP	H		;BEGINING OF BLOCK IN HL
LF1:	MVI	A,1AH		;CONTROL Z
	MOV	M,A		;STORE IT IN MEMORY
	INX	H
	CPHL			;LIMIT REACHED
	JNZ	LF1
PM1:	LDA	FAMBIG,15
	STA	BLKBLK		;RESET BLOCK COUNTER
RBEG:	MVI	A,1
	STA	BLOCK		;SET BLOCK COUNT TO 1
RLOOP:	READ	FCB		;READ A RECORD FROM DISK
	JC	FEND		;CARRY SET ON EOF OR ERROR
	MOVEI	IPOINT,BPOINT,128	;MOVE BLOCK
	LDA	BLOCK
	CPI	8
	JZ	TAPWRT		;IF 8 RECORDS WRITE TAPE
	INR	A
	STA	BLOCK		;INCR BLOCK COUNT
	INDEX	BPOINT,128	;INCR  ADDR BY 128
	JMP	RLOOP
FEND:	CPI	1
	JNZ	RDERR		;DISK READ ERROR
	MVI	C,2		;TYPE
	XRA	A		;CLEAR CARRY
	LDA	BLOCK		;BLOCK COUNT
	INR	A
	RAR			;NO OF 256 BYTE BLOCKS
	MOV	B,A	;
TDISK:	FILFCB	FCB,SLOC1	;FILL IN FCB FROM INPUT BUFFER
	JC	NAMERR		;FILE NAME ERROR PRINT MESS
	CALL	SCANFCB		;CONVERT * TO ? IN AMBIG FILE NAMES
	JNC	TDISK1
	MVI	A,-1
	STA	AMBIG		;SET AMBIGUOUS NAME FLAG
	MOVE	FCB,AMBNAM,12	;SAVE AMBIG NAME
TDISK1:	MOVE	80H,FILBUF,128	;SAVE NAME AND COMMENT, RESDRV MAY USE BUFFER
	RESDRV	NEWDRV		;LOAD NEW DRIVE NO IF SELECTED
	MOVE	FILBUF,80H,128	;RESTORE NAME AND COMMENT
	PRINT	CRLF2
	PRINTL	'START CASSETTE TAPE - TYPE CARRIAGE RETURN$'
	PRINT	CRLF2
	CONINLD	IPOINT		;RESET INPUT BUFFER POINTER TO 80H
	LXI	H,0
	SHLD	NBLOCKS		;INITIALIZE BLOCK COUNT TO ZERO
LD1:	READ	FCB		;READ A RECORD FROM DISK
	JC	ENDFIL		;EXIT IF ERROR OR EOF
	MOVEI	IPOINT,BPOINT,128	;MOVE BLOCK TO BUFFER
	INDEX	NBLOCKS,1	;INDEX BLOCK COUNT BY ONE
	INDEX	BPOINT,128	;INDEX BUFFER POINTER BY 128
	XCHG
	LHLD	MEMEND		;TEST FOR MEMORY OVERFLOW
	CPHL			;COMPARE DE AND HL
	JNC	LD1		;BACK TO READ LOOP
MEMFUL:	PRINT	CRLF2
	PRINTL	'BLOCKED TAPE REQUESTED OR$'
	PRINT	CRLF
	PRINTL	'FILE
	ORA	A
	JNZ	PMX		;NO START MESSAGE
	CALL	STARTW		;DISPLAY MESSAGE
	MVI	A,0FFH
	STA	FAMBIG		;SET SWITCH FOR DISPLAY OFF
PMX:	CALL	WRID		;WRITE AN ID BLOCK ON TAPE
	POP	B		;NO OF 256 BYTE BLOCKS IN B
	LXI	H,FILBUF
	MVI	C,1		;RECORD TYPE
	CALL	TAPOUT		;WRITE THE RECORD
PMY:	LDA	AMBIG		;AMBIGUOUS NAME FLAG
	ORA	A
	JZ	PM2		;NOT SET THEN EXIT
	CALL	GETNAM		;SEARCH DIR WITH PREVIOUS NAME
	MOVE	AMBNAM,FCB,12	;AMBIG NAME FOR NEXT SEARCH
	CALL	GETNEXT		;SEARCH DIR FOR NEXT NAME
	JC	PM2		;EXIT IF NO 	;STORE IN B
	LXI	H,FILBUF	;BUFFER POINTER
	CALL	WRSPAC		;WRITE SPACER BLOCK
	CALL	TAPOUT
	MOVE	FILBUF+1280,FILBUF,128	;RESTORE COMMENT FIELD
	JMP	PMY		;PRINT MESSAGE AND EXIT
TAPWRT:	LDA	FIRST
	ORA	A		;IS THIS THE FIRST RECORD
	JNZ	BLK1		;YES, WRITE IT WITH HEADER
	MVI	C,1
	MVI	B,4		;BLOCK COUNT
BLKN:	LXI	H,FILBUF	;BUFFER POINTER
	CALL	WRSPAC		;WRITE SPACER BLOCK
	CALL	TAPOUT		;WRITE TAPE
	FILL	FILBUF,FILBUF+1024,1AH
	LXI	H,FILBUF
	SHLD	BPOINT
	JMP	RBEG		;BACK FOR MORE DISK INPUT
BLK1:	CA			;WAIT FOR CONSOLE INPUT
	CPI	3		;CONTROL C ?
	JZ	MOREIN		;RETURN TO MONITOR
	JMP	TAPIN		;TO TAPE INPUT ROUTINE
;
;   CASW - CASSETTE OUTPUT ROUTINE  (DATA IN A)
;
CASW:	PUSH	H		;SAVE REGS
	PUSH	D
	PUSH	B
	PUSH	PSW
	CALL	ESCAPE		;CHECK FOR CONTROL C
CAS1:	IN	CASC		;GET STATUS
	ANI	20H
	JNZ	CAS1		;WAIT FOR STATUS READY
	POP	PSW		;DATA BACK TO A
	PUSH	PSW		;SAVE IT AGAIN
	OUT	CASD		;WRITE BYTE TO TAPE
	OUT	0FFH		;OUT TO LIGHTS
	LXI	H,CKSUM		;MEMORY ADDR OF CHECKSUM
	ADD	M		;ADD TO A
	ST;SAVE DATA
	LDA	DISFLG		;DISPLAY FLAG
	ORA	A
	JZ	YSKIP		;OUT IF ZERO
	LDA	DFLAG1
	ORA	A		;DISPLAY OFF FOR SLOW TERMINALS
	JNZ	YSKIP		;OUT IF NOT ZERO
	LDA	BCOUNT		;COUNT OF BYTES PER LINE
	DCR	A		;DECR BY ONE
	STA	BCOUNT		;STORE IT BACK
	JNZ	USKIP		;CONTINUE IF NOT END OF LINE
	PRINT	CRLF
	MVI	A,64		;CHAR PER LINE
	STA	BCOUNT		;RESET COUNTER
USKIP:	POP	PSW		;GET BACK DATA
	CPI	7FH		;COMPARE WITH RUBOUT
	JP	VSKIP		;PRINT PERIOD
	CPI	20H		;COMPARE WITH SPACE
	JP	XSKIP		;SKIP SUBSTITUTION
VSYTES - 1
T3:	MOV	A,M		;GET A BYTE FROM MEMORY
	CALL	CASW		;WRITE IT TO CASSETTE
	INX	H
	DCR	C
	JNZ	T3		;LOOP TILL END OF BLOCK
	DCR	B
	JNZ	T2		;LOOP TILL ALL BLOCKS DONE
T4:	XRA	A
	STA	DISFLG		;TURN OFF DISPLAY
	LDA	CKSUM
	CALL	CASW		;WRITE CHECKSUM
	RET			;BYE
;
;  TAPIN - TAPE INPUT ROUTINE
;
TAPIN:	XRA	A
	STA	DISFLG		;TURN OFF DISPLAY
	CALL	RDID		;SEARCH TAPE FOR ID BLOCK
	XRA	A		;ZERO
	STA	CKSUM		;ZERO CHECKSUM
	MVI	A,10H
	OUT	CASC		;RESET RECEIVER
	CALL	CASR		;READ DECODE BYTE
	WITH MEMORY
	JNZ	TPERR		;CHECKSUM ERROR
	LDA	AMBIG		;CHECK AMBIG FLAG
	ORA	A
	JNZ	PCR2		;TO DISK ROUTINE
	CALL	STOP		;DISPLAY STOP MESSAGE
	JMP	WDISK		;TO DISK WRITE ROUTINE
PCR2:	PRINT	CRLF2		;CARRIAGE RET
	JMP	WDISK		;TO DISK WRITE ROUTINE
;
TPERR:	PRINT	BELL
	PRINTL	'CHECKSUM ERROR$'
	PRINT	CRLF
	PRINTL	'TO RESTART - REWIND TAPE AND TYPE CARRIAGE RETURN$'
	PRINT	CRLF
	CONIN			;READ CONSOLE
	CPI	3		;CONTROL C ?
	JZ	MOREIN		;RETURN TO MONITOR
	JMP	TAPIN		;BACK TO TAPE INPUT ROUTINE
;
;A	CKSUM		;STORE IT BACK
	POP	PSW		;GET BACK DATA
	CALL	DISPLY		;OUTPUT TO CONSOLE
	POP	B		;RESTORE REGISTERS
	POP	D
	POP	H
	RET
CASC	==	6EH		;CASSETTE STATUS PORT
CASD	==	6FH		;CASSETTE DATA   PORT
;
CASR:	PUSH	H		;SAVE REGISTERS
	PUSH	D
	PUSH	B
ETEST:	CALL	ESCAPE		;CHECK FOR CONTROL C
READCT:	IN	CASC		;READ CASSETTE STATUS
	ANI	10H		;CHECK BIT 4
	JNZ	ETEST		;WAIT TILL READY
	IN	CASD		;READ CASSETTE DATA
	PUSH	PSW		;SAVE IT
	OUT	0FFH		;OUT TO LIGHTS
	LXI	H,CKSUM		;POINTER TO CKSUM
	ADD	KIP:	MVI	A,2EH		;ASCII PERIOD
XSKIP:	CONOUT			;OUT TO CONSOLE
	RET
YSKIP:	POP	PSW
	RET
;   NAME ERROR IN FILE NAME - PRINT ERROR MESSAGE
;
NAMERR:	PRINT	CRLF
	PRINTL	'ERROR IN FILE NAME$'
	JMP	MOREIN		;EXIT BACK TO MONITOR
;
;
;
;   TAPEOUT - OUTPUT BLOCK OF TAPE IN TARBELL FORMAT
;
TAPOUT:	PUSH	H		;SAVE POINTER
	LXI	H,BLKBLK	;POINT TO BLOCK COUNT
	INR	M		;INCR BY ONE
	MVI	A,16		;BLOCK LIM 1
	CMP	M
	JZ	T0		;WRITE SPACER BLOCK
	INR	A
	CMP	M		;IS COUNT 18
	JNZ	T1		;NO EXTRA SPACE BLOCKCPI	0FFH		;CHECK IT
	JNZ	TAPIN
	CALL	CASR		;READ TYPE BYTE
	STA	TYPE		;SAVE IT
	CPI	3		;CHECK TYPE < 3
	JP	TAPIN
	CALL	CASR		;READ LENGTH
	LXI	H,0
	MOV	L,A		;NO OF 256 BYTE BLOCKS ON TAPE
	MOV	B,A		;SAVE IT IN B
	DAD	H		;SHIFT LEFT 1
	DCX	H		;NUMBER OF 128 BYTE BLOCKS (FOR DISK)
	SHLD	NBLOCKS		;STORE TO MEMORY
	MVI	A,0FFH		;.TRUE.
	STA	DISFLG		;TURN ON DISPLAY FLAG
	LXI	H,FILBUF	;BUFFER POINTER
	LXI	D,1		;BLOCK COUNT FOR NAME CHECK
RD1:	MVI	C,128		;NO BYTES PER BLOCK - 1
RD2:	CALL	CASR		;R
NAMCHK:	PUSH	H
	PUSH	D
	PUSH	B
	PRINT	CRLF
	LXI	H,FILBUF	;SET POINTERS
	LXI	D,FCB+1
	MVI	C,11
NAMC1:	DCR	C
	JM	NAMC3		;MATCH IF MINUS
	LDAX	D		;GET BYTE OF FCB NAME
	CPI	'?'
	JNZ	NAMCY
	MOV	A,M		;CHECK NAME FOR NON PRINTABLE CHAR
	CPI	20H
	JM	NAMC2
	CPI	7FH		;DELETE CODE
	JP	NAMC2
	JMP	NAMCX
NAMCY:	CMP	M		;COMPARE WITH FILE NAME
	JNZ	NAMC2
NAMCX:	INX	H
	INX	D
	JMP	NAMC1
NAMC2:	XRA	A		;CLEAR CARRY
	JMP	ENDCK
NAMC3:	STC
ENDCK:	POP	B
	POP	D
	POP	H
	JC	TYPCHK		;MATCH, CHECK TYPE
	M		;ADD IT TO DATA
	STA	CKSUM		;STORE IT BACK
	POP	PSW		;GET BACK DATA
	PUSH	PSW		;SAVE IT AGAIN
	CALL	DISPLY		;OUT TO CONSOLE
	POP	PSW		;GET BACK DATA
	POP	B
	POP	D
	POP	H		;RESTORE REGISTERS
	RET
;  ESCAPE - TEST FOR CONTROL C AND RETURN TO MONITOR
;
ESCAPE:	MVI	C,11
	CALL	5
	ANI	1
	RZ			;RETURN IF LOW BIT NOT SET
	CONIN
	CPI	3		;TEST FOR ^C
	JZ	MOREIN		;EXIT TO MONITOR OR BACK TO INPUT
	RET
;
;
;   DISPLY - OUTPUT A TO CONSOLE AND SUBSTITUTE . FOR ^ CHARACTERS
;
DISPLY:	PUSH	PSW		
	MVI	M,1		;SET BLOCK COUNT TO ONE
T0:	CALL	WRSPAC		;WRITE SPACE BLOCK
	CALL	WRSPAC		;WRITE SPACE BLOCK
T1:	POP	H		;RESTORE POINTER
	MVI	A,3CH		;START BYTE
	CALL	CASW		;WRITE IT OUT
	MVI	A,0E6H		;SYNC BYTE
	CALL	CASW		;WRITE IT
	XRA	A
	STA	CKSUM		;ZERO CHECKSUM
	MVI	A,0FFH		;DECODE BYTE
	CALL	CASW		;WRITE IT
	MOV	A,C		;TYPE BYTE
	CALL	CASW		;WRITE IT TO TAPE
	MOV	A,B		;NO OF 256 BYTE BLOCKS
	CALL	CASW		;WRITE IT OUT
	MVI	A,0FFH		;SET DISPLAY FLAG
	STA	DISFLG
T2:	MVI	C,0		;BLOCK LENGTH IN BEAD A BYTE
	MOV	M,A		;STORE IT
	INX	H
	DCR	C		;DECR LENGTH
	JNZ	RD2		;LOOP BACK
	DCX	D
	MOV	A,D		;DECR BLOCK COUNT FOR NAME CHECK
	ORA	E
	JZ	NAMCHK		;COMPARE NAME FROM TAPE WITH FCB
GOON:	DCR	B		;DECR NO OF BLOCKS
	MVI	C,0		;NO OF BYTES PER BLOCK - 1
	JNZ	RD2		;LOOP BACK
	SHLD	ENDF		;SAVE LOCATION OF LAST BYTE READ
	LDA	CKSUM		;GET CHECKSUM FROM MEMORY
	MOV	B,A		;STORE IT TEMPORARILY IN B
	XRA	A		;ZERO
	STA	DISFLG		;TURN OFF DISPLAY
	CALL	CASR		;READ CHECKSUM FROM TAPE
	SUB	B		;COMPARE IT JMP	TAPIN		;NO MATCH SEARCH SOME MORE
TYPCHK:	LDA	TYPE		;GET TYPE
	CPI	1		;IS IT TYPE 1
	JZ	RD1		;YES,UNBLOCKED RECORD
;
;    THIS ROUTINE READS BLOCKED TAPES
;
BLKIN:	PUSH	B		;SAVE BLOCK COUNT
	MOVE	FILBUF,FCB+1,11	;MOVE NAME INTO FCB
	XRA	A
	STA	FCB+32
	POP	B		;RESTORE BLOCK COUNT
	LXI	H,FILBUF	;POINTER TO BUFFER
	MVI	C,128		;BYTES LEFT IN FIRST BLOCK
RD5:	CALL	CASR		;READ A BYTE FROM TAPE
	MOV	M,A		;STORE IN BUFFER
	INX	H		;INCR BUFFER POINTER
	DCR	C		;DECR BYTE COUNT
	JNZ	RD5		;BLOCK NLXI	H,FILBUF	
	SHLD	BPOINT		;SET DMA ADDR
WD4:	MOVEI	BPOINT,IPOINT,128	;MOVE BLOCK
	WRITE	FCB		;WRITE A RECORD ON DISK
	JC	DERR		;DISK WRITE ERROR (FULL)
	INDEX	BPOINT,128	;INCR  ADDR BY 128
	LDA	NBLOCKS		;BLOCK COUNT
	DCR	A
	STA	NBLOCKS		;DECR BY 1
	JNZ	WD4		;WRITE ANOTHER BLOCK
WD4X:	LDA	TYPE
	CPI	2		;IS IT LAST BLOCK
	JZ	WD5		;CLOSE FILE AND EXIT
	XRA	A
	STA	CKSUM		;ZERO CHECKSUB
	STA	DISFLG		;TURN OFF DISPLAY
	MVI	A,10H
	OUT	CASC		;RESET RECEIVER
	CALL	CASR		;READ DECODE BYTE
	CALL	CA TO START OF FILE IN MEMORY
	SHLD	BPOINT		;SET POINTER
DWLOOP:	MOVEI	BPOINT,IPOINT,128	;MOVE INDIRECT BLOCK TO OUT BUFFER
	WRITE	FCB		;WRITE IT OUT
	JC	DERR		;JUMP TO WRITE ERROR
	LHLD	NBLOCKS		;NO OF BLOCKS TO WRITE
	DCX	H		;DECREMENT IT
	MOV	A,H
	ORA	L
	JZ	DWCLOS		;CLOSE FILE AND EXIT
	SHLD	NBLOCKS		;OTHERWISE STORE IT BACK
	INDEX	BPOINT,128	;INCR MEMORY POINTER BY 128
	JMP	DWLOOP		;BACK TO WRITE ANOTHER BLOCK
;
DWCLOS:	CLOSE	FCB		;CLOSE FILE
	MOVE	FCB,FCB+16,12	;RENAME FILE
	MOVE	OLDTYP,FK IS
;    MADE TO VERIFY THAT IT IS A COM FILE.
;
RUN:	$MATCH	65H,'COM'	;TYPE IN FCB
	JNC	TYPERR
	MOVE	CODE,80H,40	;FILE OVERLAYS PROG MOVE TO BUFFER
	JMP	80H		;GO EXECUTE MOVE ROUTINE
CODE:	LXI	B,100H
	LXI	D,FILBUF+128	;POINTS TO BEGINNING OF FILE
	LHLD	ENDF		;LAST LOC TO BE MOVED
MLOOP:	LDAX	D		;GET A BYTE
	STAX	B		;STORE IT
	INX	D
	INX	B
	MOV	A,H		;COMPARE DE WITH HL
	CMP	D
	JNZ	89H
	MOV	A,L
	CMP	E
	JNZ	89H
	LXI	H,0
	SHLD	80H		;ZERO START OF INPUT BUFFER
	JMP	100H		;EXECUTE MOVED FIOT FINISHED
	MVI	C,0		;RESET BYTES PER BLOCK (256)
	DCR	B		;DECR BLOCK COUNT
	JNZ	RD5		;READ ANOTHER BLOCK
	SHLD	ENDF		;SAVE LAST LOCATION USED IN BUFFER
	XRA	A
	STA	DISFLG		;TURN OFF DISPLAY
	LDA	CKSUM		;GET CHECKSUM READ FROM TAPE
	MOV	B,A		;SAVE IT IN B
	CALL	CASR		;READ BLOCK CHECKSUM
	SUB	B		;COMPARE
	JNZ	TPERR		;CHECKSUM ERROR
;
;    NOW WRITE THE BLOCK ON DISK OR VERIFY IT
;
	LDA	TYPE		;GET TYPE
	ORA	A
	JNZ	WBLK		;IF NOT ZERO WRITE BLOCK
	LDA	VERFLG		;CHECK VERIFY FLAG (SET IF CKSUMSR		;READ	TYPE
	STA	TYPE		;SAVE IT
	CALL	CASR		;READ	LENGTH
	LXI	H,0
	MOV	L,A
	MOV	B,A		;NO OF 256 BYTE BLOCKS
	DAD	H
	SHLD	NBLOCKS		;SAVE NO OF 128 BYTE BLOCKS
	LXI	H,FILBUF	;BUFFER POINTER
	MVI	C,0		;NO OF BYTES PER BLOCK (256)
	MVI	A,0FFH
	STA	DISFLG		;TURN ON DISPLAY
	JMP	RD5		;READ ANOTHER BLOCK
WD5:	LDA	AMBIG		;CHECK AMBIG FILE NAME FLAG
	ORA	A
	JNZ	WD6		;OMIT STOP MESSAGE
	CALL	STOP		;DISPLAY STOP TAPE MESSAGE
WD6:	LDA	VERFLG		;CHECK VERIFY FLAG
	ORA	A
	JNZ	VOUT
	JMP	DWCLOS
;
; CB+25,3
	MVI	C,19		;DELETE
	LXI	D,FCB+16
	CALL	5
	MVI	C,23
	LXI	D,FCB
	CALL	5		;RENAME ROUTINE
	JMP	AMBCHK		;RETURN FOR MORE TAPE INPUT ON AMBIG NAME
;
;
VERIFY:	LXI	H,FILBUF+128	;POINTER TO START OF TAPE FILE
	SHLD	BPOINT
	MVI	A,-1
	STA	VERFLG		;SET VERIFY FLAG
	OPEN	FCB		;OPEN THE DISK FILE
	JC	OPNERR		;PRINT ERROR MESSAGE IF NO FILE
VLOOP:	READ	FCB		;READ A DISK RECORD
	JC	VEND		;EXIT ON EOF OR ERROR
	LHLD	BPOINT		;POINTER FOR COMPARE
	IMATCH	80H,HL,128	;COMPARE (HL POINTS TO ONE STRINLE
;
;    RENAME ROUTINE - RENAME FILE FOR TAPE TO DISK TRANSFER
;
RENFIL:	$INSTR	IPOINT,120,'RENAME'	;RENAME ?
	RNC			;RETURN IF NO 'RENAME'
SKPBLK:	INX	H		;INCR POINTER
	MOV	A,M		;GET A BYTE
	CPI	20H		;IS IT A BLANK
	JZ	SKPBLK		;SKIP OVER BLANKS
	SHLD	SLOC2		;STORE POINTER
	FILFCB	FCB,SLOC2	;FILL IN FCB WITH NEW NAME
	JC	NAMERR		;ERROR IN NAME (TOO LONG)
	RET
;
;    VERIFY BLOCKED TAPE
;
VERBLK:	OPEN	FCB		;OPEN THE FILE
	JC	OPNERR		;EXIT IF NO FILE
VERNXT:	LXI	H,FILBUF+1024	;POINTER FOR ERROR)
	ORA	A
	JNZ	VERBLK		;VERIFY TAPE
	$INSTR	IPOINT,120,'VERIFY'	;VERIFY FILE ?
	JNC	REN1
	MVI	A,0FFH
	STA	VERFLG		;SET VERIFY FLAG
	JMP	VERBLK
REN1:	CALL	RENFIL		;RENAME FILE ?
	$INSTR	IPOINT,120,'RUN'	;RUN FILE ?
	JC	RUNERR
	CALL	$$$TYP		;SAVE OLD TYPE AND SUB $$$
	DELMAK	FCB		;IF FIRST BLOCK DELETE
WD3X:	OPEN	FCB		;AND OPEN FILE
	LDA	NBLOCKS		;NO OF 128 BYTE BLOCKS
	DCR	A		;SUBTRACT 1 FOR HEADER
	STA	NBLOCKS		;STORE IT BACK
WBLK:	LDA	VERFLG		;CHECK VERIFY ONLY
	ORA	A
	JNZ	VERNXT
	  WDISK - DISK OUTPUT ROUTINE
;
WDISK:	MOVE	FILBUF,FCB+1,11	;MOVE NAME INTO FCB
	LDA	VERFLG
	ORA	A
	JNZ	VERIFY
	$INSTR	IPOINT,120,'VERIFY'	;VERIFY ONLY?
	JC	VERIFY
	$INSTR	IPOINT,120,'RUN'	;LOAD AND EXEC FILE?
	JC	RUN
	LDA	RUNFLG		;GET RUN FLAG, OTHER RUN TEST
	ORA	A
	JNZ	RUN
	CALL	RENFIL		;RENAME ?
WDISK1:	CALL	$$$TYP		;CHANGE TYPE TO $$$ AND SAVE OLDTYP
	DELMAK	FCB		;DELETE AND MAKE FILE
	OPEN	FCB		;OPEN THE FILE
	JC	OPNERR		;ERROR ON OPEN - PRINT MESS AND EXIT
	LXI	H,FILBUF+128	;POINTERG)
	JNC	VERERR		;EXIT IF NO MATCH
	INDEX	BPOINT,128	;INCR THE POINTER
	JMP	VLOOP		;DO ANOTHER RECORD
VEND:	CPI	1		;CHECK END FILE
	JNZ	RDERR		;READ ERROR IF NOT 1
VOUT:	PRINT	BELL2
	PRINTL	'VERIFIED SUCCESSFULLY$'
	PRINT	CRLF
AMBCHK:	LDA	AMBIG		;CONTINUE IF AMBIGUOUS FILE NAME
	ORA	A
	JZ	MOREIN		;EXIT
	MOVE	AMBNAM,FCB,12	;REPLACE AMBIG NAME IN FCB
	XRA	A
	STA	FCB+12		;ZERO EXTENTS
	STA	FCB+32
	JMP	TAPIN		;BACK TO TAPE INPUT
;
;    THIS SECTION MOVES THE FILE TO 100H AND EXECUTES IT. A CHEC DISK INPUT
	SHLD	BPOINT
	LDA	NBLOCKS
	CPI	9		;SET BLOCKS TO 8 IF > 8
	JM	VER2
	MVI	A,8		;SET BLOCKS TO 8
	STA	NBLOCKS
VER2:	READ	FCB		;READ A RECORD
	JNC	VER3
	CPI	1		;TEST EOF
	JNZ	RDERR		;DISK READ ERROR
	JMP	WD5		;PRINT STOP MESSAGE AND EXIT
VER3:	MOVEI	IPOINT,BPOINT,128
	INDEX	BPOINT,128	;INCR POINTER
	LDA	NBLOCKS		;BLOCK COUNT
	DCR	A
	STA	NBLOCKS		;DECR COUNT BY 1
	JNZ	VER2		;READ SOME MORE
	LHLD	BPOINT		;POINTS TO END OF BLOCK
	DCX	H		;DECR BY 1
	XCHG			;TO DE
	LXI	H,FILBUF+1024		;CHECK NAME NOT PRESENT
	JZ	OPNERR		;DISPLAY ERROR MESSAGE
	JMP	N1
GETNEXT:SERNXT	FCB		;SEARCH FOR NEXT OCCURRANCE OF NAME
	CPI	0FFH		;NAME NOT FOUND ?
	JNZ	N1		;RETURN ADDR IF FOUND
	STC
	RET			;SET CARRY AND RETURN
N1:	ANI	03		;ADDR MOD 4
	RRC
	RRC
	RRC			;ADDR * 32
	ADI	80H		;ADD BASE ADDR 
	LXI	H,0
	MOV	L,A		;HL NOW POINTS TO FCB FROM DIR
	XRA	A		;CLEAR CARRY
	RET
;
;   WRITE SYNC STREAM ON TAPE (65K BYTES)
;
SYNC:	CALL	STARTW		;PRINT START MESSAGE
	MVI	A,0FFH
	STA	DISFLG		;TURN O  WRITE SPACER BLOCK OF START BYTES FOR BLOCKED TAPES
;
WRSPAC:	PUSH	H
	PUSH	D
	PUSH	B
	LXI	D,160		;COUNT
WRSP1:	MVI	A,3CH		;START BYTE
	CALL	CASW		;WRITE IT
	DCX	D		;DECR COUNT
	MOV	A,D
	ORA	E
	JNZ	WRSP1		;LOOP TILL COUNT IS ZERO
	POP	B
	POP	D
	POP	H
	RET
;
;   CONSOLE MESSAGE ROUTINES
;
STARTW:	PRINT	CRLF2
	PRINTL	'START CASSETTE TAPE <<RECORD>> - TYPE CARRIAGE RETURN$'
	PRINT	CRLF2
	CONIN
	CPI	3		;ESCAPE CHARACTER
	JZ	GETOUT
	RET
GETOUT:	POP	PSW		;RESET STACK POINTER
	JMP	MOREI4H]
BCOUNT:	.BYTE	65	;COUNT OF BYTES PER LINE
RUNFLG:	.BYTE	0	;CONTROLS FILE TO BE LOADED AND EXECUTED
DISFLG:	.BYTE	0	;CONTROLS DISPLAY DURING TAPE OPERATIONS
DRVNO:	.BYTE	0	;CURRENTLY LOGGED DISK DRIVE NO
NEWDRV:	.BYTE	0	;STORAGE FOR NEW DRIVE NO IF ONE IS SELECTED
CKSUM:	.BYTE	0	;STORAGE FOR TAPE CHECKSUM
INFLAG:	.BYTE	0	;FLAG - IF SET RETURN FOR MORE CONSOLE INPUT
FIRST:	.BYTE	0	;INDICATES FIRST RECORD OF BLOCKED TAPE
BLOCK:	.BYTE	0	;BLOCK COUNT FOR BLOCKED TAPE
TYPE:	.BYTE	0	;TYPE CODE FOR BL;POINTS TO DISK DATA
	LXI	B,FILBUF	;POINTS TO TAPE DATA
VER4:	LDAX	B		;GET A BYTE
	CMP	M		;COMPARE
	JNZ	VERERR		;ERROR, NO MATCH
	INX	H
	INX	B
	CPHL			;COMPARE HL AND DE
	JNZ	VER4
	JMP	WD4X		;BACK INTO TAPE INPUT ROUTINE
;
;    THIS ROUTINE SCANS FCB NAME AND FILLS * TO ?.
;    CARRY SET SET IF * OR ? IN FILE NAME
;
SCANFCB:LXI	H,FCB+1		;POINTS TO FILE NAME
	MVI	B,'?'
	MVI	A,'*'
	CMP	M		;IS NAME *
	JNZ	SCAN2
	MVI	C,8		;FILL IN 8 '?'
SCAN1:	MOV	M,B		;MOVE A BYTE
	INX	H
	DCR	C
	JNZ	SCANN DISPLAY
	LXI	D,0		;SYNC BYTE COUNTER
SYNC1:	MVI	A,0E6H		;LOAD A SYNC BYTE
	CALL	CASW		;WRITE IT OUT
	DCX	D		;DECR COUNT
	MOV	A,D
	ORA	E
	JNZ	SYNC1		;TEST COUNT AND LOOP
	CALL	STOP		;PRINT STOP MESSAGE
	JMP	MOREIN
;
;
;    SWAP FCB TYPE WITH $$$
;
$$$TYP:	MOVE	FCBTYP,OLDTYP,3	;MOVE TYPE TO TEMPORARY STORAGE
	FILL	FCBTYP,FCBTYP+2,'$'
	RET
;
;    WRITE LEADER AND ID BLOCK OF 100 76H BYTES ON TAPE
;
WRID:	LXI	D,1500		;LOAD COUNT
WRHD:	MVI	A,3CH		;START BYTE
	CALL	CASW		;WRITE IT
	DCX	D	N		;BACK FOR MORE INPUT
STOP:	PRINT	BELL2
	PRINTL	'STOP CASSETTE TAPE$'
	PRINT	CRLF
	RET
;
;
;   EXIT AND ERROR ROUTINES
;
VERERR:	PRINT	BELL2
	PRINTL	'VERIFY ERROR$'
	JMP	MOREIN
;
TYPERR:	PRINT	BELL2
	PRINTL	'ERROR - FILE TYPE NOT <COM> - CANNOT BE RUN$'
	JMP	MOREIN
;
RUNERR:	PRINT	CRLF2
	PRINTL 'ERROR - A PROGRAM CAN NOT BE RUN FROM A BLOCKED TAPE$'
	PRINT	CRLF
	PRINTL	'TO EXECUTE PROGRAM FIRST LOAD TO DISK$'
	CALL	STOP		;DISPLAY STOP TAPE MESSAGE
	JMP	MOREIN
;
DERR:	PRINT	BELL2
	OCKED TAPE
LENGTH:	.BYTE	0	;LENGTH OF BLOCKED RECORD 256 BYTE BLOCKS
DFLAG1:	.BYTE	0	;DISPLAY OFF FOR SLOW TERMINALS
VERFLG:	.BYTE	0	;FLAG - SET FOR VERIFICATION
AMBIG:	.BYTE	0	;AMBIGUOUS NAME FLAG
FAMBIG:	.BYTE	0	;FIRST AMBIGUOUS FILE FLAG
BLKBLK:	.BYTE	0	;BLOCK COUNT FOR BLOCKED TAPES
MEMEND:	.WORD	0	;END MEMORY FOR FILE STORAGE
BPOINT:	.WORD	0	;POINTER TO FILE MEMORY BUFFER
SLOC2:	.WORD	0	;STORAGE FOR POINTER TO FCB NAME
SLOC1:	.WORD	88H	;POINTER TO NAME IN INPUT BUFFER
IPOINT:	.WORD	80H	;POIN1
SCAN2:	LXI	H,FCB+9		;POINTS TO TYPE
	CMP	M		;IS TYPE A *
	JNZ	SCAN4
	MVI	C,3		;FILL TYPE WITH '?'
SCAN3:	MOV	M,B		;MOVE A BYTE
	INX	H
	DCR	C
	JNZ	SCAN3
SCAN4:	LXI	H,FCB+1		;RESCAN FOR ? AND SET CARRY
	MVI	C,11
	MOV	A,B		;PUT '?' IN A
SCAN5:	CMP	M
	JZ	SCAN6
	INX	H
	DCR	C
	JNZ	SCAN5
	XRA	A		;CARRY OFF NO '?'
	RET
SCAN6:	STC			;CARRY ON
	RET
;
;    THIS ROUTINE SEARCHES DIRECTORY WITH AMBIGUOUS FILE NAME
;
GETNAM:	MVI	A,0
	STA	FCB+12		;SET FILE EXTENT TO ZERO
	SEARCH	FCB
	CPI	0FFH		;DECR COUNT
	MOV	A,D
	ORA	E
	JNZ	WRHD		;LOOP TILL ZERO
	MVI	D,100		;LOAD COUNT
	MVI	A,0E6H		;SYNC BYTE
	CALL	CASW		;WRITE IT
WRID1:	MVI	A,76H		;HALT CODE
	CALL	CASW		;WRITE IT
	DCR	D
	JNZ	WRID1		;WRITE ANOTHER BYTE
	RET
;
;    SEARCH FOR BLOCK OF 100 76H BYTES ON TAPE
;
RDID:	MVI	D,100		;LOAD COUNT
	MVI	A,10H
	OUT	CASC		;RESET RECEIVER
RDID1:	CALL	CASR		;READ A BYTE
	CPI	76H		;COMPARE WITH 76H
	JNZ	RDID		;START OVER
	DCR	D		;DECR COUNT
	JNZ	RDID1		;READ ANOTHER BYTE
	RET
;
;
;
; PRINTL	'DISK WRITE ERROR - DISK OR DIRECTORY FULL$'
	PRINT	CRLF
	PRINTL	'FILE DELETED FROM DISK$'
	DELETE	FCB
;
MOREIN:	LDA	INFLAG
	ORA	A
	JNZ	NEWIN
;
MONITOR: PRINT	CRLF
	RESDRV	DRVNO		;RESTORE ORIGINAL DRIVE NUMBER
	JMP	0		;EXIT BACK TO MONITOR
;
;
;   DATA ALLOCATIONS -
;
FCB	=	5CH	;FILE CONTROL BLOCK
FCBNAM	=	FCB+1	;FILE NAME
FCBTYP	=	FCB+9	;FILE TYPE
BELL:	.ASCII	[07H][0DH][0AH][24H]
BELL2:	.ASCII	[07H][0DH][0AH][0AH][24H]
CRLF:	.ASCII	[0DH][0AH]'$'
CRLF2:	.ASCII	[0DH][0AH][0AH][2TER TO DISK INPUT BUFFER
NBLOCKS:.WORD	0	;NUMBER OF 256 BYTE BLOCKS IN FILE
ENDF:	.WORD	0	;LAST MEMORY LOC USED TO STORE FILE
OLDTYP:	.BLKB	3	;TEMP STORAGE FOR FILE TYPE (FOR RENAME)
AMBNAM:	.BLKB	12	;STORAGE FOR AMBIGUOUS FILE NAME
ENDSTK:	.BLKW	16	;NEW STACK
NEWSTK:	.WORD	0	;START OF NEW STACK
FILBUF:	.WORD	0	;FILE BUFFER - TO TOP OF MEMORY
	.END
                                                                                                                                			************************
			*** PREPARED BY ZOSO ***
			***   2, 13, 1978    ***
			************************


THE FOLLOWING DOCUMENTS THE RULES AND OPTIONS OF THE GAMES 'STARTREK.TXT' AND
'BIGTREK'.


OBJECTIVE - UNLIKE MOST OTHER STARTREKS, DESTROYING THE KLINGON FLEET IS ONLY
A SECONDARY OBJECTIVE; THIS GAME FEATURES A VERY COMPREHENSIVE SCORING ROU-
TINE, AND THE REAL OBJECTIVE IS TO GET THE HIGHEST POSSIBLE SCORE (NOT UNLIKE
A PINBALL MACHINE).

START OF GAME - WHEN THIS GAME SIGNS ONE - I INSERTED SEVERAL TRAPS
FOR THIS, BUT I VERY LIKELY MISSED SOME ALSO. Z.) FINALLY IT GOES WITHOUT
SAYING THAT IF YOU WANTED TO TRAVEL ON A COURSE EXACTLY HALF WAY BETWEEN NOON
AND 3:00 O'CLOCK, THE CORRECT COURSE WOULD BE 1.5 (NOT 1:30).

WHAT YOU WILL FIND IN THE QUADRANTS:

E:	THE ENTERPRISE
K:	KLINGON BATTLE CRUISER
O:	ORGANIAN TRUCE-MONITOR VESSEL-SPACE WARPS OFTEN ACCOMPANY THESE.
	(SHOOT THEM JUST FOR PRACTISE).  
C:	COMMANDER-MAY BE YOURS, MAY BE ENEMY'S. LONG RANGE SCAN WILL TELL
	YAND (IF YOU STILL HAVE OPERATIONAL
SHUTTLE CRAFT) PROCEED AS CAPTAIN OF THE FAERIE QUEENE.

CH-CHART
CUMULATIVE GALACTIC MAP-EACH 'WINDOW' IS OPENED BY USE OF THE LRSENSORS. UNLIKE
THE USUAL ONES, THIS ONE ALWAYS SHOWS YOU WHERE THE STARBASES AND SUPERNOVAS
ARE LOCATED.

CO-COMPUTER
LIBRARY COMPUTER - SEE COMMAND SUMMARY BELOW

DA-DAMAGES
DAMAGE CONTROL/REPAIR. GET A FEEL FOR THIS BY PLAYING.
	WHAT DAMAGE CONTROL/REPAIR REFERENCES:
		SRSENSORS
		LRSENSORS
		PHASERS
		PHOTON TUBES
		LIFE SU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                , IT ASKS: "MISSION DURATION ?"; ANSWER
'S', 'M' OR 'L' (SHORT MEDIUM OR LONG). IT IS WORTH NOTING THAT THE SHORT GAMES
CAN BE VERY, VERY SHORT. NEXT IT ASKS "ARE YOU A BEGINNER, NOVICE, SENIOR OR
EXPERT; ANSWER 'B', 'N', 'S' OR 'E', ALSO WORTH NOTING, IF YOU REPLY 'B' THE
GAME STARTS OUT GIVING THE PLAYER MORE INFORMATION THAN IS AVAILABLE IN ANY OF
THE OTHER THREE MODES. THEN IT REQUESTS YOUR "MISSION PASSWORD"; REMEMBER WHAT
YOU REPLY HERE; YOU WILL NEED TO KNOW THE WORD TO SELF DESTRUCT (WHICH DUEOU WHICH (IF YOU COUNT TOTAL ENEMY IN QUADRANT).
F:	THE FAERIE QUEENE-AN OLD STARSHIP WHICH YOU CAN SOMETIMES USE AFTER
	ENTERPRISE HAS BEEN ABANDONED OR CRIPPLED.
*:	STARS-IF THEY ARE IN YOUR WAY, YOU CAN SHOOT THEM WITH YOUR PHOTONS,
	THERE IS A MINOR PENALTY FOR THIS. (THEY 'NOVA' WHEN DESTROYED.) IF
	YOU ARE TOO CLOSE TO A STAR WHEN YOU SHOOT IT, THE FORCE OF THE NOVA
	MAY WELL DESTROY THE ENTERPRISE.
?	THIS MEANS YOU ARE TRYING TO VIEW BEYOND QUADRANT BOUNDARY WITH THE
	VISUAL-SENSORS (SEE BELOPPORT
		WARP ENGINES
		IMPULSE ENGINES
		SHIELDS
		SUBSPACE-RADIO
		SHUTTLE CRAFT
		COMPUTER
		TRANSFER PANEL
	NOTE: THE ABOVE DO NOT ALL NECESSARILY CORRESPOND TO THE TWENTY
	COMMAND-LEVEL OPTIONS.

DE-DESTRUCT
SELF-DESTRUCT SERVOS. REMEMBER PASSWORD YOU ENTERED AT BEGINNING.

DO-DOCK
WHAT YOU MUST DO WHEN ADJACENT TO A STARBASE, UNLIKE MOST OTHER 'STARTREKS',
THIS MUST BE SPECIFICALLY COMMANDED; IT IS NOT AUTOMATIC.

ID-IDLE
IDLE ENGINES - KILL TIME WHILE WAITING FOR REPAIRS TO BE COMPL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 TO
THE EMPHASIS ON POINTS SCORED IS OFTEN THE WISEST OPTION). FINALLY YOU WILL BE
ASKED, "READY TO CONTINUE ?"; ENTER ANY CHARACTER AND HIT RETURN.

NAVIGATION, PHOTON AIMING ETC. - THE COORDINATES USED ARE JUST EXACTLY LIKE
THE NUMBERS ON A CLOCK FACE (12 O'CLOCK AT THE TOP) N.B.!!! IF YOU WANT TO
TRAVEL OR AIM A PHOTON STRAIGHT UP, ENTER COURSE 12 (NOT COURSE 0); FAILURE
TO OBSERVE THIS PRECAUTION WILL LEAD TO AN OCCASIONAL DIVISION BY ZERO ERROR,
AND YOU WILL HAVE LOST THE GAME IN PROGRESS. (NOTW).
***:	SUPER-NOVA - AVOID THESE AT ALL COSTS !!!

EACH QUADRANT IS A 10 BY 10 GRID, WHICH CAN BE EXACTLY TRANSVERSED EITHER IN A
HORIZONTAL OR VERTICAL (NOT DIAGONAL) DIRECTION WITH A WARP FACTOR OF 1. THE
CORRECT WARP FACTOR FOR FULL DIAGONAL TRANSVERSE IS 1.4142 (2^0.5) [IN BASIC].

			*** COMMAND LEVEL ***

EACH OF THE FOLLOWING COMMANDS MUST BE ENTERED AS TWO (OR MORE) SIGNIFICANT
LETTERS FOLLOWED BY <CR>. (THE 20 COMMAND-LEVEL OPTIONS)

AB-ABANDON
ABANDON SHIP - SACRIFICE THE ENTERPRISE ETED. THIS
COMMAND IS NULLIFIED WHEN A TRACTOR-BEAM LOCKS ONTO YOUR STARSHIP.

IM-IMPULSE
IMPULSE ENGINES - USE THESE WHEN WARP ENGINES ARE OUT (THEY ARE FAR LESS
ENERGY-EFFICIENT). ALSO CERTAIN STARS HAVE MAGNETIC PROPERTIES, AND IN SUCH
CASES YOU MUST USE IMPULSE ENGINES TO BREAK FREE.

LR-LRSCAN
LONG RANGE SCANNERS - WORKS AS YOU WOULD EXPECT.

NA-NAVIGATE
MOVE YOUR STARSHIP THROUGH SPACE.

PH-PHASERS
PHASER BANKS. UNDER CERTAIN CIRCUMSTANCES MAY BE DIRECTED AT ENEMY IN ANOTHER
QUADRANT (ND (WASTEFUL TO USE IT OTHERWISE).

			*** COMPUTER OPTIONS ***

THESE MAY BE INVOKED WITH A SINGLE LETTER.

C-COURSE
GIVES EXACT BEARINGS AND DISTANCES (WARP FACTORS) FROM WHEREVER YOU ARE TO
ANYWHERE ELSE IN GALAXY. INVALUABLE FOR LONG PHOTON SHOTS. NOTE THAT THE DATA
MUST BE GIVEN IN THE FOLLOWING FORMAT: IF YOU WISH TO FIND COURSE AND DISTANCE
TO QUADRANT 3-2, SECTOR 4-10, THE CORRECT INPUT IS '32,0410'. NO OTHER SYSTEM
OF ENTRY IS ACCEPTED.

W-WCOST
THIS COMPUTES HOW MUCH ENERGY WILL BE C                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                MPUTER,TRANSFER PANEL,ABANDON,CHART,COMPUTER
120 DATA DAMAGES,DESTRUCT,DOCK,IDLE,IMPULSE,LRSCAN,NAVIGATE,PHASERS,QUIT
130 DATA SHIELDS,SOS,SRSCAN,STATUS,TORPEDO,TRANSFER,VISUAL,WARP,SHORT
140 DATA MEDIUM,LONG,BEGINNER,NOVICE,SENIOR,EXPERT,COURSE,WCOST,ICOST
150 DATA PEFFECT,OUT,ANTARES,SIRIUS,RIGEL,MERAK,PROCYON,CAPELLA
160 DATA VEGA,DENEB,CANOPUS,ALDEBARAN,ALTAIR,REGULUS,BELLATRIX,ARCTURUS
170 DATA POLLUX,SPICA,10.5,12,1.5,9,0,3,7.5,6,4.5
180 DEF FNA(X)=INT(8*RND(X))+1:DEF FNB(X)=INT(10*RND(X))+1
1SEE PEFFECT BELOW).

QU-QUIT
TERMINATE GAME WITHOUT SCORING.

SH-SHIELDS
LOWERS RAISED SHIELDS OR RAISES LOWERED SHIELDS. YOU WILL UNDERSTAND WHEN
AND HOW TO USE THIS AFTER A FEW GAMES.

SO-SOS
CALL A STARBASE FOR HELP (THIS INVOLVES A POINT-PENALTY).

SR-SRSCAN
SHORT RANGE SCANNERS - THE USUAL, BUT ALSO INVOKES LRSCAN (IF OPERATIONAL).

ST-STATUS
STATUS REPORT OF GAME IN PROGRESS. (MORE COMPREHENSIVE THAN USUAL)

TO-TORPEDO
PHOTON TORPEDOS - CAN BE FIRED SINGLY OR IN BURSTS OF THREE. THEONSUMED BY A GIVEN DISTANCE OF TRAVEL
WITH THE WARP ENGINES.

I-ICOST
THIS COMPUTES HOW MUCH ENERGY WILL BE CONSUMED BY A GIVEN DISTANCE OF TRAVEL
WITH THE IMPULSE ENGINES.

S-SCORE
THIS GIVES A PLAYER'S CURRENT SCORE AT ANY TIME DURING GAME.

P-PEFFECT
THIS COMPUTES PHASER EFFECTIVENESS AT A GIVEN DISTANCE. WITH EXPERIENCE, IT
HELPS ONE MAKE A GOOD GUESS ABOUT HOW MUCH ENERGY TO ALLOCATE TO PHASERS.

O-OUT
THIS IS COMMAND FOR COMPUTER EXIT. UNTIL THIS COMMAND IS GIVEN, ALL COMMANDS
ONLY REF                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                90 DEF FND(X)=X/60
200 DEFFNR(X)=INT(X*10+.5)/10:DEFFNS(X)=INT(X*100+.5)/100
210 FORI=1TO12:READD$(I):NEXT:FORI=1TO20:READC$(I):NEXT
220 FORI=1TO3:READT$(I):NEXT:FORI=1TO4:READS$(I):NEXT:FORI=1TO5
230 READC2$(I):NEXT:FORI=1TO16:READG1$(I):NEXT:FORI=1TO9:READC5(I):NEXT
240 GOSUB9760:S7$(1)="":S7$(2)="  ":S7$(3)=" ":S7$(4)=""
250 IFA2<>0THEN760
260 J4=0:T1=0:INPUT"COMMAND";A$:IFLEN(A$)>1THEN280
270 PRINT"2 LETTERS, PLEASE.":GOTO260
280 FORI=1TO20
290 IFA$=LEFT$(C$(I),LEN(A$))THEN350
300 NEXT
310 P LATTER OP-
TION IS RECOMMENDED WHEN TRYING TO DESTROY A KLINGON COMMANDER (THEY HAVE
SUPERIOR DEFENSIVE CAPABILITIES).

TR-TRANSFER
TRANSFER PANEL - ALLOWS THE TRANSFER OF ENERGY TO AND FROM PHASER BANKS.

VI-VISUAL
VERY SHORT RANGE SCANNER - USEFUL FOR LIMITED NAVIGATION WHEN SRSCANNERS ARE
NON-FUNCTIONAL. A VERY CUTE OPTION.

WA-WARP
THIS DICTATES CERTAIN PARAMATERS FOR QUADRANT TO QUADRANT TRAVEL WHEN ENGINES
(NAVIGATIONAL OR IMPULSE) ARE DAMAGED. YOU WILL BE ADVISED WHEN TO USE THIS
COMMAERENCE COMPUTER OPTIONS.

*****************************************************************************
*************************************** ENJOY !!! - ZOSO ********************
*****************************************************************************

                                                                                                                                10 'BASED ON BIGTREK GAME / SHORTENED BY EDISON DOGGE.
20 WIDTH90:LQ=1000'REM NO SCORE - NO VISUALS
30 INPUT"CLEARANCE NUMBER (1 TO 25000)...";I
40 IFI<1ORI>25000ORI<>INT(I)THEN30
50 I1=IMOD97:IFI1=0THENI=I+199:GOTO50
60 I=RND(-I1):FORI1=1TOI:X=RND(1):NEXT
70 DIM G1$(16),V$(5,5),C$(20),G(8,8),D$(12),Q$(10,10),D4(12),D9(106)
80 DIM S2(8,8):Q$="?"
90 DATA S.R. SENSORS,L.R. SENSORS,PHASERS,PHOTON TUBES,LIFE SUPPORT
100 DATA WARP ENGINES,IMPULSE ENGINES,SHIELDS,SUBSPACE RADIO
110 DATA SHUTTLE CRAFT,CORINT"ILLEGAL !! - USE THIS LIST"
320 PRINT:FORI=1TO20STEP4
330 PRINTC$(I);TAB(12);C$(I+1);TAB(22);C$(I+2);TAB(32);C$(I+3)
340 NEXT:PRINT:GOTO250
350 ONIGOTO370,380,390,400,410,420,430,470,490,500
360 ONI-10GOTO530,760,550,580,590,600,610,620,660,670
370 GOSUB 12310:GOTO250
380 GOSUB 2020:GOTO250
390 GOSUB2540:GOTO250
400 GOSUB3540:GOTO250
410 GOSUB12550:GOTO250
420 GOSUB3430:GOTO250
430 GOSUB11700:IFJ3=0THEN250
440 IFA2<>0THEN760
450 IFG(Q1,Q2)=1000THEN720
460 GOSUB790:GOTO250
470 GOSUB5390:
910 A3=1
920 D6=.8+.05*RND(1)
930 H4=K6(L)*D6^K8(L)
940 IF(S4=0)AND(S9=0)THEN1000
950 P3=.1:IFP2*S3>P3THENP3=P2*S3
960 H5=P3*C6*H4+1
970 IFH5>S3THENH5=S3
980 S3=S3-H5:H4=H4-H5
990 IF(P3>.1)AND(H4<5E-03*E1)THEN1320
1000 J5=1
1010 PRINTFNR(H4);"UNIT HIT ON THE ";S5$;" FROM ";
1020 J6=K4(L):J7=K5(L)
1030 IFQ$(J6,J7)="K"THENPRINT"KLINGON AT";
1040 IFQ$(J6,J7)="C"THENPRINT"COMMANDER AT";
1050 PRINTJ6;"-";J7
1060 IFH4>H2THENH2=H4
1070 H3=H3+H4
1080 IFH4<(275-25*S8)*(1+.5*RND(1))THEN1310
1090 N4T ATTACK"
1490 C4=C4+J8
1500 GOTO1540
1510 F9=5
1520 GOSUB4710:RETURN
1530 PRINT"*** KLINGONS ATTACK-- STARBASE SHIELDS PROTECT THE ";S5$
1540 FORW4=1TOK3
1550 K8(W4)=K7(W4)
1560 NEXTW4
1570 GOSUB10980:RETURN
1580 PRINT:IFJ4=0THEN1610
1590 PRINT"*** RED ALERT!  RED ALERT!"
1600 PRINT"*** THE ";S5$;" HAS STOPPED IN QUADRANT CONTAINING SUPERNOVA"
1610 PRINT "*** AUTO-OVERRIDE ATTEMPTS TO HURL ";S5$;" TO OTHER QUADRANT"
1620 S2(Q1,Q2)=1
1630 GOSUB7260
1640 IFD4(6)=0THEN1830
1650 PRINT
1660 PRG(I,J))));STR$(G(I,J));
2140 IFG(I,J)=LQTHENPRINT" ***";
2150 GOTO2170
2160 PRINTS2(I,J)-LQ;
2170 NEXTJ:PRINT:NEXTI:GOSUB7550:PRINT
2180 PRINT"THE ";S5$;" IS CURRENTLY IN ";G2$;" (";Q1;"-";Q2;")"
2190 RETURN
2200 PRINTCHR$(26)
2210 S8=0:L2=0
2220 PRINT"MISSION DURATION...: ";
2230 INPUTA$
2240 FOR I=1TO3
2250 IFA$=LEFT$(T$(I),LEN(A$))THEN2290
2260 NEXTI
2270 PRINT"WOULD YOU LIKE A SHORT, MEDIUM OR LONG GAME";
2280 GOTO2230
2290 L2=I
2300 PRINT"ARE YOU A BEGINNER, NOVICE, SENIOR OR EXPERT ";IFJ3=0THEN250
480 GOTO680
490 GOSUB5650:GOTO250
500 GOSUB11830
510 IFJ3=0THEN250
520 GOTO680
530 GOSUB8270:IFJ3=0THEN250
540 GOSUB790:GOTO250
550 GOSUB10370:IFJ3=0THEN250
560 IFA2<>0THEN760
570 GOSUB790:S9=0:GOTO250
580 GOSUB4720:GOTO250
590 GOSUB11090:GOSUB5650:GOTO250
600 PRINT:GOSUB12770:GOTO250
610 GOSUB8660:IFJ3=0THEN250ELSE680
620 GOSUB11560:IFJ3=0THEN250
630 IFA2<>0THEN760
640 IFG(Q1,Q2)<>LQTHEN250
650 GOTO720
660 PRINT:PRINT"VISUAL INOPERATIVE !":RETURN
670 GOSUB10210:GOTO250
68=1+INT(H4/(500+100*RND(1)))
1100 PRINT"*** CRITICAL HIT--";
1110 K9=1
1120 FORW4=1TON4
1130 J9=INT(12*RND(1))+1
1140 C5(W4)=J9
1150 E3=(H4*D5)/(N4*(75+25*RND(1)))
1160 IFJ9=6THENE3=E3/3
1170 D4(J9)=D4(J9)+E3
1180 IFW4=1THEN1250
1190 FORV=1TOW4
1200 IFJ9=C5(V-1)THEN1260
1210 NEXTV
1220 K9=K9+1
1230 IFK9=3THENPRINT
1240 PRINT " AND ";
1250 PRINTD$(J9);
1260 NEXTW4
1270 PRINT " DAMAGED."
1280 IFD4(8)=0THEN1310
1290 IFS4<>0THENPRINT"*** SHIELDS KNOCKED DOWN."
1300 S4=0
1310 E1=E1-H4
1320 INT"WARP ENGINES DAMAGED."
1670 PRINT:PRINT"TRYING TO ENGAGE IMPULSE ENGINES..."
1680 IFD4(7)=0THEN1730
1690 PRINT"IMPULSE ENGINES DAMAGED."
1700 F9=8
1710 GOSUB4710
1720 RETURN
1730 P2=.75*E1
1740 D6=4E-03*(P2-50)
1750 D7=1.4142+1.2*RND(1)
1760 D1=D6
1770 IFD6>D7THEND1=D7
1780 T1=D1/.4
1790 D2=12*RND(1)
1800 J4=0
1810 GOSUB5590
1820 GOTO1940
1830 W1=6+2*RND(1)
1840 W2=W1*W1
1850 P2=.75*E1
1860 D6=P2/(W1*W1*W1*(S4+1))
1870 D7=1.4142+2*RND(1)
1880 D1=D6
1890 IFD6>D7THEND1=D7
1900 T1=1
2310 INPUTA$
2320 FORI=1TO4
2330 IFA$=LEFT$(S$(I),LEN(A$))THEN2360
2340 NEXTI
2350 GOTO2300
2360 S8=I
2370 INPUT"ENTER MISSION PASSWORD...";X$:PRINT
2380 PRINT"....STAND BY...."
2390 J=RND(1)
2400 D5=.5*S8:I2=INT(L2+1+RND(1)*3)
2410 IFI2>5THENI2=5
2420 R3=I2
2430 I5=7*L2
2440 R5=I5
2450 R7=(S8-2*RND(1)+1)*S8*.1+.1
2460 IFR7<.2THENR7=R7+.1
2470 I1=INT(2*R7*I5)
2480 R1=I1
2490 I4=INT(S8+.0625*I1*RND(1))
2500 R2=I4
2510 I3=(I1+4*I4)*I5
2520 R4=I3
2530 RETURN
2540 IFD4(11)=0THEN2570
250 IFA2<>0THEN760
690 IFT1<>0THENGOSUB3640
700 IFA2<>0THEN760
710 IFG(Q1,Q2)<LQTHEN750
720 GOSUB1580:IFA2<>0THEN760
730 IFA2<>0THEN760
740 GOTO710
750 GOSUB790:GOTO250
760 PRINT:PRINT:INPUT"ANOTHER GAME ";A$
770 IFLEFT$(A$,1)="Y"THEN240
780 PRINTCHR$(26):END
790 IF(C3<>0)AND(J4=0)THENGOSUB6620
800 IFK3=0THENRETURN
810 IFA2<>0THENRETURN
820 P2=1/I8
830 J5=0
840 PRINT
850 IFC5$="DOCKED"THEN1530
860 H2=0:H3=0:C6=1
870 IFS9=1THENC6=.5+.5*RND(1)
880 A3=0
890 FORL=1TOK3
900 IFK6(L)<0THEN1320NEXTL
1330 IFA3=0THENRETURN
1340 IFE1<=0THEN1510
1350 P4=100*P2*S3+.5
1360 IFJ5<>0THEN1390
1370 PRINT"ENEMY ATTACK--SHIELDS REDUCED TO ";
1380 GOTO1430
1390 PRINT"ENERGY LEFT:";FNS(E1);"   SHIELDS ";
1400 IFS4<>0THENPRINT"UP,";
1410 IF(S4=0)AND(D4(8)=0)THENPRINT"DOWN, ";
1420 IFD4(8)>0THENPRINT"DAMяGED, ";
1430 PRINTINT(P4);"%"
1440 IF(H2<200)AND(H3<500)THEN1540
1450 J8=INT(H3*RND(1)*.015)
1460 IFJ8<2THEN1540
1470 PRINT
1480 PRINT"---> 'SICKBAY TO BRIDGE.  WE SUFFERED ";J8;"CASUALTIES IN THA0*D1/W2
1910 D2=12*RND(1)
1920 J4=0
1930 GOSUB12040
1940 IFJ4<>0THEN1980
1950 F9=8
1960 GOSUB4710
1970 RETURN
1980 IFR1<>0THENRETURN
1990 F9=1
2000 GOSUB4710
2010 RETURN
2020 PRINT:PRINT"      1   2   3   4   5   6   7   8"
2030 PRINT"     --- --- --- --- --- --- --- ---"
2040 FORI=1TO8
2050 PRINTI;" ";
2060 FORJ=1TO8
2070 ONSGN(S2(I,J))+2GOTO2080,2100,2120
2080 PRINT" .1.";
2090 GOTO 2170
2100 PRINT" ...";
2110 GOTO2170
2120 IFS2(I,J)>LQTHEN2160
2130 IFG(I,J)<LQTHENPRINTS7$(LEN(STR$(50 PRINT" COMPUTER DISABLED"
2560 RETURN
2570 PRINT"----COMPUTER ACTIVE----"
2580 INPUT"PROGRAM NAME";B$
2590 FORI=1TO6
2600 IFB$=LEFT$(C2$(I),LEN(B$))THEN2660
2610 NEXT
2620 PRINT"VALID PROGRAMS ARE:"
2630 PRINT"  COURSE    WCOST   OUT"
2640 PRINT"  PEFFECT   ICOST"
2650 GOTO2580
2660 ON IGOTO2670,2910,2980,3040,2580,3110
2670 INPUT "ENTER QUADRANT AND SECTOR - ";A3,A4
2680 IF(A3<>INT(A3))OR(A4<>INT(A4))THEN3120
2690 IFA3<0THEN2580
2700 IFA3=0THENA3=10*Q1+Q2
2710 A3=A3+.5
2720 K=INT(A3/10)AND USE"
3020 PRINTC7;"UNITS OF ENERGY"
3030 GOTO2580
3040 INPUT"ENTER PHASER RANGE IN QUADRANTS";A3
3050 IFA3<0THEN2580
3060 A3=A3*10:C7=(.9^A3)*100
3070 PRINT"PHASERS ARE ";LEFT$(STR$(C7),5);"% EFFECTIVE AT THAT RANGE"
3080 GOTO2580
3090 GOSUB9750
3100 GOTO2580
3110 RETURN
3120 PRINT"FORMAT IS MN,XXYY...WHERE MN IS THE QUADRANT"
3130 PRINT"AND XXYY IS THE SECTOR...E.G. 64,0307 REFERS"
3140 PRINT"TO QUADRANT 6-4, SECTOR 3-7."
3150 GOTO 2580
3160 IFT2$<>"C"THEN3250
3170 C3=0:PRINT"*** COMMAN
3550 IFD4(I)<=0THEN3600
3560 IFJ<>0THEN3590
3570 PRINT"     DEVICE";SPC(12);"-REPAIR TIMES-"
3580 PRINTSPC(21);"IN FLIGHT    DOCKED":J=1
3590 PRINT"  ";D$(I);TAB(23);FNS(D4(I));TAB(33);FNS(D3*D4(I))
3600 NEXTI
3610 PRINT"TAB(23);"VISUAL SENSORS PERMANENTLY DAMAGED"
3620 IFJ=0THENPRINT" - ALL DEVICES (EXCEPT VISUAL) FUNCTIONAL -"
3630 RETURN
3640 M=0:D7=D0+T1:FORL=1TO5
3650 IFF1(L)>D7THEN3670
3660 M=L:D7=F1(L)
3670 NEXTL
3680 X6=D7-D0:D0=D7
3690 R4=R4-(R1+4*R2)*X6
3700 R5=R4/(R1+4*R2)
3710 I090 IFS4<>0THEN4150
4100 IF(D4(8)=0)AND(S3>0)THEN4130
4110 PRINT"(SHIELDS NOT CURRENTLY USABLE.)"
4120 GOTO4150
4130 GOSUB10390
4140 S9=0
4150 GOSUB7260
4160 F1(2)=D0+T1-1.5*(I5/R2)*LOG(RND(1))
4170 GOTO3640
4180 F1(2)=1E+30:GOTO3640
4190 D9(1)=D0:D9(2)=R1:D9(3)=R2:D9(4)=R3:D9(5)=R4:D9(6)=R5
4200 D9(7)=S1:D9(8)=B1:D9(9)=K1:D9(10)=K2
4210 FORI=1TO8:FORJ=1TO8:D9(I-1+8*(J-1)+11)=G(I,J):NEXTJ:NEXTI
4220 FORI=75TO84:D9(I)=C1(I-74):NEXT
4230 FORI=85TO94:D9(I)=C2(I-84):NEXT
4240 FORI=95TO99:D9(I)=B2
2730 IF(K<1)OR(K>8)THEN3120
2740 C6(1)=K:K=INT(A3-C6(1)*10)
2750 IF(K<1)OR(K>8)THEN3120
2760 C6(2)=K:A4=A4+.5
2770 K=INT(A4/100)
2780 IF(K<1)OR(K>10)THEN3120
2790 C6(1)=C6(1)+(K-1)/10:K=INT(A4-K*100)
2800 IF(K<1)OR(K>10)THEN3120
2810 C6(2)=C6(2)+(K-1)/10
2820 X=Q1+((S6-1)/10)-C6(1):Y=Q2+((S7-1)/10)-C6(2)
2830 D1=0:D2=0:IF(X=0)AND(Y=0)THEN2890
2840 D1=SQR(X*X+Y*Y)
2850 IFX<0THENZ7=SGN(Y)*(3.1416-ATN(ABS(Y/X)))
2860 IFX=0THENZ7=SGN(Y)*1.5708
2870 IFX>0THENZ7=ATN(Y/X)
2880 D2=12-Z7*1.9098593#:DER AT";
3180 FORF=1TOR2:IF(C1(F)=Q1)AND(C2(F)=Q2)THEN3200
3190 NEXTF
3200 C1(F)=C1(R2):C2(F)=C2(R2):C1(R2)=0:C2(R2)=0
3210 R2=R2-1:F1(2)=1E+30
3220 IFR2<>0THENF1(2)=D0-(I4/R2)*LOG(RND(1))
3230 K2=K2+1
3240 GOTO3270
3250 PRINT"*** KLINGON AT";
3260 K1=K1+1
3270 PRINTA5;"-";A6;"DESTROYED."
3280 Q$(A5,A6)=".":R1=R1-1
3290 IFR1=0THENRETURN
3300 R5=R4/(R1+4*R2)
3310 G(Q1,Q2)=G(Q1,Q2)-100
3320 FORF=1TOK3
3330 IF(K4(F)=A5)AND(K5(F)=A6)THEN3350
3340 NEXTF
3350 K3=K3-1
3360 IFF>K3THEN3410
3370 FFR5>0THEN3750
3720 F9=2
3730 GOSUB4710
3740 RETURN
3750 IF(D4(5)=0)OR(C5$="DOCKED")THEN3810
3760 IF(L1>=X6)OR(D4(5)<=L1)THEN3790
3770 F9=3:GOSUB4710
3780 RETURN
3790 L1=L1-X6
3800 IFD4(5)<=X6THENL1=J1
3810 R=X6
3820 IFC5$="DOCKED"THENR=X6/D3
3830 FORL=1TO12
3840 IFD4(L)<=0THEN3890
3850 D4(L)=D4(L)-R
3860 IFD4(L)<0THEND4(L)=0
3870 IFD4(L)<>0THEN3890
3880 PRINT:PRINT"DAMAGE CONTROL-  ";D$(L);" NOW OPERATIONAL."
3890 NEXTL
3900 IFM=0THENRETURN
3910 T1=T1-X6
3920 ONMGOTO3930,3970,4190,4280,(I-94):NEXT
4250 FORI=100TO104:D9(I)=B3(I-99):NEXT
4260 D9(105)=B4:D9(106)=B5
4270 S0=1:F1(3)=D0-.3*I5*LOG(RND(1)):GOTO3640
4280 IF(R2=0)OR(R3=0)THEN4330
4290 FORI=1TOR3:FORJ=1TOR2:IF(B2(I)=C1(J))AND(B3(I)=C2(J))THEN4340
4300 NEXTJ:NEXTI
4310 F1(4)=D0+.5+3*RND(1)
4320 F1(5)=1E+30:GOTO3640
4330 F1(4)=1E+30:F1(5)=1E+30:GOTO3640
4340 B4=B2(I):B5=B3(I)
4350 IF(B4=Q1)AND(B5=Q2)THEN4310
4360 F1(5)=D0+.5+3*RND(1)
4370 F1(4)=F1(5)-.3*I5*LOG(RND(1))
4380 IFD4(9)>0THEN3640
4390 PRINT:PRINT"  CAPTAIN, TIFD2>12THEND2=D2-12
2890 PRINT"COURSE IS";FNS(D2);" FOR A DISTANCE OF";
2900 PRINTFNS(D1);"QUADRANTS.":GOTO2580
2910 INPUT"ENTER DISTANCE AND WARP FACTOR";D1,A4
2920 IF(D1<0)THEN2580
2930 C7=D1*A4*A4*A4
2940 T1=(10*D1)/((A4*A4)+1E-05)
2950 PRINT"IT WOULD TAKE";FNS(T1);"STARDATES AND USE"
2960 PRINTFNR(C7);"UNITS OF ENERGY  (";FNR(C7+C7);"IF SHIELDS ARE UP)"
2970 GOTO2580
2980 INPUT"ENTER DISTANCE...";D1
2990 IFD1<0THEN2580
3000 C7=250*D1+50:T1=D1/.4
3010 PRINT"IT WOULD TAKE";FNR(T1);"STARDATES ORG=FTOK3
3380 K4(G)=K4(G+1):K5(G)=K5(G+1):K6(G)=K6(G+1)
3390 K7(G)=K7(G+1):K8(G)=K7(G)
3400 NEXTG
3410 K4(K3+1)=0:K5(K3+1)=0:K7(K3+1)=0:K8(K3+1)=0:K6(K3+1)=0
3420 RETURN
3430 IFC5$="DOCKED"THEN3520
3440 IFB6=0THEN3460
3450 IF(ABS(S6-B6)<=1)AND(ABS(S7-B7)<=1)THEN3480
3460 PRINTS5$;" NOT ADJACENT TO A BASE."
3470 RETURN
3480 C5$="DOCKED"
3490 PRINT"---> DOCKING COMPLETED"
3500 E1=I7:S3=I8:T4[9:L1=J1
3510 RETURN
3520 PRINT"CAPTAIN, WE'RE ALREADY DOCKED!"
3530 RETURN
3540 J=0:PRINT:FORI=1TO124450
3930 X2=0:Y2=0:GOSUB10520
3940 F1(1)=D0-.5*I5*LOG(RND(1))
3950 IFG(Q1,Q2)=LQTHENRETURN
3960 GOTO3640
3970 IFR2=0THEN4180
3980 IFC5$="DOCKED"THEN4160
3990 I=INT(RND(1)*R2)+1
4000 Y6=(C1(I)-Q1)^2+(C2(I)-Q2)^2
4010 IFY6=0THEN4160
4020 Y6=SQR(Y6):T1=.17778*Y6
4030 PRINT:PRINT"*** ";S5$;" CAUGHT IN LONG-RANGE TRACTOR BEAM--"
4040 Q1=C1(I):Q2=C2(I)
4050 S6=FNB(1):S7=FNB(1)
4060 PRINT"PULLED TO QUADRANT";Q1;"-";Q2;", SECTOR";S6;"-";S7
4070 IFR6<>0THENPRINT"(IDLE PERIOD CANCELLED)"
4080 R6=0
4HE STARBASE IN";B4;"-";B5;"IS UNDER ATTACK-"
4400 PRINT"  AND CAN ONLY RESIST UNTIL STARDATE";FNR(F1(5));"!!!"
4410 IFR6=0THEN3640
4420 INPUT"  SHALL WE CANCEL IDLE PERIOD";B$
4430 IFLEFT$(B$,1)="Y"THENR6=0
4440 GOTO3640
4450 F1(5)=1E+30:IF(R2=0)OR(R3=0)THEN3640
4460 K=INT(G(B4,B5)/100):IFG(B4,B5)-K*100<10THEN3640
4470 FORI=1TOR2:IF(C1(I)=B4)AND(C2(I)=B5)THEN4490
4480 NEXT:GOTO3640
4490 IFS2(B4,B5)=-1THENS2(B4,B5)=0
4500 IFS2(B4,B5)>999THENS2(B4,B5)=S2(B4,B5)-10
4510 IF(B4<>Q1)OR(B5<>Q2)THEN4600)
4830 IFX>D1THEN4850
4840 D1=X:K=L
4850 NEXTL
4860 Q1=B2(K):Q2=B3(K):GOSUB7260
4870 Q$(S6,S7)="."
4880 PRINT
4890 PRINT"STARBASE IN QUADRANT";Q1;"-";Q2;"RESPONDS --";
4900 PRINT"  ";S5$;" DEMATERIALIZES."
4910 P2=(1-.98^D1)^.333333
4920 FORL=1TO3
4930 IFL=1THENPRINT"1ST ";
4940 IFL=2THENPRINT"2ND ";
4950 IFL=3THENPRINT"3RD ";
4960 PRINT"ATTEMPT TO RE-MATERIALIZE THE ";S5$;". . . . .";
4970 IFRND(1)>P2THEN5000
4980 PRINT"FAILS.":NEXTL
4990 F9=11:GOSUB4710:RETURN
5000 FORL=1TO5:I=B6+INT(3*R5340 PRINT
5350 K6(N)=-K6(N)
5360 N=N+1
5370 NEXTK
5380 RETURN
5390 J3=0
5400 IFD4(7)<>0THEN5640
5410 IFE1<=75THEN5470
5420 INPUT"ENTER COURSE....";D2
5430 IFD2<.01ORD2>12THENGOSUB12780ELSE5450
5440 RETURN
5450 P3=50+250*D1
5460 IFP3<E1THEN5540
5470 PRINT
5480 PRINT"1ST OFFICER SPOCK-  'CAPTAIN, THE IMPULSE ENGINES"
5490 PRINT"REQUIRE 50 UNITS OF ENERGY TO ENGAGE, PLUS 250 UNITS PER ";
5500 IFE1>75THEN5520
5510 PRINT"QUADRANT.  THEY ARE USELESS NOW.'":RETURN
5520 PRINT"QUADRANT.  WE CAN GON(A5):D6=COS(A5):B8=ABS(D4)
5860 IFABS(D6)>B8THENB8=ABS(D6)
5870 D4=D4/B8:D6=D6/B8:T5=0:T6=0
5880 IFD0+T1<F1(2)THEN5910
5890 T5=1:C5$="RED":D1=D1*(F1(2)-D0)/T1+.1
5900 T1=F1(2)-D0+1E-05
5910 Q$(S6,S7)=".":X7=S6:Y7=S7:H9=INT(10*D1*B8+.5)
5920 IFH9=0THEN6020
5930 FORL=1TOH9
5940 X7=X7+D4:X1=INT(X7+.5):Y7=Y7+D6:Y1=INT(Y7+.5)
5950 IF(X1<1)OR(X1>10)THEN6190
5960 IF(Y1<1)OR(Y1>10)THEN6190
5970 IFQ$(X1,Y1)="O"THEN6000
5980 IFQ$(X1,Y1)<>"."THEN6070
5990 NEXTL
6000 D1=.1*SQR((S6-X1)^2+(S7-Y1)^2)
6010
4520 FORI=1TOK3:K=K4(I):L=K5(I)
4530 IFQ$(K,L)="C"THEN4550
4540 NEXT
4550 IFK6(I)<25+50*RND(1)THEN3640
4560 Q$(B6,B7)=".":B6=0:B7=0
4570 GOSUB7230
4580 PRINT:PRINT"CAPTAIN, I BELIEVE THE STARBASE HAS BEEN DESTROYED"
4590 GOTO4640
4600 IF(R3=1)OR(D4(9)>0)THEN4640
4610 PRINT
4620 PRINT"--> STARFLEET COMMAND REPORTS THAT STARBASE IN QUADRANT";B4;"-";B5
4630 PRINT"HAS BEEN DESTROYED BY ENEMY COMMANDER !!"
4640 G(B4,B5)=G(B4,B5)-10
4650 IFR3<=1THEN4690
4660 FORI=1TOR3:IF(B2(I)=B4)AND(B3(I)=B5)THEND(1))-1
5010 IF(I<1)OR(I>10)THEN5050
5020 J=B7+INT(3*RND(1))-1
5030 IF(J<1)OR(J>10)THEN5050
5040 IFQ$(I,J)="."THEN5060
5050 NEXTL:PRINT"FAILS.":GOTO4990
5060 PRINT"SUCCEEDS.":S6=I:S7=J:Q$(I,J)=LEFT$(S5$,1)
5070 GOSUB3430:PRINT"CAPTAIN, WE MADE IT!":RETURN
5080 P4=2:L5=K3:N=1
5090 FORK=1TOL5
5100 IFH3(K)=0THEN5360
5110 D6=.9+.01*RND(1):H2=H3(K)*D6^K7(N)
5120 P3=K6(N)
5130 P=ABS(P3):IFP4*H2<PTHENP=P4*H2
5140 K6(N)=P3-SGN(P3)*ABS(P)
5150 X8=K4(N):Y8=K5(N)
5160 IFH2>4.99THEN5180
5170 PRINT"MIN A MAXIMUM OF ";
5530 PRINTFNR(4E-03*(E1-50)-.05);"QUADRANTS.'":RETURN
5540 T1=D1/.4
5550 IFT1<R5THEN5590
5560 PRINT"SIR, MAX. SPEED UNDER IMPULSE IS ONLY 4 SECTORS PER STARDATE"
5570 INPUT"-- AUTHORIZE ";B$
5580 IFLEFT$(B$,1)<>"Y"THENRETURN
5590 GOSUB5850:J3=1
5600 IFA2<>0THENRETURN
5610 E1=E1-P3
5620 IFE1>0THENRETURN
5630 F9=4:GOSUB4710:RETURN
5640 PRINT"IMPULSE ENGINES DAMAGED.":RETURN
5650 N$="    #"
5660 PRINT
5670 IFD4(2)<>0THEN5840
5680 PRINT"L.R. SCAN FOR QUADRANT";Q1;"-";Q2:PRINT
5 S6=X1:S7=Y1
6020 F4=S6:F5=S7
6030 IFQ$(X1,Y1)<>"O"THEN6520
6040 T2=FNA(1):T3=FNA(1)
6050 Q1=FNA(1):Q2=FNA(1):S6=FNB(1):S7=FNB(1):PRINT
6060 PRINT"*** SPACE PORTAL ENTERED ***":GOTO6490
6070 T6=1:K=50*D1/T1+1E-03:D1=.1*SQR((S6-X1)^2+(S7-Y1)^2)
6080 IF(Q$(X1,Y1)="K")OR(Q$(X1,Y1)="C")THEN6180
6090 PRINT:PRINTS5$;" BLOCKED BY ";
6100 IFQ$(X1,Y1)="*"THENPRINT"STAR AT";
6110 IFQ$(X1,Y1)="B"THENPRINT"STARBASE AT";
6120 PRINT" SECTOR";X1;"-";Y1;"...."
6130 PRINT"EMERGENCY STOP REQUIRED";FNR(K);"UNITS ON4680
4670 NEXT
4680 B2(I)=B2(R3):B3(I)=B3(R3)
4690 R3=R3-1
4700 GOTO3640
4710 PRINT:PRINT:PRINT:PRINT"CONFLICT RESOLVED -GAME OVER":GOTO760
4720 IFC5$<>"DOCKED"THEN4750
4730 PRINT"--> CAPTAIN, WE'RE ALREADY DOCKED!"
4740 RETURN
4750 IFD4(9)=0THEN4770
4760 PRINT"SUBSPACE RADIO DAMAGED...CANNOT TRANSMIT.":RETURN
4770 IFR3<>0THEN4790
4780 PRINT"CAPTAIN, NO RESPONSE FROM STARBASE !":RETURN
4790 N1=N1+1:IFB6=0THEN4810
4800 GOTO4870
4810 D1=1E+30
4820 FORL=1TOR3:X=10*SQR((B2(L)-Q1)^2+(B3(L)-Q2)^2OR HIT ON ":GOTO5190
5180 PRINTFNR(H2);"UNIT HIT ON ";
5190 M$=Q$(X8,Y8)
5200 IF M$="K"THENPRINT"KLINGON AT";
5210 IFM$="C"THENPRINT"COMMANDER AT";
5220 PRINTX8;"-";Y8
5230 IFK6(N)<>0THEN5270
5240 A5=X8:A6=Y8:T2$=Q$(X8,Y8):GOSUB3160
5250 IFR1<>0THEN5370
5260 F9=1:GOSUB4710:GOTO5370
5270 IFK6(N)<0THEN5360
5280 IFRND(1)<.9THEN5360
5290 IFK6(N)>(.4+.4*RND(1))*P3THEN5360
5300 PRINT
5310 PRINT"*** CAPTAIN, THE VESSEL AT SECTOR";
5320 PRINTX8;"-";Y8
5330 PRINT"   HAS JUST LOST ITS FIREPOWER !!!"
690 I=Q1-1:J=Q1+1:K=Q2-1:L=Q2+1
5700 FORM=ITOJ:FORN=KTOL
5710 IF(M<=0)OR(M>8)THEN5770
5720 IF(N<=0)OR(N>8)THEN5770
5730 IFD4(11)=0THENS2(M,N)=1
5740 IFG(M,N)>=LQTHEN PRINT"  ***";" ";
5750 IFG(M,N)<LQTHENPRINTSPC(5-LEN(STR$(G(M,N))));G(M,N);
5760 GOTO5780
5770 PRINTN$;" ";
5780 NEXTN:PRINT
5790 PRINT
5800 NEXTM
5810 IFD4(11)=0THENRETURN
5820 PRINT"*** WARNING *** - COMPUTER DISABLED - SCAN NO`RECORDED."
5830 RETURN
5840 PRINT"LONG RANGE SENSORS DAMAGED.":RETURN
5850 A5=(15-D2)*.523599:D4=-SIF ENERGY."
6140 E1=E1-K
6150 S6=INT(X7-D4+.5):F4=S6:S7=INT(Y7-D6+.5):F5=S7
6160 IFE1>0THEN6520
6170 F9=4:GOSUB4710:RETURN
6180 S6=X1:S7=Y1:GOSUB9600:F4=S6:F5=S7:GOTO6520
6190 IFK3=0THEN6250
6200 FORL=1TOK3
6210 F3=SQR((X1-K4(L))^2+(Y1-K5(L))^2)
6220 K8(L)=.5*(F3+K7(L)):NEXTL
6230 IFG(Q1,Q2)<>LQTHENGOSUB790
6240 IFA2<>0THENRETURN
6250 X7=10*(Q1-1)+S6:Y7=10*(Q2-1)+S7
6260 X1=INT(X7+10*D1*B8*D4+.5)
6270 Y1=INT(Y7+10*D1*B8*D6+.5):L6=0
6280 L5=0
6290 IFX1>0THEN6310
6300 X1=-X1+1:L5=1
6310 IFY1>5(K)
6650 IFQ$(C,D)="C"THEN6670
6660 NEXTK
6670 N=0:F=K6(K)+100*K3
6680 IFF>LQTHENN=INT(RND(1)*K7(K)+1)
6690 IF((C5$="DOCKED")AND((B4<>Q1)OR(B5<>Q2)))THENN=-S8
6700 IFN=0THENN=INT(((F+200*RND(1))/150)-5)
6710 IFN=0THENRETURN
6720 IF(N>0)AND(K7(K)<1.5)THENRETURN
6730 IFABS(N)>S8THENN=SGN(N)*ABS(S8)
6740 T=ABS(N):P=S6-C:Q=S7-D
6750 IF2*ABS(P)<ABS(Q)THENP=0
6760 IF2*ABS(Q)<ABS(P)THENQ=0
6770 IFP<>0THENP=SGN(P*N)
6780 IFQ<>0THENQ=SGN(Q*N)
6790 R=C:S=D:Q$(C,D)="."
6800 FORL2=1TOT:L=R+P:M=S+Q
681)=K4(K3):K5(K)=K5(K3):K7(K)=K7(K3):K8(K)=K8(K3)
7140 K6(K)=K6(K3):K3=K3-1:C3=0
7150 IFC5$<>"DOCKED"THENGOSUB7230
7160 GOSUB10980
7170 G(Q1,Q2)=G(Q1,Q2)-100:G(I,J)=G(I,J)+100
7180 FORL3=1TOR2
7190 IF(C1(L3)=Q1)AND(C2(L3)=Q2)THEN7210
7200 NEXTL3
7210 C1(L3)=I:C2(L3)=J:RETURN
7220 A=-A:B=-B:GOTO6990
7230 C5$="GREEN":IFE1<LQTHENC5$="YELLOW"
7240 IFG(Q1,Q2)>99THENC5$="RED"
7250 RETURN
7260 J4=1:B6=0:B7=0:K3=0:C3=0:U=G(Q1,Q2):IFU>999THEN7530
7270 K3=INT(.01*U):FORA=1TO10:FORB=1TO10:Q$(A,B)=".":NEXTB=Q2-4
7600 G3$="IV":IFL=4THEN7620
7610 G3$=LEFT$(G4$,L)
7620 G2$=G2$+" "+G3$:RETURN
7630 IFRND(1)>.1THEN7650
7640 GOSUB10520:RETURN
7650 Q$(A5,A6)=".":PRINT"*** STAR AT SECTOR";A5;"-";A6;"NOVAS."
7660 G(Q1,Q2)=G(Q1,Q2)-1:S1=S1+1
7670 B9=1:T6=1:T7=1:K=0:X1=0:Y1=0
7680 H4(B9,1)=A5:H4(B9,2)=A6
7690 FORM=B9TOT6:FORQ=1TO3:FORJ=1TO3
7700 IFJ*Q=4THEN8140
7710 J5=H4(M,1)+Q-2:J6=H4(M,2)+J-2
7720 IF(J5<1)OR(J5>10)THEN8140
7730 IF(J6<1)OR(J6>10)THEN8140
7740 IFQ$(J5,J6)="."THEN8140
7750 IFQ$(J5,J6)="O"0THEN6330
6320 Y1=-Y1+1:L5=1
6330 IFX1<=80THEN6350
6340 X1=161-X1:L5=1
6350 IFY1<=80THEN6370
6360 Y1=161-Y1:L5=1
6370 IFL5=0THEN6390
6380 L6=1:GOTO6280
6390 IFL6=0THEN6460
6400 PRINT:PRINT"*** MESSAGE FROM STARFLEET COMMAND.....STARDATE";FNR(DO)
6410 PRINT"PERMISSION TO EXIT GALAXY - DENIED -"
6420 PRINT"'ENGINES SHUT DOWN AT ";
6430 Z1=INT((X1+9)/10):Z2=INT((Y1+9)/10)
6440 PRINT"QUADRANT";Z1;"-";Z2;",  ";
6450 PRINT"SECTOR";X1-10*(Z1-1);"-";Y1-10*(Z2-1);"'"
6460 IFT5<>0THENRETURN
6470 Q1=IN0 IF(L>0)AND(L<=10)THEN6830
6820 ONSGN(N)+2GOTO7060,6920,6920
6830 IF(M>0)AND(M<=10)THEN6850
6840 ONSGN(N)+2GOTO7060,6860,6860
6850 IFQ$(L,M)="."THEN6980
6860 IF(Q=B)OR(P=0)THEN6920
6870 M=S+B
6880 IF(M>0)AND(M<=10)THEN6900
6890 ONSGN(N)+2GOTO7060,6910,6910
6900 IFQ$(L,M)="."THEN6980
6910 B=-B
6920 IF(P=A)OR(Q=0)THEN6990
6930 L=R+A
6940 IF(L>0)AND(L<=10)THEN6960
6950 ONSGN(N)+2GOTO7060,6970,6970
6960 IFQ$(L,M)="."THEN6980
6970 A=-A:GOTO6990
6980 R=L:S=M
6990 NEXTL2
7000 Q$(R,S)="C"
7010 :NEXTA
7280 Q$(S6,S7)=LEFT$(S5$,1):U=G(Q1,Q2):IFU<100THEN7400
7290 U=U-100*K3:FORA=1TOK3
7300 S=FNB(1):K4(A)=S:T=FNB(1):K5(A)=T
7310 IFQ$(S,T)<>"."THEN7300
7320 Q$(S,T)="K":K7(A)=SQR((S6-S)^2+(S7-T)^2):K8(A)=K7(A)
7330 K6(A)=RND(1)*150+325:NEXTA
7340 IFR2=0THEN7390
7350 FORA=1TOR2
7360 IF(C1(A)=Q1)AND(C2(A)=Q2)THEN7380
7370 NEXTA:GOTO7390
7380 Q$(S,T)="C":K6(K3)=LQ+400*RND(1):C3=1
7390 GOSUB10980
7400 IFU<10THEN7440
7410 U=U-10
7420 B6=FNB(1):B7=FNB(1):IFQ$(B6,B7)<>"."THEN7420
7430 Q$(B6,B7)THEN8140
7760 IFQ$(J5,J6)<>"*"THEN7820
7770 IFRND(1)>=.1THEN7790
7780 X2=J5:Y2=J6:GOSUB10520:RETURN
7790 T7=T7+1:H4(T7,1)=J5:H4(T7,2)=J6:G(Q1,Q2)=G(Q1,Q2)-1
7800 S1=S1+1:PRINT"*** STAR AT SECTOR";J5;"-";J6;"NOVAS."
7810 GOTO8130
7820 IFQ$(J5,J6)<>"B"THEN7890
7830 G(Q1,Q2)=G(Q1,Q2)-10:FORV=1TOR3
7840 IF(B2(V)<>Q1)OR(B3(V)<>Q2)THEN7860
7850 B2(V)=B2(R3):B3(V)=B3(R3)
7860 NEXTV:R3=R3-1:B6=0:B7=0:B1=B1+1:GOSUB7230
7870 PRINT"*** STARBASE AT SECTOR";J5;"-";J6;"DESTROYED."
7880 GOTO8130
7890 IF(S6<>T((X1+9)/10):Q2=INT((Y1+9)/10)
6480 S6=X1-10*(Q1-1):S7=Y1-10*(Q2-1)
6490 GOSUB7550:PRINT:GOTO6510
6500 PRINTCHR$(26):PRINT"ENTERING THE ";G2$;" QUADRANT  (";Q1;"-";Q2;")"
6510 Q$(S6,S7)=LEFT$(S5$,1):GOSUB7260:GOSUB11090:GOSUB5650:RETURN
6520 Q$(S6,S7)=LEFT$(S5$,1)
6530 IFL6=1THENRETURN
6540 IFK3=0THEN6610
6550 FORL=1TOK3
6560 F3=SQR((F4-K4(L))^2+(F5-K5(L))^2)
6570 K8(L)=.5*(K7(L)+F3)
6580 K7(L)=F3
6590 NEXTL
6600 GOSUB10980
6610 GOSUB7230:RETURN
6620 A=1:B=1
6630 FORK=1TOK3
6640 C=K4(K):D=KIF(R=C)AND(S=D)THENRETURN
7020 K4(K)=R:K5(K)=S:K7(K)=SQR((S6-R)^2+(S7-S)^2)
7030 K8(K)=K7(K):IFN>0THENPRINT"*** COMMANDER ADVANCES TO";
7040 IFN<0THENPRINT"*** COMMANDER RETREATS TO";
7050 PRINT" SECTOR";R;"-";S:GOSUB10980:RETURN
7060 I=Q1+INT((L+9)/10)-1:J=Q2+INT((M+9)/10)-1
7070 IF(I<1)OR(I>8)THEN7220
7080 IF(J<1)OR(J>8)THEN7220
7090 FORL3=1TOR2
7100 IF(C1(L3)=I)AND(C2(L3)=J)THEN7220
7110 NEXTL3:PRINT"*** COMMANDER ESCAPES TO ";
7120 PRINT"QUADRANT";I;"-";J;"  (AND REGAINS STRENGTH)"
7130 K4(K="B"
7440 GOSUB7230:IFU<1THENRETURN
7450 FORA=1TOU
7460 S=FNB(1):T=FNB(1):IFQ$(S,T)<>"."THEN7460
7470 Q$(S,T)="*":NEXTA
7480 IF(T2<>Q1)OR(T3<>Q2)THENRETURN
7490 S=FNB(1):T=FNB(1):IFQ$(S,T)<>"."THEN7490
7500 Q$(S,T)="O":PRINT
7510 PRINT"*** SHORT-RANGE SENSORS DETECT A SPACE-WARP IN THIS QUADRANT"
7520 RETURN
7530 FORA=1TO10:FORB=1TO10:Q$(A,B)=".":NEXTB:NEXTA
7540 Q$(S6,S7)=LEFT$(S5$,1):RETURN
7550 G4$="III":L=2:IFQ2>=5THEN7570
7560 L=1
7570 G2$=G1$(2*(Q1-1)+L):L=Q2
7580 IFL<=4THEN7600
7590 LJ5)OR(S7<>J6)THEN7990
7900 PRINT"*** STARSHIP BUFFETED BY NOVA.":IFS4<>0THEN7920
7910 E1=E1-LQ:GOTO7950
7920 IFS3>=LQTHEN7970
7930 D6=LQ-S3:E1=E1-D6:GOSUB7230:S3=0:S4=0
7940 PRINT"*** STARSHIP SHIELDS KNOCKED OUT.":D4(8)=5E-03*D5*RND(1))*D6
7950 IFE1>0THEN7980
7960 F9=7:GOSUB4710:RETURN
7970 S3=S3-LQ
7980 X1=X1+S6-H4(M,1):Y1=Y1+S7-H4(M,2):K=K+1:GOTO8140
7990 IFQ$(J5,J6)<>"C"THEN8120
8000 FORV=1TOK3
8010 IF(K4(V)=J5)AND(K5(V)=J6)THEN8030
8020 NEXTV
8030 K6(V)=K6(V)-800:IFK6(V)<=0THEN8120
8040 SHORT-RANGE SENSORS DETECT NO ENEMY IN THIS QUADRANT."
8370 J3=0:RETURN
8380 PRINT"PHASERS LOCKED ON TARGET.  ENERGY AVAILABLE=";
8390 PRINT.01*INT(100*E1)
8400 INPUT"UNITS TO FIRE";P1:IFP1<E1THEN8420
8410 PRINT"ENERGY AVAILABLE =";:GOTO8390
8420 IFP1>0THEN8440
8430 J3=0:RETURN
8440 E1=E1-P1
8450 IFD4(11)=0THEN8480
8460 P1=P1*(RND(1)*.5+.5)
8470 PRINT:PRINT"COMPUTER MALFUNCTION HAMPERS PHASER ACCURACY.":PRINT
8480 E=P1:IFK3=0THEN8650
8490 E=0:T5=(K3*(K3+1))/2
8500 FORI=1TOK3:H3(I)=((K3+1-I)/T5-.5
8870 IF(R>=-.4)AND(R<=.4)THEN8940
8880 R=(RND(1)+1.2)*R:IFN=3THEN8900
8890 PRINT"*** TORPEDO MISFIRES...":GOTO8910
8900 PRINT"*** TORPEDO NUMBER";Z6;"MISFIRES..."
8910 IF RND(1)>.2THEN8940
8920 PRINT"*** PHOTON TUBES DAMAGED BY MISFIRE."
8930 D4(4)=D5*(1+2*RND(1)):GOTO9580
8940 IF(S4<>0)OR(C5$="DOCKED")THENR=R+1E-03*S3*R
8950 A3=C6+.25*R:IFN=1THEN8980
8960 A8=(15-A3+(2-Z6)*G2)*.523599:PRINT
8970 PRINT"TRACK FOR TORPEDO NUMBER";Z7;"--":GOTO8990
8980 PRINT:PRINT"TORPEDO TRACK --":A8=(15-A3)*.5A7)/W3:Y7=COS(A7)/W3
9280 P=INT(A5+X7+.5):Q=INT(A6+Y7+.5)
9290 IF(P<1)OR(P>10)OR(Q<1)OR(Q>10)THEN9360
9300 IFQ$(P,Q)<>"."THEN9360
9310 Q$(P,Q)=Q$(A5,A6):Q$(A5,A6)=".":PRINT"DAMAGED--"
9320 PRINT"   DISPLACED BY BLAST TO SECTOR";P;"-";Q
9330 K4(V)=P:K5(V)=Q:K7(V)=SQR((S6-P)^2+(S7-Q)^2)
9340 K8(V)=K7(V)
9350 GOSUB10980:GOTO9570
9360 PRINT"DAMAGED, BUT NOT DESTROYED.":GOTO9570
9370 IFQ$(A5,A6)<>"B"THEN9450
9380 PRINT"*** STARBASE DESTROYED...!!!"
9390 IFS2(Q1,Q2)<0THENS2(Q1,Q2)=0
9400 FORW=1TOR3
N5=J5+J5-H4(M,1):N6=J6+J6-H4(M,2)
8050 PRINT"*** COMMANDER AT SECTOR";J5;"-";J6;"DAMAGED";
8060 IF(N5<1)OR(N5>10)OR(N6<1)OR(N6>10)THEN8110
8070 PRINT" AND BUFFETED TO SECTOR";N5;"-";N6
8080 Q$(N5,N6)="C":K4(V)=N5:K5(V)=N6
8090 K7(V)=SQR((S6-N5)^2+(S7-N6)^2):K8(V)=K7(V)
8100 Q$(J5,J6)="."
8110 PRINT:GOTO8140
8120 A5=J5:A6=J6:T2$=Q$(J5,J6):GOSUB3160:GOTO8140
8130 PRINT:Q$(J5,J6)="."
8140 NEXTJ:NEXTQ:NEXTM
8150 IFT6=T7THEN8170
8160 B9=T6+1:T6=T7:GOTO7690
8170 IFK=0THENRETURN
8180 D1=K*.1
8190 IF)*P1
8510 H5(I)=ABS(K6(I))/(P*.9^K7(I))
8520 IFH3(I)<=H5(I)THEN8540
8530 E=E+(H3(I)-H5(I)):H3(I)=H5(I)
8540 NEXTI
8550 IFE=0THEN8620
8560 FORI=1TOK3:R7=H5(I)-H3(I)
8570 IFR7<=0THEN8600
8580 IFR7>=ETHEN8610
8590 H3(I)=H5(I):E=E-R7
8600 NEXTI:GOTO8620
8610 H3(I)=H3(I)+E:E=0
8620 GOSUB5080
8630 IF(E<>0)AND(A2=0)THEN8650
8640 J3=1:RETURN
8650 PRINTFNR(E);"EXPENDED ON EMPTY SPACE.":J3=1:RETURN
8660 J3=1:IFD4(4)=0THEN8680
8670 PRINT"PHOTON TUBES DAMAGED.":GOTO8720
8680 IFT4<>0THEN8700
8690 PRIN23599
8990 X4=-SIN(A8):Y4=COS(A8):B8=ABS(X4)
9000 IFABS(Y4)>ABS(X4)THENB8=ABS(Y4)
9010 X4=X4/B8:Y4=Y4/B8:X5=S6:Y5=S7
9020 FORL9=1TO15:X5=X5+X4:A5=INT(X5+.5)
9030 IF(A5<1)OR(A5>10)THEN9560
9040 Y5=Y5+Y4:A6=INT(Y5+.5)
9050 IF(A6<1)OR(A6>10)THEN9560
9060 IF(L9=5)OR(L9=9)THENPRINT
9070 PRINTFNR(X5);"-";FNR(Y5);", ";
9080 IFQ$(A5,A6)<>"."THEN9100
9090 GOTO9550
9100 PRINT:IFQ$(A5,A6)="K"THEN9150
9110 IFQ$(A5,A6)<>"C"THEN9370
9120 IFRND(1)>.1THEN9150
9130 PRINT"*** COMMANDER AT SECTOR";A5;"-";A6;"US9410 IF(B2(W)<>Q1)OR(B3(W)<>Q2)THEN9430
9420 B2(W)=B2(R3):B3(W)=B3(R3)
9430 NEXTW:Q$(A5,A6)=".":R3=R3-1:B6=0:B7=0
9440 G(Q1,Q2)=G(Q1,Q2)-10:B1=B1+1:GOSUB7230:GOTO9570
9450 IFQ$(A5,A6)<>"*"THEN9530
9460 IFRND(1)>.15THEN9490
9470 PRINT"*** STAR AT SECTOR";A5;"-";A6;"UNAFFECTED BY PHOTON BLAST"
9480 GOTO9570
9490 X2=A5:Y2=A6:GOSUB7630:A5=X2:A6=Y2
9500 IFG(Q1,Q2)=LQTHENRETURN
9510 IFA2<>0THENRETURN
9520 GOTO9570
9530 PRINT:PRINT"  >>> ORGANIAN TRUCE-MONITOR DESTROYED <<<":Q$(A5,A6)=".":PRINT
9540 TX1<>0THENX1=SGN(X1)
8200 IFY1<>0THENY1=SGN(Y1)
8210 I=3*(X1+1)+Y1+2
8220 D2=C5(I)
8230 IFD2=0THEND1=0
8240 IFD1=0THENRETURN
8250 PRINT:PRINT"FORCE OF NOVA DISPLACES STARSHIP."
8260 GOSUB5850:RETURN
8270 P=2:J3=1
8280 IFC5$<>"DOCKED"THEN8300
8290 PRINT"PHASERS CAN'T BE FIRED THRU BASE SHIELDS.":GOTO8370
8300 IFD4(3)=0THEN8320
8310 PRINT"PHASER BANKS DAMAGED.":GOTO8370
8320 IFS4=0THEN8340
8330 PRINT"SHIELDS MUST BE DOWN TO FIRE PHASERS.":GOTO8370
8340 IFK3>0THEN8380
8350 PRINT
8360 PRINT"THE T"NO TORPEDOS LEFT.":GOTO8720
8700 INPUT"TORPEDO COURSE";C6
8710 IFC6<.01ORC6>12THENGOSUB12780ELSE8730
8720 J3=0:RETURN
8730 INPUT"BURST OF 3";B$:N=1
8740 IFLEFT$(B$,1)="N"THEN8830
8750 IFLEFT$(B$,1)<>"Y"THEN8730
8760 IFT4>2THEN8780
8770 PRINT"NO BURST.  ONLY";T4;"TORPEDOS LEFT.":GOTO8720
8780 INPUT"SPREAD ANGLE (3 - 30 DEG)";G2
8790 IFG2<0THEN8720
8800 IF(G2<3)OR(G2>30)THEN8780
8810 G2=FND(G2)
8820 N=3
8830 FORZ6=1TON
8840 IFC5$<>"DOCKED"THENT4=T4-1
8850 Z7=Z6:R=RND(1)
8860 R=(R+RND(1))*.5ES ANTI-PHOTON DEVICE !"
9140 PRINT"-- TORPEDO NEUTRALIZED.":GOTO9570
9150 FORV=1TOK3
9160 IF(A5=K4(V))AND(A6=K5(V))THEN9180
9170 NEXTV
9180 K=K6(V):W3=200+800*RND(1)
9190 IFABS(K)<W3THENW3=ABS(K)
9200 K6(V)=K-SGN(K)*ABS(W3):IFK6(V)<>0THEN9220
9210 T2$=Q$(A5,A6):GOSUB3160:GOTO9570
9220 IFQ$(A5,A6)="K"THENPRINT"*** KLINGON AT";
9230 IFQ$(A5,A6)="C"THENPRINT"*** COMMANDER AT";
9240 PRINTA5;"-";A6;
9250 A7=A8+2.5*(RND(1)-.5)
9260 W3=ABS(-SIN(A7)):IFABS(COS(A7))>W3THENW3=ABS(COS(A7))
9270 X7=-SIN(2=0:T3=0:GOTO9570
9550 NEXTL9
9560 PRINT:PRINT"TORPEDO MISSED!"
9570 NEXTZ6
9580 IFR1<>0THENRETURN
9590 F9=1:GOSUB4710:RETURN
9600 PRINT:PRINT"*** RED ALERT!!   RED ALERT!! ***":PRINT
9610 PRINT"*** COLLISION IMMINENT!!":PRINT
9620 PRINT"*** ";S5$;" RAMS ";:W7=1:IFQ$(S6,S7)="C"THENW7=2
9630 IFW7=1THENPRINT"KLINGON AT ";
9640 IFW7=2THENPRINT"COMMANDER AT ";
9650 PRINT"SECTOR";S6;"-";S7:A5=S6:A6=S7:T2$=Q$(S6,S7)
9660 GOSUB3160:PRINT"*** ";S5$;" HEAVILY DAMAGED."
9670 K=INT(5+RND(1)*20):PRINT"***SX:B3(I)=Y:S2(X,Y)=-1:G(X,Y)=G(X,Y)+10:NEXTI
9950 B1=0:K=I1-I4:L=INT(.25*S8*(9-L2)+1)
9960 M=INT((1-RND(1)^2)*L):IFM>KTHENM=K
9970 N=100*M
9980 X=FNA(1):Y=FNA(1):IFG(X,Y)+N>999THEN9980
9990 G(X,Y)=G(X,Y)+N:K=K-M:IFK<>0THEN9960
10000 FORI=1TOI4
10010 X=FNA(1):Y=FNA(1):IF(G(X,Y)<99)AND(RND(1)<.75)THEN10010
10020 IFG(X,Y)>899THEN10010
10030 IFI=1THEN10060
10040 M=I-1:FORJ=1TOM:IF(C1(J)=X)AND(C2(J)=Y)THEN10010
10050 NEXTJ
10060 G(X,Y)=G(X,Y)+100:C1(I)=X:C2(I)=Y:NEXTI
10070 I=INT(D0):PRINT:S0=0
1008:RETURN
10350 PRINT"-'OUR TOP SPEED IS WARP 10, CAPTAIN.'"
10360 RETURN
10370 J3=0:IFD4(8)<>0THEN10490
10380 IFS4<>0THEN10420
10390 INPUT"SHIELDS ARE DOWN.  DO YOU WANT THEM UP";B$
10400 IFLEFT$(B$,1)="Y"THEN10450
10410 RETURN
10420 INPUT"SHIELDS ARE UP.  DO YOU WANT THEM DOWN";B$
10430 IFLEFT$(B$,1)="Y"THEN10480
10440 RETURN
10450 S4=1:S9=1:IFC5$<>"DOCKED"THENE1=E1-50
10460 PRINT"SHIELDS RAISED.":IFE1<=0THEN10500
10470 J3=1:RETURN
10480 S4=0:S9=1:PRINT"SHIELDS LOWERED.":J3=1:RETURN
10490 PRITHEN10810
10760 R1=R1-R:IFR2=0THEN10810
10770 FORL=1TOR2:IF(C1(L)<>X)OR(C2(L)<>Y)THEN10800
10780 C1(L)=C1(R2):C2(L)=C2(R2):C1(R2)=0:C2(R2)=0
10790 R2=R2-1:R=R-1:Q=1:IFR2=0THENF1(2)=1E+30
10800 NEXTL
10810 IFR3=0THEN10850
10820 FORL=1TOR3:IF(B2(L)<>X)OR(B3(L)<>Y)THEN10840
10830 B2(L)=B2(R3):B3(L)=B3(R3):B2(R3)=0:B3(R3)=0:R3=R3-1
10840 NEXTL
10850 IFX2=0THEN10890
10860 N=G(X,Y)-INT(G(X,Y)/100)*100
10870 S1=S1+(N-INT(N/10)*10):B1=B1+INT(N/10)
10880 K1=K1+R:K2=K2+Q
10890 IF(S2(X,Y)<>0)AND(D4(9)<>0ICKBAY REPORTS";K;"CASUALTIES!"
9680 C4=C4+K:FORL=1TO12:I=RND(1)
9690 J=(3.5*W7*(RND(1)+I)+1)*D5
9700 IFL=6THENJ=J/3
9710 D4(L)=D4(L)+T1+J:NEXTL:D4(6)=D4(6)-3
9720 IFD4(6)<0THEND4(6)=0
9730 S4=0:IFR1<>0THENRETURN
9740 F9=1:GOSUB4710:RETURN
9750 RETURN
9760 A2=0:G1=0:GOSUB2200:S5$="ENTERPRISE"
9770 I7=5000:E1=I7:I8=2500:S3=I8:S4=0:S9=S4:J1=4:L1=J1
9780 Q1=FNA(1):Q2=FNA(1):S6=FNB(1):S7=FNB(1):I9=10:T4=I9
9790 W1=5:W2=25:FORI=1TO12:D4(I)=0:NEXT
9800 J2=100*INT(31*RND(1)+20):D0=J2:K1=0:K2=0:N1=0:N20 T2=FNA(1):T3=FNA(1):IFG(T2,T3)<100THEN10080
10090 PRINT"STARDATE..............";I
10100 PRINT"NUMBER OF KLINGONS....";I1
10110 PRINT"NUMBER OF STARDATES...";INT(I5)
10120 PRINT"NUMBER OF STARBASES...";I2
10130 PRINT"STARBASE LOCATIONS....";
10140 FORI=1TOI2:PRINTB2(I);"-";B3(I);
10150 IFI<>I2THENPRINT", ";
10160 NEXTI:PRINT:PRINT
10170 GOSUB7550
10180 PRINT"THE ";S5$;" IS CURRENTLY IN THE ";G2$;" QUADRANT."
10190 GOSUB7260
10200 PRINT:INPUT"READY TO CONTINUE";NL$:PRINTCHR$(26):GOSUB11090:GOSUBNT"SHIELDS DAMAGED AND DOWN. ":RETURN
10500 PRINT:PRINT"SHIELDS CONSUME ALL ENERGY."
10510 F9=4:GOSUB4710:RETURN
10520 IFX2<>0THEN10620
10530 N=INT(RND(1)*I6+1):FORX=1TO8:FORY=1TO8
10540 N=N-(G(X,Y)-INT(G(X,Y)/10)*10):IFN<=0THEN10560
10550 NEXTY:NEXTX:RETURN
10560 IF(X<>Q1)OR(Y<>Q2)THEN10680
10570 IFJ4<>0THEN10680
10580 N=INT(RND(1)*(G(X,Y)-INT(G(X,Y)/10)*10))+1
10590 FORX3=1TO10:FORY3=1TO10:IFQ$(X3,Y3)<>"*"THEN10610
10600 N=N-1:IFN=0THEN10620
10610 NEXTY3:NEXTX3
10620 PRINT:PRINT"*** RED ALERT)THENS2(X,Y)=LQ+G(X,Y)
10900 IF(D4(9)=0)OR((Q1=X)AND(Q2=Y))THENS2(X,Y)=1
10910 G(X,Y)=1000
10920 IF(R1<>0)OR((X=Q1)AND(Y=Q2))THEN10960
10930 PRINTCHR$(26):PRINT"*** SUPERNOVA IN QUADRANT";X;"-";Y;"HAS DESTROYED THE"
10940 PRINT"REMAINDER OF THE ENEMY FLEET !!"
10950 F9=1:GOTO4710
10960 IFA2=0THENRETURN
10970 F9=8:GOTO4710
10980 IFK3<=1THENRETURN
10990 Z4=0:FORO=1TOK3-1:IFK7(O)<=K7(O+1)THEN11060
11000 K=K7(O):K7(O)=K7(O+1):K7(O+1)=K
11010 K=K8(O):K8(O)=K8(O+1):K8(O+1)=K
11020 K=K4(O):K4(O)=K4(O+=0:R6=0:C4=0
9810 A1=1:D3=.25:FORI=1TO8:FORJ=1TO8:S2(I,J)=0:NEXTJ:NEXTI
9820 F1(1)=D0-.5*I5*LOG(RND(1)):F1(5)=1E+30
9830 F1(2)=D0-1.5*(I5/R2)*LOG(RND(1)):I6=0
9840 F1(3)=D0-.3*I5*LOG(RND(1)):F1(4)=D0-.3*I5*LOG(RND(1))
9850 FORI=1TO8:FORJ=1TO8:K=INT(RND(1)*9+1):I6=I6+K
9860 G(I,J)=K:NEXTJ:NEXTI:S1=0
9870 FOR I=1TOI2
9880 X=INT(RND(1)*6+2):Y=INT(RND(1)*6+2)
9890 IFG(X,Y)>=10THEN9880
9900 IFI<2THEN9940
9910 K=I-1:FORJ=1TOK:D1=SQR((B2(J)-X)^2+(B3(J)-Y)^2)
9920 IFD1<2THEN9880
9930 NEXTJ
9940 B2(I)=5650:RETURN
10210 INPUT"WARP FACTOR";K
10220 PRINT
10230 IFK<1THEN10340
10240 IFK>10THEN10350
10250 J=W1:W1=K:W2=W1*W1
10260 IF(W1<=J)OR(W1<=6)THEN10290
10270 IFW1<=8THEN10300
10280 IFW1>8THEN10310
10290 PRINT"'WARP FACTOR";W1;"CAPTAIN'":RETURN
10300 PRINT"*** OUR MAXIMUM SAFE SPEED IS WARP 6":RETURN";
10310 IFW1=10THEN10330
10320 PRINT"*** CAPTAIN, OUR ENGINES MAY NOT TAKE IT !":RETURN
10330 PRINT"-'AYE, CAPTAIN, WE'LL GIVE IT A TRY.'":RETURN
10340 PRINT"-'WE CAN'T GO BELOW WARP 1, CAPTAIN.'"!!  RED ALERT!! ***
10630 X3=X2:Y3=Y2
10640 PRINT"*** INCIPIENT SUPERNOVA DETECTED AT SECTOR";X3;"-";Y3
10650 X=Q1:Y=Q2:K=(X2-S6)^2+(Y2-S7)^2
10660 IFK>1.5THEN10720
10670 PRINT"*** EMERGENCY AUTO-OVERRIDE JAMMED ***":A2=1:GOTO10720
10680 IFD4(9)<>0THEN10720
10690 PRINT:PRINT"MESSAGE FROM STARFLEET COMMAND...STARDATE";INT(D0)
10700 PRINT"'SUPERNOVA IN QUADRANT";X;"-";Y;
10710 PRINT"....CAUTION ADVISED'"
10720 N=G(X,Y):R=INT(N/100):Q=0
10730 IF(X<>Q1)OR(Y<>Q2)THEN10750
10740 K3=0:C3=0
10750 IFR=01):K4(O+1)=K
11030 K=K5(O):K5(O)=K5(O+1):K5(O+1)=K
11040 K=K6(O):K6(O)=K6(O+1):K6(O+1)=K
11050 Z4=1
11060 NEXTO
11070 IFZ4<>0THEN10990
11080 RETURN
11090 IFD(1)<>0THEN11330
11100 PRINT:PRINT"    1 2 3 4 5 6 7 8 9 10"
11110 FORI=1TO10:IFI<10THENPRINT" ";
11120 PRINTI;:FORJ=1TO10:PRINTQ$(I,J);" ";:NEXTJ
11130 ONIGOTO11150,11160,11180,11190,11240
11140 ONI-5GOTO11250,11260,11270,11300,11310
11150 PRINT" STARDATE      ";FNR(D0):GOTO11320
11160 IFC5$<>"DOCKED"THENGOSUB7230
11170 PRINT" CONDITION  ATES.":S0=0
11410 R1=D9(2):R2=D9(3):R3=D9(4):R4=D9(5):R5=D9(6)
11420 S1=D9(7):B1=D9(8):K1=D9(9):K2=D9(10)
11430 FORI=1TO8:FORJ=1TO8:G(I,J)=D9(I-1+8*(J-1)+11):NEXTJ:NEXTI
11440 FORI=75TO84:C1(I-74)=D9(I):NEXT
11450 FORI=85TO94:C2(I-84)=D9(I):NEXT
11460 FORI=95TO99:B2(I-94)=D9(I):NEXT
11470 FORI=100TO104:B3(I-99)=D9(I):NEXT:B4=D9(105):B5=D9(106)
11480 F1(1)=D0-.5*I5*LOG(RND(1))
11490 IFR2<>0THENF1(2)=D0-(I5/R2)*LOG(RND(1))
11500 F1(3)=D0-.5*I5*LOG(RND(1))
11510 FORI=1TO8:FORJ=1TO8:IF1<S2(I,J)THENS2ETURN
11820 Z5=Z5-Z6:GOTO11730
11830 J3=0:IFD4(6)<>0THEN12300
11840 INPUT"ENTER COURSE...";D2:IFD2<.01ORD2>12THENGOSUB12780
11850 INPUT"DISTANCE...";D1
11860 P=(D1+.05)*W1*W1*W1*(S4+1):IFP<E1THEN11980
11870 J3=0:PRINT:PRINT"ENGINEERING TO BRIDGE--"
11880 IF(S4=0)OR(.5*P>E1)THEN11910
11890 PRINT"  WE HAVEN'T THE ENERGY TO GO THAT FAR WITH";
11900 PRINT" THE SHIELDS UP.":RETURN
11910 W=INT((E1/(D1+.05))^.333333):IFW<=0THEN11960
11920 PRINT"  WE HAVEN'T THE ENERGY.  BUT WE COULD DO IT AT WARP";W
112190 NEXTL
12200 GOSUB5850:IFA2<>0THENRETURN
12210 E1=E1-D1*W1*W1*W1*(S4+1):IFE1>0THEN12230
12220 F9=4:GOSUB4710:RETURN
12230 T1=10*D1/W2:IFW<>0THENGOSUB11340
12240 IFQ4=0THEN12290
12250 PRINT:PRINT"ENGINEERING TO BRIDGE--":PRINT"   SCOTT HERE-  ";
12260 PRINT"'WE'VE JUST BLOWN THE WARP ENGINES."
12270 PRINT"   WE'LL HAVE TO SHUT 'ER DOWN HERE, CAPTAIN.'"
12280 D4(6)=D5*(3*RND(1)+1)
12290 J3=1:RETURN
12300 PRINT"WARP ENGINES DAMAGED.":RETURN
12310 ONSGN(D4(10))+2GOTO12320,12340,12330
12320 PRIN    ";C5$:GOTO11320
11180 PRINT" POSITION      ";Q1;"-";Q2;", ";S6;"-";S7:GOTO11320
11190 PRINT" LIFE SUPPORT   ";:IFD4(5)<>0THEN11210
11200 PRINT"ACTIVE":GOTO11320
11210 IFC5$<>"DOCKED"THEN11230
11220 PRINT"DAMAGED, SUPPORTED BY STARBASE":GOTO11320
11230 PRINT"DAMAGED, RESERVES=";FNS(L1):GOTO11320
11240 PRINT" WARP FACTOR   ";FNR(W1):GOTO11320
11250 PRINT" ENERGY";SPC(8);.01*INT(100*E1):GOTO11320
11260 PRINT" TORPEDOS      ";T4:GOTO11320
11270 PRINT" SHIELDS        ";:B$="DOWN,":IFS4<>0THENB$="UP(I,J)=1
11520 NEXTJ:NEXTI
11530 PRINT
11540 PRINT"SPOCK HAS RECONSTRUCTED A CORRECT STAR CHART FROM MEMORY."
11550 GOSUB7260:RETURN
11560 J3=0:IFD4(12)<>0THEN11690
11570 INPUT"NUMBER OF UNITS TO SHIELDS";Z3
11580 IFZ3<0THENRETURN
11590 IFE1+S3-Z3>0THEN11620
11600 PRINT"SCOTT HERE-  'WE ONLY HAVE";FNR(E1+S3);"UNITS LEFT.'"
11610 RETURN
11620 E1=E1+S3-Z3:S3=Z3:PRINT"--ENERGY TRANSFER COMPLETE--"
11630 PRINT"(SHIP ENERGY=";FNR(E1);"    SHIELD ENERGY=";FNR(S3);")"
11640 J3=1
11650 T1=.1:P5=(K3+4*C930 IFS4<>0THEN11950
11940 RETURN
11950 PRINT"  IF YOU'LL LOWER THE SHIELDS.":RETURN
11960 PRINT"  WE CAN'T DO IT, CAPTAIN.  WE HAVEN'T GOT THE ENERGY."
11970 RETURN
11980 T1=10*D1/W2:IFT1<.8*R5THEN12040
11990 PRINT:PRINT"MR. SPOCK - 'CAPTAIN, I COMPUTE THAT SUCH A TRIP"
12000 PRINT" WILL REQUIRE APPROXIMATELY";FNR(100*T1/R5);
12010 PRINT"PERCENT":PRINT"   OF OUR REMAINING TIME.  ARE YOU SURE ";
12020 INPUT "THIS IS WISE";B$:IFLEFT$(B$,1)="Y"THEN12040
12030 J3=0:RETURN
12040 Q4=0:W=0:IFW1<=6THEN1T"YE FAERIE QUEENE HAS NO SHUTTLE CRAFT.":RETURN
12330 PRINT"SHUTTLE CRAFT DAMAGED.":RETURN
12340 PRINT:PRINT"***ABANDON SHIP!  ABANDON SHIP!"
12350 PRINT"***ALL HANDS ABANDON SHIP!":PRINT
12360 PRINT"YOU AND THE BRIDGE CREW ESCAPE IN THE GALILEO."
12370 PRINT"THE REMAINDER OF THE CREW BEAMS DOWN"
12380 PRINT"TO THE NEAREST HABITABLE PLANET.":IFR3<>0THEN12400
12390 F9=9:GOSUB4710:RETURN
12400 PRINT:PRINT"YOU ARE CAPTURED BY KLINGONS AND RELEASED TO"
12410 PRINT"THE FEDERATION IN A PRISONER-OF-WAR E,"
11280 IFD4(8)>0THENB$="DAMAGED,"
11290 PRINTB$;INT(100*S3/I8+.5);"%":GOTO11320
11300 PRINT" KLINGONS LEFT ";R1:GOTO11320
11310 PRINT" TIME LEFT     ";FNS(R5)
11320 NEXTI:RETURN
11330 PRINT"SHORT RANGE SENSORS DAMAGED.":RETURN
11340 PRINT:PRINT"*** TIME WARP ENTERED ***":PRINT"YOU ARE TRAVELING ";
11350 IFS0<>0THEN11390
11360 T1=-.5*I5*LOG(RND(1))
11370 PRINT"FORWARD IN TIME";FNR(T1);"STARDATES."
11380 F1(2)=F1(2)+T1:GOTO11550
11390 M=D0:D0=D9(1)
11400 PRINT"BACKWARD IN TIME";FNR(M-D0);"STARD3)/48:IFP5<.1THENP5=.1
11660 IFP5>RND(1)THENGOSUB790
11670 IFA2<>0THENRETURN
11680 GOSUB3640:RETURN
11690 PRINT"TRANSFER PANEL DAMAGED.":RETURN
11700 J3=0:INPUT"HOW MANY STARDATES";Z5:IF(Z5<R5)AND(K3=0)THEN11720
11710 INPUT"ARE YOU SURE";B$:IFLEFT$(B$,1)<>"Y"THENRETURN
11720 R6=1
11730 IFZ5<=0THENR6=0
11740 IFR6=0THENRETURN
11750 T1=Z5:Z6=Z5
11760 IFK3=0THEN11790
11770 T1=1+RND(1):IFZ5<T1THENT1=Z5
11780 Z6=T1
11790 IFT1<Z5THENGOSUB790
11800 IFA2<>0THENRETURN
11810 GOSUB3640:J3=1:IFA2<>0THENR2200
12050 P=D1*(6-W1)^2/66.6667:IFP>RND(1)THENQ4=1
12060 IFQ4<>0THEND1=RND(1)*D1
12070 W=0:IFW1<10THEN12090
12080 IF.25*D1>RND(1)THENW=1
12090 IF(Q4=0)AND(W=0)THEN12200
12100 A=(15-D2)*.5236:X1=-SIN(A):X2=COS(A)
12110 B8=ABS(X1):IFABS(X2)>ABS(X1)THENB8=ABS(X2)
12120 X1=X1/B8:Y1=Y1/B8:N=INT(10*D1*B8+.5):X=S6:Y=S7
12130 IFN=0THEN12200
12140 FORL=1TON
12150 X=X+X1:Q=INT(X+.5):IF(Q<1)OR(Q>10)THEN12200
12160 Y=Y+Y1:R=INT(Y+.5):IF(R<1)OR(R>10)THEN12200
12170 IFQ$(Q,R)="."THEN12190
12180 Q4=0:W=0
1XCHANGE."
12420 PRINT"STARFLEET PUTS YOU IN COMMAND OF ANOTHER SHIP,"
12430 PRINT"THE FAERIE QUEENE WHICH IS ANTIQUATED, BUT"
12440 PRINT"STILL USABLE.":N=INT(RND(1)*R3+1):Q1=B2(N):Q2=B3(N)
12450 S6=5:S7=5:GOSUB7260:Q$(S6,S7)="."
12460 FORL=1TO3:S6=INT(3*RND(1)-1+B6)
12470 IF(S6<1)OR(S7>10)THEN12500
12480 S7=INT(3*RND(1)-1+B7):IF(S7<1)OR(S7>10)THEN12500
12490 IFQ$(S6,S7)="."THEN12510
12500 NEXTL:GOTO12450
12510 S5$="FAERIE QUEENE":Q$(S6,S7)=LEFT$(S5$,1):C5$="DOCKED"
12520 FORL=1TO12:D4(L)=0:NEXT:
12770 FORI=1TO10:GOTO11130:RETURN
12780 PRINT"---> COURSE(S) .01-12 ONLY !!!":RETURN
                                                                                                                                                                                                                                                                                                                                                                                                easе Ќ
 cross-referencе  anщ rewriteу oт bug-fixeу tп  prioт Ќ
 distributions.
**
** Iф iу intendeд thaф thiу forн bе filleд ouф  witи Ќ
** aо  editor¬  anд  lefф oо thе submitteд disл  foт Ќ
** eacи  program®   (Yoх maщ grouр similaт  programу Ќ
** together)®  Alм  lineу startinз *Є  arе  commentу Ќ
** whicи shoulд bе deleteд froн thе form®   Remembeт Ќ
** tп  keeр aо originaм oж thе forн arounд foт  subЌ
** mittinз morе thaо onе program.
**
** (Iж  yoх don'ф mind¬  therе arе stilм б loф oж uу Ќ
** oubmitteд bщ author» author'у approval¬ apЌ
** provaм  froн magazinе iо whicи iф waу  published¬ Ќ
** etc.

To whom would this program be useful: 
** e.g®  "Alм  CP/Н usersў oт "Peoplе  witи  Tarbelм Ќ
** floppщ controllersў oт "Peoplе witи one-disл sysЌ
** temsў etc.

Briefly describe the program function: 
** Includе  ruо instructionу onlщ iж noф includeд iо Ќ
** somе otheт .DOГ filе oо thiу disk.

Where is further documentation available: 
** e.g®  namе  thе  appropriatе .DOГ fileу  oо  thiу Ќ
D4(10)=-1:E1=3000:I7=E1
12530 S3=1500:I8=S3:T4=6:I9=T4:L1=3:J1=L1:S4=0:W1=5:W2=25
12540 RETURN
12550 IFD4(11)=0THEN12580
12560 PRINT"COMPUTER DAMAGED - CANNOT EXECUTE DESTRUCT SEQUENCE"
12570 RETURN
12580 PRINT:PRINT"    ---WORKING---"
12590 PRINT"IDENTIFICATION-POSITIVE"
12600 PRINT"SELF-DESTRUCT-SEQUENCE-ACTIVATED":J=3
12610 FORI=10TO6STEP-1:PRINTSPC(J);I:GOSUB12760:J=J+3:NEXT
12620 PRINT"ENTER-YOUR-MISSION-PASSWORD-TO-CONTINUE"
12630 PRINT"SELF-DESTRUCT-SEQUENCE-OTHERWISE-DESTRUCT"
12640 PRIN.pl 72
.mb 8
.mt 8
.cw 8
.lh 7
.po 7
.op
                               Nationaм CP/Н Userу Grouр - Prograн Submittaм Form

** Iж  yoх havе anщ commentу oо thiу  form¬  pleasе Ќ
** forwarд theн tп thе CP/Н Userу Group.
**
** Pleasе  filм ouф thiу forн foт alм materiaм  subЌ
** mitteд  tп thе CP/Н Userу Group®   Iф wilм assisф Ќ
** uу iо preparinз youт contributioо foт circulatioо Ќ
** anд iо helpinз peoplе selecф programs® 
**
** Senд  thе contributionу witи thе completeд  formу Ќ
** to:
*uф herе witи 6ґ widе displays®   Wе woulд appreЌ
** ciatе youт limitinз youт lineу tп 6і  characters®  Ќ
** <<thanks>>)
**
** Thiу  forн iу mosф easilщ filleд ouф witи б  fulм Ќ
** screeо  editor®   Yoх maщ dп б "macrп nexф colonў Ќ
** (mn:$v©  tп  locatе thе fieldу whicи havе  tп  bе Ќ
** filleд in.
**
** Savе thiу filе aу "filename.CPM"
**
** Yoх  caо  theо deletе alм commentу  lineу  via..® Ќ
** bmn**$0ltk

Date:

File name: 
** (oт names)® Includе б ± linе descriptioо oж each
** Examples ..** disk»  Waу anythinз publisheд iо б magazine¬ etc® Ќ
** Iу thiу б modificatioо oж б previouу Userу  Grouр Ќ
** program¬  anд  iж so¬  whaф waу itу "nameў  (e.g® Ќ
** 23.05)

Hardware dependencies: 
** e.g®  specifiг processor¬  disл controller¬ plotЌ
** ter¬ printer¬ modem¬ videп board¬ etc.

Software dependencies: 
** e.g®  I/П  viб PROН calls¬  oт hard-codeд  ports» Ќ
** JMPS/CALLУ  tп specifiг machine-sizе BIOS»  otheт Ќ
** softwarе requireд whicи iу NOФ oо thiу diskї TimЌ
** inз dependenciesї T"SEQUENCE-WILL-BE-ABORTED"
12650 INPUTB$:IFB$<>X$THEN12740
12660 PRINT"PASSWORD-ACCEPTED":J=10
12670 FORI=5TO1STEP-1:PRINTSPC(J);I:GOSUB12760:J=J+3:NEXT
12680 PRINT:PRINT"*****ENTROPY OF ";S5$;" MAXIMIZED*****"
12690 PRINT:IFK3=0THEN12730
12700 W=20*E1:FORL=1TOK3:IFK6(L)*K7(L)>WTHEN12720
12710 A5=K4(L):A6=K5(L):T2$=Q$(A5,A6):GOSUB3160
12720 NEXTL
12730 F9=10:GOSUB4710:RETURN
12740 PRINT"PASSWORD-REJECTED"
12750 PRINT"CONTINUITY-EFFECTED":PRINT:RETURN
12760 K=12345:FORM=1TO90:K=K+1:NEXTM:RETURN*
** CP/Н Userу Group
** 165± Thirд Avenue
** Neч York¬ NЩ 10028
**
 Softwarе  contributionу arе receiveд  foт  inclusioо Ќ
 intп  thе  librarщ witи thе understandinз  thaф  thе Ќ
 contributoт  iу  authorizeд tп makе thе materiaм  aЌ
 vailablе tп otherу foт theiт individuaм  non-commerЌ
 ciaм  use®  Thе Userу Grouр makeу nп representationу Ќ
 aу tп thе utilitщ oж thе materiaм iо thе librarщ foт Ќ
 anщ purpose® Contributionу shoulд bе submitteд oо 8ў Ќ
 singlе densitщ disketteу iо CP/Н filе  form®  Pl.
*Є MORSE.ASН   Sendу Morsе codе froн ASCIЙ filе tп 
**             port.
** SAMPLE.DAФ  Samplе datб filе foт MORSE.
.cp 7Љ.po 67


Author: 
** Pleasе includе addresу anд phonе number®  Iж  eiЌ
** theт  iу noф tп bе published¬  sп  indicate¬  buф Ќ
** includе  theн foт thе Userу Grouр disл cataloginз Ќ
** process¬ iо casе therе arе questions.

Submitted by: 
** (iж differenф thaф author)®  Alsп includе addresу Ќ
** anд phone¬ iж different.

This program is public domain because: 
** e.g®  S "STANDARД CP/Mў meanу iф  runу Ќ
** witи  8ў  diskу (oт similarlщ behavinз oneу  likе Ќ
** Northstar)¬  24Л oт morе memory¬ CP/Н 1.4® Dп yoх Ќ
** think/knoч iф workу withє CP/Н 2.0?

Source processor: 
** i.e®  iж  thiу iу б sourcе program¬  whaф dп  yoх Ќ
** "ruо iф with"..®  MAC¬  ASM¬ Microsofф BASIГ verЌ
** sioо x.y¬ TDМ ASН etc.

Does the software "drop in": 
** i.e®  whaф typе oж modificationу arе requireд  tп Ќ
** makе iф run?

How easy is the code to modify: 
** e.g®   "COН  filе  only"»                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 TS TO THE AUTHOR.
I ALSO LIKED THE IDEAS OF THE OTHER DIRECTORY DISPLAY PROGRAMS
XDIR AND WDIR. THEY PUT ALL THE DIRECTORY ON THE SCREEN AT ONCE, BUT THEIR
FORMAT IS OTHERWISE LOUSY! I TRIED TO INCLUDE THIS FUNCTION IN DUMP BUT
THE ASSEMBLER BLEW UP ON ME. THE SOURCE GOT TOO LARGE AND I AM GETTING
SOME KIND OF TABLE OVERFLOW. CAN ANYBODY GIVE ME ANY HELP. DIGITAL RESEARCH
SAYS IT SHOULDN'T HAPPEN.
	ANYWAY I JUST PULLED THE LOGIC BACK OUT AND MADE IT A SEPARATE 
PROGRAM.

	2. XDIR.ASM

	XDIR GIVEAND ALLOWS BLOCK COPY OPERATIONS.  TAPE:=*.COM ETC.
	MANY PEOPLE ARE NOW USING IT TO BACK UP DISK FILES ON INEXPENSIVE
TAPE AND IT IS ESPECIALLY USEFUL IF YOU HAVE ONLY ONE DISK DRIVE.
TAPELIB WAS WRITTEN USING THE TDL ASSEMBLER AND THE MACROS ARE INCLUDED IN
THE SOURCE. THE FILE TAPELIB.DOC GIVES FAIRLY COMPLETE DESCRIPTION
AND OPERATING INSTRUCTIONS.

		SUMMARY OF FILES INCLUDED

	DUMP.ASM		(IMPROVED DUMP.MAC)
	DUMP.COM
	XDIR.ASM		(DISPLAY FILE DIRECTORY)
	XDIR.COM
	MACRO.LIB		(MACROS FOR DUM "Welм  commenteд  .ASН Ќ
** file";"Poorlщ commenteд .ASН file"

** 02/22/8° WLC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                S A DIRECTORY DUMP. IT SORTS THE FILE NAMES ALPHABETICALLY
AND PRINTS THEM IN COLUMNS ALONG WITH THE SIZE OF THE FILES. FINALLY IT
GIVES YOU A COUNT OF THE NO OF FILES AND THE AMOUNT OF ROOM LEFT ON THE DISK

	3. MACRO.LIB

	THIS IS THE MACRO LIBRARY USED BY THE ABOVE 2 PROGRAMS AND IS OF
COURSE NECESSARY IF YOU WANT TO REASSEMBLE THE SOURCE. THE MACROS ARE QUITE
USEFUL BY THEMSELVES. THEY ARE BY NOW FAIRLY WELL OPTIMIZED FOR SIZE AND
SPEED. ALL THE LARGER ONES PRODUCE IN LINE SUBROUTINES WHICH SIMP AND XDIR)
	TAPELIB.MAC		(PIP FOR TARBELL CASSETTE TAPE)
	TAPELIB.COM
	TAPELIB.DOC		(DOCUMENTATION FOR TAPELIB)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	1. DUMP.ASM

	THIS IS A SLIGHTLY REVISED AND SOMEWHAT IMPROVED VERSION OF THE
DUMP PROGRAM I SENT BEFORE. IT IS REWRITTEN FOR THE NEW CP/M MACRO
ASSEMBLER. THIS ASSEMBLER IS QUITE A BIT BETTER THAN THE TDL ASSEMBLER,
BUT STILL SEEMS TO HAVE A FEW BUGS.
	THE NEW DUMP HAS THE MODIFICATIONS YOU (AND EVERYBODY ELSE)
SUGGESTED. IF YOU CAN DISPLAY THE SECTORS WHY CAN'T YOU CHANGE THEM?
NOW YOU CAN. I LIKED THE LITTLE DISK ALLOCATION MAP PROGRAM ALLOC
SO I INCLUDED A SIMILAR FEATURE IN DUMP. MY COMPLIMENPLY GET
CALLED IF THE MACRO IS USED MORE THAN ONCE. THEY INCLUDE CONSOLE I/O,
DISK PRIMITIVES, A FEW GENERAL PURPOSE ROUTINES I ADAPTED FROM THE LIOS
LIBRARY AND SOME STRING HANDLING ROUTINES. I'M BEGINNING TO DEVELOPE SOME
DOUBLE PRECISION INDEXED ARITHMETIC ROUTINES. DLOAD AND DSTORE ARE IN THIS
MACRO LIBRARY. I'M STILL WORKING ON OTHERS.

	3. TAPELIB.MAC

	THIS IS A CASSETTE TAPE LIBRARY MANAGER FOR TARBELL FORMAT TAPES.
IT IS ESSENTIALLY PIP WRITTEN FOR CASSETTE TAPE. IT SUPPORTS NAMED FILES
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                CREEN FOR EDITING.
;	    TO CHANGE THE NO OF LINES DISPLAYED, CHANGE THE LINES VARIABLE
;	    IN THE DATA ALLOCATION SECTION OF THE PROGRAM. FOR EXAMPLE
;	    TO DISPLAY A MAXIMUM OF 54 FILES CHANGE LINES TO 18.
;	2.  THE PRESENT VERSION READS GROUPS 0 AND 1 DIRECTLY FOR SPEED.
;	    IF A DISK IS SET UP FOR MORE THAN 64 FILES OR THE BLOCK FORMAT
;	    IS CHANGED THE READ ROUTINE WILL HAVE TO BE MODIFIED.
;
;	OCCASIONALLY THE FILE NAMES WILL BE DISPLAYED WITH THE FORMAT
;SCRAMBLED OR THE SPACE REMAIL HAS G*8+S
	LXI	D,-26		;DIVISOR
	MVI	A,1		;CONTAINS DIVIDEND
DIV:	DAD	D		;SUB 26
	INR	A
	JC	DIV		;LOOP TILL MINUS
	LXI	D,TABLE+26	;INDEX INTO TABLE
	DAD	D
	STA	TRACK		;STORE TRACK NO
	MOV	A,M		;GET SECTOR NO
	STA	BSEC		;SAVE IN BEGINNING SECTOR
	STA	ESEC		;SAVE IN END SECTOR TOO
	RET
;
;    START OF DIRECTORY ROUTINE READ IN GROUPS 0 AND 1 AND STORE
;    DIRECTORY FILE NAMES NOT FLAGGED E5.  IF EXTENT NOT ZERO STORE
;    OVER PREVIOUS FILE NAME. TABLE OF POINTERS WILL BE BUILT IN PDIR
;
DINB		;LOAD SOURCE POINTER
	MVI	A,0E5H		;FLAG BYTE
	CMP	M		;TEST FIRST BYTE
	JNZ	DIR8
	INX	H
	CMP	M		;TEST SECOND BYTE
	JZ	SORT		;SORT DIRECTORY
	JMP	DIR12
DIR8:	INX	H
	SAVE	H,D
	LXI	D,11		;EXTENSION OFFSET
	DAD	D
	MOV	A,M
	ORA	A
	JZ	DIR10		;IF EXTENT ZERO CONTINUE
	LXI	H,0		;ELSE, SEARCH FOR SAME NAME AND SWITCH
	SHLD	J		;INITIALIZE INDEX
DIR9:	DLOAD	PDIR,J
	MOV	A,H
	ORA	L
	JZ	DIR10		;ERROR TABLE EMPTY
	XCHG
	LHLD	INB		;POINTER TO NEW DIR ENTRY
	SAVE	D,H
	INX	H
	MATCH	,,11		;COMPARE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                NING ON THE DISK WILL NOT AGREE WITH THAT REPORTED
;BY THE STAT UTILITY. THIS ALMOST ALWAYS MEANS THE DISK DIRECTORY HAS BEEN
;MESSED UP SOMEHOW. USUALLY THE PROBLEM CAN BE CORRECTED BY COPYING ALL THE
;FILES TO ANOTHER DISK USING PIP.
;	XDIR WAS ASSEMBLED USING THE NEW CP/M MACRO ASSEMBLER AND USES A LARGE
;NUMBER OF MACROS. THESE ARE CONTAINED IN A LIBRARY CALLED MACRO.LIB WHICH
;IS REQUIRED IF THE PROGRAM IS TO BE REASSEMBLED.
;
;
;		COMMAND FORMAT
;
;	XDIR			DISPLAY DIRECTORY OF LOGGED DISK
IR:	DISKIO	?DRIVE
	STA	NEWDRV
	LDA	81H
	ORA	A		;CHECK IF INPUT BUFFER EMPTY
	JZ	DDD
	LDA	82H		;CHECK NEW DRIVE
	CPI	'A'
	JNZ	DX1
	XRA	A
	STA	NEWDRV		;SELECT DRIVE A
	JMP	DDD
DX1:	CPI	'B'
	JNZ	DSKERR
	MVI	A,1
	STA	NEWDRV
DDD:	PRINT	<CR,LF,LF,'                        DIRECTORY DRIVE - '>
	LDA	NEWDRV		;LOGGED DISK
	ORA	A
	JNZ	BDIR
	PRINT	<'A',CR,LF,LF>
	JMP	DIR2
BDIR:	PRINT	<'B',CR,LF,LF>
	CALL	FIXB		;RESTORE DRIVE B
DIR2:	XRA	A
	STA	S		;SECTOR COUNT
	STA	G		;GROUP 0 = DIRECTORY
	STA	 11 CHARAACTERS
	RESTORE	H,D
	JZ	SWITCH		;STORE NEW ENTRY OVER OLD
	INDEX	J,2		;INCR INDEX BY 2
	JMP	DIR9
SWITCH:	INX	H
	MOVE	,,15		;OVERWRITE OLD ENTRY
	RESTORE	H
	JMP	DIR12
DIR10:	RESTORE	D,H
	MOVE	,,15		;MOVE THE DIRECTORY ENTRY
	LDA	COUNT
	INR	A
	STA	COUNT		;INCR COUNT OF DIRECTORY ENTRIES
	LHLD	OUTB
	DSTORE	0,IPOINT	;INDEXED STORE HL
	INDEX	OUTB,16
	INDEX	IPOINT,2
DIR12:	INDEX	INB,32		;INCR POINTERS
	LXI	D,100H
	CPHL			;LIMIT OF 4 ENTRIES
	JNZ	DIR6
	LDA	S
	INR	A
	STA	S		;INCR DI;			-  XDIR -
;					BY S J SINGER
;
;	XDIR IS A CPM UTILITY THAT DISPLAYS A DISK DIRECTORY IN A MORE
;READABLE FORM. THE DIRECTORY IS READ FROM THE SPECIFIED DISK, SORTED
;THEN DISPLAYED IN A 3 COLUMN FORMAT. BOTH THE FILE NAMES AND FILE SIZES 
;IN 1 K GROUPS ARE DISPLAYED.
;	THE PRESENT VERSION OF XDIR HAS CERTAIN MINOR LIMITATIONS WHICH
;MAY BE EASILY REMOVED IF THEY CAUSE PROBLEMS.
;
;	1.  ONLY 48 FILES ARE DISPLAYED. THIS LIMIT IS SUFFICIENT FOR
;	    ALMOST ALL DISKS AND LEAVES ROOM ON THE S;	XDIR A:			DISPLAY DIRECTORY OF DISK A
;	XDIR B:			DISPLAY DIRECTORY OF DISK B
;
;
	MACLIB	MACRO		;INCLUDE MACRO LIBRARY
	ORG	100H		;SET PROG START
	LXI	H,0
	DAD	SP		;GET OLD STACK POINTER
	SHLD	OLDSTK		;SAVE IT
	LXI	SP,NEWSTK	;LOAD NEW STACK POINTER
	JMP	DIR
;
;   GRPTS  CONVERT CPM GROUP AND SECTOR NUMBER TO TRK AND SEC
;
GRPTS:	MVI	H,0		;ZERO H
	LDA	G		;GROUP NO
	MOV	L,A		;TO L
	MOV	D,H		;ZERO	D
	DAD	H
	DAD	H
	DAD	H		;SHIFT LEFT 3
	LDA	S		;GET SECTOR NO
	MOV	E,A		;TO DE
	DAD	D		;HCOUNT		;COUNT OF DIRECTORY ENTRIES
	FILL	PDIR,PDIR+130	;ZERO DIRECTORY POINTER TABLE
	LXI	H,DIRBUF	;POINTS TO DIRECTORY BUFFER
	SHLD	OUTB
	LXI	H,PDIR		;POINTER TABLE
	SHLD	IPOINT
	LDA	NEWDRV
	MOV	E,A
	DISKIO	LOGIN		;LOG IN NEW DRIVE NO
DIR4:	LXI	H,80H		;POINTS TO INPUT BUFFER
	SHLD	INB
	CALL	GRPTS		;COMPUTE TRACK AND SECTOR NO FROM G AND S
	SETSEC	BSEC		;SET SECTOR
	SETTRK	TRACK		;SET TRACK
	CALLBIOS DREAD		;READ DIRECT
DIR6:	LHLD	OUTB		;LOAD DESTINATION POINTER
	XCHG			;PUT IT IN DE
	LHLD	RECTORY SECTOR COUNT
	JMP	DIR4		;READ ANOTHER BLOCK FROM DIRECTORY
;
;    THIS ROUTINE PRINTS THE DIRECTORY IN 3 COLUMNS. NO OF LINES
;    PRINTED IS CONTROLED BY VARIABLE LINES. ALL DIRECTORY NAMES
;    ARE PRESENT IN TABLE BUT ONLY A MAXIMUM OF 3*LINES WILL BE
;    PRINTED.
;
DIR14:	LXI	H,0
	SHLD	W		;INITIALIZE ALLOCATION
	SHLD	I		;INITIALIZE INDEX
DIR16:	DLOAD	PDIR,I		;INDEX LOAD POINTER
	DJZ	ENDFIL		;EXIT IF POINTER ZERO
	CALL	DIR20		;CALL PRINT ROUTINE
	PRINT	'         '
	DLOAD	PDIR+LINE	SAVE	H
	LXI	D,10
	CPHL
	JM	DIR28
	PRINT	'  '
	JMP	DIR30
DIR28:	PRINT	'   '
DIR30:	POP	H
	PUSH	H
	XCHG
	LHLD	W
	DAD	D
	SHLD	W
	POP	H
	DECOUT
	PRINT	'K'
	RET
;
;
;    THIS ROUTINE RESTORES DRIVE B
;
FIXB:	LDA	NEWDRV		;CHECK DRIVE NO
	ORA	A
	RZ			;RETURN IF DRIVE A
	LDA	NEWDRV		;SELECT DRIVE B
	MOV	E,A
	DISKIO	LOGIN
	XRA	A
	STA	TNUM		;SELECT TRACK ZERO
	INR	A		;SELECT SECTOR 1
	STA	SNUM
	SETSEC	SNUM
	SETTRK	TNUM
	CALLBIOS DHOME		;HOME DRIVES
	CALLBIOS DREAD		;READ TRACK ZERO  SPACE REQUIRED IS PROPORTIONAL TO THE NO OF ITEMS TO BE
;    SORTED.
;
SORT:	LDA	COUNT		;NO OF ENTRIES IN DIR
	ORA	A
	JZ	ENDFIL		;EXIT IF DIRECTORY EMPTY
	DCR	A
	LXI	H,0		;ZERO HL
	MOV	L,A
	DAD	H
	SHLD	LAST		;END OF ARRAY
	LXI	H,0
	SHLD	FIRST		;START OF ARRAY
	LXI	H,0FFFFH
	PUSH	H		;FLAG FOR STACK EMPTY
	LHLD	FIRST
	PUSH	H
	LHLD	LAST
	PUSH	H		;STACK CONTAINS FIRST AND LAST INDICES
;
;    NOW POP STACK AND KEEP CALLING SPLIT RECURSIVELY TILL STACK EMPTY
;
SORT2:	POP	H
	MOV	A,H
	CPI	0AD	PDIR,J
	DSTORE	PDIR,I
	RESTORE	H
	DSTORE	PDIR,J
	JMP	SPLIT2
;
;   DATA ALLOCATIONS
;
LINES	EQU	16		;LINES PER PAGE ON DISPLAY
SPACE:	DB	' $'		;ASCII SPACE
CRLF:	DB	0DH,0AH,24H	;ASCII CR LF
I:	DW	0		;PSEUDO INDEX REGISTER
J:	DW	0		;PSEUDO INDEX REGISTER
K:	DW	0		;PSEUDO INDEX REGISTER
FIRST:	DW	0		;START OF ARRAY
LAST:	DW	0		;END OF ARRAY
W:	DW	0		;STORAGE FOR PARTITION INDEX
LINE:	DW	0		;LINE NUMBER FOR LISTING
IPOINT:	DW	00		;VARIABLE BUFFER POINTER
DRVNO:	DB	0		;STORAGE FOR ORIGINALLS*2,I	;POINTER COL 2
	DJZ	DIR18		;NO PRINT IF ZERO
	CALL	DIR20		;PRINT IT
	PRINT	'         '
	DLOAD	PDIR+LINES*4,I	;POINTER COL 3
	DJZ	DIR18
	CALL	DIR20		;CALL PRINT ROUTINE
DIR18:	PRINT	CRLF,$
	INDEX	I,2		;INCR INDEX BY 2
	LXI	D,LINES*2	;CHECK INDEX LIMIT
	CPHL
	JZ	ENDFIL		;EXIT WHEN INDEX 32
	JMP	DIR16		;PRINT SOME MORE
;
;    SUBROUTINE TO PRINT A SINGLE DIRECTORY ENTRY
;
DIR20:	MVI	C,11		;NAME LENGTH
DIR22:	SAVE	B,H		;SAVE REGISTERS
	MVI	C,2
	MOV	E,M		;CHAR TO BE PRINTER
	CALL	5		;CADIRECT
	RET
;
;    THIS IS THE EXIT POINT FROM THE PROGRAM. PRINT NO OF FILES AND
;    SPACE REMAINING, RELOAD OLD STACK POINTER AND RETURN BACK TO CCP.
;
ENDFIL:	PRINT	<CR,LF,'                '>
	LXI	H,0
	LDA	COUNT
	MOV	L,A
	DECOUT
	PRINT	' FILES    '
	LHLD	W
	MOV	A,L
	CMA
	INR	A		;NEGATE
	ADI	240
	MOV	L,A
	DECOUT
	PRINT	<'K BYTES REMAINING ON DISK',CR,LF>
EF1:	LHLD	OLDSTK
	SPHL			;RELOAD OLD STACK POINTER
	RET			;RETURN TO CCP WITHOUT REBOOT
;
DSKERR:	PRINT	<CR,LF,'ERROR - SELECT DFFH
	JZ	DIR14		;GO TO PRINT ROUTINE
	SHLD	J
	SHLD	LAST
	POP	H
	SHLD	I
	SHLD	FIRST
	CALL	SPLIT
	LHLD	I
	XCHG
	LHLD	FIRST
	CPHL
	JZ	SORT4
	PUSH	H		;I ON STACK
	DCX	D
	DCX	D
	PUSH	D		;J ON STACK
SORT4:	LHLD	J
	XCHG
	LHLD	LAST
	CPHL
	JZ	SORT8
	INX	D
	INX	D
	PUSH	D		;NEW I ON STACK
	PUSH	H		;NEW J ON STACK
SORT8:	JMP	SORT2
;
;    SPLIT SUBROUTINE DOES A SINGLE PARTITION ON AN ARRAY OF POINTERS
;
SPLIT:	HALF	I
	XCHG
	HALF	J
	DAD	D
	MOV	A,L
	ANI	0FEH
	MOV	L,A
	SHLD	K		;K=I+J/2Y LOGGED DRIVE
NEWDRV:	DB	0		;STORAGE FOR NEW DRIVE NO
TRACK:	DB	0		;SELECTED TRACK
BSEC:	DB	0		;SELECTED BEGINNING SECTOR
ESEC:	DB	0		;SELECTED ENDING SECTOR
TNUM:	DB	0		;TRACK NUMBER
SNUM:	DB	0		;SECTOR NUMBER
G:	DB	0		;CPM GROUP NO
S:	DB	0		;SECTOR NO WITHIN GROUP G
COUNT:	DB	0		;COUNT OF DIRECTORY ENTRIES
OLDSTK:	DW	0		;STORAGE FOR OLD STACK POINTER
ENDSTK:	DS	60		;STORAGE FOR NEW STACK
NEWSTK:	DW	0		;NEW STACK
INB:	DW	0		;STORES POINTER TO INPUT BUFFER AREA
OUTB:	DW	0		;STORES POINTER TO LL BDOS
	RESTORE	H,B		;RESTORE THE REGISTERS
	INX	H		;INCR NAME POINTER
	DCR	C		;DECR CHAR COUNT
	JZ	DIR24		;PRINT SIZE
	JMP	DIR22		;LOOP TILL COUNT 0
DIR24:	MOV	A,M		;EXTENSION TO A
	ADD	A
	ADD	A
	ADD	A
	ADD	A		;MULTIPLY BY 16
	MOV	B,A		;SAVE IN B
	INX	H
	INX	H
	INX	H		;ADD 3
	MOV	A,M		;GET RECORD COUNT
	RRC
	RRC
	RRC			;SHIFT RIGHT 3
	PUSH	PSW
	ANI	1FH		;EXTRACT
	LXI	H,0
	MOV	L,A		;NO TO HL TO PRINT
	POP	PSW
	ANI	0E0H		;EXTRACT
	JZ	DIR26
	INX	H
DIR26:	MOV	A,L
	ADD	B
	MOV	L,A
RIVE A OR B'>
	JMP	EF1		;EXIT
;
;    THIS SECTION DOES THE ACTUAL SORTING OF THE DIRECTORY. DURING THE
;    INPUT OF THE DIRECTORY NAMES, A TABLE OF ADDRESS POINTERS PDIR
;    WAS CONSTRUCTED. THE SORT ROUTINE SORTS THE ADDRESS POINTERS
;    RATHER THAN THE ACTUAL DIRECTORY. 
;    THIS IS AN IMPLEMENTATION OF C. A. R. HOARE'S QUICKSORT ALGORITHM.
;    THE ALGORITHM IS VERY FAST AND GENERALLY USEFUL, HOWEVER CAUTION
;    SHOULD BE USED WITH LARGE FILES. THE ALGORITHM IS RECURSIVE AND
;    THE STACK
	DLOAD	PDIR,K
	SHLD	W		;W IS POINTER TO PARTITION ELEMENT OF PDIR
SPLIT2:	DLOAD	PDIR,I		;GET ITEM FROM LEFT
	XCHG
	LHLD	W		;PARTITION ELEMENT
	MATCH	,,11		;CONPARE KEYS
	JP	SPLIT4
	INDEX	I,2		;INCR I
	JMP	SPLIT2
SPLIT4:	DLOAD	PDIR,J		;GET ITEM FROM RIGHT
	XCHG
	LHLD	W		;PARTITION ELEMENT
	XCHG
	MATCH	,,11		;COMPARE KEYS
	JP	SPLIT6
	INDEX	J,-2
	JMP	SPLIT4		;LOOP BACK
SPLIT6:	LHLD	I
	XCHG
	LHLD	J
	CPHL			;COMPARE I AND J
	RZ			;RET IF I = J
	DLOAD	PDIR,I		;SWITCH POINTERS
	SAVE	H
	DLODIRECTORY BUFFER AREA
TABLE:	DB	01H		;SECTOR LOOK UP TABLE
	DB	07H
	DB	0DH
	DB	13H
	DB	19H
	DB	05H
	DB	0BH
	DB	11H
	DB	17H
	DB	03H
	DB	09H
	DB	0FH
	DB	15H
	DB	02H
	DB	08H
	DB	0EH
	DB	14H
	DB	1AH
	DB	06H
	DB	0CH
	DB	12H
	DB	18H
	DB	04H
	DB	0AH
	DB	10H
	DB	16H
PDIR	DW	0		;POINTER TABLE TO DIRECTORY (64 ENTRIES MAX)
DIRBUF:	EQU	PDIR+130	;START OF AREA USED TO STORE AND SORT DIRECTORY
	END
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 *sщЙГ(
ERROR - SELECT DRIVE A OR B$
	Н Г:r·К‘=!  o)"a!  "_!яяе*_е*aеб|юяК"["aб"Y"_Н™*Yл*_|єВz}»КЃеХ*[л*a|єВЏ}»К–ХеГUГ¤Ї|g}oЙ*YНњл*[Нњ}жюo"]*]С^#Vл"c*YС^#Vлл*cНsтл*Y "YГЗ*[С^#Vлл*cлНsт*[юя"[Гл*Yл*[|єВ}»И*YС^#Vле*[С^#Vле*Yл!ССs#rбе*[л!ССs#rГЗ $
$                            Вz}»КЃеХ*[л*a|єВЏ}»К–ХеГUГ¤Ї|g}oЙ*YНњл*[Нњ      	
                                               	THIS, THE OBJECTIVE BECAME TO MAKE IT SUITABLE FOR TDL'S DISK
		BASIC RUNNING IN 64K. IT RUNS QUITE NICELY THAT WAY. ALL OF THE
		FEATURES OF THE ABOVE PROGRAM ARE RETAINED, AND A COUPLE OF NEW
		ONES HAVE BEEN IMPLEMENTED.

BIGTREK.BAS	THIS IS THE COMPACTED MACHINE CODE OF THE ABOVE FILE WHICH
		LOADS ABOUT 50 TIMES FASTER THAN THE ASCII VERSION (TDL DISK
		BASIC ONLY). THE PROPER STEPS TO LOAD THIS ARE AS FOLLOWS :
		(ASSUME YOU HAVE LOADED TDL BASIC INTO A 64K SYSTEM)...
			1 - OPEN#1,"I","BIGT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                !  9"s1±Г5& :poT))):q_жя><Ъ!С2k~2l2mЙН 2j:Ѓ ·К]:‚ юAВSЇ2jГ]юBВ>2jГЋ

                        DIRECTORY DRIVE - $`	Н :j·В°ГҐA

$ 	Н ГГГёB

$і	Н Н5Ї2q2p2r!Сѓ s#ВФ!S"µ!С"g:j_Н !Ђ "іН:l·7Кю?ЪO* .!"Н  :kюM?Ъ'O* ."%Н  * .'"0Н  *µл*і>еѕВG#ѕК3Гб#еХ ~·К®!  "[*[С^#Vл|µК®л*іХе#Г~И–А#ГtНsбСК•*[ "[ГY#Г¤x±И~#Г™ Н™бГбСб Н™:r<2r*µе*gл!  Сs#r*µ "µ*g "g*і  "і |єВх}»В2:q<2qГ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                REK.BAS"   <CR>
			2 - LOAD "B"		       <CR>
			3 - CLOSE#1,"I"		       <CR>
			4 - RUN			       <CR> 

TREKINFO.DOC	A BRIEF TUTORIAL ON THE RULES FOR PLAYING THIS, CROSS-REFER-
		ENCED WHERE POSSIBLE WITH THE FAMILIAR COMMANDS OF THE MORE
		COMMONLY AVAILABLE 'STARTREKS'.

TREKMOD.ASC	SEE EXPLANATION (IN POST-SCRIPT).

STRTRK/2.ASC	THIS IS INCLUDED BECAUSE I LIKE THE 'COMMUNICATIONS' AND 'MIS-
		SION-PROGRESS-REPORTS' THAT HAVE BEEN IMPLEMENTED IN THIS MUCH
		SMALLER (STILL > 20K) VERSION.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                п!  "c"Y*YС^#Vл|µК‘НђГ+         $!	Н *Yс^#Vл|µКnНђГS         $I	Н *Y^#Vл|µКnНђV	Н *Y "Y  |єВЉ}»К‘ГЕе^Н бБ#К¤Г’~‡‡‡‡G###~хж!  oсжаКї#}Ђoе
 |єВН}»ъбГЦ  $У	Н ГрГи   $д	Н бел*c"cбГ$ЕХецяяя	Ъ
 	л|µДю{Ж0__Н бСБЙНюГ,K$*	Н Й:j·И:j_Н Ї2n<2o:o·7Кeю?ЪeO* .!"cН  :nюM?ЪzO* ."xН  * ."ѓН  * .'"ЋН  ЙГ§
                $”	Н !  :roНюГЗ FILES    $ј	Н *c}/<ЖрoНюГъK BYTES REMAINING ON DISK
$Ю	Н		THIS DISK CONTAINS THE FOLLOWING FILES:


STARTREK.TXT	THIS IS THE ORIGINAL SOURCE FILE FROM WHICH THIS PACKAGE WAS
		DEVELOPED. IT IS PURPORTED TO RUN AS IS WITH MITS 8K BASIC. IT
		CONTAINS ALL THE REMARKS, AUTHOR CREDITS ETC. IF YOU HAVE THIS
		BASIC WITH ASCII-LOAD CAPABILITY, TRY IT !!

BIGTREK.ASC	THIS IS THE RESULT OF HAVING TRIED TO TRIM THE ABOVE SOURCE SO
		AS TO GET IT TO RUN (IN A 64K SYSTEM) WITH MICROSOFT'S MBASIC.
		IT PRESENTLY IS ALMOST SHORT ENOUGH, BUT NOT QUITE. BECAUSE OF
	NO MATTER HOW YOU GO WITH THIS, IT IS LIKELY THAT YOU WILL NEED 64K (PERHAPS
60K IF YOU USE 8K BASIC) TO RUN IT AT ALL. ONLY GUARANTEE IS THAT IT WILL RUN
WITH TDL DISK BASIC/64K AS IS.

SINCE I CAN RUN THIS, I LEAVE IT TO SOMEONE ELSE TO GET IT WORKING WITH EITHER
MICROSOFT DISK BASIC (OR BASIC-E). ONE SUGGESTION FOR THE FORMER PROJECT MIGHT
BE TO PARTITION THIS PROGRAM INTO TWO MODULES. THE FIRST WOULD CONTAIN ALL OF
THE LINES RELATING TO GALAXY INITIALIZATION, DIMENSIONING STATEMENTS, DATA-
TABLEOGGE ENCOUNTERED SHOULD BE ATTRIBUTED TO HONEST EXPERIMENTATION COMBINED
WITH (THE TYPICALLY) INADEQUATE DOCUMENTATION.



					HAVE FUN !!! - ZOSO


LATE NOTE:  THE EXPERIMENT WITH MERGING TWO OR MORE MODULES HAS BEEN TRIED. I
AM SAD TO REPORT THAT THIS APPROACH APPARENTLY DOES NOT WORK. IT SEEMS THAT
THE EFFECT OF THE 'MERGE' FUNCTION IS TO DESTROY DATA (IN ADDITION TO CERTAIN
LINE NUMBERS). MY THANKS TO MR. E. DOGGE FOR THIS INFO. E.D. ALSO SENT A 'TRIM-
JOB' OF 'BIGTREK' CALLED 'TREKMOD'; IT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                S AND ALL BEGINNING OF GAME DIALOGUE - IN OTHER WORDS, LINES NOT REFER-
ENCED AFTER GAME IS IN PROGRESS. THIS FILE MIGHT BE CALLED 'STARMOD1.ASC'. THE
OTHER MODULE, 'STARMOD2.ASC' WOULD CONTAIN EVERYTHING ELSE. THE LAST COMMAND
(TO BASIC) IN 'STARMOD1.ASC' WOULD BE: MERGE"STARMOD2.ASC". BOTH MODULES WOULD
HAVE TO BE RENUMBERED IN SUCH A WAY THAT AT THE BEGINNING OF THE 'MERGE', EACH
NEW LINE OF 'STARMOD2' WOULD WIPE OUT A LINE OF 'STARMOD1' WHICH HAD THE SAME
LINE NUMBER (UNTIL EVERY LINE OF FIRST MOD PLAYS THE SAME GAME, BUT LACKS THE 'SCO-
RING' AND 'VISUAL' FUNCTIONS. NOT TO DEMEAN MR. DOGGE'S EFFORT, I CAN'T PER-
SONALLY SEE HOW THIS PARTICULAR 'STARTREK' CAN BE MEANINGFUL WITHOUT THE SCO-
RING ROUTINE. IF THIS WERE MY 'BABY', I WOULD (IF NECESSARY) REDUCE EVERY BIT
OF (TEXTUAL) CONSOLE OUTPUT TO A 2 DIGIT CODE SO AS TO RETAIN 'SCORING'; THE
'VISUALS' ARE CUTE BUT NON-ESSENTIAL. SEE WHAT YOU THINK. ALSO !!! THERE ARE
(IN THE 'BIGTREK' FILES ONLY) SOME CRUCIAL ERROR TRAPS WHICH I INSERTED. LOOK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ULE WAS OVERWRITTEN BY A NEW LINE
FROM SECOND MODULE). ONE CHANGE WOULD BE NECESSITATED IN THE SECOND MODULE: IF
A PLAYER REPLIED 'Y' TO THE QUESTION, 'ANOTHER GAME ?' A BRANCH WOULD NEED TO
BE MADE TO A LINE WITH THE FOLLOWING COMMAND, - RUN "STARMOD1.ASC". THIS SOL-
UTION IS A BIT 'KLUGEY', BUT PERHAPS PREFERABLE TO FURTHER TRIMMING. SEE THE
'P.S.' BELOW; THE MICROSOFT MANUAL IMPLYS (BY NO PROHIBITION) THE LIKELIHOOD
OF SUCH (ABOVE-MENTIONED) ARTIFICES BEING EFFECTIVE. THE DISAPPOINTMENT THAT
MR. D
FOR THESE AT THE BEGINNING OF THE 'NAVIGATE' AND 'IMPULSE' SUBROUTINES. THE
COMMON STARTREK PRACTISE OF INPUTTING A '0' WARP-FACTOR (DISTANCE) TO ABORT
AN IMPROPERLY ENTERED NAVIGATION ROUTINE WILL, WITHOUT THESE TRAPS, GIVE YOU
A 'SUBSCRIPT OUT OF BOUNDS' ERROR, AND THE GAME WILL HAVE BEEN (LITERALLY)
LOST. I SUGGEST COPYING THESE EXACTLY IF YOU WILL BE TRYING THE 'TREKMOD' IM-
PLEMENTATION.



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                